!function(t,n){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{};function i(){return g.__string_rec(this,"")}var e,T={},p=p||{};function r(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}function ne(){}(T.HxOverrides=ne).__name__=!0,ne.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var r=t.split(" "),s=r[0].split("-"),a=r[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new ge("Invalid date format : "+t)}},ne.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},ne.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},ne.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},ne.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};function l(){}(T.Lambda=l).__name__=!0,l.array=function(t){for(var e,i=[],n=(e=t)instanceof Array?ne.iter(e):e.iterator();n.hasNext();){var r=n.next();i.push(r)}return i};function re(){}(T.Main=re).__name__=!0,re.main=function(){var t=1600,e=900;null!=y.get_primary()&&(t>y.get_primary().get_width()&&(t=y.get_primary().get_width()),e>y.get_primary().get_height()-30&&(e=y.get_primary().get_height()-30)),ve.start(new Y("Armory2D",t,e,null,new M(null,null,null,null,null,2)),re.initialized)},re.initialized=function(t){re.prefs={path:"",scaleFactor:1,keyMap:{selectMouseButton:"Left",grabKey:71,rotateKey:82,sizeKey:83,slowMovement:16,gridInvert:17,gridInvertRelative:18}};var e=Krom.getArgCount();if(4<e&&(re.prefs.path=Krom.getArg(3)),5<e){var i=parseFloat(Krom.getArg(4));re.prefs.scaleFactor=i}var n=re.prefs.path.split("/");n.pop(),re.cwd=n.join("/");var r="Windows"==ve.get_systemId()?he.replace(re.prefs.path,"/","\\"):re.prefs.path;me.loadBlobFromPath(r,function(t){var e=JSON.parse(t.toString());re.inst=new le(e)},null,{fileName:"Main.hx",lineNumber:57,className:"Main",methodName:"initialized"})},re.loadDefaultKeyMap=function(){re.prefs.keyMap.grabKey=71,re.prefs.keyMap.rotateKey=82,re.prefs.keyMap.sizeKey=83,re.prefs.keyMap.slowMovement=16,re.prefs.keyMap.gridInvert=17,re.prefs.keyMap.gridInvertRelative=18},Math.__name__=!0;function se(){}(T.Reflect=se).__name__=!0,se.field=function(t,e){try{return t[e]}catch(t){t instanceof ge&&t.val;return null}},se.getProperty=function(t,e){var i;return null==t?null:!!t.__properties__&&(i=t.__properties__["get_"+e])?t[i]():t[e]},se.setProperty=function(t,e,i){var n;!!t.__properties__&&(n=t.__properties__["set_"+e])?t[n](i):t[e]=i},se.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},se.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},se.copy=function(t){if(null==t)return null;for(var e={},i=0,n=se.fields(t);i<n.length;){var r=n[i];++i,e[r]=se.field(t,r)}return e};function ae(){}(T.Std=ae).__name__=!0,ae.string=function(t){return g.__string_rec(t,"")},ae.parseInt=function(t){if(null!=t)for(var e=0,i=t.length;e<i;){var n=e++,r=t.charCodeAt(n);if(r<=8||14<=r&&32!=r&&45!=r){var s=parseInt(t,"x"==t[1+n]||"X"==t[1+n]?16:10);return isNaN(s)?null:s}}return null};var he=function(){};(T.StringTools=he).__name__=!0,he.endsWith=function(t,e){var i=e.length,n=t.length;return i<=n&&t.indexOf(e,n-i)==n-i},he.isSpace=function(t,e){var i=ne.cca(t,e);return 8<i&&i<14||32==i},he.rtrim=function(t){for(var e=t.length,i=0;i<e&&he.isSpace(t,e-i-1);)++i;return 0<i?ne.substr(t,0,e-i):t},he.replace=function(t,e,i){return t.split(e).join(i)};function S(){}(T.Type=S).__name__=!0,S.createEnum=function(t,e,i){var n=se.field(t,e);if(null==n)throw new ge("No such constructor "+e);if(se.isFunction(n)){if(null==i)throw new ge("Constructor "+e+" need parameters");return n.apply(t,i)}if(null!=i&&0!=i.length)throw new ge("Constructor "+e+" does not need parameters");return n},S.getInstanceFields=function(t){var e=[];for(var i in t.prototype)e.push(i);return ne.remove(e,"__class__"),ne.remove(e,"__properties__"),e};var Ot={};(T["_UInt.UInt_Impl_"]=Ot).__name__=!0,Ot.gt=function(t,e){var i=t<0;return i!=e<0?i:e<t},Ot.gte=function(t,e){var i=t<0;return i!=e<0?i:e<=t},Ot.toFloat=function(t){return t<0?4294967296+t:t+0};function oe(){}(T["arm2d.Assets"]=oe).__name__=!0,oe.getImage=function(t){return Ci.assetMap.h[t.id]},oe.getFont=function(t){return Ci.assetMap.h[t.id]},oe.importAsset=function(s,a){var t=ue.toAbsolute(a,re.cwd);t="Windows"==ve.get_systemId()?he.replace(t,"/","\\"):t,oe.isPathImage(a)?me.loadImageFromPath(t,!1,function(t){var e=a.split("/"),i=e[e.length-1],n=Ci.getAssetId(s),r={name:i,file:a,id:n};s.assets.push(r),Ci.assetMap.h[r.id]=t,le.assetNames.push(i),fe.hwin.redraws=2},null,{fileName:"arm2d/Assets.hx",lineNumber:25,className:"arm2d.Assets",methodName:"importAsset"}):"ttf"==pe.extension(a).toLowerCase()&&me.loadFontFromPath(t,function(t){var e=a.split("/"),i=e[e.length-1],n=Ci.getAssetId(s),r={name:i,file:a,id:n};s.assets.push(r),Ci.assetMap.h[r.id]=t,le.assetNames.push(i),fe.hwin.redraws=2},null,{fileName:"arm2d/Assets.hx",lineNumber:37,className:"arm2d.Assets",methodName:"importAsset"})},oe.importThemes=function(){var t=pe.directory(re.prefs.path),e=pe.join([t,"_themes.json"]);e="Windows"==ve.get_systemId()?he.replace(e,"/","\\"):e;try{me.loadBlobFromPath(e,function(t){Ci.themes=JSON.parse(t.toString()),0==Ci.themes.length&&Ci.themes.push(se.copy(Fi.light)),null!=re.inst&&(le.selectedTheme=Ci.themes[0])},function(t){Ci.themes.push(se.copy(Fi.light)),null!=re.inst&&(le.selectedTheme=Ci.themes[0])},{fileName:"arm2d/Assets.hx",lineNumber:60,className:"arm2d.Assets",methodName:"importThemes"})}catch(t){t instanceof ge&&t.val;Ci.themes.push(se.copy(Fi.light)),null!=re.inst&&(le.selectedTheme=Ci.themes[0])}},oe.save=function(t){t.x=0,t.y=0,oe.saveCanvas(t),oe.saveAssets(t),oe.saveThemes(),t.x=le.coffX,t.y=le.coffY},oe.saveCanvas=function(t){Krom.fileSaveBytes(re.prefs.path,ht.ofString(JSON.stringify(t)).b.bufferValue)},oe.saveAssets=function(t){var e=ne.substr(re.prefs.path,0,re.prefs.path.length-5);e+=".files";for(var i="",n=0,r=t.assets;n<r.length;){var s=r[n];++n,i+=s.file+"\n"}Krom.fileSaveBytes(e,ht.ofString(i).b.bufferValue)},oe.saveThemes=function(){var t=pe.join([pe.directory(re.prefs.path),"_themes.json"]);Krom.fileSaveBytes(t,ht.ofString(JSON.stringify(Ci.themes)).b.bufferValue)},oe.getEnumTexts=function(){return null==re.inst?[""]:0<le.assetNames.length?le.assetNames:[""]},oe.getAssetIndex=function(t,e){for(var i=0,n=t.assets.length;i<n;){var r=i++;if(e==t.assets[r].name)return 1+r}return 0},oe.isPathImage=function(t){var e=pe.extension(t).toLowerCase();return"jpg"==e||"png"==e||"k"==e||"hdr"==e},oe.isPathFont=function(t){return"ttf"==pe.extension(t).toLowerCase()};var le=function(t){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.selectedFrame=0,this.zoom=1,this.resizeCanvas=!1,this.dropPath="",0<(this.canvas=t).assets.length){var e=t.assets;t.assets=[];for(var i=0;i<e.length;){var n=e[i];++i,oe.importAsset(t,n.file)}}oe.importThemes(),me.loadEverything(Mi(this,this.loaded))};(T["arm2d.Editor"]=le).__name__=!0,le.__properties__={get_uiw:"get_uiw"},le.get_uiw=function(){return le.windowW*re.prefs.scaleFactor|0},le.prototype={ui:null,cui:null,canvas:null,toolbarw:null,get_toolbarw:function(){return 140*this.ui.ops.scaleFactor|0},dropPath:null,resizeCanvas:null,zoom:null,uimodal:null,selectedFrame:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var e=this,t=se.copy(Fi.dark);t.FILL_WINDOW_BG=!0,this.ui=new Ai({scaleFactor:re.prefs.scaleFactor,font:me.fonts.font_default,theme:t,color_wheel:me.images.color_wheel}),this.cui=new Ai({scaleFactor:1,font:me.fonts.font_default,autoNotifyInput:!0,theme:se.copy(Ci.getTheme(this.canvas.theme))}),this.uimodal=new Ai({font:me.fonts.font_default,scaleFactor:re.prefs.scaleFactor}),X.initialize(this.ui,this.cui),null==Ci.getTheme(this.canvas.theme)&&(Li.showMessage(new Ai(this.ui.ops),"Warning!",'Theme "'+this.canvas.theme+'" was not found!\nUsing first theme in list instead: "'+Ci.themes[0].NAME+'"'),this.canvas.theme=Ci.themes[0].NAME),ve.notifyOnDropFiles(function(t){e.dropPath=he.rtrim(t),e.dropPath=ue.toRelative(e.dropPath,re.cwd)}),ve.notifyOnFrames(Mi(this,this.onFrames)),G.addTimeTask(Mi(this,this.update),0,.016666666666666666)},resize:function(){null!=le.grid&&(le.grid.unload(),le.grid=null),null!=le.timeline&&(le.timeline.unload(),le.timeline=null)},drawGrid:function(){var t=le.gridSize*this.cui.ops.scaleFactor|0,e=2*le.gridSize*this.cui.ops.scaleFactor|0,i=ve.windowWidth()+2*e,n=ve.windowHeight()+2*e;le.grid=P.createRenderTarget(i,n),le.grid.get_g2().begin(!0,-14408668);for(var r=0,s=1+(n/e|0);r<s;){var a=r++;le.grid.get_g2().set_color(-14145496),le.grid.get_g2().drawLine(0,a*e+t,i,a*e+t),le.grid.get_g2().set_color(-13487566),le.grid.get_g2().drawLine(0,a*e,i,a*e)}for(var o=0,l=1+(i/e|0);o<l;){var u=o++;le.grid.get_g2().set_color(-14145496),le.grid.get_g2().drawLine(u*e+t,0,u*e+t,n),le.grid.get_g2().set_color(-13487566),le.grid.get_g2().drawLine(u*e,0,u*e,n)}le.grid.get_g2().end()},drawTimeline:function(t,e){var i=this.ui.ops.scaleFactor,n=t+e;le.timeline=P.createRenderTarget(ve.windowWidth()-le.get_uiw()-this.get_toolbarw(),n);var r=le.timeline.get_g2();r.begin(!0,-14540254),r.set_font(me.fonts.font_default),r.set_fontSize(16*i|0);for(var s=le.timeline.get_width()/(11*i)|0,a=0,o=1+(s/5|0);a<o;){var l=a++,u=5*l,h=me.fonts.font_default.width(r.get_fontSize(),u+"");r.drawString(u+"",55*l*i+5*i-h/2,t/2-r.get_fontSize()/2)}for(var c=0,d=s;c<d;){var _=c++;r.set_color(_%5==0?-12303292:-13421773),r.fillRect(11*_*i,n-e,10*i,e)}r.end()},onFrames:function(t){var e=t[0];Li.show&&this.ui.inputRegistered?(this.ui.unregisterInput(),this.cui.unregisterInput()):Li.show||this.ui.inputRegistered||(this.ui.registerInput(),this.cui.registerInput()),Li.show&&(fe.hwin.redraws=1),""!=this.dropPath&&(oe.importAsset(this.canvas,this.dropPath),this.dropPath="");var i=this.ui.ops.scaleFactor,n=30*i|0,r=40*i|0;null==le.grid&&this.drawGrid(),null!=le.timeline&&le.timeline.get_height()==n+r||this.drawTimeline(n,r);var s=e.get_g2();s.begin(),s.set_color(-1);var a=2*le.gridSize*this.cui.ops.scaleFactor|0;s.drawImage(le.grid,le.coffX%a-a,le.coffY%a-a),this.canvas.x=le.coffX,this.canvas.y=le.coffY,s.drawRect(this.canvas.x,this.canvas.y,this.canvas.width*this.cui.ops.scaleFactor|0,this.canvas.height*this.cui.ops.scaleFactor|0,1);var o=8*X.ui.ops.scaleFactor|0;de.hitbox(this.cui,this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-o/2,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-o/2,o,o)&&(s.set_color(-14656100),s.fillRect(this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-o/2,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-o/2,o,o),s.set_color(-1)),s.drawRect(this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-o/2,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-o/2,o,o,1),Ci.screenW=this.canvas.width,Ci.screenH=this.canvas.height,Ci.draw(this.cui,this.canvas,s),X.render(s,this.canvas),""!=le.currentOperation&&(s.set_fontSize(14*this.ui.ops.scaleFactor|0),s.set_color(-5592406),s.drawString(le.currentOperation,this.get_toolbarw(),ve.windowHeight()-le.timeline.get_height()-s.get_fontSize()));s.set_color(-1);var l=ve.windowHeight()-le.timeline.get_height();s.drawImage(le.timeline,this.get_toolbarw(),l),s.set_color(-14656100),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i,l+n,10*i,r),s.set_font(me.fonts.font_default),s.set_fontSize(16*i|0);var u=4*i,h=4*i,c=30*i,d=n-2*u,_=me.fonts.font_default.width(s.get_fontSize(),""+this.selectedFrame);if(c+h<_&&(c=_+h),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i+5*i-c/2,l+u,c,d),s.set_color(-1),s.drawString(""+this.selectedFrame,this.get_toolbarw()+11*this.selectedFrame*i+5*i-_/2,l+n/2-s.get_fontSize()/2),s.end(),this.ui.begin(s),m.renderToolbar(this.ui,this.cui,this.canvas,this.get_toolbarw()),this.ui.window(_e.global.nest(61,null),this.get_toolbarw(),0,ve.windowWidth()-le.get_uiw()-this.get_toolbarw(),(this.ui.t.ELEMENT_H+2)*this.ui.ops.scaleFactor|0)&&this.ui.tab(_e.global.nest(62,null),this.canvas.name),fe.renderProperties(this.ui,le.get_uiw(),this.canvas),this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),s.begin(!1),null!=le.dragAsset){var f=Math.min(128,oe.getImage(le.dragAsset).get_width()),p=f/oe.getImage(le.dragAsset).get_width(),g=oe.getImage(le.dragAsset).get_height()*p;s.drawScaledImage(oe.getImage(le.dragAsset),this.ui.inputX,this.ui.inputY,f,g)}s.end(),0<this.lastW&&(this.lastW!=ve.windowWidth()||this.lastH!=ve.windowHeight())?this.resize():0<this.lastCanvasW&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=ve.windowWidth(),this.lastH=ve.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,le.showFiles&&this.renderFiles(s),Li.show&&Li.render(s)},acceptDrag:function(t){var e=ce.makeElem(this.cui,this.canvas,1);e.asset=le.assetNames[t+1],e.x=this.ui.inputX-this.canvas.x,e.y=this.ui.inputY-this.canvas.y,e.width=oe.getImage(this.canvas.assets[t]).get_width(),e.height=oe.getImage(this.canvas.assets[t]).get_height(),le.selectedElem=e},update:function(){if(this.ui.inputReleased&&null!=le.dragAsset){if(this.ui.inputX<ve.windowWidth()-le.get_uiw()){for(var t=0,e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(this.canvas.assets[n]==le.dragAsset){t=n;break}}this.acceptDrag(t)}le.dragAsset=null}if(null==le.dragAsset){if(this.updateCanvas(),null!=le.timeline){var r=ve.windowHeight()-le.timeline.get_height();this.ui.inputDown&&this.ui.inputY>r&&this.ui.inputX<ve.windowWidth()-le.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=(this.ui.inputX-this.get_toolbarw())/11/this.ui.ops.scaleFactor|0)}X.update(this.ui,this.cui,this.canvas),Li.show&&Li.update(),this.updateFiles()}},updateCanvas:function(){if(!(le.showFiles||this.ui.inputX>ve.windowWidth()-le.get_uiw())){if(X.selectElement(this.canvas),!X.isManipulating&&(this.ui.inputDownR&&(le.coffX+=0|this.ui.inputDX,le.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta)){var t=this.zoom;this.zoom+=-this.ui.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.setScale(this.zoom),t!=this.zoom&&this.drawGrid()}var e=8*X.ui.ops.scaleFactor|0;this.ui.inputStarted&&de.hitbox(this.cui,this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-e/2,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-e/2,e,e)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,this.canvas.width<1&&(this.canvas.width=1),this.canvas.height<1&&(this.canvas.height=1))}},updateFiles:function(){if(le.showFiles&&this.ui.inputReleased){var t=ve.windowWidth(),e=ve.windowHeight(),i=t/2-le.modalRectW/2,n=t/2+le.modalRectW/2,r=e/2-le.modalRectH/2,s=e/2+le.modalRectH/2;(this.ui.inputX<i||this.ui.inputX>n||this.ui.inputY<r+le.modalHeaderH||this.ui.inputY>s)&&(le.showFiles=!1)}},renderFiles:function(t){var e=ve.windowWidth(),i=ve.windowHeight(),n=e/2-le.modalW/2,r=i/2-le.modalH/2;t.begin(!1),t.set_color(-14671840),t.fillRect(n,r,le.modalW,le.modalH),t.end();var s=e/2-le.modalRectW/2|0,a=e/2+le.modalRectW/2|0,o=i/2-le.modalRectH/2|0,l=i/2+le.modalRectH/2|0;if(o+=le.modalHeaderH,this.uimodal.begin(t),this.uimodal.window(_e.global.nest(63,null),s,o,le.modalRectW,le.modalRectH-100)){var u=_e.global.nest(64,null);u.text=this.uimodal.textInput(u),le.path=Bi.fileBrowser(this.uimodal,u,le.foldersOnly)}this.uimodal.end(!1),t.begin(!1),this.uimodal.beginRegion(t,a-100,l-30,100),this.uimodal.button("OK")&&(le.showFiles=!1,le.filesDone(le.path)),this.uimodal.endRegion(!1),this.uimodal.beginRegion(t,a-200,l-30,100),this.uimodal.button("Cancel")&&(le.showFiles=!1),this.uimodal.endRegion(),t.end()},scaled:function(t){return t*this.cui.ops.scaleFactor|0},__class__:le,__properties__:{get_toolbarw:"get_toolbarw"}};var X=function(){};(T["arm2d.ElementController"]=X).__name__=!0,X.__properties__={get_handleSize:"get_handleSize"},X.get_handleSize=function(){return 8*X.ui.ops.scaleFactor|0},X.initialize=function(t,e){X.ui=t,X.cui=e},X.selectElement=function(t){if(null!=X.ui){var e=re.prefs.keyMap.selectMouseButton;if("Left"==e&&X.ui.inputStarted&&X.ui.inputDown||"Right"==e&&X.ui.inputStartedR&&X.ui.inputDownR){var i=le.selectedElem;le.selectedElem=null;var n=t.elements.slice();n.reverse();for(var r=0;r<n.length;){var s=n[r];++r;var a=Ci.getAnchorOffset(t,s),o=(de.absx(t,s)*X.cui.ops.scaleFactor|0)+a[0],l=(de.absy(t,s)*X.cui.ops.scaleFactor|0)+a[1],u=s.width*X.cui.ops.scaleFactor|0,h=s.height*X.cui.ops.scaleFactor|0,c=t.x+o+u/2,d=t.y+l+h/2,_=c-(8*X.ui.ops.scaleFactor|0)/2,f=t.y+l-2*(8*X.ui.ops.scaleFactor|0)-(8*X.ui.ops.scaleFactor|0)/2,p=2*(8*X.ui.ops.scaleFactor|0)+(8*X.ui.ops.scaleFactor|0)/2;if(de.hitbox(X.cui,t.x+o-(8*X.ui.ops.scaleFactor|0)/2,t.y+l-(8*X.ui.ops.scaleFactor|0)/2,u+(8*X.ui.ops.scaleFactor|0),h+(8*X.ui.ops.scaleFactor|0),s.rotation)||de.hitbox(X.cui,_,f,8*X.ui.ops.scaleFactor|0,p,s.rotation,[c,d])&&i==s){le.selectedElem=s;break}}}}},X.render=function(t,e){if(null!=le.selectedElem){var i=Ci.getAnchorOffset(e,le.selectedElem),n=(de.absx(e,le.selectedElem)*X.cui.ops.scaleFactor|0)+i[0],r=(de.absy(e,le.selectedElem)*X.cui.ops.scaleFactor|0)+i[1],s=le.selectedElem.width*X.cui.ops.scaleFactor|0,a=le.selectedElem.height*X.cui.ops.scaleFactor|0,o=e.x+n+s/2,l=e.y+r+a/2;t.pushRotation(le.selectedElem.rotation,o,l),t.set_color(-1),t.drawRect(e.x+n,e.y+r,s,a),t.set_color(-16777216),t.drawRect(e.x+n+1,e.y+r+1,s,a),t.set_color(-1);for(var u=de.rotatePoint(X.ui.inputX,X.ui.inputY,o,l,-le.selectedElem.rotation),h=0;h<3;)for(var c=h++/2,d=0;d<3;){var _=d++/2;if(.5!=c||.5!=_){var f=e.x+n+s*c-(8*X.ui.ops.scaleFactor|0)/2,p=e.y+r+a*_-(8*X.ui.ops.scaleFactor|0)/2,g=!1;0==c&&X.dragLeft?0==_&&X.dragTop?g=!0:.5!=_||X.dragTop||X.dragBottom?1==_&&X.dragBottom&&(g=!0):g=!0:.5!=c||X.dragLeft||X.dragRight?1==c&&X.dragRight&&(0==_&&X.dragTop?g=!0:.5!=_||X.dragTop||X.dragBottom?1==_&&X.dragBottom&&(g=!0):g=!0):0==_&&X.dragTop?g=!0:1==_&&X.dragBottom&&(g=!0),g=g&&X.drag,(u.x>f&&u.x<f+(8*X.ui.ops.scaleFactor|0)||g)&&(u.y>p&&u.y<p+(8*X.ui.ops.scaleFactor|0)||g)&&(t.set_color(-14656100),t.fillRect(f,p,8*X.ui.ops.scaleFactor|0,8*X.ui.ops.scaleFactor|0),t.set_color(-1)),t.drawRect(f,p,8*X.ui.ops.scaleFactor|0,8*X.ui.ops.scaleFactor|0)}}t.drawLine(o,e.y+r,o,e.y+r-2*(8*X.ui.ops.scaleFactor|0));var m=o,v=e.y+r-2*(8*X.ui.ops.scaleFactor|0);null==v&&(v=0),null==m&&(m=0);var b=m,w=v,y=u.x-b,x=u.y-w;null==x&&(x=0),null==y&&(y=0);(Math.sqrt(y*y+x*x)<=(8*X.ui.ops.scaleFactor|0)/2||X.rotate)&&(t.set_color(-14656100),be.fillCircle(t,b,w,(8*X.ui.ops.scaleFactor|0)/2),t.set_color(-1)),be.drawCircle(t,b,w,(8*X.ui.ops.scaleFactor|0)/2),t.popTransformation()}},X.update=function(t,e,i){if(X.ui=t,X.cui=e,null!=le.selectedElem){var n=le.selectedElem,r=Ci.getAnchorOffset(i,n),s=(de.absx(i,n)*X.cui.ops.scaleFactor|0)+r[0],a=(de.absy(i,n)*X.cui.ops.scaleFactor|0)+r[1],o=n.width*X.cui.ops.scaleFactor|0,l=n.height*X.cui.ops.scaleFactor|0,u=de.rotatePoint(t.inputX,t.inputY,i.x+s+o/2,i.y+a+l/2,-n.rotation);if(t.inputStarted&&t.inputDown)if(de.hitbox(t,i.x+s-(8*X.ui.ops.scaleFactor|0)/2,i.y+a-(8*X.ui.ops.scaleFactor|0)/2,o+(8*X.ui.ops.scaleFactor|0),l+(8*X.ui.ops.scaleFactor|0),le.selectedElem.rotation))X.drag=!0,X.dragLeft=X.dragRight=X.dragTop=X.dragBottom=!1,u.x>i.x+s+o-(8*X.ui.ops.scaleFactor|0)?X.dragRight=!0:u.x<i.x+s+(8*X.ui.ops.scaleFactor|0)&&(X.dragLeft=!0),u.y>i.y+a+l-(8*X.ui.ops.scaleFactor|0)?X.dragBottom=!0:u.y<i.y+a+(8*X.ui.ops.scaleFactor|0)&&(X.dragTop=!0),X.startElementManipulation(!0);else{var h=i.x+s+o/2,c=i.y+a-2*(8*X.ui.ops.scaleFactor|0);null==c&&(c=0),null==h&&(h=0);var d=h,_=c,f=u.x-d,p=u.y-_;null==p&&(p=0),null==f&&(f=0);Math.sqrt(f*f+p*p)<=(8*X.ui.ops.scaleFactor|0)&&(X.rotate=!0,X.startElementManipulation(!0))}if(X.isManipulating)if(fe.hwin.redraws=2,X.transformStartedMouse&&t.inputReleased||!X.transformStartedMouse&&t.inputStarted)X.endElementManipulation();else if(t.isKeyPressed&&t.isEscapeDown||t.inputStartedR)X.endElementManipulation(!0);else if(X.drag){var g=t.inputX,m=t.inputY;null==m&&(m=0),null==g&&(g=0);var v=g,b=m,w=X.transformInitInput,y=v-w.x,x=b-w.y;null==x&&(x=0),null==y&&(y=0);var T=y,S=x;X.transformStartedMouse||(t.isKeyPressed&&88==t.key&&(n.width=0|X.transformInitSize.x,n.height=0|X.transformInitSize.y,X.dragRight=!0,X.dragBottom=!X.dragBottom),t.isKeyPressed&&89==t.key&&(n.width=0|X.transformInitSize.x,n.height=0|X.transformInitSize.y,X.dragBottom=!0,X.dragRight=!X.dragRight)),X.dragRight?(T=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,T,X.transformInitPos.x+X.transformInitSize.x),n.width=X.transformInitSize.x+T|0):X.dragLeft&&(T=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,T,X.transformInitPos.x),n.x=X.transformInitPos.x+T,n.width=X.transformInitSize.x-T|0),X.dragBottom?(S=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,S,X.transformInitPos.y+X.transformInitSize.y),n.height=X.transformInitSize.y+S|0):X.dragTop&&(S=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,S,X.transformInitPos.y),n.y=X.transformInitPos.y+S,n.height=X.transformInitSize.y-S|0),1!=n.type&&(n.width<1&&(n.width=1),n.height<1&&(n.height=1)),X.dragLeft||X.dragRight||X.dragBottom||X.dragTop?((X.dragBottom||X.dragTop)&&(X.dragLeft||X.dragRight)||(S=0),le.currentOperation=" x: "+n.x+"  y: "+n.y+"  w: "+n.width+"  h: "+n.height+"  (dx: "+T+"  dy: "+S+")"):(X.grab=!0,X.grabX=!0,X.grabY=!0,X.drag=!1)}else if(X.grab){var k=t.inputX,I=t.inputY;null==I&&(I=0),null==k&&(k=0);var E=k,C=I,B=X.transformInitInput,N=E-B.x,L=C-B.y;null==L&&(L=0),null==N&&(N=0);var F=N,A=L;t.isKeyPressed&&88==t.key&&(n.x=X.transformInitPos.x,n.y=X.transformInitPos.y,X.grabX=!0,X.grabY=!X.grabY),t.isKeyPressed&&89==t.key&&(n.x=X.transformInitPos.x,n.y=X.transformInitPos.y,X.grabY=!0,X.grabX=!X.grabX),X.grabX&&(F=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,F,X.transformInitPos.x),n.x=X.transformInitPos.x+F|0),X.grabY&&(A=de.calculateTransformDelta(t,le.gridSnapPos,le.gridUseRelative,le.gridSize,A,X.transformInitPos.y),n.y=X.transformInitPos.y+A|0),X.grabX?X.grabY||(A=0):F=0,le.currentOperation=" x: "+n.x+"  y: "+n.y+"  (dx: "+F+"  dy: "+A+")"}else if(X.rotate){var M=i.x+s+o/2,O=i.y+a+l/2;null==O&&(O=0),null==M&&(M=0);var P=M,R=O,V=t.inputX,D=t.inputY;null==D&&(D=0),null==V&&(V=0);var U=V-P,H=D-R;null==H&&(H=0),null==U&&(U=0);var W=U,G=H,z=-Math.atan2(W,G)+Math.PI;(t.isKeyDown&&t.key==re.prefs.keyMap.gridInvert)!=le.useRotationSteps&&(z=Math.round(z/le.rotationSteps)*le.rotationSteps),n.rotation=z,le.currentOperation=" Rot: "+de.roundPrecision(57.29578*z,2)+"deg"}t.isKeyPressed&&!t.isTyping&&(X.grab||t.key!=re.prefs.keyMap.grabKey||(X.startElementManipulation(),X.grab=!0,X.grabX=!0,X.grabY=!0),X.drag||t.key!=re.prefs.keyMap.sizeKey||(X.startElementManipulation(),X.drag=!0,X.dragLeft=!1,X.dragTop=!1,X.dragRight=!0,X.dragBottom=!0),X.rotate||t.key!=re.prefs.keyMap.rotateKey||(X.startElementManipulation(),X.rotate=!0),X.isManipulating||(37==t.key&&(le.gridSnapPos?n.x-=le.gridSize:n.x--),39==t.key&&(le.gridSnapPos?n.x+=le.gridSize:n.x++),38==t.key&&(le.gridSnapPos?n.y-=le.gridSize:n.y--),40==t.key&&(le.gridSnapPos?n.y+=le.gridSize:n.y++),t.isBackspaceDown||t.isDeleteDown?(ce.removeElem(i,le.selectedElem),le.selectedElem=null):68==t.key&&(le.selectedElem=ce.duplicateElem(i,n))))}else X.endElementManipulation()},X.startElementManipulation=function(t){null==t&&(t=!1),X.isManipulating&&X.endElementManipulation(!0),X.transformInitInput=new mi(X.ui.inputX,X.ui.inputY),X.transformInitPos=new mi(le.selectedElem.x,le.selectedElem.y),X.transformInitSize=new mi(le.selectedElem.width,le.selectedElem.height),X.transformInitRot=le.selectedElem.rotation,X.transformStartedMouse=t,X.isManipulating=!0},X.endElementManipulation=function(t){null==t&&(t=!1),t&&(le.selectedElem.x=X.transformInitPos.x,le.selectedElem.y=X.transformInitPos.y,le.selectedElem.width=0|X.transformInitSize.x,le.selectedElem.height=0|X.transformInitSize.y,le.selectedElem.rotation=X.transformInitRot),X.isManipulating=!1,X.grab=!1,X.drag=!1,X.rotate=!1,X.transformStartedMouse=!1,le.currentOperation=""},X.scaled=function(t){return t*X.cui.ops.scaleFactor|0};var ue=function(){};(T["arm2d.Path"]=ue).__name__=!0,ue.toRelative=function(t,e){t=pe.normalize(t),e=pe.normalize(e);for(var i=[],n=t.split("/"),r=e.split("/"),s=0;n[s]==r[s];)++s;for(var a=0,o=r.length-s;a<o;){a++;i.push("..")}for(var l=s,u=n.length;l<u;){var h=l++;i.push(n[h])}return i.join("/")},ue.toAbsolute=function(t,e){return pe.normalize(e+"/"+t)};var ce=function(){};(T["arm2d.tools.CanvasTools"]=ce).__name__=!0,ce.makeElem=function(t,e,i){var n="",r=t.t.ELEMENT_H,s=0;switch(i){case 0:n=ce.unique("Text",e.elements,"name");break;case 1:n=ce.unique("Image",e.elements,"name"),r=100;break;case 2:n=ce.unique("Button",e.elements,"name"),s=1;break;case 3:n=ce.unique("Empty",e.elements,"name"),r=100;break;case 6:n=ce.unique("Check",e.elements,"name");break;case 7:n=ce.unique("Radio",e.elements,"name");break;case 8:n=ce.unique("Combo",e.elements,"name");break;case 9:n=ce.unique("Slider",e.elements,"name"),s=2;break;case 10:n=ce.unique("TextInput",e.elements,"name");break;case 11:n=ce.unique("KeyInput",e.elements,"name");break;case 12:n=ce.unique("Filled_Rectangle",e.elements,"name"),r=100;break;case 13:n=ce.unique("Rectangle",e.elements,"name"),r=100;break;case 14:n=ce.unique("Filled_Circle",e.elements,"name");break;case 15:n=ce.unique("Circle",e.elements,"name");break;case 16:n=ce.unique("Filled_Triangle",e.elements,"name");break;case 17:n=ce.unique("Triangle",e.elements,"name");break;case 18:n=ce.unique("Progress_bar",e.elements,"name");break;case 19:n=ce.unique("CProgress_bar",e.elements,"name")}var a={id:Ci.getElementId(e),type:i,name:n,event:"",x:0,y:0,width:150,height:r,rotation:0,text:"My "+n,asset:"",progress_at:0,progress_total:100,strength:1,alignment:g.__cast(s,Oi),anchor:0,parent:null,children:[],visible:!0};return e.elements.push(a),a},ce.unique=function(t,e,i,n){null==n&&(n=-1);var r=t,s=t.lastIndexOf(".");-1!=s&&4==t.substring(s).length&&(r=t.substring(0,s));for(var a=0;a<e.length;){var o=e[a];if(++a,se.getProperty(o,i)==t){if(-1<n){var l=(null==++n?"null":""+n).length;3<l&&(l=3);for(var u=".",h=0,c=3-l;h<c;){h++;u+="0"}return ce.unique(r+u+(null==n?"null":""+n),e,i,n)}return ce.unique(r,e,i,0)}}return t},ce.moveElem=function(t,e,i){for(var n=t.elements,r=n.indexOf(e),s=e.parent;!((r+=i)<0||r>=n.length);)if(n[r].parent==s){ne.remove(n,e),n.splice(r,0,e);break}},ce.removeElem=function(t,e){if(null!=e.children)for(var i=0,n=e.children;i<n.length;){var r=n[i];++i,ce.removeElem(t,ce.elemById(t,r))}ne.remove(t.elements,e),null!=e.parent&&(ne.remove(ce.elemById(t,e.parent).children,e.id),e.parent=null)},ce.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var r=n[i];if(++i,r.id==e)return r}return null},ce.unparent=function(t,e){var i=ce.elemById(t,e.parent);null!=i&&(e.x+=de.absx(t,i),e.y+=de.absy(t,i),e.parent=null,ne.remove(i.children,e.id))},ce.setParent=function(t,e,i){ce.elemById(t,e.parent)!=i&&(ce.unparent(t,e),null!=i&&(null==i.children&&(e.children=[]),i.children.push(e.id),e.parent=i.id,e.x-=de.absx(t,i),e.y-=de.absy(t,i)))},ce.duplicateElem=function(t,e,i){if(null==e)return null;null==i&&(i=e.parent);var n={id:Ci.getElementId(t),type:e.type,name:e.name,event:e.event,x:e.x+10,y:e.y+10,width:e.width,height:e.height,rotation:e.rotation,text:e.text,asset:e.asset,color:e.color,color_text:e.color_text,color_hover:e.color_hover,color_press:e.color_press,color_progress:e.color_progress,progress_at:e.progress_at,progress_total:e.progress_total,strength:e.strength,anchor:e.anchor,parent:i,children:[],visible:e.visible};t.elements.push(n),null!=i&&(ce.elemById(t,i).children.push(n.id),e.parent!=i&&(n.x=e.x,n.y=e.y));for(var r=0,s=e.children;r<s.length;){var a=s[r];++r,ce.duplicateElem(t,ce.elemById(t,a),n.id)}return n};var de=function(){};(T["arm2d.tools.Math"]=de).__name__=!0,de.toDegrees=function(t){return 57.29578*t},de.toRadians=function(t){return.0174532924*t},de.hitbox=function(t,e,i,n,r,s,a){if(null==s&&(s=0),null!=a&&2!=a.length)throw new ge("arm2d.tools.Math.hitbox(): 'center' argument must consist of two values!");null==a&&(a=[e+n/2,i+r/2]);var o=de.rotatePoint(t.inputX,t.inputY,a[0],a[1],-s);return o.x>e&&o.x<e+n&&o.y>i&&o.y<i+r},de.absx=function(t,e){return null==e?0:e.x+de.absx(t,ce.elemById(t,e.parent))},de.absy=function(t,e){return null==e?0:e.y+de.absy(t,ce.elemById(t,e.parent))},de.roundPrecision=function(t,e){return null==e&&(e=0),t*=Math.pow(10,e),t|=0,t/=Math.pow(10,e)},de.rotatePoint=function(t,e,i,n,r){e-=n;var s=(t-=i)*Math.cos(r)-e*Math.sin(r),a=t*Math.sin(r)+e*Math.cos(r);return new mi(i+s,n+a)},de.calculateTransformDelta=function(t,e,i,n,r,s){null==s&&(s=0);var a=t.isKeyDown&&t.key==re.prefs.keyMap.slowMovement,o=e!=(t.isKeyDown&&t.key==re.prefs.keyMap.gridInvert),l=i!=(t.isKeyDown&&t.key==re.prefs.keyMap.gridInvertRelative);return o?(r=Math.round(r/n)*n,a&&(r/=2),l&&0!=s&&(n/2<(s%=n)&&(s=-(n-s)),r-=s),r):a?r/2:r};var _e=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(T["zui.Handle"]=_e).__name__=!0,_e.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){null==this.children&&(this.children=new $);var i=this.children.h[t];return null==i&&(i=new _e(e),this.children.h[t]=i),i},unnest:function(t){null!=this.children&&this.children.remove(t)},__class__:_e};var fe=function(){};(T["arm2d.ui.UIProperties"]=fe).__name__=!0,fe.renderProperties=function(l,t,u){var e=fe.hwin,i=ve.windowWidth()-t,n=ve.windowHeight();if(l.window(e,i,0,t,n)){var r=_e.global.nest(1,null);if(l.tab(r,"Project")){l.button("Save")&&oe.save(u);var s=_e.global.nest(2,{selected:!1});if(l.panel(s,"Canvas")){l.indent(),l.button("New")&&(u.elements=[],le.selectedElem=null),l.isHovered&&l.tooltip("Create new canvas");var a=_e.global.nest(3,{text:u.name});l.textInput(a,"Name",2),a.changed&&("_themes"==a.text?(Li.showMessage(new Ai(l.ops),"Sorry!",'"_themes" is not a valid canvas name as it is reserved!'),a.text=u.name):u.name=a.text),l.row([.5,.5]);var o=_e.global.nest(4,{text:u.width+""}),h=_e.global.nest(5,{text:u.height+""});o.text=u.width+"",h.text=u.height+"";var c=l.textInput(o,"Width",2),d=l.textInput(h,"Height",2);u.width=ae.parseInt(c),u.height=ae.parseInt(d),l.unindent()}var _=_e.global.nest(6,{selected:!0});if(l.panel(_,"Outliner")){l.indent();var f=null;if(f=function(t,e){var i=!1;le.selectedElem==e&&(l.g.set_color(-14656100),l.g.fillRect(l._x,l._y,l._w,l.t.ELEMENT_H*l.ops.scaleFactor),l.g.set_color(-1));var n=l.getStarted();if(n&&!l.inputDownR&&(le.selectedElem=e),n&&l.inputDownR&&(e==le.selectedElem?ce.unparent(u,e):ce.setParent(u,le.selectedElem,e)),null!=e.children&&0<e.children.length){l.row([.07692307692307693,.9230769230769231]);var r=t.nest(e.id,{selected:!0});i=l.panel(r,"",!0,!1,!1),l.text(e.name)}else l._x+=18,l.text(e.name),l._x-=18;if(i)for(var s=e.children.length;0<s;){--s;var a=e.children[e.children.length-1-s];l.indent();var o=ce.elemById(u,a);f(t,o),l.unindent()}},0<u.elements.length){for(var p=0,g=u.elements.length;p<g;){var m=p++,v=u.elements[u.elements.length-1-m];if(null==v.parent){var b=_e.global.nest(7,null);f(b,v)}}l.row([.25,.25,.25,.25]),l.button("Up")&&null!=le.selectedElem&&ce.moveElem(u,le.selectedElem,1),l.isHovered&&l.tooltip("Move element up"),l.button("Down")&&null!=le.selectedElem&&ce.moveElem(u,le.selectedElem,-1),l.isHovered&&l.tooltip("Move element down"),l.button("Remove")&&null!=le.selectedElem&&(ce.removeElem(u,le.selectedElem),le.selectedElem=null),l.isHovered&&l.tooltip("Delete element"),l.button("Duplicate")&&null!=le.selectedElem&&(le.selectedElem=ce.duplicateElem(u,le.selectedElem)),l.isHovered&&l.tooltip("Create duplicate of element")}l.unindent()}if(null!=le.selectedElem){var w=le.selectedElem,y=w.id,x=_e.global.nest(8,{selected:!0});if(l.panel(x,"Properties")){l.indent();var T=null==w.visible||w.visible,S=_e.global.nest(9,null).nest(y,{selected:T});w.visible=l.check(S,"Visible");var k=_e.global.nest(10,null).nest(y,{text:w.name});w.name=l.textInput(k,"Name",2);var I=_e.global.nest(11,null).nest(y,{text:w.text});w.text=l.textInput(I,"Text",2),l.row([.25,.25,.25,.25]);var E=w.x+"",C=_e.global.nest(12,null).nest(y,{text:E}),B=w.y+"",N=_e.global.nest(13,null).nest(y,{text:B});C.text=w.x+"",N.text=w.y+"";var L=l.textInput(C,"X",2),F=l.textInput(N,"Y",2);w.x=parseFloat(L),w.y=parseFloat(F);var A=w.width+"",M=_e.global.nest(14,null).nest(y,{text:A}),O=w.height+"",P=_e.global.nest(15,null).nest(y,{text:O});M.text=w.width+"",P.text=w.height+"";var R=l.textInput(M,"W",2),V=l.textInput(P,"H",2);if(w.width=0|parseFloat(R),w.height=0|parseFloat(V),13==w.type||15==w.type||17==w.type||18==w.type||19==w.type){var D=w.strength+"",U=_e.global.nest(16,null).nest(y,{text:D}),H=l.textInput(U,"Line Strength",2);w.strength=0|parseFloat(H)}if(18==w.type||19==w.type){var W=_e.global.nest(17,null).nest(y,{value:w.progress_at}),G=l.slider(W,"Progress",0,w.progress_total,!0,1),z=w.progress_total+"",X=_e.global.nest(18,null).nest(y,{text:z}),K=l.textInput(X,"Total Progress",2);w.progress_total=0|parseFloat(K),w.progress_at=0|G}var Y=_e.global.nest(19,null).nest(y,{value:de.roundPrecision(57.29578*(null==w.rotation?0:w.rotation),2)});Y.value=de.roundPrecision(57.29578*w.rotation,2),360<=Y.value&&(Y.value=0),w.rotation=.0174532924*l.slider(Y,"Rotation",0,360,!0);var Z=_e.global.nest(20,null).nest(y,{position:oe.getAssetIndex(u,w.asset)}),j=oe.getEnumTexts(),q=l.combo(Z,j,"Asset",!0,2);w.asset=oe.getEnumTexts()[q],l.unindent()}var Q=_e.global.nest(21,{selected:!1});if(l.panel(Q,"Color")){l.indent();var J=function(t,e,i){l.row([.5,.5]);var n=_e.global.nest(22,null).nest(y).nest(t,{color:null!=e?e:i});return Bi.colorField(l,n,!0),n.changed&&(e=n.color),!l.button("Reset")&&null!=e||(e=null,n.color=i,n.changed=!1),e},$=Ci.getTheme(u.theme);switch(w.type){case 0:l.text("Text:"),w.color_text=J(1,w.color_text,$.TEXT_COL);break;case 2:l.text("Text:"),w.color_text=J(1,w.color_text,$.BUTTON_TEXT_COL),l.text("Background:"),w.color=J(2,w.color,$.BUTTON_COL),l.text("On Hover:"),w.color_hover=J(3,w.color_hover,$.BUTTON_HOVER_COL),l.text("On Pressed:"),w.color_press=J(4,w.color_press,$.BUTTON_PRESSED_COL);break;case 6:case 8:case 9:case 10:case 11:l.text("Text:"),w.color_text=J(1,w.color_text,$.TEXT_COL),l.text("Background:"),w.color=J(2,w.color,$.BUTTON_COL),l.text("On Hover:"),w.color_hover=J(3,w.color_hover,$.BUTTON_HOVER_COL);break;case 12:case 13:case 14:case 15:case 16:case 17:l.text("Color:"),w.color=J(1,w.color,$.BUTTON_COL);break;case 18:case 19:l.text("Progress:"),w.color_progress=J(1,w.color_progress,$.TEXT_COL),l.text("Background:"),w.color=J(2,w.color,$.BUTTON_COL);break;default:l.text("This element type has no color settings!")}l.unindent()}var tt=_e.global.nest(23,{selected:!1});if(l.panel(tt,"Align")){l.indent();var et=_e.global.nest(24,null).nest(y,{position:w.alignment});l.row([.3333333333333333,.3333333333333333,.3333333333333333]),l.radio(et,0,"Left"),l.radio(et,1,"Center"),l.radio(et,2,"Right"),le.selectedElem.alignment=et.position,l.unindent()}var it=_e.global.nest(25,{selected:!1});if(l.panel(it,"Anchor")){l.indent();var nt=_e.global.nest(26,null).nest(y,{position:w.anchor});l.row([.36363636363636365,.2727272727272727,.36363636363636365]),l.radio(nt,0,"Top-Left"),l.radio(nt,1,"Top"),l.radio(nt,2,"Top-Right"),l.row([.36363636363636365,.2727272727272727,.36363636363636365]),l.radio(nt,3,"Left"),l.radio(nt,4,"Center"),l.radio(nt,5,"Right"),l.row([.36363636363636365,.2727272727272727,.36363636363636365]),l.radio(nt,6,"Bot-Left"),l.radio(nt,7,"Bottom"),l.radio(nt,8,"Bot-Right"),w.anchor=nt.position,l.unindent()}var rt=_e.global.nest(27,{selected:!1});if(l.panel(rt,"Script")){l.indent();var st=_e.global.nest(28,null).nest(y,{text:w.event});w.event=l.textInput(st,"Event",2),l.unindent()}var at=_e.global.nest(29,{selected:!1});l.panel(at,"Timeline")}}if(l.tab(r,"Themes")){for(var ot=_e.global.nest(30,null),lt=_e.global.nest(31,null),ut=function(t,e){if(le.selectedTheme==e&&(l.g.set_color(-14656100),l.g.fillRect(0,l._y,l._windowW,l.t.ELEMENT_H*l.ops.scaleFactor),l.g.set_color(-1)),e==Ci.getTheme(u.theme)){var i=(l.t.BUTTON_H-16)/2;l.g.drawSubImage(me.images.icons,l._x+i,l._y+i,0,0,16,16)}l.getStarted()&&!l.inputDownR&&(le.selectedTheme=e),l._x+=16,l.text(e.NAME),l._x-=16},ht=0,ct=Ci.themes;ht<ct.length;){var dt=ct[ht];++ht,ut(_e.global.nest(32,null),dt)}if(l.row([.25,.25,.25,.25]),l.button("Add")){var _t=se.copy(Fi.light);_t.NAME=ce.unique("New Theme",Ci.themes,"NAME"),Ci.themes.push(_t),le.selectedTheme=_t}if(null==le.selectedTheme&&(l.enabled=!1),l.button("Copy")){var ft=se.copy(le.selectedTheme);ft.NAME=ce.unique(ft.NAME,Ci.themes,"NAME"),Ci.themes.push(ft),le.selectedTheme=ft}l.enabled=!0,null==le.selectedTheme&&(l.enabled=!1);var pt=lt.nest(Ci.themes.indexOf(le.selectedTheme));if(l.button("Rename")&&(pt.text=le.selectedTheme.NAME,Li.showCustom(new Ai(l.ops),function(t){t.textInput(pt),t.button("OK")&&(Li.show=!1,fe.hwin.redraws=2)},0|l.inputX,0|l.inputY,200,60)),null!=le.selectedTheme){var gt=le.selectedTheme.NAME;pt.changed&&le.selectedTheme.NAME!=pt.text&&(gt=ce.unique(pt.text,Ci.themes,"NAME"),u.theme==le.selectedTheme.NAME&&(u.theme=gt),le.selectedTheme.NAME=gt)}if(l.enabled=!0,1!=Ci.themes.length&&null!=le.selectedTheme||(l.enabled=!1),l.button("Delete")&&(ot.unnest(Ci.themes.indexOf(le.selectedTheme)),lt.unnest(Ci.themes.indexOf(le.selectedTheme)),ne.remove(Ci.themes,le.selectedTheme),null==Ci.getTheme(u.theme)&&(u.theme=Ci.themes[0].NAME),le.selectedTheme=null),l.enabled=!0,null==le.selectedTheme&&(l.enabled=!1),l.button("Apply to Canvas")&&(u.theme=le.selectedTheme.NAME),l.enabled=!0,null==le.selectedTheme)l.text("Please select a Theme!");else for(var mt=[["Text","TEXT_COL"],["Elements","BUTTON_COL","BUTTON_TEXT_COL","BUTTON_HOVER_COL","BUTTON_PRESSED_COL","ACCENT_COL","ACCENT_HOVER_COL","ACCENT_SELECT_COL"],["Other","PANEL_BG_COL"]],vt=0,bt=mt.length;vt<bt;){var wt=vt++,yt=_e.global.nest(33,null).nest(wt,{selected:!0});if(l.panel(yt,mt[wt][0])){l.indent();for(var xt=mt[wt].slice(1),Tt=0,St=xt.length;Tt<St;){var kt=Tt++,It=xt[kt];l.row([.6666666666666666,.3333333333333333]),l.text(It);var Et=se.getProperty(le.selectedTheme,It),Ct=ot.nest(Ci.themes.indexOf(le.selectedTheme)).nest(wt).nest(kt,{color:Et}),Bt=Bi.colorField(l,Ct,!0);se.setProperty(le.selectedTheme,It,Bt)}l.unindent()}}}if(l.tab(r,"Assets"))if(l.button("Import Asset")&&(le.showFiles=!0,le.foldersOnly=!1,le.filesDone=function(t){t=he.rtrim(t),t=ue.toRelative(t,re.cwd),oe.importAsset(u,t)}),0<u.assets.length){l.text("(Drag and drop assets to canvas)",1);var Nt=_e.global.nest(34,{selected:!0});if(l.panel(Nt,"Imported Assets")){l.indent();for(var Lt=u.assets.length-1;0<=Lt;){var Ft,At=u.assets[Lt];if("ttf"!=pe.extension(At.name).toLowerCase()){var Mt=oe.getImage(At);Ft=1==l.image(Mt)}else Ft=!1;if(Ft)le.dragAsset=At;else if("ttf"==pe.extension(At.name).toLowerCase()){var Ot=l.ops.font,Pt=l.fontSize;l.ops.font=oe.getFont(At),l.fontSize=32*l.ops.scaleFactor|0,l.text(At.name),l.ops.font=Ot,l.fontSize=Pt}l.row([.875,.125]);var Rt=_e.global.nest(35,null).nest(At.id,{text:At.name});At.name=l.textInput(Rt,"",2),le.assetNames[Lt+1]=At.name,l.button("X")&&(oe.getImage(At).unload(),u.assets.splice(Lt,1),le.assetNames.splice(Lt+1,1)),--Lt}l.unindent()}}else l.text("(Drag and drop images and fonts here)",1);if(l.tab(r,"Preferences")){var Vt=_e.global.nest(36,{selected:!0});if(l.panel(Vt,"Application")){l.indent();var Dt=_e.global.nest(37,{value:1});l.slider(Dt,"UI Scale",.5,4,!0),Dt.changed&&!l.inputDown&&(l.setScale(Dt.value),le.windowW=le.defaultWindowW*Dt.value|0);var Ut=_e.global.nest(38,{selected:!0});re.prefs.window_vsync=l.check(Ut,"VSync"),l.unindent()}var Ht=_e.global.nest(39,{selected:!0});if(l.panel(Ht,"Grid")){l.indent();var Wt=_e.global.nest(40,{value:20});l.slider(Wt,"Grid Size",1,128,!0,1);var Gt=_e.global.nest(41,{selected:!0});le.gridSnapPos=l.check(Gt,"Grid Snap Position"),l.isHovered&&l.tooltip("Snap the element's position to the grid");var zt=_e.global.nest(42,{selected:!1});le.gridSnapBounds=l.check(zt,"Grid Snap Bounds"),l.isHovered&&l.tooltip("Snap the element's bounds to the grid");var Xt=_e.global.nest(43,{selected:!0});le.gridUseRelative=l.check(Xt,"Use Relative Grid"),l.isHovered&&l.tooltip("Use a grid that's relative to the selected element"),Wt.changed&&!l.inputDown&&(le.gridSize=0|Wt.value);var Kt=_e.global.nest(44,{selected:!1});le.useRotationSteps=l.check(Kt,"Use Fixed Rotation Steps"),l.isHovered&&l.tooltip("Rotate elements by a fixed step size");var Yt=_e.global.nest(45,{value:15});le.useRotationSteps&&l.slider(Yt,"Rotation Step Size",1,180,!0,1),Yt.changed&&!l.inputDown&&(le.rotationSteps=.0174532924*Yt.value),l.unindent()}var Zt=_e.global.nest(46,{selected:!0});if(l.panel(Zt,"Shortcuts")){l.indent(),l.row([.5,.5]),l.text("Select");var jt=_e.global.nest(47,{position:0});l.combo(jt,["Left Click","Right Click"],""),l.isHovered&&l.tooltip("Mouse button used for element selection."),jt.changed&&(re.prefs.keyMap.selectMouseButton=["Left","Right"][jt.position]),l.separator(8,!1),l.row([.5,.5]),l.text("Grab");var qt=_e.global.nest(48,{value:71});re.prefs.keyMap.grabKey=Bi.keyInput(l,qt,"Key"),l.isHovered&&l.tooltip("Key used for grabbing elements"),l.row([.5,.5]),l.text("Rotate");var Qt=_e.global.nest(49,{value:82});re.prefs.keyMap.rotateKey=Bi.keyInput(l,Qt,"Key"),l.isHovered&&l.tooltip("Key used for rotating elements"),l.row([.5,.5]),l.text("Size");var Jt=_e.global.nest(50,{value:83});re.prefs.keyMap.sizeKey=Bi.keyInput(l,Jt,"Key"),l.isHovered&&l.tooltip("Key used for resizing elements"),l.separator(8,!1),l.row([.5,.5]),l.text("Precision Transform");var $t=_e.global.nest(51,{value:16});re.prefs.keyMap.slowMovement=Bi.keyInput(l,$t,"Key"),l.isHovered&&l.tooltip("More precise transformations"),l.row([.5,.5]),l.text("Invert Grid");var te=_e.global.nest(52,{value:17});re.prefs.keyMap.gridInvert=Bi.keyInput(l,te,"Key"),l.isHovered&&l.tooltip("Invert the grid setting"),l.row([.5,.5]),l.text("Invert Rel. Grid");var ee=_e.global.nest(53,{value:18});re.prefs.keyMap.gridInvertRelative=Bi.keyInput(l,ee,"Key"),l.isHovered&&l.tooltip("Invert the relative grid setting"),l.unindent()}var ie=_e.global.nest(54,{selected:!1});l.panel(ie,"Console")&&(l.indent(),l.text("Mouse X: "+l.inputX),l.text("Mouse Y: "+l.inputY),l.unindent())}}};var m=function(){};(T["arm2d.ui.UIToolBar"]=m).__name__=!0,m.renderToolbar=function(t,e,i,n){t.window(_e.global.nest(55,null),0,0,n,ve.windowHeight())&&(t.text("Add Elements:"),t.panel(_e.global.nest(56,{selected:!0}),"Basic")&&(t.indent(),t.button("Empty")&&(le.selectedElem=ce.makeElem(e,i,3)),t.isHovered&&t.tooltip("Creates empty element"),t.button("Text")&&(le.selectedElem=ce.makeElem(e,i,0)),t.isHovered&&t.tooltip("Create text element"),t.button("Image")&&(le.selectedElem=ce.makeElem(e,i,1)),t.isHovered&&t.tooltip("Creates image element"),t.unindent()),t.panel(_e.global.nest(57,{selected:!0}),"Buttons")&&(t.indent(),t.button("Button")&&(le.selectedElem=ce.makeElem(e,i,2)),t.isHovered&&t.tooltip("Creates button element"),t.button("Check")&&(le.selectedElem=ce.makeElem(e,i,6)),t.isHovered&&t.tooltip("Creates check box element"),t.button("Radio")&&(le.selectedElem=ce.makeElem(e,i,7)),t.isHovered&&t.tooltip("Creates inline-radio element"),t.unindent()),t.panel(_e.global.nest(58,{selected:!0}),"Inputs")&&(t.indent(),t.button("Text Input")&&(le.selectedElem=ce.makeElem(e,i,10)),t.isHovered&&t.tooltip("Creates text input element"),t.button("Key Input")&&(le.selectedElem=ce.makeElem(e,i,11)),t.isHovered&&t.tooltip("Creates key input element"),t.button("Combo Box")&&(le.selectedElem=ce.makeElem(e,i,8)),t.isHovered&&t.tooltip("Creates combo box element"),t.button("Slider")&&(le.selectedElem=ce.makeElem(e,i,9)),t.isHovered&&t.tooltip("Creates slider element"),t.unindent()),t.panel(_e.global.nest(59,{selected:!0}),"Shapes")&&(t.indent(),t.button("Rect")&&(le.selectedElem=ce.makeElem(e,i,13)),t.isHovered&&t.tooltip("Creates rectangle shaped element"),t.button("Fill Rect")&&(le.selectedElem=ce.makeElem(e,i,12)),t.isHovered&&t.tooltip("Creates filled rectangle shaped element"),t.button("Circle")&&(le.selectedElem=ce.makeElem(e,i,15)),t.isHovered&&t.tooltip("Creates circle shaped element"),t.button("Fill Circle")&&(le.selectedElem=ce.makeElem(e,i,14)),t.isHovered&&t.tooltip("Creates filled circle shaped element"),t.button("Triangle")&&(le.selectedElem=ce.makeElem(e,i,17)),t.isHovered&&t.tooltip("Creates triangle shaped element"),t.button("Fill Triangle")&&(le.selectedElem=ce.makeElem(e,i,16)),t.isHovered&&t.tooltip("Creates filled triangle shaped element"),t.unindent()),t.panel(_e.global.nest(60,{selected:!0}),"ProgressBars")&&(t.indent(),t.button("RectPB")&&(le.selectedElem=ce.makeElem(e,i,18)),t.isHovered&&t.tooltip("Creates rectangular progress bar"),t.button("CircularPB")&&(le.selectedElem=ce.makeElem(e,i,19)),t.isHovered&&t.tooltip("Creates circular progress bar"),t.unindent()))};function s(){}(T["haxe.IMap"]=s).__name__=!0,s.__isInterface__=!0;function L(){}(T["haxe.Log"]=L).__name__=!0,L.formatOutput=function(t,e){var i=ae.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e.customParams)for(var r=0,s=e.customParams;r<s.length;){var a=s[r];++r,i+=", "+ae.string(a)}return n+": "+i},L.trace=function(t,e){var i=L.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};function a(){}(T["haxe._Unserializer.DefaultResolver"]=a).__name__=!0,a.prototype={resolveClass:function(t){return T[t]},resolveEnum:function(t){return p[t]},__class__:a};var J=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=J.DEFAULT_RESOLVER;null==e&&(e=new a,J.DEFAULT_RESOLVER=e),this.resolver=e};(T["haxe.Unserializer"]=J).__name__=!0,J.initCodes=function(){for(var t=[],e=0,i=J.BASE64.length;e<i;){var n=e++;t[J.BASE64.charCodeAt(n)]=n}return t},J.run=function(t){return new J(t).unserialize()},J.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||57<n)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return parseFloat(ne.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new ge("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new ge("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new ge("Invalid enum format");var i=this.readDigits();if(0==i)return S.createEnum(t,e);for(var n=[];0<i--;)n.push(this.unserialize());return S.createEnum(t,e,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new ge("Class not found "+t);return e;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new ge("Enum not found "+i);return n;case 67:var r=this.unserialize(),s=this.resolver.resolveClass(r);if(null==s)throw new ge("Class not found "+r);var a=Object.create(s.prototype);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new ge("Invalid custom data");return a;case 77:var o=new et;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new ge("Invalid string reference");return this.scache[u];case 97:this.buf;var h=[];for(this.cache.push(h);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var d=this.readDigits();h[h.length+d-1]=null}else h.push(this.unserialize())}return h;case 98:var _=new it;this.cache.push(_);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var f=this.unserialize(),p=this.unserialize();null!=Hi[f]?_.setReserved(f,p):_.h[f]=p}return this.pos++,_;case 99:var g=this.unserialize(),m=this.resolver.resolveClass(g);if(null==m)throw new ge("Class not found "+g);var v=Object.create(m.prototype);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var b=this.unserialize(),w=this.resolver.resolveEnum(b);if(null==w)throw new ge("Enum not found "+b);this.pos++;var y=this.readDigits(),x=w.__constructs__.slice()[y];if(null==x)throw new ge("Unknown enum index "+b+"@"+y);var T=this.unserializeEnum(w,x);return this.cache.push(T),T;case 107:return NaN;case 108:var S=new tt;this.cache.push(S);for(this.buf;104!=this.buf.charCodeAt(this.pos);)S.add(this.unserialize());return this.pos++,S;case 109:return-1/0;case 110:return null;case 111:var k={};return this.cache.push(k),this.unserializeObject(k),k;case 112:return 1/0;case 113:var I=new $;this.cache.push(I);this.buf;for(var E=this.buf.charCodeAt(this.pos++);58==E;){var C=this.readDigits(),B=this.unserialize();I.h[C]=B,E=this.buf.charCodeAt(this.pos++)}if(104!=E)throw new ge("Invalid IntMap format");return I;case 114:var N=this.readDigits();if(N<0||N>=this.cache.length)throw new ge("Invalid reference");return this.cache[N];case 115:var L=this.readDigits(),F=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<L)throw new ge("Invalid bytes length");var A=J.CODES;null==A&&(A=J.initCodes(),J.CODES=A);for(var M=this.pos,O=3&L,P=M+(L-O),R=new ht(new ArrayBuffer(3*(L>>2)+(2<=O?O-1:0))),V=0;M<P;){var D=A[F.charCodeAt(M++)],U=A[F.charCodeAt(M++)];R.b[V++]=D<<2|U>>4;var H=A[F.charCodeAt(M++)];R.b[V++]=U<<4|H>>2;var W=A[F.charCodeAt(M++)];R.b[V++]=H<<6|W}if(2<=O){var G=A[F.charCodeAt(M++)],z=A[F.charCodeAt(M++)];if(R.b[V++]=G<<2|z>>4,3==O){var X=A[F.charCodeAt(M++)];R.b[V++]=z<<4|X>>2}}return this.pos+=L,this.cache.push(R),R;case 116:return!0;case 118:var K;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(K=ne.strDate(ne.substr(this.buf,this.pos,19)),this.pos+=19):K=new Date(this.readFloat()),this.cache.push(K),K;case 119:var Y=this.unserialize(),Z=this.resolver.resolveEnum(Y);if(null==Z)throw new ge("Enum not found "+Y);var j=this.unserializeEnum(Z,this.unserialize());return this.cache.push(j),j;case 120:throw ge.wrap(this.unserialize());case 121:var q=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<q)throw new ge("Invalid string length");var Q=ne.substr(this.buf,this.pos,q);return this.pos+=q,Q=decodeURIComponent(Q.split("+").join(" ")),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new ge("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:J};var $=function(){this.h={}};(T["haxe.ds.IntMap"]=$).__name__=!0,$.__interfaces__=[s],$.prototype={h:null,remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return ne.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:$};var tt=function(){this.length=0};(T["haxe.ds.List"]=tt).__name__=!0,tt.prototype={h:null,q:null,length:null,add:function(t){var e=new o(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:tt};var o=function(t,e){this.item=t,this.next=e};(T["haxe.ds._List.ListNode"]=o).__name__=!0,o.prototype={item:null,next:null,__class__:o};var et=function(){this.h={__keys__:{}}};(T["haxe.ds.ObjectMap"]=et).__name__=!0,et.__interfaces__=[s],et.prototype={h:null,set:function(t,e){var i=t.__id__;null==i&&(i=t.__id__=n.$haxeUID++),this.h[i]=e,this.h.__keys__[i]=t},__class__:et};var it=function(){this.h={}};(T["haxe.ds.StringMap"]=it).__name__=!0,it.__interfaces__=[s],it.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:it};var ht=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(T["haxe.io.Bytes"]=ht).__name__=!0,ht.ofString=function(t,e){if(e==d.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,r=t.length;n<r;){var s=n++,a=t.charCodeAt(s);i[s<<1]=255&a,i[s<<1|1]=a>>8}return new ht(i.buffer)}for(var o=[],l=0;l<t.length;){var u=t.charCodeAt(l++);55296<=u&&u<=56319&&(u=u-55232<<10|1023&t.charCodeAt(l++)),u<=127?o.push(u):(u<=2047?o.push(192|u>>6):(u<=65535?o.push(224|u>>12):(o.push(240|u>>18),o.push(128|u>>12&63)),o.push(128|u>>6&63)),o.push(128|63&u))}return new ht(new Uint8Array(o).buffer)},ht.ofData=function(t){var e=t.hxBytes;return null!=e?e:new ht(t)},ht.prototype={length:null,b:null,data:null,blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new ge(_.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new ge(_.OutsideBounds);return new ht(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getDouble:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(t,!0)},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setDouble:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(t,e,!0)},setFloat:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(t,e,!0)},getUInt16:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(t,!0)},getInt32:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new ge(_.OutsideBounds);null==i&&(i=d.UTF8);var n="",r=this.b,s=t,a=t+e;switch(i._hx_index){case 0:for(;s<a;){var o=r[s++];if(o<128){if(0==o)break;n+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&r[s++];n+=String.fromCodePoint(l)}else if(o<240){var u=(31&o)<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(u)}else{var h=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(h)}}break;case 1:for(;s<a;){var c=r[s++]|r[s++]<<8;n+=String.fromCodePoint(c)}}return n},toString:function(){return this.getString(0,this.length)},__class__:ht};function u(){this.pos=0,this.size=0}(T["haxe.io.BytesBuffer"]=u).__name__=!0,u.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ge(_.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var n=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(n,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),r=new Uint8Array(n);0<this.size&&r.set(this.u8),this.size=i,this.buffer=n,this.u8=r,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new ht(new ArrayBuffer(0));var t=new ht(this.buffer);return t.length=this.pos,t},__class__:u};function h(){}(T["haxe.io.Input"]=h).__name__=!0,h.prototype={bigEndian:null,readByte:function(){throw new ge("Not implemented")},readBytes:function(t,e,i){var n=i,r=t.b;if(e<0||i<0||e+i>t.length)throw new ge(_.OutsideBounds);try{for(;0<n;)r[e]=this.readByte(),++e,--n}catch(t){var s=t instanceof ge?t.val:t;if(!(s instanceof v))throw t}return i-n},readFullBytes:function(t,e,i){for(;0<i;){var n=this.readBytes(t,e,i);if(0==n)throw new ge(_.Blocked);e+=n,i-=n}},read:function(t){for(var e=new ht(new ArrayBuffer(t)),i=0;0<t;){var n=this.readBytes(e,i,t);if(0==n)throw new ge(_.Blocked);i+=n,t-=n}return e},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=new ht(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:h};function ct(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new ge(_.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i}(T["haxe.io.BytesInput"]=ct).__name__=!0,ct.__super__=h,ct.prototype=r(h.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new ge(new v);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ge(_.OutsideBounds);if(0==this.len&&0<i)throw new ge(new v);this.len<i&&(i=this.len);for(var n=this.b,r=t.b,s=0,a=i;s<a;){var o=s++;r[e+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:ct,__properties__:{set_position:"set_position"}});function c(){}(T["haxe.io.Output"]=c).__name__=!0,c.prototype={bigEndian:null,writeByte:function(t){throw new ge("Not implemented")},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ge(_.OutsideBounds);for(var n=t.b,r=i;0<r;)this.writeByte(n[e]),++e,--r;return i},write:function(t){for(var e=t.length,i=0;0<e;){var n=this.writeBytes(t,i,e);if(0==n)throw new ge(_.Blocked);i+=n,e-=n}},writeFloat:function(t){this.writeInt32(f.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:c};function dt(){this.b=new u}(T["haxe.io.BytesOutput"]=dt).__name__=!0,dt.__super__=c,dt.prototype=r(c.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:dt});var d=p["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},v=function(){};(T["haxe.io.Eof"]=v).__name__=!0,v.prototype={toString:function(){return"Eof"},__class__:v};var _=p["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:((e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}}).__params__=["e"],e)},f=function(){};(T["haxe.io.FPHelper"]=f).__name__=!0,f.floatToI32=function(t){return f.helper.setFloat32(0,t,!0),f.helper.getInt32(0,!0)};var pe=function(t){switch(t){case".":case"..":return this.dir=t,void(this.file="")}var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");e<i?(this.dir=ne.substr(t,0,i),t=ne.substr(t,i+1,null),this.backslash=!0):i<e?(this.dir=ne.substr(t,0,e),t=ne.substr(t,e+1,null)):this.dir=null;var n=t.lastIndexOf(".");-1!=n?(this.ext=ne.substr(t,n+1,null),this.file=ne.substr(t,0,n)):(this.ext=null,this.file=t)};(T["haxe.io.Path"]=pe).__name__=!0,pe.directory=function(t){var e=new pe(t);return null==e.dir?"":e.dir},pe.extension=function(t){var e=new pe(t);return null==e.ext?"":e.ext},pe.join=function(t){for(var e=[],i=0,n=t;i<n.length;){var r=n[i];++i,null!=r&&""!=r&&e.push(r)}var s=e;if(0==s.length)return"";for(var a=s[0],o=1,l=s.length;o<l;){var u=o++;a=pe.addTrailingSlash(a),a+=s[u]}return pe.normalize(a)},pe.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,n=t.split("/");i<n.length;){var r=n[i];++i,".."==r&&0<e.length&&".."!=e[e.length-1]?e.pop():""==r?(0<e.length||47==ne.cca(t,0))&&e.push(r):"."!=r&&e.push(r)}for(var s="",a=!1,o=!1,l=0,u=e.join("/");l<u.length;){var h=u,c=l++,d=h.charCodeAt(c);55296<=d&&d<=56319&&(d=d-55232<<10|1023&h.charCodeAt(1+c));65536<=d&&++l;var _=d;switch(_){case 47:if(a){var f=_;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(f)}else o=!0;break;case 58:s+=":",a=!0;break;default:var p=_;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(p)}}return s},pe.addTrailingSlash=function(t){if(0==t.length)return"/";var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");return e<i?i!=t.length-1?t+"\\":t:e!=t.length-1?t+"/":t},pe.prototype={dir:null,file:null,ext:null,backslash:null,__class__:pe};var ge=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,ge)};(T["js._Boot.HaxeError"]=ge).__name__=!0,ge.wrap=function(t){return t instanceof Error?t:new ge(t)},ge.__super__=Error,ge.prototype=r(Error.prototype,{val:null,__class__:ge});var g=function(){};(T["js.Boot"]=g).__name__=!0,g.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var i=g.__nativeClassName(t);return null!=i?g.__resolveNativeClass(i):null},g.__string_rec=function(r,s){if(null==r)return"null";if(5<=s.length)return"<...>";var t=typeof r;switch("function"==t&&(r.__name__||r.__ename__)&&(t="object"),t){case"function":return"<function>";case"object":if(r.__enum__){var e=p[r.__enum__],i=e.__constructs__[r._hx_index],a=e[i];return a.__params__?(s+="\t",i+"("+function(){for(var t=[],e=0,i=a.__params__;e<i.length;){var n=i[e];e+=1,t.push(g.__string_rec(r[n],s))}return t}().join(",")+")"):i}if(r instanceof Array){var n="[";s+="\t";for(var o=0,l=r.length;o<l;){var u=o++;n+=(0<u?",":"")+g.__string_rec(r[u],s)}return n+="]"}var h;try{h=r.toString}catch(t){t instanceof ge&&t.val;return"???"}if(null!=h&&h!=Object.toString&&"function"==typeof h){var c=r.toString();if("[object Object]"!=c)return c}var d="{\n";s+="\t";var _=null!=r.hasOwnProperty,f=null;for(f in r)_&&!r.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=d.length&&(d+=", \n"),d+=s+f+" : "+g.__string_rec(r[f],s));return d+="\n"+(s=s.substring(1))+"}";case"string":return r;default:return String(r)}},g.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;if(Object.prototype.hasOwnProperty.call(t,"__interfaces__"))for(var i=t.__interfaces__,n=0,r=i.length;n<r;){var s=i[n++];if(s==e||g.__interfLoop(s,e))return!0}return g.__interfLoop(t.__super__,e)},g.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case Vi:return"boolean"==typeof t;case Pi:return null!=t;case Ri:return"number"==typeof t;case Oi:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(g.__downcastCheck(t,e))return!0}else if("object"==typeof e&&g.__isNativeObj(e)&&t instanceof e)return!0;return e==Di&&null!=t.__name__?!0:e==Ui&&null!=t.__ename__||null!=t.__enum__&&p[t.__enum__]==e}},g.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&g.__interfLoop(g.getClass(t),e)},g.__cast=function(t,e){if(null==t||g.__instanceof(t,e))return t;throw new ge("Cannot cast "+ae.string(t)+" to "+ae.string(e))},g.__nativeClassName=function(t){var e=g.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},g.__isNativeObj=function(t){return null!=g.__nativeClassName(t)},g.__resolveNativeClass=function(t){return n[t]};function b(){}(T["js.lib._ArrayBuffer.ArrayBufferCompat"]=b).__name__=!0,b.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),n=new Uint8Array(i.byteLength);return n.set(i),n.buffer};function k(){this.names=["color_wheel","icons"],this.iconsDescription={name:"icons",original_height:512,file_sizes:[1],original_width:512,files:["icons.png"],type:"image"},this.iconsName="icons",this.icons=null,this.color_wheelDescription={name:"color_wheel",original_height:270,file_sizes:[1],original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null}(T["kha._Assets.ImageList"]=k).__name__=!0,k.prototype={get:function(t){return se.field(this,t)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(e,t){me.loadImage("color_wheel",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:126,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},icons:null,iconsName:null,iconsDescription:null,iconsLoad:function(e,t){me.loadImage("icons",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:126,className:"kha._Assets.ImageList",methodName:"iconsLoad"})},iconsUnload:function(){this.icons.unload(),this.icons=null},names:null,__class__:k};function I(){this.names=[]}(T["kha._Assets.SoundList"]=I).__name__=!0,I.prototype={get:function(t){return se.field(this,t)},names:null,__class__:I};function E(){this.names=[]}(T["kha._Assets.BlobList"]=E).__name__=!0,E.prototype={get:function(t){return se.field(this,t)},names:null,__class__:E};function C(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",file_sizes:[1],files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null}(T["kha._Assets.FontList"]=C).__name__=!0,C.prototype={get:function(t){return se.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){me.loadFont("font_default",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:138,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:C};function B(){this.names=[]}(T["kha._Assets.VideoList"]=B).__name__=!0,B.prototype={get:function(t){return se.field(this,t)},names:null,__class__:B};var me=function(){};(T["kha.Assets"]=me).__name__=!0,me.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},me.loadEverything=function(t,e,r,i){for(var n=[k,I,E,C,B],s=[me.images,me.sounds,me.blobs,me.fonts,me.videos],a=0,o=0;o<n.length;){var l=n[o];++o;for(var u=0,h=S.getInstanceFields(l);u<h.length;){var c=h[u];++u,he.endsWith(c,"Description")&&(a+=1)}}if(0!=a)for(var d=a,_=function(e,i,t){var n=e.name;switch(e.type){case"blob":me.loadBlob(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:122,className:"kha.Assets",methodName:"loadEverything"});break;case"font":me.loadFont(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:124,className:"kha.Assets",methodName:"loadEverything"});break;case"image":me.loadImage(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:113,className:"kha.Assets",methodName:"loadEverything"});break;case"sound":me.loadSound(n,function(t){null==r||r(e)?t.uncompress(i):i()},t,{fileName:"kha/Assets.hx",lineNumber:115,className:"kha.Assets",methodName:"loadEverything"});break;case"video":me.loadVideo(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:126,className:"kha.Assets",methodName:"loadEverything"})}},f=function(){--d,me.progress=1-d/a,0==d&&t()},p=function(t){me.reporter(i,{fileName:"kha/Assets.hx",lineNumber:137,className:"kha.Assets",methodName:"loadEverything"})(t),f()},g=0,m=n.length;g<m;)for(var v=g++,b=s[v],w=0,y=S.getInstanceFields(n[v]);w<y.length;){var x=y[w];if(++w,he.endsWith(x,"Description")){var T=se.field(b,x);null==e||e(T)?_(T,f,p):f()}}else t()},me.loadImage=function(e,i,t,n){var r=se.field(me.images,e+"Description");U.loadImageFromDescription(r,function(t){me.images[e]=t,i(t)},me.reporter(t,n))},me.loadImageFromPath=function(t,e,i,n,r){var s={files:[t],readable:e};U.loadImageFromDescription(s,i,me.reporter(n,r))},me.get_imageFormats=function(){return U.getImageFormats()},me.loadBlob=function(e,i,t,n){var r=se.field(me.blobs,e+"Description");U.loadBlobFromDescription(r,function(t){me.blobs[e]=t,i(t)},me.reporter(t,n))},me.loadBlobFromPath=function(t,e,i,n){var r={files:[t]};U.loadBlobFromDescription(r,e,me.reporter(i,n))},me.loadSound=function(e,i,t,n){var r=se.field(me.sounds,e+"Description");U.loadSoundFromDescription(r,function(t){me.sounds[e]=t,i(t)},me.reporter(t,n))},me.loadSoundFromPath=function(t,e,i,n){var r={files:[t]};U.loadSoundFromDescription(r,e,me.reporter(i,n))},me.get_soundFormats=function(){return U.getSoundFormats()},me.loadFont=function(e,i,t,n){var r=se.field(me.fonts,e+"Description");U.loadFontFromDescription(r,function(t){me.fonts[e]=t,i(t)},me.reporter(t,n))},me.loadFontFromPath=function(t,e,i,n){var r={files:[t]};U.loadFontFromDescription(r,e,me.reporter(i,n))},me.get_fontFormats=function(){return["ttf"]},me.loadVideo=function(e,i,t,n){var r=se.field(me.videos,e+"Description");U.loadVideoFromDescription(r,function(t){me.videos[e]=t,i(t)},me.reporter(t,n))},me.loadVideoFromPath=function(t,e,i,n){var r={files:[t]};U.loadVideoFromDescription(r,e,me.reporter(i,n))},me.get_videoFormats=function(){return U.getVideoFormats()},me.reporter=function(t,e){if(null!=t)return t;var i=L.trace,n=e;return function(t){i(t,n)}};function w(){}(T["kha.Canvas"]=w).__name__=!0,w.__isInterface__=!0,w.prototype={get_width:null,get_height:null,get_g1:null,get_g2:null,get_g4:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:w,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var N={};(T["kha._Color.Color_Impl_"]=N).__name__=!0,N.__properties__={set_value:"set_value",get_value:"get_value",set_A:"set_A",get_A:"get_A",set_B:"set_B",get_B:"get_B",set_G:"set_G",get_G:"get_G",set_R:"set_R",get_R:"get_R",set_Ab:"set_Ab",get_Ab:"get_Ab",set_Bb:"set_Bb",get_Bb:"get_Bb",set_Gb:"set_Gb",get_Gb:"get_Gb",set_Rb:"set_Rb",get_Rb:"get_Rb"},N.fromValue=function(t){return N._new(t)},N.fromBytes=function(t,e,i,n){return null==n&&(n=255),N._new(n<<24|t<<16|e<<8|i)},N.fromFloats=function(t,e,i,n){return null==n&&(n=1),N._new((255*n|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*i|0)},N.fromString=function(t){if(7!=t.length&&9!=t.length||35!=t.charCodeAt(0))throw new ge("Invalid Color string: '"+t+"'");var e=ae.parseInt("0x"+ne.substr(t,1,null));return 7==t.length&&(e+=-16777216),N._new(e)},N._new=function(t){return t},N.get_value=function(t){return t},N.set_value=function(t,e){return e},N.get_Rb=function(t){return(16711680&t)>>>16},N.get_Gb=function(t){return(65280&t)>>>8},N.get_Bb=function(t){return 255&t},N.get_Ab=function(t){return t>>>24},N.set_Rb=function(t,e){return e},N.set_Gb=function(t,e){return e},N.set_Bb=function(t,e){return e},N.set_Ab=function(t,e){return e},N.get_R=function(t){return.00392156862745098*((16711680&t)>>>16)},N.get_G=function(t){return.00392156862745098*((65280&t)>>>8)},N.get_B=function(t){return.00392156862745098*(255&t)},N.get_A=function(t){return.00392156862745098*(t>>>24)},N.set_R=function(t,e){return e},N.set_G=function(t,e){return e},N.set_B=function(t,e){return e},N.set_A=function(t,e){return e};var y=function(t,e){this.num=t,this.isPrimary=e};(T["kha.Display"]=y).__name__=!0,y.__properties__={get_all:"get_all",get_primary:"get_primary"},y.init=function(){for(var t=0,e=Krom.displayCount();t<e;){var i=t++;y.displays.push(new y(i,Krom.displayIsPrimary(i)))}},y.get_primary=function(){y.init();for(var t=0,e=y.displays;t<e.length;){var i=e[t];if(++t,i.isPrimary)return i}return null},y.get_all=function(){return y.init(),y.displays},y.prototype={num:null,isPrimary:null,get_available:function(){return!0},get_name:function(){return"Display"},get_x:function(){return Krom.displayX(this.num)},get_y:function(){return Krom.displayY(this.num)},get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},get_pixelsPerInch:function(){return Krom.screenDpi()},get_modes:function(){return[]},__class__:y,__properties__:{get_modes:"get_modes",get_pixelsPerInch:"get_pixelsPerInch",get_frequency:"get_frequency",get_height:"get_height",get_width:"get_width",get_y:"get_y",get_x:"get_x",get_name:"get_name",get_available:"get_available"}};function x(t,e,i,n){this.width=t,this.height=e,this.frequency=i,this.bitsPerPixel=n}(T["kha.DisplayMode"]=x).__name__=!0,x.prototype={width:null,height:null,frequency:null,bitsPerPixel:null,__class__:x};function F(t,e,i){this.bold=t,this.italic=e,this.underlined=i}(T["kha.FontStyle"]=F).__name__=!0,F.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:F};function A(t,e,i,n){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=n}(T["kha.Framebuffer"]=A).__name__=!0,A.__interfaces__=[w],A.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(t,e,i){this.graphics1=t,this.graphics2=e,this.graphics4=i},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return ve.windowWidth(this.window)},height:null,get_height:function(){return ve.windowHeight(this.window)},__class__:A,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1"}};var M=function(t,e,i,n,r,s){null==s&&(s=1),null==r&&(r=8),null==n&&(n=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=n,this.stencilBufferBits=r,this.samplesPerPixel=s};(T["kha.FramebufferOptions"]=M).__name__=!0,M.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:M};function O(){}(T["kha.Resource"]=O).__name__=!0,O.__isInterface__=!0,O.prototype={unload:null,__class__:O};var P=function(t){this.pixels=null,this.texture_=t};(T["kha.Image"]=P).__name__=!0,P.__interfaces__=[O,w],P.__properties__={get_nonPow2Supported:"get_nonPow2Supported",get_maxSize:"get_maxSize"},P.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 1:return 5;case 2:return 3;case 3:return 4;case 4:return 1;case 5:return 2;case 6:return 6;default:return 0}},P.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},P.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},P.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;case 6:return 7;default:return 1}},P._fromTexture=function(t){return new P(t)},P.fromBytes=function(t,e,i,n,r){null==n&&(n=0);var s=new P(null);return s.format=n,s.texture_=Krom.createTextureFromBytes(t.b.bufferValue,e,i,P.getTextureFormat(n),!0),s},P.fromBytes3D=function(t,e,i,n,r,s){null==r&&(r=0);var a=new P(null);return a.format=r,a.texture_=Krom.createTextureFromBytes3D(t.b.bufferValue,e,i,n,P.getTextureFormat(r),!0),a},P.fromEncodedBytes=function(t,e,i,n,r){null==r&&(r=!1);var s=new P(null);s.texture_=Krom.createTextureFromEncodedBytes(t.b.bufferValue,e,r),i(s)},P.create=function(t,e,i,n){null==i&&(i=0);var r=new P(null);return r.format=i,r.texture_=Krom.createTexture(t,e,P.getTextureFormat(i)),r},P.create3D=function(t,e,i,n,r){null==n&&(n=0);var s=new P(null);return s.format=n,s.texture_=Krom.createTexture3D(t,e,i,P.getTextureFormat(n)),s},P.createRenderTarget=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=1),null==n&&(n=0),null==i&&(i=0);var a=new P(null);return a.format=i,a.renderTarget_=Krom.createRenderTarget(t,e,P.getDepthBufferBits(n),P.getRenderTargetFormat(i),P.getStencilBufferBits(n),s),a},P.get_maxSize=function(){return 4096},P.get_nonPow2Supported=function(){return!0},P.renderTargetsInvertedY=function(){return Krom.renderTargetsInvertedY()},P.formatByteSize=function(t){switch(t){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},P.prototype={texture_:null,renderTarget_:null,format:null,readable:null,graphics1:null,graphics2:null,graphics4:null,isOpaque:function(t,e){return!1},at:function(t,e){return-16777216},unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(t){return null==t&&(t=0),ht.ofData(Krom.lockTexture(this.texture_,t))},unlock:function(){Krom.unlockTexture(this.texture_)},pixels:null,getPixels:function(){return null!=this.renderTarget_?(null==this.pixels&&(this.pixels=new ht(new ArrayBuffer(P.formatByteSize(this.format)*this.get_width()*this.get_height()))),Krom.getRenderTargetPixels(this.renderTarget_,this.pixels.b.bufferValue),this.pixels):ht.ofData(Krom.getTexturePixels(this.texture_))},generateMipmaps:function(t){null==this.texture_?Krom.generateRenderTargetMipmaps(this.renderTarget_,t):Krom.generateTextureMipmaps(this.texture_,t)},setMipmaps:function(t){Krom.setMipmaps(this.texture_,t)},setDepthStencilFrom:function(t){Krom.setDepthStencilFrom(this.renderTarget_,t.renderTarget_)},clear:function(t,e,i,n,r,s,a){Krom.clearTexture(this.texture_,t,e,i,n,r,s,a)},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},depth:null,get_depth:function(){return null!=this.texture_?this.texture_.depth:1},realWidth:null,get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},realHeight:null,get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},g1:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new jt(this)),this.graphics1},g2:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new De(this)),this.graphics2},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new li(this)),this.graphics4},__class__:P,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};function R(){}(T["kha.AlignedQuad"]=R).__name__=!0,R.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:R};function V(t,e,i,n,r,s,a,o){this.mySize=t,this.width=r,this.height=s,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var u=a[l];++l,u.yoff+=this.baseline}this.texture=P.fromBytes(o.toBytes(),r,s,1)}(T["kha.KravurImage"]=V).__name__=!0,V.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,n){if(e>=this.chars.length)return null;var r=1/this.width,s=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*r,t.t0=a.y0*s,t.s1=a.x1*r,t.t1=a.y1*s,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=V.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,n=V.charBlocks.length/2|0;i<n;){var r=i++,s=V.charBlocks[2*r-1],a=V.charBlocks[2*r];a-1<t&&(e+=a-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,n=t.length;i<n;){var r=i++;e+=this.getCharWidth(ne.cca(t,r))}return e},charactersWidth:function(t,e,i){for(var n=0,r=e,s=e+i;r<s;){var a=r++;n+=this.getCharWidth(t[a])}return n},getBaselinePosition:function(){return this.baseline},__class__:V};function D(t){this.images=new $,this.blob=t}(T["kha.Kravur"]=D).__name__=!0,D.__interfaces__=[O],D.fromBytes=function(t){return new D(oi.fromBytes(t))},D.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=Zt.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(V.charBlocks=[e[0]])[0]+1,n=1,r=e.length;n<r;){var s=n++;e[s]!=i?(V.charBlocks.push(e[s-1]),V.charBlocks.push(e[s]),i=e[s]+1):++i}V.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(this.images.h.hasOwnProperty(a))return this.images.h[a];for(var o=64,l=32,u=new Array(e.length),h=0,c=u.length;h<c;){u[h++]=new ee}for(var d=null,_=-1;_<=0;)l<o?l*=2:o*=2,d=oi.alloc(o*l),_=Be.stbtt_BakeFontBitmap(this.blob,0,t,d,o,l,e,u);var f=new Te;Be.stbtt_InitFont(f,this.blob,0);var p=Be.stbtt_GetFontVMetrics(f),g=Be.stbtt_ScaleForPixelHeight(f,t),m=Math.round(p.ascent*g),v=Math.round(p.descent*g),b=Math.round(p.lineGap*g),w=new V(0|t,m,v,b,o,l,u,d);return this.images.h[a]=w},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},widthOfCharacters:function(t,e,i,n){return this._get(t).charactersWidth(e,i,n)},baseline:function(t){return this._get(t).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:D};var U=function(){};(T["kha.LoaderImpl"]=U).__name__=!0,U.getImageFormats=function(){return["png","jpg"]},U.loadImageFromDescription=function(t,e,i){var n=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;e(P._fromTexture(Krom.loadImage(t.files[0],n)))},U.getSoundFormats=function(){return["wav","ogg"]},U.loadSoundFromDescription=function(t,e,i){e(new ui(ht.ofData(Krom.loadSound(t.files[0]))))},U.getVideoFormats=function(){return["webm"]},U.loadVideoFromDescription=function(t,e,i){},U.loadBlobFromDescription=function(t,e,i){e(new oi(ht.ofData(Krom.loadBlob(t.files[0]))))},U.loadFontFromDescription=function(t,e,i){U.loadBlobFromDescription(t,function(t){e(new D(t))},i)};function H(){}(T["kha.TimeTask"]=H).__name__=!0,H.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:H};function W(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1}(T["kha.FrameTask"]=W).__name__=!0,W.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:W};var G=function(){};(T["kha.Scheduler"]=G).__name__=!0,G.init=function(){G.deltas=[];for(var t=0,e=G.DIF_COUNT;t<e;){var i=t++;G.deltas[i]=0}G.stopped=!0,G.frame_tasks_sorted=!0,G.current=G.lastTime=G.realTime(),G.currentFrameTaskId=0,G.currentTimeTaskId=0,G.currentGroupId=0,G.timeTasks=[],G.pausedTimeTasks=[],G.outdatedTimeTasks=[],G.timeTasksScratchpad=[],G.frameTasks=[],G.toDeleteFrame=[]},G.start=function(t){null==t&&(t=!1),G.vsync=q.get(0).get_vSynced();var e=y.get_primary().get_frequency();57<=e&&e<=63&&(e=60),G.onedifhz=1/e,G.stopped=!1,G.resetTime(),G.lastTime=G.realTime()-G.startTime;for(var i=0,n=G.DIF_COUNT;i<n;){var r=i++;G.deltas[r]=0}if(t){for(var s=0,a=G.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,u=G.frameTasks;l<u.length;){var h=u[l];++l,h.paused=!1}}},G.stop=function(){G.stopped=!0},G.isStopped=function(){return G.stopped},G.warpTimeTasksBack=function(t,e){for(var i=0;i<e.length;){var n=e[i];if(++i,n.start>=t)n.next=n.start;else if(0<n.period){var r=t-n.start,s=Math.ceil(r/n.period);n.next=n.start+s*n.period}}},G.warp=function(t){if(t<G.lastTime){G.current=t,G.lastTime=t,G.warpTimeTasksBack(t,G.outdatedTimeTasks),G.warpTimeTasksBack(t,G.timeTasks);for(var e=0,i=G.outdatedTimeTasks;e<i.length;){var n=i[e];++e,n.next>=t&&G.timeTasksScratchpad.push(n)}for(var r=0,s=G.timeTasksScratchpad;r<s.length;){var a=s[r];++r,ne.remove(G.outdatedTimeTasks,a)}for(var o=0,l=G.timeTasksScratchpad;o<l.length;){var u=l[o];++o,G.insertSorted(G.timeTasks,u)}for(;0<G.timeTasksScratchpad.length;)ne.remove(G.timeTasksScratchpad,G.timeTasksScratchpad[0])}else t>G.lastTime&&(G.startTime-=t-G.lastTime,G.current=t,G.lastTime=t,G.executeTimeTasks(t))},G.executeFrame=function(){var t=G.realTime()-G.startTime-G.lastTime,e=G.current;if(0<=t){if(null==ki.the())if(t>G.maxframetime)G.startTime+=t-G.maxframetime,e+=t=G.maxframetime;else if(G.vsync){for(var i=G.onedifhz;i<t-G.onedifhz;)i+=G.onedifhz;t=i;for(var n=0,r=G.DIF_COUNT-2;n<r;){var s=n++;t+=G.deltas[s],G.deltas[s]=G.deltas[1+s]}t+=G.deltas[G.DIF_COUNT-2],t/=G.DIF_COUNT,G.deltas[G.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=G.DIF_COUNT-1;a<o;){var l=a++;G.deltas[l]=G.deltas[1+l]}G.deltas[G.DIF_COUNT-1]=t;for(var u=0,h=0,c=G.DIF_COUNT;h<c;){var d=h++;u+=G.deltas[d]}e+=u/=G.DIF_COUNT}else e+=t;G.lastTime=e,G.stopped||(G.current=e);for(var _=0,f=G.pausedTimeTasks;_<f.length;){var p=f[_];++_,p.next+=t}if(G.stopped)for(var g=0,m=G.timeTasks;g<m.length;){var v=m[g];++g,v.next+=t}G.executeTimeTasks(e);for(var b=0,w=G.outdatedTimeTasks;b<w.length;){var y=w[b];++b,y.next<e-10&&G.timeTasksScratchpad.push(y)}for(var x=0,T=G.timeTasksScratchpad;x<T.length;){var S=T[x];++x,ne.remove(G.outdatedTimeTasks,S)}for(;0<G.timeTasksScratchpad.length;)ne.remove(G.timeTasksScratchpad,G.timeTasksScratchpad[0])}G.sortFrameTasks();for(var k=0,I=G.frameTasks;k<I.length;){var E=I[k];++k,G.stopped||E.paused||!E.active||E.task()||(E.active=!1)}for(var C=0,B=G.frameTasks;C<B.length;){var N=B[C];++C,N.active||G.toDeleteFrame.push(N)}for(;0<G.toDeleteFrame.length;)ne.remove(G.frameTasks,G.toDeleteFrame.pop())},G.executeTimeTasks=function(t){for(;0<G.timeTasks.length&&(G.activeTimeTask=G.timeTasks[0],G.activeTimeTask.next<=t);)G.activeTimeTask.next+=G.activeTimeTask.period,ne.remove(G.timeTasks,G.activeTimeTask),G.activeTimeTask.active&&G.activeTimeTask.task()?0<G.activeTimeTask.period&&(0==G.activeTimeTask.duration||G.activeTimeTask.duration>=G.activeTimeTask.start+G.activeTimeTask.next)?G.insertSorted(G.timeTasks,G.activeTimeTask):G.archiveTimeTask(G.activeTimeTask,t):(G.activeTimeTask.active=!1,G.archiveTimeTask(G.activeTimeTask,t));G.activeTimeTask=null},G.archiveTimeTask=function(t,e){},G.time=function(){return G.current},G.realTime=function(){return ve.get_time()},G.resetTime=function(){var t=ve.get_time(),e=t-G.startTime;G.startTime=t;for(var i=0,n=G.timeTasks;i<n.length;){var r=n[i];++i,r.start-=e,r.next-=e}for(var s=0,a=G.DIF_COUNT;s<a;){var o=s++;G.deltas[o]=0}G.current=0,G.lastTime=0},G.addBreakableFrameTask=function(t,e){return G.frameTasks.push(new W(t,e,++G.currentFrameTaskId)),G.frame_tasks_sorted=!1,G.currentFrameTaskId},G.addFrameTask=function(t,e){return G.addBreakableFrameTask(function(){return t(),!0},e)},G.pauseFrameTask=function(t,e){for(var i=0,n=G.frameTasks;i<n.length;){var r=n[i];if(++i,r.id==t){r.paused=e;break}}},G.removeFrameTask=function(t){for(var e=0,i=G.frameTasks;e<i.length;){var n=i[e];if(++e,n.id==t){n.active=!1;break}}},G.generateGroupId=function(){return++G.currentGroupId},G.addBreakableTimeTaskToGroup=function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=new H;return s.active=!0,s.task=e,s.id=++G.currentTimeTaskId,s.groupId=t,s.start=G.current+i,(s.period=0)!=n&&(s.period=n),(s.duration=0)!=r&&(s.duration=s.start+r),s.next=s.start,G.insertSorted(G.timeTasks,s),s.id},G.addTimeTaskToGroup=function(t,e,i,n,r){return null==r&&(r=0),null==n&&(n=0),G.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,n,r)},G.addBreakableTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),G.addBreakableTimeTaskToGroup(0,t,e,i,n)},G.addTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),G.addTimeTaskToGroup(0,t,e,i,n)},G.getTimeTask=function(t){if(null!=G.activeTimeTask&&G.activeTimeTask.id==t)return G.activeTimeTask;for(var e=0,i=G.timeTasks;e<i.length;){var n=i[e];if(++e,n.id==t)return n}for(var r=0,s=G.pausedTimeTasks;r<s.length;){var a=s[r];if(++r,a.id==t)return a}return null},G.pauseTimeTask=function(t,e){var i=G.getTimeTask(t);null!=i&&G.pauseRunningTimeTask(i,e),null!=G.activeTimeTask&&G.activeTimeTask.id==t&&(G.activeTimeTask.paused=e)},G.pauseRunningTimeTask=function(t,e){(t.paused=e)?(ne.remove(G.timeTasks,t),G.pausedTimeTasks.push(t)):(G.insertSorted(G.timeTasks,t),ne.remove(G.pausedTimeTasks,t))},G.pauseTimeTasks=function(t,e){for(var i=0,n=G.timeTasks;i<n.length;){var r=n[i];++i,r.groupId==t&&G.pauseRunningTimeTask(r,e)}null!=G.activeTimeTask&&G.activeTimeTask.groupId==t&&(G.activeTimeTask.paused=e)},G.removeTimeTask=function(t){var e=G.getTimeTask(t);null!=e&&(e.active=!1,ne.remove(G.timeTasks,e))},G.removeTimeTasks=function(t){for(var e=0,i=G.timeTasks;e<i.length;){var n=i[e];++e,n.groupId==t&&(n.active=!1,G.timeTasksScratchpad.push(n))}for(var r=0,s=G.timeTasksScratchpad;r<s.length;){var a=s[r];++r,ne.remove(G.timeTasks,a)}for(;0<G.timeTasksScratchpad.length;)ne.remove(G.timeTasksScratchpad,G.timeTasksScratchpad[0]);null!=G.activeTimeTask&&G.activeTimeTask.groupId==t&&(G.activeTimeTask.active=!1)},G.numTasksInSchedule=function(){return G.timeTasks.length+G.frameTasks.length},G.insertSorted=function(t,e){for(var i=0,n=t.length;i<n;){var r=i++;if(t[r].next>e.next)return void t.splice(r,0,e)}t.push(e)},G.sortFrameTasks=function(){G.frame_tasks_sorted||(G.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),G.frame_tasks_sorted=!0)};function z(){}(T["kha.Shaders"]=z).__name__=!0,z.init=function(){var t=[],e=se.field(z,"painter_colored_fragData0"),i=J.run(e);t.push(oi.fromBytes(i)),z.painter_colored_frag=new Fe(t,["painter-colored.frag.glsl"]);var n=[],r=se.field(z,"painter_colored_vertData0"),s=J.run(r);n.push(oi.fromBytes(s)),z.painter_colored_vert=new je(n,["painter-colored.vert.glsl"]);var a=[],o=se.field(z,"painter_image_fragData0"),l=J.run(o);a.push(oi.fromBytes(l)),z.painter_image_frag=new Fe(a,["painter-image.frag.glsl"]);var u=[],h=se.field(z,"painter_image_vertData0"),c=J.run(h);u.push(oi.fromBytes(c)),z.painter_image_vert=new je(u,["painter-image.vert.glsl"]);var d=[],_=se.field(z,"painter_text_fragData0"),f=J.run(_);d.push(oi.fromBytes(f)),z.painter_text_frag=new Fe(d,["painter-text.frag.glsl"]);var p=[],g=se.field(z,"painter_text_vertData0"),m=J.run(g);p.push(oi.fromBytes(m)),z.painter_text_vert=new je(p,["painter-text.vert.glsl"]);var v=[],b=se.field(z,"painter_video_fragData0"),w=J.run(b);v.push(oi.fromBytes(w)),z.painter_video_frag=new Fe(v,["painter-video.frag.glsl"]);var y=[],x=se.field(z,"painter_video_vertData0"),T=J.run(x);y.push(oi.fromBytes(T)),z.painter_video_vert=new je(y,["painter-video.vert.glsl"])};function K(){this.sampleRate=0,this.channels=0,this.length=0}(T["kha.Sound"]=K).__name__=!0,K.__interfaces__=[O],K.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(t){if(null==this.uncompressedData){var e=new dt,i=xt.readAll(this.compressedData,e,!0),n=e.getBytes(),r=n.length/4|0;if(1==i.channel){this.length=r/_t.samplesPerSecond;var s=new Float32Array(2*r);this.uncompressedData=s;for(var a=0,o=r;a<o;){var l=a++;this.uncompressedData[2*l]=n.getFloat(4*l),this.uncompressedData[2*l+1]=n.getFloat(4*l)}}else{this.length=r/2/_t.samplesPerSecond;var u=new Float32Array(r);this.uncompressedData=u;for(var h=0,c=r;h<c;){var d=h++;this.uncompressedData[d]=n.getFloat(4*d)}}this.channels=i.channel,this.sampleRate=i.sampleRate,this.compressedData=null,t()}else t()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:K};var Y=function(t,e,i,n,r){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==n?new nt(null,null,null,null,null,null,null,null,null):n,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<i?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==r?new M(null,null,null,null,null,null):r};(T["kha.SystemOptions"]=Y).__name__=!0,Y.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:Y};var ve=function(){};(T["kha.System"]=ve).__name__=!0,ve.__properties__={get_refreshRate:"get_refreshRate",get_vsync:"get_vsync",get_language:"get_language",get_systemId:"get_systemId",get_screenRotation:"get_screenRotation",get_time:"get_time",get_title:"get_title"},ve.init=function(t,e){var i=0;t.resizable&&(i|=1),t.maximizable&&(i|=4),t.minimizable&&(i|=2);var n=new Y(t.title,t.width,t.height,new nt(null,null,null,null,null,null,null,i,t.windowMode),new M(null,t.vSync,null,null,null,t.samplesPerPixel));ve.start(n,function(t){e()})},ve.start=function(t,e){ve.theTitle=t.title,Z.init(t,e)},ve.get_title=function(){return ve.theTitle},ve.notifyOnRender=function(e,i){null==i&&(i=0),ve.renderListeners.push(function(t){i<t.length&&e(t[i])})},ve.notifyOnFrames=function(t){ve.renderListeners.push(t)},ve.removeFramesListener=function(t){ne.remove(ve.renderListeners,t)},ve.notifyOnApplicationState=function(t,e,i,n,r){null!=t&&ve.foregroundListeners.push(t),null!=e&&ve.resumeListeners.push(e),null!=i&&ve.pauseListeners.push(i),null!=n&&ve.backgroundListeners.push(n),null!=r&&ve.shutdownListeners.push(r)},ve.notifyOnDropFiles=function(t){ve.dropFilesListeners.push(t)},ve.removeDropListener=function(t){ne.remove(ve.dropFilesListeners,t)},ve.notifyOnCutCopyPaste=function(t,e,i){ve.cutListener=t,ve.copyListener=e,ve.pasteListener=i},ve.notifyOnLoginLogout=function(t,e){ve.loginListener=t,ve.logoutListener=e},ve.login=function(){Z.login()},ve.waitingForLogin=function(){return Z.waitingForLogin()},ve.allowUserChange=function(){Z.allowUserChange()},ve.disallowUserChange=function(){Z.disallowUserChange()},ve.render=function(t){for(var e=0,i=ve.renderListeners;e<i.length;){var n=i[e];++e,n(t)}},ve.foreground=function(){for(var t=0,e=ve.foregroundListeners;t<e.length;){var i=e[t];++t,i()}},ve.resume=function(){for(var t=0,e=ve.resumeListeners;t<e.length;){var i=e[t];++t,i()}},ve.pause=function(){for(var t=0,e=ve.pauseListeners;t<e.length;){var i=e[t];++t,i()}},ve.background=function(){for(var t=0,e=ve.backgroundListeners;t<e.length;){var i=e[t];++t,i()}},ve.shutdown=function(){for(var t=0,e=ve.shutdownListeners;t<e.length;){var i=e[t];++t,i()}},ve.dropFiles=function(t){for(var e=0,i=ve.dropFilesListeners;e<i.length;){var n=i[e];++e,n(t)}},ve.get_time=function(){return Z.getTime()},ve.windowWidth=function(t){return null==t&&(t=0),q.get(t).get_width()},ve.windowHeight=function(t){return null==t&&(t=0),q.get_all()[t].get_height()},ve.get_screenRotation=function(){return 0},ve.get_systemId=function(){return Z.getSystemId()},ve.vibrate=function(t){Z.vibrate(t)},ve.get_language=function(){return Z.getLanguage()},ve.stop=function(){return Z.requestShutdown()},ve.loadUrl=function(t){Z.loadUrl(t)},ve.canSwitchFullscreen=function(){return!0},ve.isFullscreen=function(){return 1==q.get(0).get_mode()||2==q.get(0).get_mode()},ve.requestFullscreen=function(){q.get(0).set_mode(1)},ve.exitFullscreen=function(){q.get(0).set_mode(0)},ve.notifyOnFullscreenChange=function(t,e){},ve.removeFullscreenListener=function(t,e){},ve.changeResolution=function(t,e){},ve.requestShutdown=function(){ve.stop()},ve.get_vsync=function(){return q.get(0).get_vSynced()},ve.get_refreshRate=function(){return y.get_primary().get_frequency()},ve.screenDpi=function(){return y.get_primary().get_pixelsPerInch()},ve.safeZone=function(){return Z.safeZone()},ve.automaticSafeZone=function(){return Z.automaticSafeZone()},ve.setSafeZone=function(t){Z.setSafeZone(t)},ve.unlockAchievement=function(t){Z.unlockAchievement(t)};var Z=function(){};(T["kha.SystemImpl"]=Z).__name__=!0,Z.renderCallback=function(){G.executeFrame(),ve.render([Z.framebuffer])},Z.dropFilesCallback=function(t){ve.dropFiles(t)},Z.copyCallback=function(){return null!=ve.copyListener?ve.copyListener():null},Z.cutCallback=function(){return null!=ve.cutListener?ve.cutListener():null},Z.pasteCallback=function(t){null!=ve.pasteListener&&ve.pasteListener(t)},Z.foregroundCallback=function(){ve.foreground()},Z.resumeCallback=function(){ve.resume()},Z.pauseCallback=function(){ve.pause()},Z.backgroundCallback=function(){ve.background()},Z.shutdownCallback=function(){ve.shutdown()},Z.keyboardDownCallback=function(t){Z.keyboard.sendDownEvent(t)},Z.keyboardUpCallback=function(t){Z.keyboard.sendUpEvent(t)},Z.keyboardPressCallback=function(t){Z.keyboard.sendPressEvent(String.fromCodePoint(t))},Z.mouseDownCallback=function(t,e,i){Z.mouse.sendDownEvent(0,t,e,i)},Z.mouseUpCallback=function(t,e,i){Z.mouse.sendUpEvent(0,t,e,i)},Z.mouseMoveCallback=function(t,e,i,n){Z.mouse.sendMoveEvent(0,t,e,i,n)},Z.mouseWheelCallback=function(t){Z.mouse.sendWheelEvent(0,t)},Z.penDownCallback=function(t,e,i){Z.pen.sendDownEvent(0,t,e,i)},Z.penUpCallback=function(t,e,i){Z.pen.sendUpEvent(0,t,e,i)},Z.penMoveCallback=function(t,e,i){Z.pen.sendMoveEvent(0,t,e,i)},Z.gamepadAxisCallback=function(t,e,i){Z.gamepads[t].sendAxisEvent(e,i)},Z.gamepadButtonCallback=function(t,e,i){Z.gamepads[t].sendButtonEvent(e,i)},Z.audioCallback=function(t){_t._callCallback(t);var e=_t.buffer;Krom.writeAudioBuffer(e.data.buffer,t)},Z.init=function(t,e){Krom.init(t.title,t.width,t.height,t.framebuffer.samplesPerPixel,t.framebuffer.verticalSync,t.window.mode,t.window.windowFeatures,3),Z.start=Krom.getTime(),L.trace=function(t,e){var i=null!=e?e.className+":"+e.lineNumber+": "+ae.string(t):ae.string(t);Krom.log(ne.substr(i,0,511))},new q(0),G.init(),z.init();var i=new li;Z.framebuffer=new A(0,null,null,i),Z.framebuffer.init(new jt(Z.framebuffer),new De(Z.framebuffer),i),Krom.setCallback(Z.renderCallback),Krom.setDropFilesCallback(Z.dropFilesCallback),Krom.setCutCopyPasteCallback(Z.cutCallback,Z.copyCallback,Z.pasteCallback),Krom.setApplicationStateCallback(Z.foregroundCallback,Z.resumeCallback,Z.pauseCallback,Z.backgroundCallback,Z.shutdownCallback),Z.keyboard=new ti,Z.mouse=new ni,Z.pen=new ri,Z.gamepads=[];for(var n=0,r=Z.maxGamepads;n<r;){var s=n++;Z.gamepads[s]=new Qe(s)}Krom.setKeyboardDownCallback(Z.keyboardDownCallback),Krom.setKeyboardUpCallback(Z.keyboardUpCallback),Krom.setKeyboardPressCallback(Z.keyboardPressCallback),Krom.setMouseDownCallback(Z.mouseDownCallback),Krom.setMouseUpCallback(Z.mouseUpCallback),Krom.setMouseMoveCallback(Z.mouseMoveCallback),Krom.setMouseWheelCallback(Z.mouseWheelCallback),Krom.setPenDownCallback(Z.penDownCallback),Krom.setPenUpCallback(Z.penUpCallback),Krom.setPenMoveCallback(Z.penMoveCallback),Krom.setGamepadAxisCallback(Z.gamepadAxisCallback),Krom.setGamepadButtonCallback(Z.gamepadButtonCallback),_t._init(),ft._init(),Krom.setAudioCallback(Z.audioCallback),G.start(),e(q.get(0))},Z.initEx=function(t,e,i,n){},Z.translateWindowMode=function(t){if(null==t)return 0;switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},Z.getScreenRotation=function(){return 0},Z.getTime=function(){return Krom.getTime()-Z.start},Z.getVsync=function(){return!0},Z.getRefreshRate=function(){return 60},Z.getSystemId=function(){return Krom.systemId()},Z.vibrate=function(t){},Z.getLanguage=function(){return"en"},Z.requestShutdown=function(){return Krom.requestShutdown(),!0},Z.getMouse=function(t){return Z.mouse},Z.getPen=function(t){return Z.pen},Z.getKeyboard=function(t){return Z.keyboard},Z.lockMouse=function(){if(!Z.isMouseLocked()){Krom.lockMouse();for(var t=0,e=Z.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},Z.unlockMouse=function(){if(Z.isMouseLocked()){Krom.unlockMouse();for(var t=0,e=Z.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},Z.canLockMouse=function(){return Krom.canLockMouse()},Z.isMouseLocked=function(){return Krom.isMouseLocked()},Z.notifyOfMouseLockChange=function(t,e){Z.canLockMouse()&&null!=t&&Z.mouseLockListeners.push(t)},Z.removeFromMouseLockChange=function(t,e){Z.canLockMouse()&&null!=t&&ne.remove(Z.mouseLockListeners,t)},Z.hideSystemCursor=function(){Krom.showMouse(!1)},Z.showSystemCursor=function(){Krom.showMouse(!0)},Z.unload=function(){},Z.canSwitchFullscreen=function(){return!1},Z.isFullscreen=function(){return!1},Z.requestFullscreen=function(){},Z.exitFullscreen=function(){},Z.notifyOfFullscreenChange=function(t,e){},Z.removeFromFullscreenChange=function(t,e){},Z.changeResolution=function(t,e){},Z.setKeepScreenOn=function(t){},Z.loadUrl=function(t){},Z.getGamepadId=function(t){return"unknown"},Z.getGamepadVendor=function(t){return"unknown"},Z.safeZone=function(){return 1},Z.login=function(){},Z.automaticSafeZone=function(){return!0},Z.setSafeZone=function(t){},Z.unlockAchievement=function(t){},Z.waitingForLogin=function(){return!1},Z.disallowUserChange=function(){},Z.allowUserChange=function(){};function j(){}(T["kha.Video"]=j).__name__=!0,j.__interfaces__=[O],j.prototype={width:function(){return 100},height:function(){return 100},play:function(t){null==t&&(t=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(t){return 0},getVolume:function(){return 1},setVolume:function(t){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:j,__properties__:{set_position:"set_position",get_position:"get_position"}};var q=function(t){this.num=t,q.windows.push(this)};(T["kha.Window"]=q).__name__=!0,q.__properties__={get_all:"get_all"},q.create=function(t,e){return null},q.destroy=function(t){},q.get=function(t){return q.windows[t]},q.get_all=function(){return q.windows},q.prototype={num:null,windowTitle:null,resize:function(t,e){},move:function(t,e){},changeWindowFeatures:function(t){},changeFramebuffer:function(t){},get_x:function(){return 0},set_x:function(t){return 0},get_y:function(){return 0},set_y:function(t){return 0},get_width:function(){return Krom.windowWidth(this.num)},set_width:function(t){return 800},get_height:function(){return Krom.windowHeight(this.num)},set_height:function(t){return 600},get_mode:function(){return 0},set_mode:function(t){return 0},get_visible:function(){return!0},set_visible:function(t){return!0},get_title:function(){return this.windowTitle},set_title:function(t){return Krom.setWindowTitle(this.num,t),this.windowTitle=t,this.windowTitle},notifyOnResize:function(t){},get_vSynced:function(){return!0},__class__:q,__properties__:{get_vSynced:"get_vSynced",set_title:"set_title",get_title:"get_title",set_visible:"set_visible",get_visible:"get_visible",set_mode:"set_mode",get_mode:"get_mode",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var Q={};(T["kha._WindowOptions.WindowFeatures_Impl_"]=Q).__name__=!0,Q._new=function(t){return t};var nt=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==s&&(s=-1),null==r&&(r=600),null==n&&(n=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=n,this.height=r,this.display=s,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(T["kha.WindowOptions"]=nt).__name__=!0,nt.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:nt};var rt={};(T["kha.arrays._Float32Array.Float32Array_Impl_"]=rt).__name__=!0,rt.__properties__={get_length:"get_length",get_buffer:"get_buffer"},rt._new=function(t){return new Float32Array(t)},rt.get_buffer=function(t){return t.buffer},rt.get_length=function(t){return t.length},rt.set=function(t,e,i){return t[e]=i},rt.get=function(t,e){return t[e]},rt.data=function(t){return t},rt.subarray=function(t,e,i){return t.subarray(e,i)};var st={};(T["kha.arrays._Int16Array.Int16Array_Impl_"]=st).__name__=!0,st.__properties__={get_length:"get_length"},st._new=function(t){return new Int16Array(t)},st.get_length=function(t){return t.length},st.set=function(t,e,i){return t[e]=i},st.get=function(t,e){return t[e]},st.data=function(t){return t},st.arrayRead=function(t,e){return t[e]},st.arrayWrite=function(t,e,i){return t[e]=i},st.subarray=function(t,e,i){return t.subarray(e,i)};var at={};(T["kha.arrays._Int32Array.Int32Array_Impl_"]=at).__name__=!0,at.__properties__={get_length:"get_length"},at._new=function(t){return new Int32Array(t)},at.get_length=function(t){return t.length},at.set=function(t,e,i){return t[e]=i},at.get=function(t,e){return t[e]},at.data=function(t){return t},at.arrayRead=function(t,e){return t[e]},at.arrayWrite=function(t,e,i){return t[e]=i},at.subarray=function(t,e,i){return t.subarray(e,i)};var ot={};(T["kha.arrays._Uint32Array.Uint32Array_Impl_"]=ot).__name__=!0,ot.__properties__={get_length:"get_length"},ot._new=function(t){return new Uint32Array(t)},ot.get_length=function(t){return t.length},ot.set=function(t,e,i){return t[e]=i},ot.get=function(t,e){return t[e]},ot.data=function(t){return t},ot.arrayRead=function(t,e){return t[e]},ot.arrayWrite=function(t,e,i){return t[e]=i},ot.subarray=function(t,e,i){return t.subarray(e,i)};function lt(){}(T["kha.audio1.AudioChannel"]=lt).__name__=!0,lt.__isInterface__=!0,lt.prototype={play:null,pause:null,stop:null,length:null,get_length:null,get_position:null,set_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:lt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};function ut(t){this.value=t}(T["kha.internal.IntBox"]=ut).__name__=!0,ut.prototype={value:null,__class__:ut};var _t=function(){};(T["kha.audio2.Audio"]=_t).__name__=!0,_t._init=function(){_t.buffer=new gt(8192,2,44100),_t.samplesPerSecond=44100},_t._callCallback=function(t){if(null!=_t.buffer)if(null!=_t.audioCallback)_t.intBox.value=t,_t.audioCallback(_t.intBox,_t.buffer);else for(var e=0,i=t;e<i;){e++;_t.buffer.data[_t.buffer.writeLocation]=0,_t.buffer.writeLocation+=1,_t.buffer.writeLocation>=_t.buffer.size&&(_t.buffer.writeLocation=0)}},_t._readSample=function(){if(null==_t.buffer)return 0;var t=_t.buffer.data[_t.buffer.readLocation];return _t.buffer.readLocation+=1,_t.buffer.readLocation>=_t.buffer.size&&(_t.buffer.readLocation=0),t},_t.play=function(t,e){return null==e&&(e=!1),null},_t.stream=function(t,e){return null==e&&(e=!1),null};var ft=function(){};(T["kha.audio2.Audio1"]=ft).__name__=!0,ft._init=function(){var t=new Array(32);ft.soundChannels=t;var e=new Array(32);ft.streamChannels=e;var i=new Array(32);ft.internalSoundChannels=i;var n=new Array(32);ft.internalStreamChannels=n;var r=new Float32Array(512);ft.sampleCache1=r;var s=new Float32Array(512);ft.sampleCache2=s,ft.lastAllocationCount=0,_t.audioCallback=ft.mix},ft.max=function(t,e){return e<t?t:e},ft.min=function(t,e){return t<e?t:e},ft.mix=function(t,e){var i=t.value;if(ft.sampleCache1.length<i){if(_t.disableGcInteractions){L.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:50,className:"kha.audio2.Audio1",methodName:"mix"});for(var n=0,r=i;n<r;){n++;e.data[e.writeLocation]=0,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}return ft.lastAllocationCount=0,void(_t.disableGcInteractions=!1)}var s=new Float32Array(2*i);ft.sampleCache1=s;var a=new Float32Array(2*i);ft.sampleCache2=a,ft.lastAllocationCount=0}else 100<ft.lastAllocationCount?_t.disableGcInteractions=!0:ft.lastAllocationCount+=1;for(var o=0,l=i;o<l;){var u=o++;ft.sampleCache2[u]=0}for(var h=0;h<32;){var c=h++;ft.internalSoundChannels[c]=ft.soundChannels[c]}for(var d=0;d<32;){var _=d++;ft.internalStreamChannels[_]=ft.streamChannels[_]}for(var f=0,p=ft.internalSoundChannels;f<p.length;){var g=p[f];if(++f,null!=g&&!g.get_finished()){g.nextSamples(ft.sampleCache1,i,e.samplesPerSecond);for(var m=0,v=i;m<v;){var b=m++;ft.sampleCache2[b]+=ft.sampleCache1[b]*g.get_volume()}}}for(var w=0,y=ft.internalStreamChannels;w<y.length;){var x=y[w];if(++w,null!=x&&!x.get_finished()){x.nextSamples(ft.sampleCache1,i,e.samplesPerSecond);for(var T=0,S=i;T<S;){var k=T++;ft.sampleCache2[k]+=ft.sampleCache1[k]*x.get_volume()}}}for(var I=0,E=i;I<E;){var C=I++,B=ft.sampleCache2[C],N=B<1?B:1;e.data[e.writeLocation]=-1<N?N:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},ft.play=function(t,e){null==e&&(e=!1);var i=null;(i=_t.samplesPerSecond!=t.sampleRate?new mt(e,t.sampleRate):new pt(e)).data=t.uncompressedData;for(var n=!1,r=0;r<32;){var s=r++;if(null==ft.soundChannels[s]||ft.soundChannels[s].get_finished()){ft.soundChannels[s]=i,n=!0;break}}return n?i:null},ft._playAgain=function(t){for(var e=0;e<32;){var i=e++;ft.soundChannels[i]==t&&(ft.soundChannels[i]=null)}for(var n=0;n<32;){var r=n++;if(null==ft.soundChannels[r]||ft.soundChannels[r].get_finished()||ft.soundChannels[r]==t){ft.soundChannels[r]=t;break}}},ft.stream=function(t,e){null==e&&(e=!1);var i=_t.stream(t,e);if(null!=i)return i;for(var n=new vt(t.compressedData,e),r=!1,s=0;s<32;){var a=s++;if(null==ft.streamChannels[a]||ft.streamChannels[a].get_finished()){ft.streamChannels[a]=n,r=!0;break}}return r?n:null};var pt=function(t){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=t};(T["kha.audio2.AudioChannel"]=pt).__name__=!0,pt.__interfaces__=[lt],pt.max=function(t,e){return e<t?t:e},pt.min=function(t,e){return t<e?t:e},pt.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=this.data.length-this.myPosition,l=e-s,u=o<l?o:l;a<u;){a++;t[s++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},play:function(){this.paused=!1,this.stopped=!1,ft._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},length:null,get_length:function(){return this.data.length/_t.samplesPerSecond/2},get_position:function(){return this.myPosition/_t.samplesPerSecond/2},set_position:function(t){this.myPosition=Math.round(t*_t.samplesPerSecond*2);var e=this.myPosition,i=this.data.length,n=e<i?e:i;return this.myPosition=0<n?n:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.stopped},__class__:pt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};var gt=function(t,e,i){this.size=t;var n=new Float32Array(t);this.data=n,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(T["kha.audio2.Buffer"]=gt).__name__=!0,gt.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:gt};var mt=function(t,e){pt.call(this,t),this.sampleRate=e};(T["kha.audio2.ResamplingAudioChannel"]=mt).__name__=!0,mt.max=function(t,e){return e<t?t:e},mt.min=function(t,e){return t<e?t:e},mt.__super__=pt,mt.prototype=r(pt.prototype,{sampleRate:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=Math.ceil(this.data.length*(i/this.sampleRate)),l=(o%2==0?o:o+1)-this.myPosition,u=e-s,h=l<u?l:u;a<h;){a++;var c,d=s++,_=this.myPosition++,f=_%2==0,p=this.sampleRate/i;if(f){var g=p*(_=_/2|0),m=Math.floor(g),v=Math.floor(1+g);m*=2,v*=2;var b=this.data.length-1;b%2==0?b=b:--b;var w=m<0||b<m?0:this.data[m],y=v<0||b<v?0:this.data[v],x=g-Math.floor(g);c=(1-x)*w+x*y}else{var T=p*(_=_/2|0),S=Math.floor(T),k=Math.floor(1+T);S=2*S+1,k=2*k+1;var I=this.data.length-1;I%2!=0?I=I:--I;var E=S<1||I<S?0:this.data[S],C=k<1||I<k?0:this.data[k],B=T-Math.floor(T);c=(1-B)*E+B*C}t[d]=c}var N=Math.ceil(this.data.length*(i/this.sampleRate));if(this.myPosition>=(N%2==0?N:N+1)&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},sample:function(t,e){var i=t%2==0,n=this.sampleRate/e;if(i){var r=n*(t=t/2|0),s=Math.floor(r),a=Math.floor(1+r);s*=2,a*=2;var o=this.data.length-1;o%2==0?o=o:--o;var l=s<0||o<s?0:this.data[s],u=a<0||o<a?0:this.data[a],h=r-Math.floor(r);return(1-h)*l+h*u}var c=n*(t=t/2|0),d=Math.floor(c),_=Math.floor(1+c);d=2*d+1,_=2*_+1;var f=this.data.length-1;f%2!=0?f=f:--f;var p=d<1||f<d?0:this.data[d],g=_<1||f<_?0:this.data[_],m=c-Math.floor(c);return(1-m)*p+m*g},lerp:function(t,e,i){return(1-i)*t+i*e},sampleLength:function(t){var e=Math.ceil(this.data.length*(t/this.sampleRate));return e%2==0?e:e+1},play:function(){this.paused=!1,this.stopped=!1,ft._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},get_length:function(){return this.data.length/this.sampleRate/2},get_position:function(){return this.myPosition/_t.samplesPerSecond/2},set_position:function(t){var e=Math.round(t*_t.samplesPerSecond*2);e%2==0?e=e:++e;var i=Math.ceil(this.data.length*(_t.samplesPerSecond/this.sampleRate)),n=i%2==0?i:i+1,r=e<n?e:n;return this.myPosition=0<r?r:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.stopped},__class__:mt});var vt=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=xt.openFromBytes(t)};(T["kha.audio2.StreamChannel"]=vt).__name__=!0,vt.__interfaces__=[lt],vt.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,i){if(this.paused)for(var n=0,r=e;n<r;){t[n++]=0}else{var s=2*this.reader.read(t,e/2|0,2,i,!0);if(s<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=s,o=e;a<o;){t[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},set_position:function(t){return t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.atend},__class__:vt,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};function bt(){}(T["kha.audio2.ogg.tools.Crc32"]=bt).__name__=!0,bt.init=function(){if(null==bt.table){var t=new Array(256);bt.table=t;for(var e=0;e<256;){var i=e++,n=i<<24;n=(n=(n=(n=(n=(n=(n=(n=n<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0))<<1^(Ot.gte(n,1<<31)?79764919:0),bt.table[i]=n}}},bt.update=function(t,e){return t<<8^bt.table[e^t>>>24]};function wt(){}(T["kha.audio2.ogg.tools.MathTools"]=wt).__name__=!0,wt.ilog=function(t){var e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return t<16384?t<16?e[t]:t<512?5+e[t>>5]:10+e[t>>10]:t<16777216?t<524288?15+e[t>>15]:20+e[t>>20]:t<536870912?25+e[t>>25]:t<-2147483648?30+e[t>>30]:0};function yt(){}(T["kha.audio2.ogg.tools.Mdct"]=yt).__name__=!0,yt.inverseTransform=function(t,e,i,n,r,s){for(var a=e>>1,o=e>>2,l=e>>3,u=new Array(a),h=a-2,c=0,d=0,_=a;d!=_;)u[h+1]=t[d]*i[c]-t[d+2]*i[c+1],u[h]=t[d]*i[c+1]+t[d+2]*i[c],h-=2,c+=2,d+=4;for(d=a-3;0<=h;)u[h+1]=-t[d+2]*i[c]- -t[d]*i[c+1],u[h]=-t[d+2]*i[c+1]+-t[d]*i[c],h-=2,c+=2,d-=4;for(var f=t,p=u,g=a-8,m=o,v=0,b=o,w=0;0<=g;){var y=p[m+1]-p[v+1],x=p[m]-p[v];f[b+1]=p[m+1]+p[v+1],f[b]=p[m]+p[v],f[w+1]=y*i[g+4]-x*i[g+5],f[w]=x*i[g+4]+y*i[g+5],y=p[m+3]-p[v+3],x=p[m+2]-p[v+2],f[b+3]=p[m+3]+p[v+3],f[b+2]=p[m+2]+p[v+2],f[w+3]=y*i[g]-x*i[g+1],f[w+2]=x*i[g]+y*i[g+1],g-=8,b+=4,w+=4,m+=4,v+=4}for(var T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],S=(e<16384?e<16?T[e]:e<512?5+T[e>>5]:10+T[e>>10]:e<16777216?e<524288?15+T[e>>15]:20+T[e>>20]:e<536870912?25+T[e>>25]:e<-2147483648?30+T[e>>30]:0)-1,k=a-1-0*o,I=k,E=k-(e>>3),C=0,B=1+(e>>4>>2);0<--B;){var N=f[I]-f[E],L=f[I+-1]-f[E+-1];f[I]=f[I]+f[E];var F=I+-1;f[F]=f[F]+f[E+-1],f[E]=N*i[C]-L*i[C+1],f[E+-1]=L*i[C]+N*i[C+1],C+=8,N=f[I+-2]-f[E+-2],L=f[I+-3]-f[E+-3];var A=I+-2;f[A]=f[A]+f[E+-2];var M=I+-3;f[M]=f[M]+f[E+-3],f[E+-2]=N*i[C]-L*i[C+1],f[E+-3]=L*i[C]+N*i[C+1],C+=8,N=f[I+-4]-f[E+-4],L=f[I+-5]-f[E+-5];var O=I+-4;f[O]=f[O]+f[E+-4];var P=I+-5;f[P]=f[P]+f[E+-5],f[E+-4]=N*i[C]-L*i[C+1],f[E+-5]=L*i[C]+N*i[C+1],C+=8,N=f[I+-6]-f[E+-6],L=f[I+-7]-f[E+-7];var R=I+-6;f[R]=f[R]+f[E+-6];var V=I+-7;f[V]=f[V]+f[E+-7],f[E+-6]=N*i[C]-L*i[C+1],f[E+-7]=L*i[C]+N*i[C+1],C+=8,I-=8,E-=8}for(var D=a-1-o,U=D,H=D-(e>>3),W=0,G=1+(e>>4>>2);0<--G;){var z=f[U]-f[H],X=f[U+-1]-f[H+-1];f[U]=f[U]+f[H];var K=U+-1;f[K]=f[K]+f[H+-1],f[H]=z*i[W]-X*i[W+1],f[H+-1]=X*i[W]+z*i[W+1],W+=8,z=f[U+-2]-f[H+-2],X=f[U+-3]-f[H+-3];var Y=U+-2;f[Y]=f[Y]+f[H+-2];var Z=U+-3;f[Z]=f[Z]+f[H+-3],f[H+-2]=z*i[W]-X*i[W+1],f[H+-3]=X*i[W]+z*i[W+1],W+=8,z=f[U+-4]-f[H+-4],X=f[U+-5]-f[H+-5];var j=U+-4;f[j]=f[j]+f[H+-4];var q=U+-5;f[q]=f[q]+f[H+-5],f[H+-4]=z*i[W]-X*i[W+1],f[H+-5]=X*i[W]+z*i[W+1],W+=8,z=f[U+-6]-f[H+-6],X=f[U+-7]-f[H+-7];var Q=U+-6;f[Q]=f[Q]+f[H+-6];var J=U+-7;f[J]=f[J]+f[H+-7],f[H+-6]=z*i[W]-X*i[W+1],f[H+-7]=X*i[W]+z*i[W+1],W+=8,U-=8,H-=8}for(var $=a-1-0*l,tt=0,et=$,it=$-(e>>4),nt=1+(e>>5>>2);0<--nt;){var rt=f[et]-f[it],st=f[et+-1]-f[it+-1];f[et]=f[et]+f[it];var at=et+-1;f[at]=f[at]+f[it+-1],f[it]=rt*i[tt]-st*i[tt+1],f[it+-1]=st*i[tt]+rt*i[tt+1],tt+=16,rt=f[et+-2]-f[it+-2],st=f[et+-3]-f[it+-3];var ot=et+-2;f[ot]=f[ot]+f[it+-2];var lt=et+-3;f[lt]=f[lt]+f[it+-3],f[it+-2]=rt*i[tt]-st*i[tt+1],f[it+-3]=st*i[tt]+rt*i[tt+1],tt+=16,rt=f[et+-4]-f[it+-4],st=f[et+-5]-f[it+-5];var ut=et+-4;f[ut]=f[ut]+f[it+-4];var ht=et+-5;f[ht]=f[ht]+f[it+-5],f[it+-4]=rt*i[tt]-st*i[tt+1],f[it+-5]=st*i[tt]+rt*i[tt+1],tt+=16,rt=f[et+-6]-f[it+-6],st=f[et+-7]-f[it+-7];var ct=et+-6;f[ct]=f[ct]+f[it+-6];var dt=et+-7;f[dt]=f[dt]+f[it+-7],f[it+-6]=rt*i[tt]-st*i[tt+1],f[it+-7]=st*i[tt]+rt*i[tt+1],et-=8,it-=8,tt+=16}for(var _t=a-1-l,ft=0,pt=_t,gt=_t-(e>>4),mt=1+(e>>5>>2);0<--mt;){var vt=f[pt]-f[gt],bt=f[pt+-1]-f[gt+-1];f[pt]=f[pt]+f[gt];var wt=pt+-1;f[wt]=f[wt]+f[gt+-1],f[gt]=vt*i[ft]-bt*i[ft+1],f[gt+-1]=bt*i[ft]+vt*i[ft+1],ft+=16,vt=f[pt+-2]-f[gt+-2],bt=f[pt+-3]-f[gt+-3];var yt=pt+-2;f[yt]=f[yt]+f[gt+-2];var xt=pt+-3;f[xt]=f[xt]+f[gt+-3],f[gt+-2]=vt*i[ft]-bt*i[ft+1],f[gt+-3]=bt*i[ft]+vt*i[ft+1],ft+=16,vt=f[pt+-4]-f[gt+-4],bt=f[pt+-5]-f[gt+-5];var Tt=pt+-4;f[Tt]=f[Tt]+f[gt+-4];var St=pt+-5;f[St]=f[St]+f[gt+-5],f[gt+-4]=vt*i[ft]-bt*i[ft+1],f[gt+-5]=bt*i[ft]+vt*i[ft+1],ft+=16,vt=f[pt+-6]-f[gt+-6],bt=f[pt+-7]-f[gt+-7];var kt=pt+-6;f[kt]=f[kt]+f[gt+-6];var It=pt+-7;f[It]=f[It]+f[gt+-7],f[gt+-6]=vt*i[ft]-bt*i[ft+1],f[gt+-7]=bt*i[ft]+vt*i[ft+1],pt-=8,gt-=8,ft+=16}for(var Et=a-1-2*l,Ct=0,Bt=Et,Nt=Et-(e>>4),Lt=1+(e>>5>>2);0<--Lt;){var Ft=f[Bt]-f[Nt],At=f[Bt+-1]-f[Nt+-1];f[Bt]=f[Bt]+f[Nt];var Mt=Bt+-1;f[Mt]=f[Mt]+f[Nt+-1],f[Nt]=Ft*i[Ct]-At*i[Ct+1],f[Nt+-1]=At*i[Ct]+Ft*i[Ct+1],Ct+=16,Ft=f[Bt+-2]-f[Nt+-2],At=f[Bt+-3]-f[Nt+-3];var Ot=Bt+-2;f[Ot]=f[Ot]+f[Nt+-2];var Pt=Bt+-3;f[Pt]=f[Pt]+f[Nt+-3],f[Nt+-2]=Ft*i[Ct]-At*i[Ct+1],f[Nt+-3]=At*i[Ct]+Ft*i[Ct+1],Ct+=16,Ft=f[Bt+-4]-f[Nt+-4],At=f[Bt+-5]-f[Nt+-5];var Rt=Bt+-4;f[Rt]=f[Rt]+f[Nt+-4];var Vt=Bt+-5;f[Vt]=f[Vt]+f[Nt+-5],f[Nt+-4]=Ft*i[Ct]-At*i[Ct+1],f[Nt+-5]=At*i[Ct]+Ft*i[Ct+1],Ct+=16,Ft=f[Bt+-6]-f[Nt+-6],At=f[Bt+-7]-f[Nt+-7];var Dt=Bt+-6;f[Dt]=f[Dt]+f[Nt+-6];var Ut=Bt+-7;f[Ut]=f[Ut]+f[Nt+-7],f[Nt+-6]=Ft*i[Ct]-At*i[Ct+1],f[Nt+-7]=At*i[Ct]+Ft*i[Ct+1],Bt-=8,Nt-=8,Ct+=16}for(var Ht=a-1-3*l,Wt=0,Gt=Ht,zt=Ht-(e>>4),Xt=1+(e>>5>>2);0<--Xt;){var Kt=f[Gt]-f[zt],Yt=f[Gt+-1]-f[zt+-1];f[Gt]=f[Gt]+f[zt];var Zt=Gt+-1;f[Zt]=f[Zt]+f[zt+-1],f[zt]=Kt*i[Wt]-Yt*i[Wt+1],f[zt+-1]=Yt*i[Wt]+Kt*i[Wt+1],Wt+=16,Kt=f[Gt+-2]-f[zt+-2],Yt=f[Gt+-3]-f[zt+-3];var jt=Gt+-2;f[jt]=f[jt]+f[zt+-2];var qt=Gt+-3;f[qt]=f[qt]+f[zt+-3],f[zt+-2]=Kt*i[Wt]-Yt*i[Wt+1],f[zt+-3]=Yt*i[Wt]+Kt*i[Wt+1],Wt+=16,Kt=f[Gt+-4]-f[zt+-4],Yt=f[Gt+-5]-f[zt+-5];var Qt=Gt+-4;f[Qt]=f[Qt]+f[zt+-4];var Jt=Gt+-5;f[Jt]=f[Jt]+f[zt+-5],f[zt+-4]=Kt*i[Wt]-Yt*i[Wt+1],f[zt+-5]=Yt*i[Wt]+Kt*i[Wt+1],Wt+=16,Kt=f[Gt+-6]-f[zt+-6],Yt=f[Gt+-7]-f[zt+-7];var $t=Gt+-6;f[$t]=f[$t]+f[zt+-6];var te=Gt+-7;f[te]=f[te]+f[zt+-7],f[zt+-6]=Kt*i[Wt]-Yt*i[Wt+1],f[zt+-7]=Yt*i[Wt]+Kt*i[Wt+1],Gt-=8,zt-=8,Wt+=16}for(var ee=2,ie=S-3>>1;ee<ie;)for(var ne=ee++,re=e>>2+ne,se=re>>1,ae=0,oe=1<<1+ne;ae<oe;)for(var le=a-1-re*ae++,ue=1<<3+ne,he=0,ce=le,de=le-se,_e=1+(e>>4+ne>>2);0<--_e;){var fe=f[ce]-f[de],pe=f[ce+-1]-f[de+-1];f[ce]=f[ce]+f[de];var ge=ce+-1;f[ge]=f[ge]+f[de+-1],f[de]=fe*i[he]-pe*i[he+1],f[de+-1]=pe*i[he]+fe*i[he+1],he+=ue,fe=f[ce+-2]-f[de+-2],pe=f[ce+-3]-f[de+-3];var me=ce+-2;f[me]=f[me]+f[de+-2];var ve=ce+-3;f[ve]=f[ve]+f[de+-3],f[de+-2]=fe*i[he]-pe*i[he+1],f[de+-3]=pe*i[he]+fe*i[he+1],he+=ue,fe=f[ce+-4]-f[de+-4],pe=f[ce+-5]-f[de+-5];var be=ce+-4;f[be]=f[be]+f[de+-4];var we=ce+-5;f[we]=f[we]+f[de+-5],f[de+-4]=fe*i[he]-pe*i[he+1],f[de+-5]=pe*i[he]+fe*i[he+1],he+=ue,fe=f[ce+-6]-f[de+-6],pe=f[ce+-7]-f[de+-7];var ye=ce+-6;f[ye]=f[ye]+f[de+-6];var xe=ce+-7;f[xe]=f[xe]+f[de+-7],f[de+-6]=fe*i[he]-pe*i[he+1],f[de+-7]=pe*i[he]+fe*i[he+1],ce-=8,de-=8,he+=ue}for(var Te=S-3>>1,Se=S-6;Te<Se;)for(var ke=Te++,Ie=e>>2+ke,Ee=1<<3+ke,Ce=Ie>>1,Be=1<<1+ke,Ne=0,Le=a-1,Fe=1+(e>>6+ke);0<--Fe;){for(var Ae=i[Ne],Me=i[Ne+1],Oe=i[Ne+Ee],Pe=i[Ne+Ee+1],Re=i[Ne+2*Ee],Ve=i[Ne+2*Ee+1],De=i[Ne+3*Ee],Ue=i[Ne+3*Ee+1],He=Le,We=Le+-Ce,Ge=1+Be;0<--Ge;){var ze=f[He]-f[We],Xe=f[He+-1]-f[We+-1];f[He]=f[He]+f[We],f[He+-1]=f[He+-1]+f[We+-1],f[We]=ze*Ae-Xe*Me,f[We+-1]=Xe*Ae+ze*Me,ze=f[He+-2]-f[We+-2],Xe=f[He+-3]-f[We+-3],f[He+-2]=f[He+-2]+f[We+-2],f[He+-3]=f[He+-3]+f[We+-3],f[We+-2]=ze*Oe-Xe*Pe,f[We+-3]=Xe*Oe+ze*Pe,ze=f[He+-4]-f[We+-4],Xe=f[He+-5]-f[We+-5],f[He+-4]=f[He+-4]+f[We+-4],f[He+-5]=f[He+-5]+f[We+-5],f[We+-4]=ze*Re-Xe*Ve,f[We+-5]=Xe*Re+ze*Ve,ze=f[He+-6]-f[We+-6],Xe=f[He+-7]-f[We+-7],f[He+-6]=f[He+-6]+f[We+-6],f[He+-7]=f[He+-7]+f[We+-7],f[We+-6]=ze*De-Xe*Ue,f[We+-7]=Xe*De+ze*Ue,He-=Ie,We-=Ie}Ne+=4*Ee,Le-=8}for(var Ke=a-1,Ye=i[e>>3],Ze=Ke,je=Ke-16*(e>>5);je<Ze;){var qe=f[Ze],Qe=f[Ze+-8];f[Ze+-8]=qe-Qe,f[Ze]=qe+Qe,qe=f[Ze+-1],Qe=f[Ze+-9],f[Ze+-9]=qe-Qe,f[Ze+-1]=qe+Qe;var Je=(qe=f[Ze+-2])-(Qe=f[Ze+-10]);f[Ze+-2]=qe+Qe;var $e=(qe=f[Ze+-3])-(Qe=f[Ze+-11]);f[Ze+-3]=qe+Qe,f[Ze+-10]=(Je+$e)*Ye,f[Ze+-11]=($e-Je)*Ye,qe=f[Ze+-4],Je=(Qe=f[Ze+-12])-qe,f[Ze+-4]=qe+Qe,$e=(qe=f[Ze+-5])-(Qe=f[Ze+-13]),f[Ze+-5]=qe+Qe,f[Ze+-12]=$e,f[Ze+-13]=Je,qe=f[Ze+-6],Je=(Qe=f[Ze+-14])-qe,f[Ze+-6]=qe+Qe,$e=(qe=f[Ze+-7])-(Qe=f[Ze+-15]),f[Ze+-7]=qe+Qe,f[Ze+-14]=(Je+$e)*Ye,f[Ze+-15]=(Je-$e)*Ye;var ti=f[Ze],ei=f[Ze+-4],ii=ti-ei,ni=ti+ei,ri=(ti=f[Ze+-2])+(ei=f[Ze+-6]),si=ti-ei;f[Ze]=ni+ri,f[Ze+-2]=ni-ri;var ai=f[Ze+-3]-f[Ze+-7];f[Ze+-4]=ii+ai,f[Ze+-6]=ii-ai;var oi=(ti=f[Ze+-1])-(ei=f[Ze+-5]),li=ti+ei,ui=f[Ze+-3]+f[Ze+-7];f[Ze+-1]=li+ui,f[Ze+-3]=li-ui,f[Ze+-5]=oi-si,f[Ze+-7]=oi+si;var hi=Ze-8,ci=f[hi],di=f[hi-4],_i=ci-di,fi=ci+di,pi=(ci=f[hi-2])+(di=f[hi-6]),gi=ci-di;f[hi]=fi+pi,f[hi-2]=fi-pi;var mi=f[hi-3]-f[hi-7];f[hi-4]=_i+mi,f[hi-6]=_i-mi;var vi=(ci=f[hi-1])-(di=f[hi-5]),bi=ci+di,wi=f[hi-3]+f[hi-7];f[hi-1]=bi+wi,f[hi-3]=bi-wi,f[hi-5]=vi-gi,f[hi-7]=vi+gi,Ze-=16}for(var yi=0,xi=o-4,Ti=a-4;0<=xi;){var Si=s[yi];p[Ti+3]=f[Si],p[Ti+2]=f[Si+1],p[xi+3]=f[Si+2],p[xi+2]=f[Si+3],Si=s[yi+1],p[Ti+1]=f[Si],p[Ti]=f[Si+1],p[xi+1]=f[Si+2],p[xi]=f[Si+3],xi-=4,Ti-=4,yi+=2}for(var ki=0,Ii=0,Ei=a-4;Ii<Ei;){var Ci=p[Ii]-p[Ei+2],Bi=p[Ii+1]+p[Ei+3],Ni=r[ki+1]*Ci+r[ki]*Bi,Li=r[ki+1]*Bi-r[ki]*Ci,Fi=p[Ii]+p[Ei+2],Ai=p[Ii+1]-p[Ei+3];p[Ii]=Fi+Ni,p[Ii+1]=Ai+Li,p[Ei+2]=Fi-Ni,p[Ei+3]=Li-Ai,Ci=p[Ii+2]-p[Ei],Bi=p[Ii+3]+p[Ei+1],Ni=r[ki+3]*Ci+r[ki+2]*Bi,Li=r[ki+3]*Bi-r[ki+2]*Ci,Fi=p[Ii+2]+p[Ei],Ai=p[Ii+3]-p[Ei+1],p[Ii+2]=Fi+Ni,p[Ii+3]=Ai+Li,p[Ei]=Fi-Ni,p[Ei+1]=Li-Ai,ki+=4,Ii+=4,Ei-=4}for(var Mi=a-8,Oi=a-8,Pi=0,Ri=a-4,Vi=a,Di=e-4;0<=Oi;){var Ui=u[Oi+6]*n[Mi+7]-u[Oi+7]*n[Mi+6],Hi=-u[Oi+6]*n[Mi+6]-u[Oi+7]*n[Mi+7];t[Pi]=Ui,t[Ri+3]=-Ui,t[Vi]=Hi,t[Di+3]=Hi;var Wi=u[Oi+4]*n[Mi+5]-u[Oi+5]*n[Mi+4],Gi=-u[Oi+4]*n[Mi+4]-u[Oi+5]*n[Mi+5];t[Pi+1]=Wi,t[Ri+2]=-Wi,t[Vi+1]=Gi,t[Di+2]=Gi,Ui=u[Oi+2]*n[Mi+3]-u[Oi+3]*n[Mi+2],Hi=-u[Oi+2]*n[Mi+2]-u[Oi+3]*n[Mi+3],t[Pi+2]=Ui,t[Ri+1]=-Ui,t[Vi+2]=Hi,t[Di+1]=Hi,Wi=u[Oi]*n[Mi+1]-u[Oi+1]*n[Mi],Gi=-u[Oi]*n[Mi]-u[Oi+1]*n[Mi+1],t[Pi+3]=Wi,t[Ri]=-Wi,t[Vi+3]=Gi,t[Di]=Gi,Mi-=8,Oi-=8,Pi+=4,Vi+=4,Ri-=4,Di-=4}},yt.step3Iter0Loop=function(t,e,i,n,r){for(var s=i,a=i+n,o=0,l=1+(t>>2);0<--l;){var u=e[s]-e[a],h=e[s+-1]-e[a+-1];e[s]=e[s]+e[a];var c=s+-1;e[c]=e[c]+e[a+-1],e[a]=u*r[o]-h*r[o+1],e[a+-1]=h*r[o]+u*r[o+1],o+=8,u=e[s+-2]-e[a+-2],h=e[s+-3]-e[a+-3];var d=s+-2;e[d]=e[d]+e[a+-2];var _=s+-3;e[_]=e[_]+e[a+-3],e[a+-2]=u*r[o]-h*r[o+1],e[a+-3]=h*r[o]+u*r[o+1],o+=8,u=e[s+-4]-e[a+-4],h=e[s+-5]-e[a+-5];var f=s+-4;e[f]=e[f]+e[a+-4];var p=s+-5;e[p]=e[p]+e[a+-5],e[a+-4]=u*r[o]-h*r[o+1],e[a+-5]=h*r[o]+u*r[o+1],o+=8,u=e[s+-6]-e[a+-6],h=e[s+-7]-e[a+-7];var g=s+-6;e[g]=e[g]+e[a+-6];var m=s+-7;e[m]=e[m]+e[a+-7],e[a+-6]=u*r[o]-h*r[o+1],e[a+-7]=h*r[o]+u*r[o+1],o+=8,s-=8,a-=8}},yt.step3InnerRLoop=function(t,e,i,n,r,s){for(var a=0,o=i,l=i+n,u=1+(t>>2);0<--u;){var h=e[o]-e[l],c=e[o+-1]-e[l+-1];e[o]=e[o]+e[l];var d=o+-1;e[d]=e[d]+e[l+-1],e[l]=h*r[a]-c*r[a+1],e[l+-1]=c*r[a]+h*r[a+1],a+=s,h=e[o+-2]-e[l+-2],c=e[o+-3]-e[l+-3];var _=o+-2;e[_]=e[_]+e[l+-2];var f=o+-3;e[f]=e[f]+e[l+-3],e[l+-2]=h*r[a]-c*r[a+1],e[l+-3]=c*r[a]+h*r[a+1],a+=s,h=e[o+-4]-e[l+-4],c=e[o+-5]-e[l+-5];var p=o+-4;e[p]=e[p]+e[l+-4];var g=o+-5;e[g]=e[g]+e[l+-5],e[l+-4]=h*r[a]-c*r[a+1],e[l+-5]=c*r[a]+h*r[a+1],a+=s,h=e[o+-6]-e[l+-6],c=e[o+-7]-e[l+-7];var m=o+-6;e[m]=e[m]+e[l+-6];var v=o+-7;e[v]=e[v]+e[l+-7],e[l+-6]=h*r[a]-c*r[a+1],e[l+-7]=c*r[a]+h*r[a+1],o-=8,l-=8,a+=s}},yt.step3InnerSLoop=function(t,e,i,n,r,s,a,o){for(var l=r[s],u=r[s+1],h=r[s+a],c=r[s+a+1],d=r[s+2*a],_=r[s+2*a+1],f=r[s+3*a],p=r[s+3*a+1],g=i,m=i+n,v=t+1;0<--v;){var b=e[g]-e[m],w=e[g+-1]-e[m+-1];e[g]=e[g]+e[m],e[g+-1]=e[g+-1]+e[m+-1],e[m]=b*l-w*u,e[m+-1]=w*l+b*u,b=e[g+-2]-e[m+-2],w=e[g+-3]-e[m+-3],e[g+-2]=e[g+-2]+e[m+-2],e[g+-3]=e[g+-3]+e[m+-3],e[m+-2]=b*h-w*c,e[m+-3]=w*h+b*c,b=e[g+-4]-e[m+-4],w=e[g+-5]-e[m+-5],e[g+-4]=e[g+-4]+e[m+-4],e[g+-5]=e[g+-5]+e[m+-5],e[m+-4]=b*d-w*_,e[m+-5]=w*d+b*_,b=e[g+-6]-e[m+-6],w=e[g+-7]-e[m+-7],e[g+-6]=e[g+-6]+e[m+-6],e[g+-7]=e[g+-7]+e[m+-7],e[m+-6]=b*f-w*p,e[m+-7]=w*f+b*p,g-=o,m-=o}},yt.iter54=function(t,e){var i=t[e],n=t[e+-4],r=i-n,s=i+n,a=(i=t[e+-2])+(n=t[e+-6]),o=i-n;t[e]=s+a,t[e+-2]=s-a;var l=t[e+-3]-t[e+-7];t[e+-4]=r+l,t[e+-6]=r-l;var u=(i=t[e+-1])-(n=t[e+-5]),h=i+n,c=t[e+-3]+t[e+-7];t[e+-1]=h+c,t[e+-3]=h-c,t[e+-5]=u-o,t[e+-7]=u+o},yt.step3InnerSLoopLd654=function(t,e,i,n,r){for(var s=n[r>>3],a=i,o=i-16*t;o<a;){var l=e[a],u=e[a+-8];e[a+-8]=l-u,e[a]=l+u,l=e[a+-1],u=e[a+-9],e[a+-9]=l-u,e[a+-1]=l+u;var h=(l=e[a+-2])-(u=e[a+-10]);e[a+-2]=l+u;var c=(l=e[a+-3])-(u=e[a+-11]);e[a+-3]=l+u,e[a+-10]=(h+c)*s,e[a+-11]=(c-h)*s,l=e[a+-4],h=(u=e[a+-12])-l,e[a+-4]=l+u,c=(l=e[a+-5])-(u=e[a+-13]),e[a+-5]=l+u,e[a+-12]=c,e[a+-13]=h,l=e[a+-6],h=(u=e[a+-14])-l,e[a+-6]=l+u,c=(l=e[a+-7])-(u=e[a+-15]),e[a+-7]=l+u,e[a+-14]=(h+c)*s,e[a+-15]=(h-c)*s;var d=e[a],_=e[a+-4],f=d-_,p=d+_,g=(d=e[a+-2])+(_=e[a+-6]),m=d-_;e[a]=p+g,e[a+-2]=p-g;var v=e[a+-3]-e[a+-7];e[a+-4]=f+v,e[a+-6]=f-v;var b=(d=e[a+-1])-(_=e[a+-5]),w=d+_,y=e[a+-3]+e[a+-7];e[a+-1]=w+y,e[a+-3]=w-y,e[a+-5]=b-m,e[a+-7]=b+m;var x=a-8,T=e[x],S=e[x-4],k=T-S,I=T+S,E=(T=e[x-2])+(S=e[x-6]),C=T-S;e[x]=I+E,e[x-2]=I-E;var B=e[x-3]-e[x-7];e[x-4]=k+B,e[x-6]=k-B;var N=(T=e[x-1])-(S=e[x-5]),L=T+S,F=e[x-3]+e[x-7];e[x-1]=L+F,e[x-3]=L-F,e[x-5]=N-C,e[x-7]=N+C,a-=16}};var xt=function(t,e,i){this.seekFunc=e,this.inputLength=i,this.decoder=kt.start(t),this.decoder.setupSampleNumber(e,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(T["kha.audio2.ogg.vorbis.Reader"]=xt).__name__=!0,xt.openFromBytes=function(t){var e=new ct(t),i=e;return new xt(e,function(t){xt.seekBytes(i,t)},t.length)},xt.seekBytes=function(t,e){t.set_position(e)},xt.readAll=function(t,e,i){null==i&&(i=!1);var n=new ct(t),r=kt.start(n),s=n;r.setupSampleNumber(function(t){xt.seekBytes(s,t)},t.length);for(var a=r.header,o=new Float32Array(4096*a.channel);;){for(var l=r.read(o,4096,a.channel,a.sampleRate,i),u=0,h=l*a.channel;u<h;){var c=u++;e.writeFloat(o[c])}if(0==l)break;0}return r.header},xt.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var t=this.decoder.totalSample,e=this.get_header().sampleRate;return Ot.toFloat(t)/Ot.toFloat(e)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return Ot.toFloat(t)/Ot.toFloat(e)*1e3},set_currentMillisecond:function(t){return this.set_currentSample(Math.floor(Ot.toFloat(this.get_header().sampleRate)*(t/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,i,n,r){return null==r&&(r=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==n&&(n=this.get_header().sampleRate),this.decoder.read(t,e,i,n,r)},clone:function(){var t=Object.create(xt.prototype);return t.seekFunc=this.seekFunc,t.inputLength=this.inputLength,t.decoder=this.decoder.clone(this.seekFunc),t.loopStart=this.loopStart,t.loopLength=this.loopLength,t},sampleToMillisecond:function(t){var e=this.get_header().sampleRate;return Ot.toFloat(t)/Ot.toFloat(e)*1e3},millisecondToSample:function(t){return Math.floor(Ot.toFloat(this.get_header().sampleRate)*(t/1e3))},__class__:xt,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_totalMillisecond:"get_totalMillisecond",get_totalSample:"get_totalSample",get_header:"get_header"}};function Tt(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Vt,bt.init()}(T["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Tt).__name__=!0,Tt.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var n=new Array(i),r=0,s=i;r<s;){n[r++]=this.input.readByte()}if(this.segments=n,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=t),--a;if(this.firstDecode){for(var o=0,l=new Ut,u=0,h=i;u<h;){var c=u++;o+=this.segments[c]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(Tt.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof ge?t.val:t;if(e instanceof Xt)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new ge(new Xt(Kt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new ge(new Xt(Kt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,i=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var n=t instanceof ge?t.val:t;if(!(n instanceof v))throw t;i=!0,e=0}if(i)return!1;if(!!(!!(79!=e||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ge(new Xt(Kt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(24<t)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var i=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var t;return t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,t},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){var t,e,i,n,r,s,a=new ht(new ArrayBuffer(6));if(t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[0]=t,e=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[1]=e,i=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[2]=i,n=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[3]=n,r=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[4]=r,s=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[5]=s,"vorbis"!=a.toString())throw new ge(new Xt(Kt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){if(this.inputPosition+=1,!!(!!(79!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ge(new Xt(Kt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(t){this.validBits<10&&this.prepHuffman();var e,i=t.fastHuffman[1023&this.acc];if(0<=i){var n=t.codewordLengths[i];this.acc=this.acc>>>n,this.validBits-=n,e=this.validBits<0?(this.validBits=0,-1):i}else e=this.decodeScalarRaw(t);return t.sparse&&(e=t.sortedValues[e]),e},decodeRaw:function(t){this.validBits<10&&this.prepHuffman();var e=t.fastHuffman[1023&this.acc];if(0<=e){var i=t.codewordLengths[e];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):e}return this.decodeScalarRaw(t)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(t,e,i){var n=i.left.start,r=!1,s=e>>1;if(this.firstDecode)this.currentLoc=-s,this.discardSamplesDeferred=e-i.right.end,r=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,n=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(r&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(e-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:n,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(s-i.left.start),r=!0}return r&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:n,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}return e},readBytes:function(t){return this.inputPosition+=t,this.input.read(t)},readString:function(t){return this.inputPosition+=t,this.input.readString(t)},getSampleNumber:function(t,e){var i=this.inputPosition,n=Ot.gte(e,65536)&&Ot.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=n);var r=0,s=!1,a=this.findPage(t,e);switch(a._hx_index){case 0:var o=a.last;r=a.end,s=o;break;case 1:throw new ge(new Xt(Kt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!s;){t(this.inputPosition=r);var u=this.findPage(t,e);switch(u._hx_index){case 0:var h=u.last;r=u.end,s=h;break;case 1:break t}n=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var c=new Array(6),d=0;d<6;){c[d++]=this.input.readByte()}this.inputPosition+=4;var _=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==_&&-1==f||0<f)throw new ge(new Xt(Kt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Ut,this.pLast.pageStart=l,this.pLast.pageEnd=r,this.pLast.lastDecodedSample=_,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=n,t(this.inputPosition=i),_},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(t,e){t(this.inputPosition=e)},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i=this.inputPosition;if(e<i-25)return St.NotFound;if(this.inputPosition+=1,!!(103!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))continue;var n=new Array(27);if(n[0]=79,n[1]=103,n[2]=103,n[3]=83,this.inputPosition+=1,n[4]=this.input.readByte(),this.inputPosition+=1,n[5]=this.input.readByte(),this.inputPosition+=1,n[6]=this.input.readByte(),this.inputPosition+=1,n[7]=this.input.readByte(),this.inputPosition+=1,n[8]=this.input.readByte(),this.inputPosition+=1,n[9]=this.input.readByte(),this.inputPosition+=1,n[10]=this.input.readByte(),this.inputPosition+=1,n[11]=this.input.readByte(),this.inputPosition+=1,n[12]=this.input.readByte(),this.inputPosition+=1,n[13]=this.input.readByte(),this.inputPosition+=1,n[14]=this.input.readByte(),this.inputPosition+=1,n[15]=this.input.readByte(),this.inputPosition+=1,n[16]=this.input.readByte(),this.inputPosition+=1,n[17]=this.input.readByte(),this.inputPosition+=1,n[18]=this.input.readByte(),this.inputPosition+=1,n[19]=this.input.readByte(),this.inputPosition+=1,n[20]=this.input.readByte(),this.inputPosition+=1,n[21]=this.input.readByte(),this.inputPosition+=1,n[22]=this.input.readByte(),this.inputPosition+=1,n[23]=this.input.readByte(),this.inputPosition+=1,n[24]=this.input.readByte(),this.inputPosition+=1,n[25]=this.input.readByte(),this.inputPosition+=1,n[26]=this.input.readByte(),0!=n[4]){t(this.inputPosition=i);continue}var r=n[22]+(n[23]<<8)+(n[24]<<16)+(n[25]<<24);n[22]=0,n[23]=0,n[24]=0;for(var s=n[25]=0,a=0;a<27;){var o=a++;s=s<<8^bt.table[n[o]^s>>>24]}var l=0;try{for(var u=0,h=n[26];u<h;){u++;this.inputPosition+=1;var c=this.input.readByte();s=s<<8^bt.table[c^s>>>24],l+=c}for(var d=0,_=l;d<_;){d++;this.inputPosition+=1;var f=this.input.readByte();s=s<<8^bt.table[f^s>>>24]}}catch(t){var p=t instanceof ge?t.val:t;if(p instanceof v){return St.NotFound}throw t}if(s==r){var g=this.inputPosition;return t(this.inputPosition=i-1),St.Found(g,0!=(4&n[5]))}}}}catch(t){var m=t instanceof ge?t.val:t;if(m instanceof v){return St.NotFound}throw t}},analyzePage:function(t,e){var i=new Ut,n=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var r=new Array(27),s=0;s<27;){r[s++]=this.input.readByte()}var a=r,o=a[26];this.inputPosition+=o;for(var l=new Array(o),u=0,h=o;u<h;){l[u++]=this.input.readByte()}for(var c=l,d=0,_=0,f=a[26];_<f;){d+=c[_++]}if(i.pageEnd=i.pageStart+27+a[26]+d,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,t(this.inputPosition=i.pageStart),i;for(var p=0,g=0==(1&a[5]),m=e.modes.length,v=0,b=a[26];v<b;){var w=v++;if(g){if(0==c[w])return t(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var y=this.input.readByte();if(0!=(1&y))return t(this.inputPosition=i.pageStart),null;y>>=1;var x=m-1,T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(m<=(y&=(1<<(x<16384?x<16?T[x]:x<512?5+T[x>>5]:10+T[x>>10]:x<16777216?x<524288?15+T[x>>15]:20+T[x>>20]:x<536870912?25+T[x>>25]:x<-2147483648?30+T[x>>30]:0))-1))return t(this.inputPosition=i.pageStart),null;n[p++]=e.modes[y].blockflag;var S=c[w]-1;this.inputPosition+=S;for(var k=new Array(S),I=0,E=S;I<E;){k[I++]=this.input.readByte()}}else{var C=c[w];this.inputPosition+=C;for(var B=new Array(C),N=0,L=C;N<L;){B[N++]=this.input.readByte()}}g=c[w]<255}var F=0;1<p&&(F+=n[p-1]?e.blocksize1:e.blocksize0);for(var A=p-2;1<=A;)n[--A]?n[A+1]?F+=e.blocksize1>>1:F+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):F+=e.blocksize0>>1,--A;return i.firstDecodedSample=i.lastDecodedSample-F,t(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,i=t.codewords,n=t.sortedCodewords;if(8<t.entries?null!=n:null!=i){for(var r=this.acc,s=(r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16,a=0,o=t.sortedEntries;1<o;){var l=a+(o>>1);Ot.gte(s,n[l])?(a=l,o-=o>>1):o>>=1}t.sparse||(a=t.sortedValues[a]);var u=e[a];return this.validBits>=u?(this.acc=this.acc>>>u,this.validBits-=u,a):(this.validBits=0,-1)}for(var h=0,c=t.entries;h<c;){var d=h++,_=e[d];if(255!=_&&i[d]==(this.acc&(1<<_)-1))return this.validBits>=_?(this.acc=this.acc>>>_,this.validBits-=_,d):(this.validBits=0,-1)}return this.error=new Xt(Kt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Tt};var St=p["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:((e=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}}).__params__=["end","last"],e),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}},kt=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(t.channel);this.channelBuffers=i;var n=new Array(t.channel);this.previousWindow=n;var r=new Array(t.channel);this.finalY=r;for(var s=0,a=t.channel;s<a;){var o=s++,l=this.channelBuffers,u=new Array(t.blocksize1);l[o]=u;var h=this.previousWindow,c=new Array(t.blocksize1/2|0);h[o]=c,this.finalY[o]=[]}var d=new Array(2);this.a=d;var _=new Array(2);this.b=_;var f=new Array(2);this.c=f;var p=new Array(2);this.window=p;var g=new Array(2);this.bitReverseData=g,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};(T["kha.audio2.ogg.vorbis.VorbisDecoder"]=kt).__name__=!0,kt.start=function(t){var e=new Tt(t),i=Ft.read(e),n=new kt(i,e);return e.startFirstDecode(),n.pumpFirstFrame(),n},kt.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,i,n,r){var s=this.header.sampleRate;if(0!=(Ot.toFloat(n)%Ot.toFloat(s)|0)){var a=this.header.sampleRate;throw new ge("Unsupported sampleRate : can't convert "+ae.string(null==a?null:Ot.toFloat(a))+" to "+n)}if(i%this.header.channel!=0)throw new ge("Unsupported channels : can't convert "+this.header.channel+" to "+i);var o=this.header.sampleRate,l=Ot.toFloat(n)/Ot.toFloat(o)|0,u=i/this.header.channel|0,h=0,c=Math.floor(e/l);null!=this.totalSample&&c>this.totalSample-this.currentSample&&(c=this.totalSample-this.currentSample);for(var d=0;h<c;){var _=this.channelBufferEnd-this.channelBufferStart;c-h<=_&&(_=c-h);for(var f=this.channelBufferStart,p=this.channelBufferStart+_;f<p;)for(var g=f++,m=0,v=l;m<v;){m++;for(var b=0,w=this.header.channel;b<w;)for(var y=b++,x=0,T=u;x<T;){x++;var S=this.channelBuffers[y][g];1<S?S=1:S<-1&&(S=-1),r&&(t[d]=S,++d)}}if(h+=_,this.channelBufferStart+=_,h==c||0==this.getFrameFloat())break}for(var k=h,I=c;k<I;){k++;for(var E=0,C=l;E<C;){E++;for(var B=0,N=this.header.channel;B<N;){B++;for(var L=0,F=u;L<F;){L++;r&&(t[d]=0,++d)}}}}return this.currentSample+=c,c*l},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var i=this.channelBufferEnd-this.channelBufferStart;if(t-e<=i&&(i=t-e),e+=i,this.channelBufferStart+=i,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new ge(new Xt(Kt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var n=this.decodeState.pFirst,r=this.decodeState.pLast;if(i>=r.lastDecodedSample&&(i=r.lastDecodedSample-1),i<n.lastDecodedSample)this.seekFrameFromPage(t,n.pageStart,0,i);else{for(var s=0;n.pageEnd<r.pageStart;){var a=n.pageEnd,o=r.afterPreviousPageStart,l=n.lastDecodedSample,u=r.lastDecodedSample;if(null==l||null==u)throw new ge(new Xt(Kt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));Ot.gt(o,a+4e3)&&(o-=4e3);var h=a+Math.floor(Ot.toFloat(o-a)/Ot.toFloat(u-l)*(i-l));if(4<=s){var c=a+(o-a>>>1);h=8<=s?c:Ot.gt(c,h)?h+(c-h>>>1):c+(h-c>>>1)}++s,t(this.decodeState.inputPosition=h);var d=this.decodeState.findPage(t,e);switch(d._hx_index){case 0:d.last,d.end;break;case 1:throw new ge(new Xt(Kt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var _=this.decodeState.analyzePage(t,this.header);if(null==_)throw new ge(new Xt(Kt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));_.afterPreviousPageStart=h,_.pageStart!=r.pageStart?i<_.lastDecodedSample?r=_:n=_:r=_}if(!(n.lastDecodedSample<=i&&i<r.lastDecodedSample))throw new ge(new Xt(Kt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,r.pageStart,n.lastDecodedSample,i)}}},seekFrameFromPage:function(t,e,i,n){var r=0,s=i;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,u=null;;){l=u,u=this.decodeState.clone(t);var h=this.decodeInitial();if(null==h){u=l;break}o=h.left.start,a=h.left.end;var c=0==r?a:o;if(n<s+h.right.start-c)break;for(var d=this.decodeState;0!=d.bytesInSeg||!d.lastSeg&&0!=d.next();)d.bytesInSeg--,d.inputPosition+=1,d.input.readByte();s+=h.right.start-c,++r}this.decodeState=u,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=s,this.skipSamples(n-s)},clone:function(t){var e=Object.create(kt.prototype);e.currentSample=this.currentSample,e.totalSample=this.totalSample,e.previousLength=this.previousLength,e.channelBufferStart=this.channelBufferStart,e.channelBufferEnd=this.channelBufferEnd,e.a=this.a,e.b=this.b,e.c=this.c,e.window=this.window,e.bitReverseData=this.bitReverseData,e.header=this.header,e.decodeState=this.decodeState.clone(t);var i=new Array(this.header.channel);e.channelBuffers=i;var n=new Array(this.header.channel);e.previousWindow=n;var r=new Array(this.header.channel);e.finalY=r;for(var s=0,a=this.header.channel;s<a;){var o=s++;e.channelBuffers[o]=It.copyVector(this.channelBuffers[o]),e.previousWindow[o]=It.copyVector(this.previousWindow[o]),e.finalY[o]=l.array(this.finalY[o])}return e},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,i=t.right,n=t.left;if(0!=this.previousLength)for(var r=this.previousLength,s=this.getWindow(r),a=0,o=this.header.channel;a<o;)for(var l=a++,u=this.channelBuffers[l],h=this.previousWindow[l],c=0,d=r;c<d;){var _=c++;u[n+_]=u[n+_]*s[_]+h[_]*s[r-1-_]}var f=this.previousLength;this.previousLength=e-i;for(var p=0,g=this.header.channel;p<g;)for(var m=p++,v=this.previousWindow[m],b=this.channelBuffers[m],w=0,y=e-i;w<y;){var x=w++;v[x]=b[i+x]}return 0==f?0:(e<i&&(i=e),i-n)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var i=e>>1,n=e>>2,r=e>>3,s=this.a,a=new Array(i);s[t]=a;var o=this.b,l=new Array(i);o[t]=l;var u=this.c,h=new Array(n);u[t]=h;var c=this.window,d=new Array(i);c[t]=d;var _=this.bitReverseData,f=new Array(r);_[t]=f,It.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),It.computeWindow(e,this.window[t]),It.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,i){for(var n=i?1:0,r=this.a[n],s=this.b[n],a=this.c[n],o=this.bitReverseData[n],l=e>>1,u=e>>2,h=e>>3,c=new Array(l),d=l-2,_=0,f=0,p=l;f!=p;)c[d+1]=t[f]*r[_]-t[f+2]*r[_+1],c[d]=t[f]*r[_+1]+t[f+2]*r[_],d-=2,_+=2,f+=4;for(f=l-3;0<=d;)c[d+1]=-t[f+2]*r[_]- -t[f]*r[_+1],c[d]=-t[f+2]*r[_+1]+-t[f]*r[_],d-=2,_+=2,f-=4;for(var g=t,m=c,v=l-8,b=u,w=0,y=u,x=0;0<=v;){var T=m[b+1]-m[w+1],S=m[b]-m[w];g[y+1]=m[b+1]+m[w+1],g[y]=m[b]+m[w],g[x+1]=T*r[v+4]-S*r[v+5],g[x]=S*r[v+4]+T*r[v+5],T=m[b+3]-m[w+3],S=m[b+2]-m[w+2],g[y+3]=m[b+3]+m[w+3],g[y+2]=m[b+2]+m[w+2],g[x+3]=T*r[v]-S*r[v+1],g[x+2]=S*r[v]+T*r[v+1],v-=8,y+=4,x+=4,b+=4,w+=4}for(var k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],I=(e<16384?e<16?k[e]:e<512?5+k[e>>5]:10+k[e>>10]:e<16777216?e<524288?15+k[e>>15]:20+k[e>>20]:e<536870912?25+k[e>>25]:e<-2147483648?30+k[e>>30]:0)-1,E=l-1-0*u,C=E,B=E-(e>>3),N=0,L=1+(e>>4>>2);0<--L;){var F=g[C]-g[B],A=g[C+-1]-g[B+-1];g[C]=g[C]+g[B];var M=C+-1;g[M]=g[M]+g[B+-1],g[B]=F*r[N]-A*r[N+1],g[B+-1]=A*r[N]+F*r[N+1],N+=8,F=g[C+-2]-g[B+-2],A=g[C+-3]-g[B+-3];var O=C+-2;g[O]=g[O]+g[B+-2];var P=C+-3;g[P]=g[P]+g[B+-3],g[B+-2]=F*r[N]-A*r[N+1],g[B+-3]=A*r[N]+F*r[N+1],N+=8,F=g[C+-4]-g[B+-4],A=g[C+-5]-g[B+-5];var R=C+-4;g[R]=g[R]+g[B+-4];var V=C+-5;g[V]=g[V]+g[B+-5],g[B+-4]=F*r[N]-A*r[N+1],g[B+-5]=A*r[N]+F*r[N+1],N+=8,F=g[C+-6]-g[B+-6],A=g[C+-7]-g[B+-7];var D=C+-6;g[D]=g[D]+g[B+-6];var U=C+-7;g[U]=g[U]+g[B+-7],g[B+-6]=F*r[N]-A*r[N+1],g[B+-7]=A*r[N]+F*r[N+1],N+=8,C-=8,B-=8}for(var H=l-1-u,W=H,G=H-(e>>3),z=0,X=1+(e>>4>>2);0<--X;){var K=g[W]-g[G],Y=g[W+-1]-g[G+-1];g[W]=g[W]+g[G];var Z=W+-1;g[Z]=g[Z]+g[G+-1],g[G]=K*r[z]-Y*r[z+1],g[G+-1]=Y*r[z]+K*r[z+1],z+=8,K=g[W+-2]-g[G+-2],Y=g[W+-3]-g[G+-3];var j=W+-2;g[j]=g[j]+g[G+-2];var q=W+-3;g[q]=g[q]+g[G+-3],g[G+-2]=K*r[z]-Y*r[z+1],g[G+-3]=Y*r[z]+K*r[z+1],z+=8,K=g[W+-4]-g[G+-4],Y=g[W+-5]-g[G+-5];var Q=W+-4;g[Q]=g[Q]+g[G+-4];var J=W+-5;g[J]=g[J]+g[G+-5],g[G+-4]=K*r[z]-Y*r[z+1],g[G+-5]=Y*r[z]+K*r[z+1],z+=8,K=g[W+-6]-g[G+-6],Y=g[W+-7]-g[G+-7];var $=W+-6;g[$]=g[$]+g[G+-6];var tt=W+-7;g[tt]=g[tt]+g[G+-7],g[G+-6]=K*r[z]-Y*r[z+1],g[G+-7]=Y*r[z]+K*r[z+1],z+=8,W-=8,G-=8}for(var et=l-1-0*h,it=0,nt=et,rt=et-(e>>4),st=1+(e>>5>>2);0<--st;){var at=g[nt]-g[rt],ot=g[nt+-1]-g[rt+-1];g[nt]=g[nt]+g[rt];var lt=nt+-1;g[lt]=g[lt]+g[rt+-1],g[rt]=at*r[it]-ot*r[it+1],g[rt+-1]=ot*r[it]+at*r[it+1],it+=16,at=g[nt+-2]-g[rt+-2],ot=g[nt+-3]-g[rt+-3];var ut=nt+-2;g[ut]=g[ut]+g[rt+-2];var ht=nt+-3;g[ht]=g[ht]+g[rt+-3],g[rt+-2]=at*r[it]-ot*r[it+1],g[rt+-3]=ot*r[it]+at*r[it+1],it+=16,at=g[nt+-4]-g[rt+-4],ot=g[nt+-5]-g[rt+-5];var ct=nt+-4;g[ct]=g[ct]+g[rt+-4];var dt=nt+-5;g[dt]=g[dt]+g[rt+-5],g[rt+-4]=at*r[it]-ot*r[it+1],g[rt+-5]=ot*r[it]+at*r[it+1],it+=16,at=g[nt+-6]-g[rt+-6],ot=g[nt+-7]-g[rt+-7];var _t=nt+-6;g[_t]=g[_t]+g[rt+-6];var ft=nt+-7;g[ft]=g[ft]+g[rt+-7],g[rt+-6]=at*r[it]-ot*r[it+1],g[rt+-7]=ot*r[it]+at*r[it+1],nt-=8,rt-=8,it+=16}for(var pt=l-1-h,gt=0,mt=pt,vt=pt-(e>>4),bt=1+(e>>5>>2);0<--bt;){var wt=g[mt]-g[vt],yt=g[mt+-1]-g[vt+-1];g[mt]=g[mt]+g[vt];var xt=mt+-1;g[xt]=g[xt]+g[vt+-1],g[vt]=wt*r[gt]-yt*r[gt+1],g[vt+-1]=yt*r[gt]+wt*r[gt+1],gt+=16,wt=g[mt+-2]-g[vt+-2],yt=g[mt+-3]-g[vt+-3];var Tt=mt+-2;g[Tt]=g[Tt]+g[vt+-2];var St=mt+-3;g[St]=g[St]+g[vt+-3],g[vt+-2]=wt*r[gt]-yt*r[gt+1],g[vt+-3]=yt*r[gt]+wt*r[gt+1],gt+=16,wt=g[mt+-4]-g[vt+-4],yt=g[mt+-5]-g[vt+-5];var kt=mt+-4;g[kt]=g[kt]+g[vt+-4];var It=mt+-5;g[It]=g[It]+g[vt+-5],g[vt+-4]=wt*r[gt]-yt*r[gt+1],g[vt+-5]=yt*r[gt]+wt*r[gt+1],gt+=16,wt=g[mt+-6]-g[vt+-6],yt=g[mt+-7]-g[vt+-7];var Et=mt+-6;g[Et]=g[Et]+g[vt+-6];var Ct=mt+-7;g[Ct]=g[Ct]+g[vt+-7],g[vt+-6]=wt*r[gt]-yt*r[gt+1],g[vt+-7]=yt*r[gt]+wt*r[gt+1],mt-=8,vt-=8,gt+=16}for(var Bt=l-1-2*h,Nt=0,Lt=Bt,Ft=Bt-(e>>4),At=1+(e>>5>>2);0<--At;){var Mt=g[Lt]-g[Ft],Ot=g[Lt+-1]-g[Ft+-1];g[Lt]=g[Lt]+g[Ft];var Pt=Lt+-1;g[Pt]=g[Pt]+g[Ft+-1],g[Ft]=Mt*r[Nt]-Ot*r[Nt+1],g[Ft+-1]=Ot*r[Nt]+Mt*r[Nt+1],Nt+=16,Mt=g[Lt+-2]-g[Ft+-2],Ot=g[Lt+-3]-g[Ft+-3];var Rt=Lt+-2;g[Rt]=g[Rt]+g[Ft+-2];var Vt=Lt+-3;g[Vt]=g[Vt]+g[Ft+-3],g[Ft+-2]=Mt*r[Nt]-Ot*r[Nt+1],g[Ft+-3]=Ot*r[Nt]+Mt*r[Nt+1],Nt+=16,Mt=g[Lt+-4]-g[Ft+-4],Ot=g[Lt+-5]-g[Ft+-5];var Dt=Lt+-4;g[Dt]=g[Dt]+g[Ft+-4];var Ut=Lt+-5;g[Ut]=g[Ut]+g[Ft+-5],g[Ft+-4]=Mt*r[Nt]-Ot*r[Nt+1],g[Ft+-5]=Ot*r[Nt]+Mt*r[Nt+1],Nt+=16,Mt=g[Lt+-6]-g[Ft+-6],Ot=g[Lt+-7]-g[Ft+-7];var Ht=Lt+-6;g[Ht]=g[Ht]+g[Ft+-6];var Wt=Lt+-7;g[Wt]=g[Wt]+g[Ft+-7],g[Ft+-6]=Mt*r[Nt]-Ot*r[Nt+1],g[Ft+-7]=Ot*r[Nt]+Mt*r[Nt+1],Lt-=8,Ft-=8,Nt+=16}for(var Gt=l-1-3*h,zt=0,Xt=Gt,Kt=Gt-(e>>4),Yt=1+(e>>5>>2);0<--Yt;){var Zt=g[Xt]-g[Kt],jt=g[Xt+-1]-g[Kt+-1];g[Xt]=g[Xt]+g[Kt];var qt=Xt+-1;g[qt]=g[qt]+g[Kt+-1],g[Kt]=Zt*r[zt]-jt*r[zt+1],g[Kt+-1]=jt*r[zt]+Zt*r[zt+1],zt+=16,Zt=g[Xt+-2]-g[Kt+-2],jt=g[Xt+-3]-g[Kt+-3];var Qt=Xt+-2;g[Qt]=g[Qt]+g[Kt+-2];var Jt=Xt+-3;g[Jt]=g[Jt]+g[Kt+-3],g[Kt+-2]=Zt*r[zt]-jt*r[zt+1],g[Kt+-3]=jt*r[zt]+Zt*r[zt+1],zt+=16,Zt=g[Xt+-4]-g[Kt+-4],jt=g[Xt+-5]-g[Kt+-5];var $t=Xt+-4;g[$t]=g[$t]+g[Kt+-4];var te=Xt+-5;g[te]=g[te]+g[Kt+-5],g[Kt+-4]=Zt*r[zt]-jt*r[zt+1],g[Kt+-5]=jt*r[zt]+Zt*r[zt+1],zt+=16,Zt=g[Xt+-6]-g[Kt+-6],jt=g[Xt+-7]-g[Kt+-7];var ee=Xt+-6;g[ee]=g[ee]+g[Kt+-6];var ie=Xt+-7;g[ie]=g[ie]+g[Kt+-7],g[Kt+-6]=Zt*r[zt]-jt*r[zt+1],g[Kt+-7]=jt*r[zt]+Zt*r[zt+1],Xt-=8,Kt-=8,zt+=16}for(var ne=2,re=I-3>>1;ne<re;)for(var se=ne++,ae=e>>2+se,oe=ae>>1,le=0,ue=1<<1+se;le<ue;)for(var he=l-1-ae*le++,ce=1<<3+se,de=0,_e=he,fe=he-oe,pe=1+(e>>4+se>>2);0<--pe;){var ge=g[_e]-g[fe],me=g[_e+-1]-g[fe+-1];g[_e]=g[_e]+g[fe];var ve=_e+-1;g[ve]=g[ve]+g[fe+-1],g[fe]=ge*r[de]-me*r[de+1],g[fe+-1]=me*r[de]+ge*r[de+1],de+=ce,ge=g[_e+-2]-g[fe+-2],me=g[_e+-3]-g[fe+-3];var be=_e+-2;g[be]=g[be]+g[fe+-2];var we=_e+-3;g[we]=g[we]+g[fe+-3],g[fe+-2]=ge*r[de]-me*r[de+1],g[fe+-3]=me*r[de]+ge*r[de+1],de+=ce,ge=g[_e+-4]-g[fe+-4],me=g[_e+-5]-g[fe+-5];var ye=_e+-4;g[ye]=g[ye]+g[fe+-4];var xe=_e+-5;g[xe]=g[xe]+g[fe+-5],g[fe+-4]=ge*r[de]-me*r[de+1],g[fe+-5]=me*r[de]+ge*r[de+1],de+=ce,ge=g[_e+-6]-g[fe+-6],me=g[_e+-7]-g[fe+-7];var Te=_e+-6;g[Te]=g[Te]+g[fe+-6];var Se=_e+-7;g[Se]=g[Se]+g[fe+-7],g[fe+-6]=ge*r[de]-me*r[de+1],g[fe+-7]=me*r[de]+ge*r[de+1],_e-=8,fe-=8,de+=ce}for(var ke=I-3>>1,Ie=I-6;ke<Ie;)for(var Ee=ke++,Ce=e>>2+Ee,Be=1<<3+Ee,Ne=Ce>>1,Le=1<<1+Ee,Fe=0,Ae=l-1,Me=1+(e>>6+Ee);0<--Me;){for(var Oe=r[Fe],Pe=r[Fe+1],Re=r[Fe+Be],Ve=r[Fe+Be+1],De=r[Fe+2*Be],Ue=r[Fe+2*Be+1],He=r[Fe+3*Be],We=r[Fe+3*Be+1],Ge=Ae,ze=Ae+-Ne,Xe=1+Le;0<--Xe;){var Ke=g[Ge]-g[ze],Ye=g[Ge+-1]-g[ze+-1];g[Ge]=g[Ge]+g[ze],g[Ge+-1]=g[Ge+-1]+g[ze+-1],g[ze]=Ke*Oe-Ye*Pe,g[ze+-1]=Ye*Oe+Ke*Pe,Ke=g[Ge+-2]-g[ze+-2],Ye=g[Ge+-3]-g[ze+-3],g[Ge+-2]=g[Ge+-2]+g[ze+-2],g[Ge+-3]=g[Ge+-3]+g[ze+-3],g[ze+-2]=Ke*Re-Ye*Ve,g[ze+-3]=Ye*Re+Ke*Ve,Ke=g[Ge+-4]-g[ze+-4],Ye=g[Ge+-5]-g[ze+-5],g[Ge+-4]=g[Ge+-4]+g[ze+-4],g[Ge+-5]=g[Ge+-5]+g[ze+-5],g[ze+-4]=Ke*De-Ye*Ue,g[ze+-5]=Ye*De+Ke*Ue,Ke=g[Ge+-6]-g[ze+-6],Ye=g[Ge+-7]-g[ze+-7],g[Ge+-6]=g[Ge+-6]+g[ze+-6],g[Ge+-7]=g[Ge+-7]+g[ze+-7],g[ze+-6]=Ke*He-Ye*We,g[ze+-7]=Ye*He+Ke*We,Ge-=Ce,ze-=Ce}Fe+=4*Be,Ae-=8}for(var Ze=l-1,je=r[e>>3],qe=Ze,Qe=Ze-16*(e>>5);Qe<qe;){var Je=g[qe],$e=g[qe+-8];g[qe+-8]=Je-$e,g[qe]=Je+$e,Je=g[qe+-1],$e=g[qe+-9],g[qe+-9]=Je-$e,g[qe+-1]=Je+$e;var ti=(Je=g[qe+-2])-($e=g[qe+-10]);g[qe+-2]=Je+$e;var ei=(Je=g[qe+-3])-($e=g[qe+-11]);g[qe+-3]=Je+$e,g[qe+-10]=(ti+ei)*je,g[qe+-11]=(ei-ti)*je,Je=g[qe+-4],ti=($e=g[qe+-12])-Je,g[qe+-4]=Je+$e,ei=(Je=g[qe+-5])-($e=g[qe+-13]),g[qe+-5]=Je+$e,g[qe+-12]=ei,g[qe+-13]=ti,Je=g[qe+-6],ti=($e=g[qe+-14])-Je,g[qe+-6]=Je+$e,ei=(Je=g[qe+-7])-($e=g[qe+-15]),g[qe+-7]=Je+$e,g[qe+-14]=(ti+ei)*je,g[qe+-15]=(ti-ei)*je;var ii=g[qe],ni=g[qe+-4],ri=ii-ni,si=ii+ni,ai=(ii=g[qe+-2])+(ni=g[qe+-6]),oi=ii-ni;g[qe]=si+ai,g[qe+-2]=si-ai;var li=g[qe+-3]-g[qe+-7];g[qe+-4]=ri+li,g[qe+-6]=ri-li;var ui=(ii=g[qe+-1])-(ni=g[qe+-5]),hi=ii+ni,ci=g[qe+-3]+g[qe+-7];g[qe+-1]=hi+ci,g[qe+-3]=hi-ci,g[qe+-5]=ui-oi,g[qe+-7]=ui+oi;var di=qe-8,_i=g[di],fi=g[di-4],pi=_i-fi,gi=_i+fi,mi=(_i=g[di-2])+(fi=g[di-6]),vi=_i-fi;g[di]=gi+mi,g[di-2]=gi-mi;var bi=g[di-3]-g[di-7];g[di-4]=pi+bi,g[di-6]=pi-bi;var wi=(_i=g[di-1])-(fi=g[di-5]),yi=_i+fi,xi=g[di-3]+g[di-7];g[di-1]=yi+xi,g[di-3]=yi-xi,g[di-5]=wi-vi,g[di-7]=wi+vi,qe-=16}for(var Ti=0,Si=u-4,ki=l-4;0<=Si;){var Ii=o[Ti];m[ki+3]=g[Ii],m[ki+2]=g[Ii+1],m[Si+3]=g[Ii+2],m[Si+2]=g[Ii+3],Ii=o[Ti+1],m[ki+1]=g[Ii],m[ki]=g[Ii+1],m[Si+1]=g[Ii+2],m[Si]=g[Ii+3],Si-=4,ki-=4,Ti+=2}for(var Ei=0,Ci=0,Bi=l-4;Ci<Bi;){var Ni=m[Ci]-m[Bi+2],Li=m[Ci+1]+m[Bi+3],Fi=a[Ei+1]*Ni+a[Ei]*Li,Ai=a[Ei+1]*Li-a[Ei]*Ni,Mi=m[Ci]+m[Bi+2],Oi=m[Ci+1]-m[Bi+3];m[Ci]=Mi+Fi,m[Ci+1]=Oi+Ai,m[Bi+2]=Mi-Fi,m[Bi+3]=Ai-Oi,Ni=m[Ci+2]-m[Bi],Li=m[Ci+3]+m[Bi+1],Fi=a[Ei+3]*Ni+a[Ei+2]*Li,Ai=a[Ei+3]*Li-a[Ei+2]*Ni,Mi=m[Ci+2]+m[Bi],Oi=m[Ci+3]-m[Bi+1],m[Ci+2]=Mi+Fi,m[Ci+3]=Oi+Ai,m[Bi]=Mi-Fi,m[Bi+1]=Ai-Oi,Ei+=4,Ci+=4,Bi-=4}for(var Pi=l-8,Ri=l-8,Vi=0,Di=l-4,Ui=l,Hi=e-4;0<=Ri;){var Wi=c[Ri+6]*s[Pi+7]-c[Ri+7]*s[Pi+6],Gi=-c[Ri+6]*s[Pi+6]-c[Ri+7]*s[Pi+7];t[Vi]=Wi,t[Di+3]=-Wi,t[Ui]=Gi,t[Hi+3]=Gi;var zi=c[Ri+4]*s[Pi+5]-c[Ri+5]*s[Pi+4],Xi=-c[Ri+4]*s[Pi+4]-c[Ri+5]*s[Pi+5];t[Vi+1]=zi,t[Di+2]=-zi,t[Ui+1]=Xi,t[Hi+2]=Xi,Wi=c[Ri+2]*s[Pi+3]-c[Ri+3]*s[Pi+2],Gi=-c[Ri+2]*s[Pi+2]-c[Ri+3]*s[Pi+3],t[Vi+2]=Wi,t[Di+1]=-Wi,t[Ui+2]=Gi,t[Hi+1]=Gi,zi=c[Ri]*s[Pi+1]-c[Ri+1]*s[Pi],Xi=-c[Ri]*s[Pi]-c[Ri+1]*s[Pi+1],t[Vi+3]=zi,t[Di]=-zi,t[Ui+3]=Xi,t[Hi]=Xi,Pi-=8,Ri-=8,Vi+=4,Ui+=4,Di-=4,Hi-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(t=0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,e.input.readByte()):-1,e.validBits=0,-1==t)break}}var i=this.header.modes.length-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],r=this.decodeState.readBits(i<16384?i<16?n[i]:i<512?5+n[i>>5]:10+n[i>>10]:i<16777216?i<524288?15+n[i>>15]:20+n[i>>20]:i<536870912?25+n[i>>25]:i<-2147483648?30+n[i>>30]:0);if(-1==r||r>=this.header.modes.length)throw new ge(new Xt(Kt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var s,a,o,l=this.header.modes[r];l.blockflag?(s=this.header.blocksize1,a=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(a=o=0,s=this.header.blocksize0);var u=s>>1;return{mode:r,left:l.blockflag&&0==a?{start:s-this.header.blocksize0>>2,end:s+this.header.blocksize0>>2}:{start:0,end:u},right:l.blockflag&&0==o?{start:3*s-this.header.blocksize0>>2,end:3*s+this.header.blocksize0>>2}:{start:u,end:s}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],i=new Array(256),n=new Array(256),r=e.blockflag?this.header.blocksize1:this.header.blocksize0,s=this.header.mapping[e.mapping],a=r>>1,o=[256,128,86,64],l=this.header.codebooks,u=0,h=this.header.channel;u<h;){var c=u++,d=s.chan[c].mux;i[c]=!1;var _=this.header.floorConfig[s.submapFloor[d]];if(0==_.type)throw new ge(new Xt(Kt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f=_.floor1;if(0!=this.decodeState.readBits(1)){var p=[],g=new Array(256),m=o[f.floor1Multiplier-1],v=2,b=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(p=this.finalY[c])[0]=this.decodeState.readBits((m<16384?m<16?b[m]:m<512?5+b[m>>5]:10+b[m>>10]:m<16777216?m<524288?15+b[m>>15]:20+b[m>>20]:m<536870912?25+b[m>>25]:m<-2147483648?30+b[m>>30]:0)-1);var w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];p[1]=this.decodeState.readBits((m<16384?m<16?w[m]:m<512?5+w[m>>5]:10+w[m>>10]:m<16777216?m<524288?15+w[m>>15]:20+w[m>>20]:m<536870912?25+w[m>>25]:m<-2147483648?30+w[m>>30]:0)-1);for(var y=0,x=f.partitions;y<x;){var T=y++,S=f.partitionClassList[T],k=f.classDimensions[S],I=f.classSubclasses[S],E=(1<<I)-1,C=0;if(0!=I){var B=l[f.classMasterbooks[S]],N=this.decodeState;N.validBits<10&&N.prepHuffman();var L,F=B.fastHuffman[1023&N.acc];if(0<=F){var A=B.codewordLengths[F];N.acc=N.acc>>>A,N.validBits-=A,L=N.validBits<0?(N.validBits=0,-1):F}else L=N.decodeScalarRaw(B);B.sparse&&(L=B.sortedValues[L]),C=L}for(var M=f.subclassBooks[S],O=0,P=k;O<P;){O++;var R=M[C&E];C>>=I;var V,D=v++;if(0<=R){var U=this.decodeState,H=l[R];U.validBits<10&&U.prepHuffman();var W,G=H.fastHuffman[1023&U.acc];if(0<=G){var z=H.codewordLengths[G];U.acc=U.acc>>>z,U.validBits-=z,W=U.validBits<0?(U.validBits=0,-1):G}else W=U.decodeScalarRaw(H);H.sparse&&(W=H.sortedValues[W]),V=W}else V=0;p[D]=V}}if(-1==this.decodeState.validBits){i[c]=!0;continue}g[0]=g[1]=!0;for(var X=f.neighbors,K=f.xlist,Y=2,Z=f.values;Y<Z;){var j=Y++,q=X[j][0],Q=X[j][1],J=K[q],$=p[q],tt=p[Q]-$,et=K[Q]-J,it=Math.abs(tt)*(K[j]-J)/et|0,nt=tt<0?$-it:$+it,rt=p[j],st=m-nt,at=st<nt?2*st:2*nt;0!=rt?(g[q]=g[Q]=!0,g[j]=!0,p[j]=at<=rt?nt<st?rt-nt+nt:nt-rt+st-1:0!=(1&rt)?nt-(rt+1>>1):nt+(rt>>1)):(g[j]=!1,p[j]=nt)}for(var ot=0,lt=f.values;ot<lt;){var ut=ot++;g[ut]||(p[ut]=-1)}}else i[c]=!0}for(var ht=0,ct=this.header.channel;ht<ct;){var dt=ht++;n[dt]=i[dt]}for(var _t=0,ft=s.couplingSteps;_t<ft;){var pt=_t++;i[s.chan[pt].magnitude]&&i[s.chan[pt].angle]||(i[s.chan[pt].magnitude]=i[s.chan[pt].angle]=!1)}for(var gt=0,mt=s.submaps;gt<mt;){for(var vt=gt++,bt=new Array(this.header.channel),wt=new Array(256),yt=0,xt=0,Tt=this.header.channel;xt<Tt;){var St=xt++;s.chan[St].mux==vt&&(i[St]?(wt[yt]=!0,bt[yt]=null):(wt[yt]=!1,bt[yt]=this.channelBuffers[St]),++yt)}var kt=s.submapResidue[vt];this.header.residueConfig[kt].decode(this.decodeState,this.header,bt,yt,a,wt,this.channelBuffers)}for(var It=s.couplingSteps,Et=r>>1;0<=--It;)for(var Ct=this.channelBuffers[s.chan[It].magnitude],Bt=this.channelBuffers[s.chan[It].angle],Nt=0,Lt=Et;Nt<Lt;){var Ft,At,Mt=Nt++;0<Ct[Mt]?0<Bt[Mt]?(At=Ct[Mt],Ft=Ct[Mt]-Bt[Mt]):(Ft=Ct[Mt],At=Ct[Mt]+Bt[Mt]):0<Bt[Mt]?(At=Ct[Mt],Ft=Ct[Mt]+Bt[Mt]):(Ft=Ct[Mt],At=Ct[Mt]-Bt[Mt]),Ct[Mt]=At,Bt[Mt]=Ft}for(var Ot=0,Pt=this.header.channel;Ot<Pt;){var Rt=Ot++;if(n[Rt])for(var Vt=0,Dt=Et;Vt<Dt;){var Ut=Vt++;this.channelBuffers[Rt][Ut]=0}else s.doFloor(this.header.floorConfig,Rt,r,this.channelBuffers[Rt],this.finalY[Rt],null)}for(var Ht=0,Wt=this.header.channel;Ht<Wt;){var Gt=Ht++;this.inverseMdct(this.channelBuffers[Gt],r,e.blockflag)}for(var zt=this.decodeState;0!=zt.bytesInSeg||!zt.lastSeg&&0!=zt.next();)zt.bytesInSeg--,zt.inputPosition+=1,zt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,r,t)},__class__:kt};var It=function(){};(T["kha.audio2.ogg.vorbis.VorbisTools"]=It).__name__=!0,It.assert=function(t,e){},It.neighbors=function(t,e){for(var i=-1,n=65536,r=0,s=0,a=0,o=e;a<o;){var l=a++;t[l]>i&&t[l]<t[e]&&(i=t[r=l]),t[l]<n&&t[l]>t[e]&&(n=t[s=l])}return{low:r,high:s}},It.floatUnpack=function(t){var e=Ot.toFloat(2097151&t),i=(2145386496&t)>>>21;return(0!=(-2147483648&t)?-e:e)*Math.pow(2,i-788)},It.bitReverse=function(t){return(t=(-16711936&(t=(-252645136&(t=(-858993460&(t=(-1431655766&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8)>>>16|t<<16},It.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},It.uintAsc=function(t,e){return Ot.gt(e,t)?-1:t==e?0:1},It.lookup1Values=function(t,e){var i=0|Math.exp(Math.log(t)/e);return(0|Math.pow(i+1,e))<=t&&++i,i},It.computeWindow=function(t,e){for(var i=t>>1,n=0,r=i;n<r;){var s=n++;e[s]=Math.sin(1.5707963267948966*It.square(Math.sin((.5+s)/i*.5*3.141592653589793)))}},It.square=function(t){return t*t},It.computeBitReverse=function(t,e){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=(t<16384?t<16?i[t]:t<512?5+i[t>>5]:10+i[t>>10]:t<16777216?t<524288?15+i[t>>15]:20+i[t>>20]:t<536870912?25+i[t>>25]:t<-2147483648?30+i[t>>30]:0)-1,r=0,s=t>>3;r<s;){var a=r++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[a]=(o>>>16|o<<16)>>>32-n+3<<2}},It.computeTwiddleFactors=function(t,e,i,n){for(var r=t>>3,s=0,a=0,o=t>>2;a<o;){var l=a++;e[s]=Math.cos(4*l*3.141592653589793/t),e[s+1]=-Math.sin(4*l*3.141592653589793/t),i[s]=.5*Math.cos(3.141592653589793*(s+1)/t/2),i[s+1]=.5*Math.sin(3.141592653589793*(s+1)/t/2),s+=2}for(var u=0,h=0,c=r;h<c;){h++;n[u]=Math.cos(2*(u+1)*3.141592653589793/t),n[u+1]=-Math.sin(2*(u+1)*3.141592653589793/t),u+=2}},It.drawLine=function(t,e,i,n,r,s){if(null==It.integerDivideTable){var a=new Array(32);It.integerDivideTable=a;for(var o=0;o<32;){var l=o++,u=It.integerDivideTable,h=new Array(64);u[l]=h;for(var c=1;c<64;){var d=c++;It.integerDivideTable[l][d]=l/d|0}}}var _,f,p=r-i,g=n-e,m=p<0?-p:p,v=e,b=i,w=0;f=g<64&&m<32?p<0?(_=-It.integerDivideTable[m][g])-1:(_=It.integerDivideTable[m][g])+1:(_=p/g|0,p<0?_-1:_+1),m-=(_<0?-_:_)*g,s<n&&(n=s);t[v]=t[v]*It.INVERSE_DB_TABLE[b];for(var y=v+1,x=n;y<x;){var T=y++;g<=(w+=m)?(w-=g,b+=f):b+=_;t[T]=t[T]*It.INVERSE_DB_TABLE[b]}},It.predictPoint=function(t,e,i,n,r){var s=r-n,a=i-e,o=Math.abs(s)*(t-e)/a|0;return s<0?n-o:n+o},It.emptyFloatVector=function(t){return new Array(t)},It.copyVector=function(t){for(var e=new Array(t.length),i=0,n=t.length;i<n;){var r=i++;e[r]=t[r]}return e};function Et(){}(T["kha.audio2.ogg.vorbis.data.Codebook"]=Et).__name__=!0,Et.read=function(t){var e=new Et;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+i;var n=t.readBits(8),r=t.readBits(8);e.entries=(t.readBits(8)<<16)+(r<<8)+n;var s=t.readBits(1);e.sparse=0==s&&0!=t.readBits(1);var a=new Array(e.entries);e.sparse||(e.codewordLengths=a);var o,l=0;if(0!=s)for(var u=0,h=t.readBits(5)+1;u<e.entries;){var c=e.entries-u,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],_=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);if(u+_>e.entries)throw new ge(new Xt(Kt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var f=0,p=_;f<p;){a[u+f++]=h}u+=_,++h}else for(var g=0,m=e.entries;g<m;){var v=g++;0!=(e.sparse?t.readBits(1):1)?(a[v]=t.readBits(5)+1,++l):a[v]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=a,e.sparse=!1),e.sparse)o=l;else{for(var b=0,w=0,y=e.entries;w<y;){var x=a[w++];10<x&&255!=x&&++b}o=b}e.sortedEntries=o;var T=null;if(e.sparse){if(0!=e.sortedEntries){var S=new Array(e.sortedEntries);e.codewordLengths=S;var k=new Array(e.entries);e.codewords=k,T=new Array(e.entries)}e.entries,e.sortedEntries}else{var I=new Array(e.entries);e.codewords=I}if(!e.computeCodewords(a,e.entries,T))throw new ge(new Xt(Kt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var E=new Array(e.sortedEntries);e.sortedValues=E,e.computeSortedHuffman(a,T)}if(e.sparse&&(T=null,a=e.codewords=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),2<e.lookupType)throw new ge(new Xt(Kt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<e.lookupType){var C=t.readBits(32),B=Ot.toFloat(2097151&C),N=(2145386496&C)>>>21,L=0!=(-2147483648&C)?-B:B;e.minimumValue=L*Math.pow(2,N-788);var F=t.readBits(32),A=Ot.toFloat(2097151&F),M=(2145386496&F)>>>21,O=0!=(-2147483648&F)?-A:A;e.deltaValue=O*Math.pow(2,M-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=It.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var P=new Array(e.lookupValues),R=0,V=e.lookupValues;R<V;){var D=R++,U=t.readBits(e.valueBits);if(-1==U)throw new ge(new Xt(Kt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));P[D]=U}var H=new Array(e.lookupValues);e.multiplicands=H;for(var W=0,G=e.lookupValues;W<G;){var z=W++;e.multiplicands[z]=P[z]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var X=1,K=e.lookupValues;X<K;){var Y=X++;e.multiplicands[Y]=e.multiplicands[Y-1]}e.sequenceP=!1}}return e},Et.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(t,e,i,n,r){this.sparse?(this.codewords[i]=t,this.codewordLengths[i]=n,r[i]=e):this.codewords[e]=t},includeInSort:function(t){return!!this.sparse||255!=t&&10<t},computeCodewords:function(t,e,i){var n=new Array(32);n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,n[16]=0,n[17]=0,n[18]=0,n[19]=0,n[20]=0,n[21]=0,n[22]=0,n[23]=0,n[24]=0,n[25]=0,n[26]=0,n[27]=0,n[28]=0,n[29]=0,n[30]=0;for(var r=n[31]=0;r<e&&!(t[r]<255);)++r;if(r==e)return!0;var s=0,a=s++;this.sparse?(this.codewords[a]=0,this.codewordLengths[a]=t[r],i[a]=r):this.codewords[r]=0;for(var o=0;++o<=t[r];)n[o]=1<<32-o;for(o=r;++o<e;){var l=t[o];if(255!=l){for(;0<l&&0==n[l];)--l;if(0==l)return!1;var u=n[l];n[l]=0;var h=u,c=(h=(-16711936&(h=(-252645136&(h=(-858993460&(h=(-1431655766&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8)>>>16|h<<16,d=s++;if(this.sparse?(this.codewords[d]=c,this.codewordLengths[d]=t[o],i[d]=o):this.codewords[o]=c,l!=t[o])for(var _=t[o];l<_;)n[_]=u+(1<<32-_),--_}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var i=0,n=this.sortedEntries;i<n;){var r=i++,s=this.codewords[r];s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,this.sortedCodewords[r]=s>>>16|s<<16}else for(var a=0,o=0,l=this.entries;o<l;){var u=o++,h=t[u];if(this.sparse||255!=h&&10<h){var c=this.codewords[u];c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,this.sortedCodewords[a++]=c>>>16|c<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(It.uintAsc);for(var d=0,_=this.sparse?this.sortedEntries:this.entries;d<_;){var f=d++,p=this.sparse?t[e[f]]:t[f];if(this.sparse||255!=p&&10<p){for(var g=this.codewords[f],m=(g=(-16711936&(g=(-252645136&(g=(-858993460&(g=(-1431655766&g)>>>1|(1431655765&g)<<1))>>>2|(858993459&g)<<2))>>>4|(252645135&g)<<4))>>>8|(16711935&g)<<8)>>>16|g<<16,v=0,b=this.sortedEntries;1<b;){var w=v+(b>>1);Ot.gte(m,this.sortedCodewords[w])?(v=w,b-=b>>1):b>>=1}this.sparse?(this.sortedValues[v]=e[f],this.codewordLengths[v]=p):this.sortedValues[v]=f}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var i=e++;this.fastHuffman[i]=-1}for(var n=0,r=this.sparse?this.sortedEntries:this.entries;n<r;){var s=n++;if(this.codewordLengths[s]<=10){var a;if(this.sparse){var o=this.sortedCodewords[s];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[s];for(;a<1024;)this.fastHuffman[a]=s,a+=1<<this.codewordLengths[s]}}},codebookDecode:function(t,e,i,n){t.validBits<10&&t.prepHuffman();var r,s=this.fastHuffman[1023&t.acc];if(0<=s){var a=this.codewordLengths[s];t.acc=t.acc>>>a,t.validBits-=a,r=t.validBits<0?(t.validBits=0,-1):s}else r=t.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var o=r,l=this.lookupValues,u=this.sequenceP,h=this.multiplicands,c=this.minimumValue;if(o<0)return!1;if(n>this.dimensions&&(n=this.dimensions),1==this.lookupType){for(var d=1,_=0,f=0,p=n;f<p;){var g=f++,m=h[Ot.toFloat(o/d|0)%Ot.toFloat(l)|0]+_,v=i+g;e[v]=e[v]+m,u&&(_=m+c),d*=l}return!0}if(o*=this.dimensions,u)for(var b=0,w=0,y=n;w<y;){var x=w++,T=h[o+x]+b,S=i+x;e[S]=e[S]+T,b=T+c}else for(var k=0,I=n;k<I;){var E=k++,C=i+E;e[C]=e[C]+(h[o+E]+0)}return!0},codebookDecodeStep:function(t,e,i,n,r){t.validBits<10&&t.prepHuffman();var s,a=this.fastHuffman[1023&t.acc];if(0<=a){var o=this.codewordLengths[a];t.acc=t.acc>>>o,t.validBits-=o,s=t.validBits<0?(t.validBits=0,-1):a}else s=t.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,u=0;if(l<0)return!1;n>this.dimensions&&(n=this.dimensions);var h=this.lookupValues,c=this.sequenceP,d=this.multiplicands;if(1==this.lookupType){for(var _=1,f=0,p=n;f<p;){var g=f++,m=d[Ot.toFloat(l/_|0)%Ot.toFloat(h)|0]+u,v=i+g*r;e[v]=e[v]+m,c&&(u=m),_*=h}return!0}l*=this.dimensions;for(var b=0,w=n;b<w;){var y=b++,x=d[l+y]+u,T=i+y*r;e[T]=e[T]+x,c&&(u=x)}return!0},decodeStart:function(t){t.validBits<10&&t.prepHuffman();var e,i=this.fastHuffman[1023&t.acc];if(0<=i){var n=this.codewordLengths[i];t.acc=t.acc>>>n,t.validBits-=n,e=t.validBits<0?(t.validBits=0,-1):i}else e=t.decodeScalarRaw(this);return this.sparse&&(e=this.sortedValues[e]),e},decodeDeinterleaveRepeat:function(t,e,i,n,r,s,a){var o=this.dimensions;if(0==this.lookupType)throw new ge(new Xt(Kt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,u=this.sequenceP,h=this.lookupValues;0<a;){var c=0;t.validBits<10&&t.prepHuffman();var d,_=this.fastHuffman[1023&t.acc];if(0<=_){var f=this.codewordLengths[_];t.acc=t.acc>>>f,t.validBits-=f,d=t.validBits<0?(t.validBits=0,-1):_}else d=t.decodeScalarRaw(this);this.sparse&&(d=this.sortedValues[d]);var p=d;if(p<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new ge(new Xt(Kt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(s*i<n+r*i+o&&(o=s*i-(r*i-n)),1==this.lookupType){var g=1;if(u)for(var m=0,v=o;m<v;){m++;var b=l[Ot.toFloat(p/g|0)%Ot.toFloat(h)|0]+c,w=e[n];w[r]=w[r]+b,++n==i&&(n=0,++r),c=b,g*=h}else for(var y=0,x=o;y<x;){y++;var T=l[Ot.toFloat(p/g|0)%Ot.toFloat(h)|0]+c,S=e[n];S[r]=S[r]+T,++n==i&&(n=0,++r),g*=h}}else if(p*=this.dimensions,u)for(var k=0,I=o;k<I;){var E=l[p+k++]+c,C=e[n];C[r]=C[r]+E,++n==i&&(n=0,++r),c=E}else for(var B=0,N=o;B<N;){var L=l[p+B++]+c,F=e[n];F[r]=F[r]+L,++n==i&&(n=0,++r)}a-=o}return{cInter:n,pInter:r}},residueDecode:function(t,e,i,n,r){if(0==r)for(var s=n/this.dimensions|0,a=0,o=s;a<o;){var l=a++;if(!this.codebookDecodeStep(t,e,i+l,n-i-l,s))return!1}else for(var u=0;u<n;){if(!this.codebookDecode(t,e,i,n-u))return!1;u+=this.dimensions,i+=this.dimensions}return!0},__class__:Et};function Ct(){this.data=new it}(T["kha.audio2.ogg.vorbis.data.Comment"]=Ct).__name__=!0,Ct.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return ae.parseInt(this.getString("loopstart"))},get_loopLength:function(){return ae.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(t,e){t=t.toLowerCase();var i=this.data;if(null!=Hi[t]?i.existsReserved(t):i.h.hasOwnProperty(t)){var n=this.data;(null!=Hi[t]?n.getReserved(t):n.h[t]).push(e)}else{var r=[e],s=this.data;null!=Hi[t]?s.setReserved(t,r):s.h[t]=r}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=Hi[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return(null!=Hi[t]?i.getReserved(t):i.h[t])[0]}return null},getArray:function(t){t=t.toLowerCase();var e=this.data;if(null!=Hi[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return null!=Hi[t]?i.getReserved(t):i.h[t]}return null},__class__:Ct,__properties__:{get_artists:"get_artists",get_isrc:"get_isrc",get_contact:"get_contact",get_location:"get_location",get_date:"get_date",get_genre:"get_genre",get_description:"get_description",get_artist:"get_artist",get_license:"get_license",get_copyright:"get_copyright",get_performer:"get_performer",get_tracknumber:"get_tracknumber",get_organization:"get_organization",get_album:"get_album",get_version:"get_version",get_loopLength:"get_loopLength",get_loopStart:"get_loopStart",get_title:"get_title"}};function Bt(){}(T["kha.audio2.ogg.vorbis.data.Floor"]=Bt).__name__=!0,Bt.read=function(t,e){var i=new Bt;if(i.type=t.readBits(16),1<i.type)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var n=i.floor0=new Nt;n.order=t.readBits(8),n.rate=t.readBits(16),n.barkMapSize=t.readBits(16),n.amplitudeBits=t.readBits(6),n.amplitudeOffset=t.readBits(8),n.numberOfBooks=t.readBits(4)+1;for(var r=0,s=n.numberOfBooks;r<s;){var a=r++;n.bookList[a]=t.readBits(8)}throw new ge(new Xt(Kt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new Lt,u=-1;l.partitions=t.readBits(5);var h=new Array(l.partitions);l.partitionClassList=h;for(var c=0,d=l.partitions;c<d;){var _=c++;l.partitionClassList[_]=t.readBits(4),l.partitionClassList[_]>u&&(u=l.partitionClassList[_])}var f=new Array(u+1);l.classDimensions=f;var p=new Array(u+1);l.classMasterbooks=p;var g=new Array(u+1);l.classSubclasses=g;var m=new Array(u+1);l.subclassBooks=m;for(var v=0,b=u+1;v<b;){var w=v++;if(l.classDimensions[w]=t.readBits(3)+1,l.classSubclasses[w]=t.readBits(2),0!=l.classSubclasses[w]&&(l.classMasterbooks[w]=t.readBits(8),l.classMasterbooks[w]>=e.length))throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var y=1<<l.classSubclasses[w],x=l.subclassBooks,T=new Array(y);x[w]=T;for(var S=0,k=y;S<k;){var I=S++;if(l.subclassBooks[w][I]=t.readBits(8)-1,l.subclassBooks[w][I]>=e.length)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var E=new Array(250);l.xlist=E,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var C=0,B=l.partitions;C<B;)for(var N=C++,L=l.partitionClassList[N],F=0,A=l.classDimensions[L];F<A;){F++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var M=0,O=l.values;M<O;){var P=M++;o.push(new At),o[P].x=l.xlist[P],o[P].y=P}o.sort(It.pointCompare);var R=new Array(l.values);l.sortedOrder=R;for(var V=0,D=l.values;V<D;){var U=V++;l.sortedOrder[U]=o[U].y}var H=new Array(l.values);l.neighbors=H;for(var W=2,G=l.values;W<G;){for(var z=W++,X=l.xlist,K=-1,Y=65536,Z=0,j=0,q=0,Q=z;q<Q;){var J=q++;X[J]>K&&X[J]<X[z]&&(K=X[Z=J]),X[J]<Y&&X[J]>X[z]&&(Y=X[j=J])}var $=Z,tt=j,et=l.neighbors,it=new Array(l.values);et[z]=it,l.neighbors[z][0]=$,l.neighbors[z][1]=tt}return i},Bt.prototype={floor0:null,floor1:null,type:null,__class__:Bt};var Nt=function(){};(T["kha.audio2.ogg.vorbis.data.Floor0"]=Nt).__name__=!0,Nt.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Nt};var Lt=function(){};(T["kha.audio2.ogg.vorbis.data.Floor1"]=Lt).__name__=!0,Lt.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Lt};var Ft=function(){};(T["kha.audio2.ogg.vorbis.data.Header"]=Ft).__name__=!0,Ft.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,n,r,s,a,o,l=new ht(new ArrayBuffer(6));if(i=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[0]=i,n=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[1]=n,r=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[2]=r,s=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[3]=s,a=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[4]=a,o=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new ge(new Xt(Kt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var u=t.input.readInt32();if(0!=u)throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"vorbis version : "+u,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var h=new Ft;if(t.inputPosition+=1,h.channel=t.input.readByte(),0==h.channel)throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<h.channel)throw new ge(new Xt(Kt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,h.sampleRate=t.input.readInt32(),0==h.sampleRate)throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,h.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,h.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,h.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var c=t.input.readByte(),d=15&c,_=c>>4;if(h.blocksize0=1<<d,h.blocksize1=1<<_,d<6||13<d)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<6||13<_)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<d)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var f=t.input.readByte();if(0==(1&f))throw new ge(new Xt(Kt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var p=0,g=new dt;0!=(p=t.next());)t.inputPosition+=p,g.write(t.input.read(p)),t.bytesInSeg=0;var m=new ct(g.getBytes());m.readByte(),m.read(6);var v,b=m.readInt32();h.vendor=m.readString(b),h.comment=new Ct;for(var w=0,y=m.readInt32();w<y;){w++;var x=m.readInt32(),T=m.readString(x),S=T.indexOf("=");-1!=S&&h.comment.add(T.substring(0,S),T.substring(S+1))}if(0==(1&m.readByte()))throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),v=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,5!=v)throw new ge(new Xt(Kt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var k,I,E,C,B,N,L=new ht(new ArrayBuffer(6));if(k=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[0]=k,I=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[1]=I,E=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[2]=E,C=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[3]=C,B=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[4]=B,N=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[5]=N,"vorbis"!=L.toString())throw new ge(new Xt(Kt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var F=t.readBits(8)+1,A=new Array(F);h.codebooks=A;for(var M=0,O=F;M<O;){var P=M++;h.codebooks[P]=Et.read(t)}for(var R=0,V=f=t.readBits(6)+1;R<V;){R++;if(0!=t.readBits(16))throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var D=t.readBits(6)+1,U=new Array(D);h.floorConfig=U;for(var H=0,W=D;H<W;){var G=H++;h.floorConfig[G]=Bt.read(t,h.codebooks)}var z=t.readBits(6)+1,X=new Array(z);h.residueConfig=X;for(var K=0,Y=z;K<Y;){var Z=K++;h.residueConfig[Z]=Ht.read(t,h.codebooks)}var j=t.readBits(6)+1,q=new Array(j);h.mapping=q;for(var Q=0,J=j;Q<J;)for(var $=Q++,tt=Mt.read(t,h.channel),et=0,it=(h.mapping[$]=tt).submaps;et<it;){var nt=et++;if(tt.submapFloor[nt]>=h.floorConfig.length)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(tt.submapResidue[nt]>=h.residueConfig.length)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var rt=t.readBits(6)+1,st=new Array(rt);h.modes=st;for(var at=0,ot=rt;at<ot;){var lt=at++,ut=Rt.read(t);if((h.modes[lt]=ut).mapping>=h.mapping.length)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return h},Ft.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Ft};var At=function(){};(T["kha.audio2.ogg.vorbis.data.IntPoint"]=At).__name__=!0,At.prototype={x:null,y:null,__class__:At};var Mt=function(){};(T["kha.audio2.ogg.vorbis.data.Mapping"]=Mt).__name__=!0,Mt.read=function(t,e){var i=new Mt,n=t.readBits(16);if(0!=n)throw new ge(new Xt(Kt.INVALID_SETUP,"mapping type "+n,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var r=new Array(e);i.chan=r;for(var s=0,a=e;s<a;){var o=s++;i.chan[o]=new Pt}if(0!=t.readBits(1)?i.submaps=t.readBits(4)+1:i.submaps=1,0!=t.readBits(1)){i.couplingSteps=t.readBits(8)+1;for(var l=0,u=i.couplingSteps;l<u;){var h=l++,c=e-1,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[h].magnitude=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);var _=e-1,f=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[h].angle=t.readBits(_<16384?_<16?f[_]:_<512?5+f[_>>5]:10+f[_>>10]:_<16777216?_<524288?15+f[_>>15]:20+f[_>>20]:_<536870912?25+f[_>>25]:_<-2147483648?30+f[_>>30]:0),i.chan[h].magnitude>=e)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].angle>=e)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].magnitude==i.chan[h].angle)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=t.readBits(2))throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<i.submaps)for(var p=0,g=e;p<g;){var m=p++;if(i.chan[m].mux=t.readBits(4),i.chan[m].mux>=i.submaps)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var v=0,b=e;v<b;){var w=v++;i.chan[w].mux=0}var y=new Array(i.submaps);i.submapFloor=y;var x=new Array(i.submaps);i.submapResidue=x;for(var T=0,S=i.submaps;T<S;){var k=T++;t.readBits(8),i.submapFloor[k]=t.readBits(8),i.submapResidue[k]=t.readBits(8)}return i},Mt.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,i,n,r,s){var a=i>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new ge(new Xt(Kt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var u=l.floor1,h=0,c=r[0]*u.floor1Multiplier,d=1,_=u.values;d<_;){var f=d++,p=u.sortedOrder[f];if(0<=r[p]){var g=r[p]*u.floor1Multiplier,m=u.xlist[p];It.drawLine(n,h,c,m,g,a),h=m,c=g}}if(h<a)for(var v=h,b=a;v<b;){var w=v++;n[w]=n[w]*It.INVERSE_DB_TABLE[c]}},__class__:Mt};var Pt=function(){};(T["kha.audio2.ogg.vorbis.data.MappingChannel"]=Pt).__name__=!0,Pt.prototype={magnitude:null,angle:null,mux:null,__class__:Pt};var Rt=function(){};(T["kha.audio2.ogg.vorbis.data.Mode"]=Rt).__name__=!0,Rt.read=function(t){var e=new Rt;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},Rt.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:Rt};var Vt=function(){};(T["kha.audio2.ogg.vorbis.data.Page"]=Vt).__name__=!0,Vt.prototype={flag:null,clone:function(){var t=new Vt;return t.flag=this.flag,t},start:function(t){if(t.inputPosition+=1,!!(!!(79!=t.input.readByte()||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,83!=t.input.readByte()))throw new ge(new Xt(Kt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new ge(new Xt(Kt.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4;var n=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(i,n)},__class__:Vt};function Dt(){}(T["kha.audio2.ogg.vorbis.data.PageFlag"]=Dt).__name__=!0;var Ut=function(){};(T["kha.audio2.ogg.vorbis.data.ProbedPage"]=Ut).__name__=!0,Ut.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Ut};var Xt=function(t,e,i){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=i};(T["kha.audio2.ogg.vorbis.data.ReaderError"]=Xt).__name__=!0,Xt.prototype={type:null,message:null,posInfos:null,__class__:Xt};var Kt=p["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i}},Ht=function(){};(T["kha.audio2.ogg.vorbis.data.Residue"]=Ht).__name__=!0,Ht.read=function(t,e){var i=new Ht;if(i.type=t.readBits(16),2<i.type)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var n=new Array(64);i.begin=t.readBits(24),i.end=t.readBits(24),i.partSize=t.readBits(24)+1;var r=i.classifications=t.readBits(6)+1;i.classbook=t.readBits(8);for(var s=0,a=i.classifications;s<a;){var o=s++,l=0,u=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),n[o]=8*l+u}var h=new Array(i.classifications);i.residueBooks=h;for(var c=0,d=i.classifications;c<d;){var _=c++,f=i.residueBooks,p=new Array(8);f[_]=p;for(var g=0;g<8;){var m=g++;if(0!=(n[_]&1<<m)){if(i.residueBooks[_][m]=t.readBits(8),i.residueBooks[_][m]>=e.length)throw new ge(new Xt(Kt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[_][m]=-1}}var v=e[i.classbook].entries,b=e[i.classbook].dimensions,w=new Array(v);i.classdata=w;for(var y=0,x=v;y<x;)for(var T=y++,S=T,k=b,I=i.classdata,E=new Array(b),C=I[T]=E;0<=--k;)C[k]=S%r,S=S/r|0;return i},Ht.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,i,n,r,s,a){for(var o=e.codebooks,l=o[this.classbook].dimensions,u=this.end-this.begin,h=this.partSize,c=Ot.toFloat(u)/Ot.toFloat(h)|0,d=new Array(e.channel*c+1),_=0,f=n;_<f;){var p=_++;if(!s[p])for(var g=i[p],m=0,v=g.length;m<v;){g[m++]=0}}if(2!=this.type||1==n)for(var b=0;b<8;)for(var w=b++,y=0;y<c;){if(0==w)for(var x=0,T=n;x<T;){var S=x++;if(!s[S]){var k=o[this.classbook];t.validBits<10&&t.prepHuffman();var I,E=k.fastHuffman[1023&t.acc];if(0<=E){var C=k.codewordLengths[E];t.acc=t.acc>>>C,t.validBits-=C,I=t.validBits<0?(t.validBits=0,-1):E}else I=t.decodeScalarRaw(k);k.sparse&&(I=k.sortedValues[I]);var B=I;if(-1==B)return;for(var N=l;0<=--N;)d[S*c+N+y]=B%this.classifications,B=B/this.classifications|0}}for(var L=0,F=l;L<F;){L++;if(c<=y)break;for(var A=0,M=n;A<M;){var O=A++;if(!s[O]){var P=d[O*c+y],R=this.residueBooks[P][w];if(0<=R){var V=i[O],D=this.begin+y*h,U=h;if(!o[R].residueDecode(t,V,D,U,this.type))return}}}++y}}else{for(var H=0,W=n;H<W;){var G=H++;if(!s[G])break;if(G==n-1)return}for(var z=0;z<8;){var X=z++,K=0;if(2==n)for(;K<c;){var Y=this.begin+K*h,Z=1&Y,j=Y>>>1;if(0==X){var q=o[this.classbook];t.validBits<10&&t.prepHuffman();var Q,J=q.fastHuffman[1023&t.acc];if(0<=J){var $=q.codewordLengths[J];t.acc=t.acc>>>$,t.validBits-=$,Q=t.validBits<0?(t.validBits=0,-1):J}else Q=t.decodeScalarRaw(q);q.sparse&&(Q=q.sortedValues[Q]);var tt=Q;if(-1==tt)return;for(var et=l;0<=--et;)d[et+K]=tt%this.classifications,tt=tt/this.classifications|0}for(var it=0,nt=l;it<nt;){it++;if(c<=K)break;var rt=this.begin+K*h,st=d[K],at=this.residueBooks[st][X];if(0<=at){var ot=o[at].decodeDeinterleaveRepeat(t,i,n,Z,j,r,h);if(null==ot)return;Z=ot.cInter,j=ot.pInter}else Z=1&(rt+=h),j=rt>>>1;++K}}else if(1==n)for(;K<c;){var lt=0,ut=this.begin+K*h;if(0==X){var ht=o[this.classbook];t.validBits<10&&t.prepHuffman();var ct,dt=ht.fastHuffman[1023&t.acc];if(0<=dt){var _t=ht.codewordLengths[dt];t.acc=t.acc>>>_t,t.validBits-=_t,ct=t.validBits<0?(t.validBits=0,-1):dt}else ct=t.decodeScalarRaw(ht);ht.sparse&&(ct=ht.sortedValues[ct]);var ft=ct;if(-1==ft)return;for(var pt=l;0<=--pt;)d[pt+K]=ft%this.classifications,ft=ft/this.classifications|0}for(var gt=0,mt=l;gt<mt;){gt++;if(c<=K)break;var vt=this.begin+K*h,bt=this.residueBooks[d[K]][X];if(0<=bt){var wt=o[bt].decodeDeinterleaveRepeat(t,i,n,lt,ut,r,h);if(null==wt)return;lt=wt.cInter,ut=wt.pInter}else lt=0,ut=vt+=h;++K}}else for(;K<c;){var yt=this.begin+K*h,xt=Ot.toFloat(yt)%Ot.toFloat(n)|0,Tt=Ot.toFloat(yt)/Ot.toFloat(n)|0;if(0==X){var St=o[this.classbook];t.validBits<10&&t.prepHuffman();var kt,It=St.fastHuffman[1023&t.acc];if(0<=It){var Et=St.codewordLengths[It];t.acc=t.acc>>>Et,t.validBits-=Et,kt=t.validBits<0?(t.validBits=0,-1):It}else kt=t.decodeScalarRaw(St);St.sparse&&(kt=St.sortedValues[kt]);var Ct=kt;if(-1==Ct)return;for(var Bt=l;0<=--Bt;)d[Bt+K]=Ct%this.classifications,Ct=Ct/this.classifications|0}for(var Nt=0,Lt=l;Nt<Lt;){Nt++;if(c<=K)break;var Ft=this.begin+K*h,At=this.residueBooks[d[K]][X];if(0<=At){var Mt=o[At].decodeDeinterleaveRepeat(t,i,n,xt,Tt,r,h);if(null==Mt)return;xt=Mt.cInter,Tt=Mt.pInter}else Ft+=h,xt=Ot.toFloat(Ft)%Ot.toFloat(n)|0,Tt=Ot.toFloat(Ft)/Ot.toFloat(n)|0;++K}}}}},__class__:Ht};function Wt(){}(T["kha.audio2.ogg.vorbis.data.Setting"]=Wt).__name__=!0;function Gt(){}(T["kha.compute.ConstantLocation"]=Gt).__name__=!0,Gt.prototype={__class__:Gt};function zt(){}(T["kha.compute.TextureUnit"]=zt).__name__=!0,zt.prototype={__class__:zt};function Yt(){}(T["kha.graphics1.Graphics"]=Yt).__name__=!0,Yt.__isInterface__=!0,Yt.prototype={begin:null,end:null,setPixel:null,__class__:Yt};var Zt=function(){this.transformations=[new hi(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};(T["kha.graphics2.Graphics"]=Zt).__name__=!0,Zt.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},flush:function(){},clear:function(t){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,n,r,s,a){this.drawScaledSubImage(t,n,r,s,a,e,i,s,a)},drawScaledImage:function(t,e,i,n,r){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,n,r)},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){},drawRect:function(t,e,i,n,r){null==r&&(r=1)},fillRect:function(t,e,i,n){},drawString:function(t,e,i){},drawCharacters:function(t,e,i,n,r){},drawLine:function(t,e,i,n,r){null==r&&(r=1)},drawVideo:function(t,e,i,n,r){},fillTriangle:function(t,e,i,n,r,s){},get_imageScaleQuality:function(){return 0},set_imageScaleQuality:function(t){return 1},get_mipmapScaleQuality:function(){return 0},set_mipmapScaleQuality:function(t){return 1},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},get_transformation:function(){return this.transformations[this.transformationIndex]},set_transformation:function(t){this.setTransformation(t);var e=this.transformations[this.transformationIndex];return e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,t},pushTransformation:function(t){this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new hi(1,0,0,0,1,0,0,0,1));var e=this.transformations[this.transformationIndex];e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(this.transformations[this.transformationIndex])},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},scale:function(t,e){var i=this.transformations[this.transformationIndex],n=this.transformations[this.transformationIndex],r=t*n._00+0*n._01+0*n._02,s=t*n._10+0*n._11+0*n._12,a=t*n._20+0*n._21+0*n._22,o=0*n._00+e*n._01+0*n._02,l=0*n._10+e*n._11+0*n._12,u=0*n._20+e*n._21+0*n._22,h=0*n._00+0*n._01+ +n._02,c=0*n._10+0*n._11+ +n._12,d=0*n._20+0*n._21+ +n._22;i._00=r,i._10=s,i._20=a,i._01=o,i._11=l,i._21=u,i._02=h,i._12=c,i._22=d},translation:function(t,e){var i=this.transformations[this.transformationIndex];return new hi(+i._00+0*i._01+t*i._02,+i._10+0*i._11+t*i._12,+i._20+0*i._21+t*i._22,0*i._00+ +i._01+e*i._02,0*i._10+ +i._11+e*i._12,0*i._20+ +i._21+e*i._22,0*i._00+0*i._01+ +i._02,0*i._10+0*i._11+ +i._12,0*i._20+0*i._21+ +i._22)},translate:function(t,e){var i=this.transformations[this.transformationIndex],n=this.transformations[this.transformationIndex],r=+n._00+0*n._01+t*n._02,s=+n._10+0*n._11+t*n._12,a=+n._20+0*n._21+t*n._22,o=0*n._00+ +n._01+e*n._02,l=0*n._10+ +n._11+e*n._12,u=0*n._20+ +n._21+e*n._22,h=0*n._00+0*n._01+ +n._02,c=0*n._10+0*n._11+ +n._12,d=0*n._20+0*n._21+ +n._22;i._00=r,i._10=s,i._20=a,i._01=o,i._11=l,i._21=u,i._02=h,i._12=c,i._22=d},pushTranslation:function(t,e){var i=this.transformations[this.transformationIndex],n=+i._00+0*i._01+t*i._02,r=+i._10+0*i._11+t*i._12,s=+i._20+0*i._21+t*i._22,a=0*i._00+ +i._01+e*i._02,o=0*i._10+ +i._11+e*i._12,l=0*i._20+ +i._21+e*i._22,u=0*i._00+0*i._01+ +i._02,h=0*i._10+0*i._11+ +i._12,c=0*i._20+0*i._21+ +i._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new hi(1,0,0,0,1,0,0,0,1));var d=this.transformations[this.transformationIndex];d._00=n,d._10=r,d._20=s,d._01=a,d._11=o,d._21=l,d._02=u,d._12=h,d._22=c,this.setTransformation(this.transformations[this.transformationIndex])},rotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=+s+0*o+0*n,h=a+0*l+0*n,c=+n+0,d=0*s+ +o+0*r,_=0*a+ +l+0*r,f=+r+0,p=0*s+0*o,g=0*a+0*l,m=-e,v=-i,b=u+0*h+0*c,w=0*u+h+0*c,y=u*m+h*v+c,x=d+0*_+0*f,T=0*d+_+0*f,S=d*m+_*v+f,k=p+0*g,I=0*p+g,E=p*m+g*v+1,C=this.transformations[this.transformationIndex];return new hi(b*C._00+w*C._01+y*C._02,b*C._10+w*C._11+y*C._12,b*C._20+w*C._21+y*C._22,x*C._00+T*C._01+S*C._02,x*C._10+T*C._11+S*C._12,x*C._20+T*C._21+S*C._22,k*C._00+I*C._01+E*C._02,k*C._10+I*C._11+E*C._12,k*C._20+I*C._21+E*C._22)},rotate:function(t,e,i){var n=this.transformations[this.transformationIndex],r=e,s=i,a=Math.cos(t),o=-Math.sin(t),l=Math.sin(t),u=Math.cos(t),h=+a+0*l+0*r,c=o+0*u+0*r,d=+r+0,_=0*a+ +l+0*s,f=0*o+ +u+0*s,p=+s+0,g=0*a+0*l,m=0*o+0*u,v=-e,b=-i,w=h+0*c+0*d,y=0*h+c+0*d,x=h*v+c*b+d,T=_+0*f+0*p,S=0*_+f+0*p,k=_*v+f*b+p,I=g+0*m,E=0*g+m,C=g*v+m*b+1,B=this.transformations[this.transformationIndex],N=w*B._00+y*B._01+x*B._02,L=w*B._10+y*B._11+x*B._12,F=w*B._20+y*B._21+x*B._22,A=T*B._00+S*B._01+k*B._02,M=T*B._10+S*B._11+k*B._12,O=T*B._20+S*B._21+k*B._22,P=I*B._00+E*B._01+C*B._02,R=I*B._10+E*B._11+C*B._12,V=I*B._20+E*B._21+C*B._22;n._00=N,n._10=L,n._20=F,n._01=A,n._11=M,n._21=O,n._02=P,n._12=R,n._22=V},pushRotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=+s+0*o+0*n,h=a+0*l+0*n,c=+n+0,d=0*s+ +o+0*r,_=0*a+ +l+0*r,f=+r+0,p=0*s+0*o,g=0*a+0*l,m=-e,v=-i,b=u+0*h+0*c,w=0*u+h+0*c,y=u*m+h*v+c,x=d+0*_+0*f,T=0*d+_+0*f,S=d*m+_*v+f,k=p+0*g,I=0*p+g,E=p*m+g*v+1,C=this.transformations[this.transformationIndex],B=b*C._00+w*C._01+y*C._02,N=b*C._10+w*C._11+y*C._12,L=b*C._20+w*C._21+y*C._22,F=x*C._00+T*C._01+S*C._02,A=x*C._10+T*C._11+S*C._12,M=x*C._20+T*C._21+S*C._22,O=k*C._00+I*C._01+E*C._02,P=k*C._10+I*C._11+E*C._12,R=k*C._20+I*C._21+E*C._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new hi(1,0,0,0,1,0,0,0,1));var V=this.transformations[this.transformationIndex];V._00=B,V._10=N,V._20=L,V._01=F,V._11=A,V._21=M,V._02=O,V._12=P,V._22=R,this.setTransformation(this.transformations[this.transformationIndex])},pushOpacity:function(t){this.setOpacity(t),this.opacities.push(t)},popOpacity:function(){var t=this.opacities.pop();return this.setOpacity(this.get_opacity()),t},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(t){return this.setOpacity(t),this.opacities[this.opacities.length-1]=t},scissor:function(t,e,i,n){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(t){return this.setPipeline(t),this.pipe=t},transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(t){},setOpacity:function(t){},setPipeline:function(t){},__class__:Zt,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline",set_opacity:"set_opacity",get_opacity:"get_opacity",set_transformation:"set_transformation",get_transformation:"get_transformation",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_mipmapScaleQuality:"set_mipmapScaleQuality",get_mipmapScaleQuality:"get_mipmapScaleQuality",set_imageScaleQuality:"set_imageScaleQuality",get_imageScaleQuality:"get_imageScaleQuality"}};var jt=function(t){this.canvas=t};(T["kha.graphics2.Graphics1"]=jt).__name__=!0,jt.__interfaces__=[Yt],jt.prototype={canvas:null,texture:null,pixels:null,begin:function(){null!=this.texture&&this.texture.get_realWidth()==this.canvas.get_width()&&this.texture.get_realHeight()==this.canvas.get_height()||(this.texture=P.create(this.canvas.get_width(),this.canvas.get_height(),0,2)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(!1),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(t,e,i){this.pixels.setInt32(e*this.texture.get_realWidth()*4+4*t,N.fromBytes(255&i,(65280&i)>>>8,(16711680&i)>>>16,i>>>24))},__class__:jt};var be=function(){};(T["kha.graphics2.GraphicsExtension"]=be).__name__=!0,be.drawArc=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==o&&(o=!1),null==a&&(a=1),r%=2*Math.PI,s%=2*Math.PI,o?r<s&&(s-=2*Math.PI):s<r&&(s+=2*Math.PI),n+=a/2,l<=0&&(l=Math.floor(10*Math.sqrt(n)));for(var u=(s-r)/l,h=Math.cos(u),c=Math.sin(u),d=Math.cos(r)*n,_=Math.sin(r)*n,f=0,p=l;f<p;){f++;var g=d+e,m=_+i,v=d;d=h*d-c*_,_=h*_+c*v,be.drawInnerLine(t,d+e,_+i,g,m,a)}},be.fillArc=function(t,e,i,n,r,s,a,o){null==o&&(o=0),null==a&&(a=!1),r%=2*Math.PI,s%=2*Math.PI,a?r<s&&(s-=2*Math.PI):s<r&&(s+=2*Math.PI),o<=0&&(o=Math.floor(10*Math.sqrt(n)));for(var l=(s-r)/o,u=Math.cos(l),h=Math.sin(l),c=Math.cos(r)*n,d=Math.sin(r)*n,_=c+e,f=d+i,p=0,g=o;p<g;){p++;var m=c+e,v=d+i,b=c;c=u*c-h*d,d=u*d+h*b,t.fillTriangle(m,v,c+e,d+i,_,f)}},be.drawCircle=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=1),n+=r/2,s<=0&&(s=Math.floor(10*Math.sqrt(n)));for(var a=2*Math.PI/s,o=Math.cos(a),l=Math.sin(a),u=n,h=0,c=0,d=s;c<d;){c++;var _=u+e,f=h+i,p=u;u=o*u-l*h,h=o*h+l*p,be.drawInnerLine(t,u+e,h+i,_,f,r)}},be.drawInnerLine=function(t,e,i,n,r,s){var a=i<r?1:0;r==i&&(a=0<n-e?1:0);var o=0,l=0;if(r==i){var u=0,h=-1;null==h&&(h=0),null==u&&(u=0),o=u,l=h}else{var c=1,d=-(n-e)/(r-i);null==d&&(d=0),null==c&&(c=0),o=c,l=d}var _=Math.sqrt(o*o+l*l);if(0!=_){var f=s/_;o*=f,l*=f}var p=e+a*o,g=i+a*l;null==g&&(g=0),null==p&&(p=0);var m=n+a*o,v=r+a*l;null==v&&(v=0),null==m&&(m=0);var b=m,w=v,y=p-o,x=g-l;null==x&&(x=0),null==y&&(y=0);var T=y,S=x,k=b-o,I=w-l;null==I&&(I=0),null==k&&(k=0);var E=k,C=I;t.fillTriangle(p,g,b,w,T,S),t.fillTriangle(T,S,b,w,E,C)},be.fillCircle=function(t,e,i,n,r){null==r&&(r=0),r<=0&&(r=Math.floor(10*Math.sqrt(n)));for(var s=2*Math.PI/r,a=Math.cos(s),o=Math.sin(s),l=n,u=0,h=0,c=r;h<c;){h++;var d=l+e,_=u+i,f=l;l=a*l-o*u,u=a*u+o*f,t.fillTriangle(d,_,l+e,u+i,e,i)}},be.drawPolygon=function(t,e,i,n,r){null==r&&(r=1);for(var s=ne.iter(n),a=s.next(),o=a;s.hasNext();){var l=s.next();t.drawLine(o.x+e,o.y+i,l.x+e,l.y+i,r),o=l}t.drawLine(o.x+e,o.y+i,a.x+e,a.y+i,r)},be.fillPolygon=function(t,e,i,n){var r=ne.iter(n);if(r.hasNext()){var s=r.next();if(r.hasNext())for(var a=r.next();r.hasNext();){var o=r.next();t.fillTriangle(s.x+e,s.y+i,a.x+e,a.y+i,o.x+e,o.y+i),a=o}}},be.drawCubicBezier=function(t,e,i,n,r){var s;null==r&&(r=1),null==n&&(n=20);for(var a,o=be.calculateCubicBezierPoint(0,e,i),l=1,u=n+1;l<u;){s=l++/n,a=be.calculateCubicBezierPoint(s,e,i),t.drawLine(o[0],o[1],a[0],a[1],r),o=a}},be.drawCubicBezierPath=function(t,e,i,n,r){null==r&&(r=1),null==n&&(n=20);for(var s,a=0,o=null,l=null;a<e.length-3;){0==a&&(o=be.calculateCubicBezierPoint(0,[e[a],e[a+1],e[a+2],e[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]));for(var u=1,h=n+1;u<h;){s=u++/n,l=be.calculateCubicBezierPoint(s,[e[a],e[a+1],e[a+2],e[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]),t.drawLine(o[0],o[1],l[0],l[1],r),o=l}a+=3}},be.calculateCubicBezierPoint=function(t,e,i){var n=1-t,r=t*t,s=n*n,a=s*n,o=r*t,l=[a*e[0],a*i[0]];return l[0]+=3*s*t*e[1],l[1]+=3*s*t*i[1],l[0]+=3*n*r*e[2],l[1]+=3*n*r*i[2],l[0]+=o*e[3],l[1]+=o*i[3],l},be.drawAlignedString=function(t,e,i,n,r,s){var a=0;if(1==r||2==r){var o=t.get_font().width(t.get_fontSize(),e);a=1==r?.5*-o:-o}var l=0;if(1==s||2==s){var u=t.get_font().height(t.get_fontSize());l=1==s?.5*-u:-u}t.drawString(e,i+a,n+l)},be.drawAlignedCharacters=function(t,e,i,n,r,s,a,o){var l=0;if(1==a||2==a){var u=t.get_font().widthOfCharacters(t.get_fontSize(),e,i,n);l=1==a?.5*-u:-u}var h=0;if(1==o||2==o){var c=t.get_font().height(t.get_fontSize());h=1==o?.5*-c:-c}t.drawCharacters(e,i,n,r+l,s+h)};function qt(){}(T["kha.graphics2.truetype.VectorOfIntPointer"]=qt).__name__=!0,qt.prototype={value:null,__class__:qt};function Qt(){}(T["kha.graphics2.truetype.Stbtt_temp_rect"]=Qt).__name__=!0,Qt.prototype={x0:null,y0:null,x1:null,y1:null,__class__:Qt};function Jt(){}(T["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Jt).__name__=!0,Jt.prototype={advanceWidth:null,leftSideBearing:null,__class__:Jt};function $t(){}(T["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=$t).__name__=!0,$t.prototype={ascent:null,descent:null,lineGap:null,__class__:$t};function te(){}(T["kha.graphics2.truetype.Stbtt_temp_region"]=te).__name__=!0,te.prototype={width:null,height:null,xoff:null,yoff:null,__class__:te};var ee=function(){};(T["kha.graphics2.truetype.Stbtt_bakedchar"]=ee).__name__=!0,ee.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:ee};function ie(){}(T["kha.graphics2.truetype.Stbtt_aligned_quad"]=ie).__name__=!0,ie.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:ie};function we(){}(T["kha.graphics2.truetype.Stbtt_packedchar"]=we).__name__=!0,we.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:we};function ye(){}(T["kha.graphics2.truetype.Stbtt_pack_range"]=ye).__name__=!0,ye.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:ye};function xe(){}(T["kha.graphics2.truetype.Stbtt_pack_context"]=xe).__name__=!0,xe.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:xe};var Te=function(){};(T["kha.graphics2.truetype.Stbtt_fontinfo"]=Te).__name__=!0,Te.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:Te};function Se(){}(T["kha.graphics2.truetype.Stbtt_vertex"]=Se).__name__=!0,Se.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:Se};function ke(){}(T["kha.graphics2.truetype.Stbtt__bitmap"]=ke).__name__=!0,ke.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:ke};function Ie(){}(T["kha.graphics2.truetype.Stbtt__edge"]=Ie).__name__=!0,Ie.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:Ie};function Ee(){}(T["kha.graphics2.truetype.Stbtt__active_edge"]=Ee).__name__=!0,Ee.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Ee};function Ce(){}(T["kha.graphics2.truetype.Stbtt__point"]=Ce).__name__=!0,Ce.prototype={x:null,y:null,__class__:Ce};var Be=function(){};(T["kha.graphics2.truetype.StbTruetype"]=Be).__name__=!0,Be.STBTT_assert=function(t){if(!t)throw new ge("Error")},Be.STBTT_POINT_SIZE=function(t){return-t},Be.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},Be.ttCHAR=function(t,e){null==e&&(e=0);var i=t.readU8(e);return 128<=i?i-256:i},Be.ttUSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e);return t.readU8(e+1)|i<<8},Be.ttSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1)|i<<8;return 0!=(32768&n)?n-65536:n},Be.ttULONG=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),r=t.readU8(i+1),s=t.readU8(i+2);return t.readU8(i+3)|s<<8|r<<16|n<<24},Be.ttLONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},Be.to_stbtt_uint16=function(t){return 65535&t},Be.ttFixed=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),r=t.readU8(i+1),s=t.readU8(i+2);return t.readU8(i+3)|s<<8|r<<16|n<<24},Be.stbtt_tag4=function(t,e,i,n,r,s){return t.readU8(e)==i&&t.readU8(e+1)==n&&t.readU8(e+2)==r&&t.readU8(e+3)==s},Be.stbtt_tag=function(t,e,i){var n=ne.cca(i,0),r=ne.cca(i,1),s=ne.cca(i,2),a=ne.cca(i,3);return t.readU8(e)==n&&t.readU8(e+1)==r&&t.readU8(e+2)==s&&t.readU8(e+3)==a},Be.stbtt__isfont=function(t){var e=ne.cca("1",0);if(t.readU8(0)==e&&0==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3))return!0;var i=ne.cca("typ1",0),n=ne.cca("typ1",1),r=ne.cca("typ1",2),s=ne.cca("typ1",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s)return!0;var a=ne.cca("OTTO",0),o=ne.cca("OTTO",1),l=ne.cca("OTTO",2),u=ne.cca("OTTO",3);return t.readU8(0)==a&&t.readU8(1)==o&&t.readU8(2)==l&&t.readU8(3)==u||0==t.readU8(0)&&1==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3)},Be.stbtt__find_table=function(t,e,i){var n=e+4;null==n&&(n=0);for(var r=t.readU8(n),s=e+12,a=0,o=t.readU8(n+1)|r<<8;a<o;){var l=s+16*a++,u=ne.cca(i,0),h=ne.cca(i,1),c=ne.cca(i,2),d=ne.cca(i,3);if(t.readU8(l)==u&&t.readU8(l+1)==h&&t.readU8(l+2)==c&&t.readU8(l+3)==d){var _=l+8;null==_&&(_=0);var f=_;null==f&&(f=0);var p=t.readU8(f),g=t.readU8(f+1),m=t.readU8(f+2);return t.readU8(f+3)|m<<8|g<<16|p<<24}}return 0},Be.stbtt_GetFontOffsetForIndex=function(t,e){if(Be.stbtt__isfont(t))return 0==e?0:-1;var i=ne.cca("ttcf",0),n=ne.cca("ttcf",1),r=ne.cca("ttcf",2),s=ne.cca("ttcf",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s){var a,o=4;null==o&&(o=0);var l=o;null==l&&(l=0);var u=t.readU8(l),h=t.readU8(l+1),c=t.readU8(l+2);if(65536!=(t.readU8(l+3)|c<<8|h<<16|u<<24)){var d=4;null==d&&(d=0);var _=d;null==_&&(_=0);var f=t.readU8(_),p=t.readU8(_+1),g=t.readU8(_+2);a=131072==(t.readU8(_+3)|g<<8|p<<16|f<<24)}else a=!0;if(a){var m=8;null==m&&(m=0);var v=t.readU8(m),b=t.readU8(m+1),w=t.readU8(m+2);if((t.readU8(m+3)|w<<8|b<<16|v<<24)<=e)return-1;var y=12+4*e;null==y&&(y=0);var x=y;null==x&&(x=0);var T=t.readU8(x),S=t.readU8(x+1),k=t.readU8(x+2);return t.readU8(x+3)|k<<8|S<<16|T<<24}}return-1},Be.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var n=Be.stbtt__find_table(e,i,"cmap");if(t.loca=Be.stbtt__find_table(e,i,"loca"),t.head=Be.stbtt__find_table(e,i,"head"),t.glyf=Be.stbtt__find_table(e,i,"glyf"),t.hhea=Be.stbtt__find_table(e,i,"hhea"),t.hmtx=Be.stbtt__find_table(e,i,"hmtx"),t.kern=Be.stbtt__find_table(e,i,"kern"),0==n||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var r=Be.stbtt__find_table(e,i,"maxp");if(0!=r){var s=r+4;null==s&&(s=0);var a=e.readU8(s),o=e.readU8(s+1);t.numGlyphs=o|a<<8}else t.numGlyphs=65535;var l=n+2;null==l&&(l=0);for(var u=e.readU8(l),h=e.readU8(l+1)|u<<8,c=t.index_map=0,d=h;c<d;){var _=n+4+8*c++,f=_;null==f&&(f=0);var p=e.readU8(f);switch(e.readU8(f+1)|p<<8){case 0:var g=_+4;null==g&&(g=0);var m=g;null==m&&(m=0);var v=e.readU8(m),b=e.readU8(m+1),w=e.readU8(m+2),y=e.readU8(m+3);t.index_map=n+(y|w<<8|b<<16|v<<24);break;case 3:var x=_+2;null==x&&(x=0);var T=e.readU8(x);switch(e.readU8(x+1)|T<<8){case 1:case 10:var S=_+4;null==S&&(S=0);var k=S;null==k&&(k=0);var I=e.readU8(k),E=e.readU8(k+1),C=e.readU8(k+2),B=e.readU8(k+3);t.index_map=n+(B|C<<8|E<<16|I<<24)}}}if(0==t.index_map)return!1;var N=t.head+50;null==N&&(N=0);var L=e.readU8(N),F=e.readU8(N+1);return t.indexToLocFormat=F|L<<8,!0},Be.stbtt_FindGlyphIndex=function(t,e){var i=t.data,n=t.index_map,r=n;null==r&&(r=0);var s=i.readU8(r),a=i.readU8(r+1)|s<<8;if(0==a){var o=n+2;null==o&&(o=0);var l=i.readU8(o);if(e<(i.readU8(o+1)|l<<8)-6){var u=n+6+e;return null==u&&(u=0),i.readU8(u)}return 0}if(6==a){var h=n+6;null==h&&(h=0);var c=i.readU8(h),d=i.readU8(h+1)|c<<8,_=n+8;null==_&&(_=0);var f=i.readU8(_),p=i.readU8(_+1);if(d<=e&&e<d+(p|f<<8)){var g=n+10+2*(e-d);null==g&&(g=0);var m=i.readU8(g);return i.readU8(g+1)|m<<8}return 0}if(2==a)throw new ge("Error");if(4==a){var v=n+6;null==v&&(v=0);var b=i.readU8(v),w=(i.readU8(v+1)|b<<8)>>1,y=n+8;null==y&&(y=0);var x=i.readU8(y),T=(i.readU8(y+1)|x<<8)>>1,S=n+10;null==S&&(S=0);var k=i.readU8(S),I=i.readU8(S+1)|k<<8,E=n+12;null==E&&(E=0);var C=i.readU8(E),B=(i.readU8(E+1)|C<<8)>>1,N=n+14,L=N;if(65535<e)return 0;var F=L+2*B;null==F&&(F=0);var A=i.readU8(F);for((i.readU8(F+1)|A<<8)<=e&&(L+=2*B),L-=2;0!=I;){var M=L+2*(T>>=1);null==M&&(M=0);var O=i.readU8(M);(i.readU8(M+1)|O<<8)<e&&(L+=2*T),--I}var P=(L+=2)-N>>1&65535,R=N+2*P;null==R&&(R=0);var V=i.readU8(R);if((i.readU8(R+1)|V<<8)<e)throw new ge("Error");var D=n+14+2*w+2+2*P;null==D&&(D=0);var U=i.readU8(D),H=i.readU8(D+1)|U<<8;if(e<H)return 0;var W=n+14+6*w+2+2*P;null==W&&(W=0);var G=i.readU8(W),z=i.readU8(W+1)|G<<8;if(0==z){var X=n+14+4*w+2+2*P;null==X&&(X=0);var K=i.readU8(X),Y=i.readU8(X+1)|K<<8;return e+(0!=(32768&Y)?Y-65536:Y)&65535}var Z=z+2*(e-H)+n+14+6*w+2+2*P;null==Z&&(Z=0);var j=i.readU8(Z);return i.readU8(Z+1)|j<<8}if(12!=a&&13!=a)throw new ge("Error");var q=n+12;null==q&&(q=0);var Q=q;null==Q&&(Q=0);for(var J=i.readU8(Q),$=i.readU8(Q+1),tt=i.readU8(Q+2),et=0,it=i.readU8(Q+3)|tt<<8|$<<16|J<<24;et<it;){var nt=et+(it-et>>1),rt=n+16+12*nt;null==rt&&(rt=0);var st=rt;null==st&&(st=0);var at=i.readU8(st),ot=i.readU8(st+1),lt=i.readU8(st+2),ut=i.readU8(st+3)|lt<<8|ot<<16|at<<24,ht=n+16+12*nt+4;null==ht&&(ht=0);var ct=ht;null==ct&&(ct=0);var dt=i.readU8(ct),_t=i.readU8(ct+1),ft=i.readU8(ct+2),pt=i.readU8(ct+3);if(e<ut)it=nt;else{if(!((pt|ft<<8|_t<<16|dt<<24)<e)){var gt=n+16+12*nt+8;null==gt&&(gt=0);var mt=gt;null==mt&&(mt=0);var vt=i.readU8(mt),bt=i.readU8(mt+1),wt=i.readU8(mt+2),yt=i.readU8(mt+3)|wt<<8|bt<<16|vt<<24;return 12==a?yt+e-ut:yt}et=nt+1}}return 0},Be.stbtt_GetCodepointShape=function(t,e){return Be.stbtt_GetGlyphShape(t,Be.stbtt_FindGlyphIndex(t,e))},Be.stbtt_setvertex=function(t,e,i,n,r,s){t.type=e,t.x=i,t.y=n,t.cx=r,t.cy=s},Be.stbtt__GetGlyfOffset=function(t,e){var i,n;if(e>=t.numGlyphs)return-1;if(2<=t.indexToLocFormat)return-1;if(0==t.indexToLocFormat){var r=t.glyf,s=t.data,a=t.loca+2*e;null==a&&(a=0);var o=s.readU8(a);i=r+2*(s.readU8(a+1)|o<<8);var l=t.glyf,u=t.data,h=t.loca+2*e+2;null==h&&(h=0);var c=u.readU8(h);n=l+2*(u.readU8(h+1)|c<<8)}else{var d=t.glyf,_=t.data,f=t.loca+4*e;null==f&&(f=0);var p=f;null==p&&(p=0);var g=_.readU8(p),m=_.readU8(p+1),v=_.readU8(p+2);i=d+(_.readU8(p+3)|v<<8|m<<16|g<<24);var b=t.glyf,w=t.data,y=t.loca+4*e+4;null==y&&(y=0);var x=y;null==x&&(x=0);var T=w.readU8(x),S=w.readU8(x+1),k=w.readU8(x+2);n=b+(w.readU8(x+3)|k<<8|S<<16|T<<24)}return i==n?-1:i},Be.stbtt_GetGlyphBox=function(t,e,i){var n=Be.stbtt__GetGlyfOffset(t,e);if(n<0)return!1;var r=t.data,s=n+2;null==s&&(s=0);var a=r.readU8(s),o=r.readU8(s+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=t.data,u=n+4;null==u&&(u=0);var h=l.readU8(u),c=l.readU8(u+1)|h<<8;i.y0=0!=(32768&c)?c-65536:c;var d=t.data,_=n+6;null==_&&(_=0);var f=d.readU8(_),p=d.readU8(_+1)|f<<8;i.x1=0!=(32768&p)?p-65536:p;var g=t.data,m=n+8;null==m&&(m=0);var v=g.readU8(m),b=g.readU8(m+1)|v<<8;return i.y1=0!=(32768&b)?b-65536:b,!0},Be.stbtt_GetCodepointBox=function(t,e,i){return Be.stbtt_GetGlyphBox(t,Be.stbtt_FindGlyphIndex(t,e),i)},Be.stbtt_IsGlyphEmpty=function(t,e){var i=Be.stbtt__GetGlyfOffset(t,e);if(i<0)return!0;var n=t.data,r=i;null==r&&(r=0);var s=n.readU8(r),a=n.readU8(r+1)|s<<8;return 0==(0!=(32768&a)?a-65536:a)},Be.stbtt__close_shape=function(t,e,i,n,r,s,a,o,l,u){return n?(i&&Be.stbtt_setvertex(t[e++],3,l+a>>1,u+o>>1,l,u),Be.stbtt_setvertex(t[e++],3,r,s,a,o)):i?Be.stbtt_setvertex(t[e++],3,r,s,l,u):Be.stbtt_setvertex(t[e++],2,r,s,0,0),e},Be.copyVertices=function(t,e,i,n){for(var r=0,s=n;r<s;){var a=r++;e[i+a]=t[a]}},Be.stbtt_GetGlyphShape=function(t,e){var i=t.data,n=null,r=0,s=Be.stbtt__GetGlyfOffset(t,e);if(s<0)return null;var a=s;null==a&&(a=0);var o=i.readU8(a),l=i.readU8(a+1)|o<<8,u=0!=(32768&l)?l-65536:l;if(0<u){var h,c=0,d=0,_=0,f=!1,p=!1,g=s+10,m=g+2*u;null==m&&(m=0);var v=i.readU8(m),b=g+2*u+2+(i.readU8(m+1)|v<<8),w=g+2*u-2;null==w&&(w=0);var y=i.readU8(w),x=1+(i.readU8(w+1)|y<<8),T=x+2*u;if(null==(n=new Array(T)))return null;for(var S=0,k=n.length;S<k;){n[S++]=new Se}var I=_=0;h=T-x;for(var E=0,C=x;E<C;){var B=E++;0==I?0!=(8&(c=i.readU8(b++)))&&(I=i.readU8(b++)):--I,n[h+B].type=c}for(var N=0,L=0,F=x;L<F;){var A=L++;if(0!=(2&(c=n[h+A].type))){var M=i.readU8(b++);N+=0!=(16&c)?M:-M}else if(0==(16&c)){var O=i.readU8(b),P=i.readU8(b+1)|O<<8;N+=0!=(32768&P)?P-65536:P,b+=2}n[h+A].x=N}for(var R=0,V=0,D=x;V<D;){var U=V++;if(0!=(4&(c=n[h+U].type))){var H=i.readU8(b++);R+=0!=(32&c)?H:-H}else if(0==(32&c)){var W=i.readU8(b),G=i.readU8(b+1)|W<<8;R+=0!=(32768&G)?G-65536:G,b+=2}n[h+U].y=R}for(var z=r=0,X=z,K=X,Y=K,Z=Y,j=Z,q=0;q<x;){if(c=n[h+q].type,N=n[h+q].x,R=n[h+q].y,_==q){0!=q&&(r=Be.stbtt__close_shape(n,r,f,p,j,Z,X,z,Y,K)),(p=0==(1&c))?(X=N,z=R,0==(1&n[h+q+1].type)?(j=N+n[h+q+1].x>>1,Z=R+n[h+q+1].y>>1):(j=n[h+q+1].x,Z=n[h+q+1].y,++q)):(j=N,Z=R),Be.stbtt_setvertex(n[r++],1,j,Z,0,0),f=!1;var Q=g+2*d;null==Q&&(Q=0);var J=i.readU8(Q);_=1+(i.readU8(Q+1)|J<<8),++d}else f=0==(1&c)?(f&&Be.stbtt_setvertex(n[r++],3,Y+N>>1,K+R>>1,Y,K),Y=N,K=R,!0):(f?Be.stbtt_setvertex(n[r++],3,N,R,Y,K):Be.stbtt_setvertex(n[r++],2,N,R,0,0),!1);++q}r=Be.stbtt__close_shape(n,r,f,p,j,Z,X,z,Y,K)}else if(-1==u){var $=1,tt=s+10;for(r=0,n=null;0!=$;){var et,it,nt=null,rt=1,st=0,at=0,ot=1,lt=0,ut=0,ht=tt;null==ht&&(ht=0);var ct=i.readU8(ht),dt=i.readU8(ht+1)|ct<<8,_t=0!=(32768&dt)?dt-65536:dt,ft=tt+=2;null==ft&&(ft=0);var pt=i.readU8(ft),gt=i.readU8(ft+1)|pt<<8,mt=0!=(32768&gt)?gt-65536:gt;if(tt+=2,0==(2&_t))throw new ge("Error");if(0!=(1&_t)){var vt=tt;null==vt&&(vt=0);var bt=i.readU8(vt),wt=i.readU8(vt+1)|bt<<8;lt=0!=(32768&wt)?wt-65536:wt;var yt=tt+=2;null==yt&&(yt=0);var xt=i.readU8(yt),Tt=i.readU8(yt+1)|xt<<8;ut=0!=(32768&Tt)?Tt-65536:Tt,tt+=2}else{var St=tt;null==St&&(St=0);var kt=i.readU8(St);lt=128<=kt?kt-256:kt;var It=++tt;null==It&&(It=0);var Et=i.readU8(It);ut=128<=Et?Et-256:Et,++tt}if(0!=(8&_t)){var Ct=tt;null==Ct&&(Ct=0);var Bt=i.readU8(Ct),Nt=i.readU8(Ct+1)|Bt<<8;rt=ot=(0!=(32768&Nt)?Nt-65536:Nt)/16384,tt+=2,st=at=0}else if(0!=(64&_t)){var Lt=tt;null==Lt&&(Lt=0);var Ft=i.readU8(Lt),At=i.readU8(Lt+1)|Ft<<8;rt=(0!=(32768&At)?At-65536:At)/16384,st=at=0;var Mt=tt+=2;null==Mt&&(Mt=0);var Ot=i.readU8(Mt),Pt=i.readU8(Mt+1)|Ot<<8;ot=(0!=(32768&Pt)?Pt-65536:Pt)/16384,tt+=2}else if(0!=(128&_t)){var Rt=tt;null==Rt&&(Rt=0);var Vt=i.readU8(Rt),Dt=i.readU8(Rt+1)|Vt<<8;rt=(0!=(32768&Dt)?Dt-65536:Dt)/16384;var Ut=tt+=2;null==Ut&&(Ut=0);var Ht=i.readU8(Ut),Wt=i.readU8(Ut+1)|Ht<<8;st=(0!=(32768&Wt)?Wt-65536:Wt)/16384;var Gt=tt+=2;null==Gt&&(Gt=0);var zt=i.readU8(Gt),Xt=i.readU8(Gt+1)|zt<<8;at=(0!=(32768&Xt)?Xt-65536:Xt)/16384;var Kt=tt+=2;null==Kt&&(Kt=0);var Yt=i.readU8(Kt),Zt=i.readU8(Kt+1)|Yt<<8;ot=(0!=(32768&Zt)?Zt-65536:Zt)/16384,tt+=2}var jt=Math.sqrt(rt*rt+st*st),qt=Math.sqrt(at*at+ot*ot);if(0<(et=null==(it=Be.stbtt_GetGlyphShape(t,mt))?0:it.length)){for(var Qt=0,Jt=et;Qt<Jt;){var $t=it[Qt++],te=$t.x,ee=$t.y;$t.x=jt*(rt*te+at*ee+lt)|0,$t.y=qt*(st*te+ot*ee+ut)|0,te=$t.cx,ee=$t.cy,$t.cx=jt*(rt*te+at*ee+lt)|0,$t.cy=qt*(st*te+ot*ee+ut)|0}if(null==(nt=new Array(r+et)))return null;0<r&&Be.copyVertices(n,nt,0,r),Be.copyVertices(it,nt,r,et),n=nt,r+=et}$=32&_t}}else if(u<0)throw new ge("Error");if(null==n)return null;if(n.length<r)throw new ge("Error");if(r<n.length){var ie=new Array(r);return Be.copyVertices(n,ie,0,r),ie}return n},Be.stbtt_GetGlyphHMetrics=function(t,e){var i=t.data,n=t.hhea+34;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=new Jt;if(e<s){var o=t.data,l=t.hmtx+4*e;null==l&&(l=0);var u=o.readU8(l),h=o.readU8(l+1)|u<<8;a.advanceWidth=0!=(32768&h)?h-65536:h;var c=t.data,d=t.hmtx+4*e+2;null==d&&(d=0);var _=c.readU8(d),f=c.readU8(d+1)|_<<8;a.leftSideBearing=0!=(32768&f)?f-65536:f}else{var p=t.data,g=t.hmtx+4*(s-1);null==g&&(g=0);var m=p.readU8(g),v=p.readU8(g+1)|m<<8;a.advanceWidth=0!=(32768&v)?v-65536:v;var b=t.data,w=t.hmtx+4*s+2*(e-s);null==w&&(w=0);var y=b.readU8(w),x=b.readU8(w+1)|y<<8;a.leftSideBearing=0!=(32768&x)?x-65536:x}return a},Be.stbtt_GetGlyphKernAdvance=function(t,e,i){var n,r,s=t.kern,a=t.data;if(0==t.kern)return 0;var o=s+2;null==o&&(o=0);var l=a.readU8(o);if((a.readU8(o+1)|l<<8)<1)return 0;var u=s+8;null==u&&(u=0);var h=a.readU8(u);if(1!=(a.readU8(u+1)|h<<8))return 0;var c=0,d=s+10;null==d&&(d=0);for(var _=a.readU8(d),f=(a.readU8(d+1)|_<<8)-1,p=e<<16|i;c<=f;){var g=s+18+6*(r=c+f>>1);null==g&&(g=0);var m=g;null==m&&(m=0);var v=a.readU8(m),b=a.readU8(m+1),w=a.readU8(m+2);if(p<(n=a.readU8(m+3)|w<<8|b<<16|v<<24))f=r-1;else{if(!(n<p)){var y=s+22+6*r;null==y&&(y=0);var x=a.readU8(y),T=a.readU8(y+1)|x<<8;return 0!=(32768&T)?T-65536:T}c=1+r}}return 0},Be.stbtt_GetCodepointKernAdvance=function(t,e,i){return 0==t.kern?0:Be.stbtt_GetGlyphKernAdvance(t,Be.stbtt_FindGlyphIndex(t,e),Be.stbtt_FindGlyphIndex(t,i))},Be.stbtt_GetCodepointHMetrics=function(t,e){return Be.stbtt_GetGlyphHMetrics(t,Be.stbtt_FindGlyphIndex(t,e))},Be.stbtt_GetFontVMetrics=function(t){var e=new $t,i=t.data,n=t.hhea+4;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.ascent=0!=(32768&s)?s-65536:s;var a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.descent=0!=(32768&u)?u-65536:u;var h=t.data,c=t.hhea+8;null==c&&(c=0);var d=h.readU8(c),_=h.readU8(c+1)|d<<8;return e.lineGap=0!=(32768&_)?_-65536:_,e},Be.stbtt_GetFontBoundingBox=function(t){var e=new Qt,i=t.data,n=t.head+36;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.x0=0!=(32768&s)?s-65536:s;var a=t.data,o=t.head+38;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.y0=0!=(32768&u)?u-65536:u;var h=t.data,c=t.head+40;null==c&&(c=0);var d=h.readU8(c),_=h.readU8(c+1)|d<<8;e.x1=0!=(32768&_)?_-65536:_;var f=t.data,p=t.head+42;null==p&&(p=0);var g=f.readU8(p),m=f.readU8(p+1)|g<<8;return e.y1=0!=(32768&m)?m-65536:m,e},Be.stbtt_ScaleForPixelHeight=function(t,e){var i=t.data,n=t.hhea+4;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;return e/((0!=(32768&s)?s-65536:s)-(0!=(32768&u)?u-65536:u))},Be.stbtt_ScaleForMappingEmToPixels=function(t,e){var i=t.data,n=t.head+18;null==n&&(n=0);var r=i.readU8(n);return e/(i.readU8(n+1)|r<<8)},Be.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,n,r,s){var a=new Qt;if(Be.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,u=a.y0,h=a.y1;a.x0=Math.floor(o*i+r),a.y0=Math.floor(-h*n+s),a.x1=Math.ceil(l*i+r),a.y1=Math.ceil(-u*n+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},Be.stbtt_GetGlyphBitmapBox=function(t,e,i,n){return Be.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,n,0,0)},Be.stbtt_GetCodepointBitmapBoxSubpixel=function(t,e,i,n,r,s){return Be.stbtt_GetGlyphBitmapBoxSubpixel(t,Be.stbtt_FindGlyphIndex(t,e),i,n,r,s)},Be.stbtt_GetCodepointBitmapBox=function(t,e,i,n){return Be.stbtt_GetCodepointBitmapBoxSubpixel(t,e,i,n,0,0)},Be.stbtt__new_active=function(t,e,i,n){var r=new Ee,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==r||(r.fdx=s,r.fdy=0!=s?1/s:0,r.fx=t[e].x0+s*(n-t[e].y0),r.fx-=i,r.direction=t[e].invert?1:-1,r.sy=t[e].y0,r.ey=t[e].y1,r.next=null),r},Be.stbtt__handle_clipped_edge=function(t,e,i,n,r,s,a,o){if(s!=o){if(!(s<o))throw new ge("Error");if(!(n.sy<=n.ey))throw new ge("Error");if(!(s>n.ey||o<n.sy)){if(s<n.sy&&(r+=(a-r)*(n.sy-s)/(o-s),s=n.sy),o>n.ey&&(a+=(a-r)*(n.ey-o)/(o-s),o=n.ey),r==i){if(!(a<=i+1))throw new ge("Error")}else if(r==i+1){if(!(i<=a))throw new ge("Error")}else if(r<=i){if(!(a<=i))throw new ge("Error")}else if(i+1<=r){if(!(i+1<=a))throw new ge("Error")}else if(!(i<=a&&a<=i+1))throw new ge("Error");if(r<=i&&a<=i){var l=e+i;t[l]=t[l]+n.direction*(o-s)}else if(!(i+1<=r&&i+1<=a)){if(!(i<=r&&r<=i+1&&i<=a&&a<=i+1))throw new ge("Error");var u=e+i;t[u]=t[u]+n.direction*(o-s)*(1-(r-i+(a-i))/2)}}}},Be.stbtt__fill_active_edges_new=function(t,e,i,n,r,s){for(var a=s+1;null!=r;){if(!(r.ey>=s))throw new ge("Error");if(0==r.fdx){var o=r.fx;o<n&&(0<=o?(Be.stbtt__handle_clipped_edge(t,0,0|o,r,o,s,o,a),Be.stbtt__handle_clipped_edge(e,i-1,o+1|0,r,o,s,o,a)):Be.stbtt__handle_clipped_edge(e,i-1,0,r,o,s,o,a))}else{var l,u,h,c,d=r.fx,_=r.fdx,f=d+_,p=r.fdy;if(!(r.sy<=a&&r.ey>=s))throw new ge("Error");if(h=r.sy>s?(l=d+_*(r.sy-s),r.sy):(l=d,s),c=r.ey<a?(u=d+_*(r.ey-s),r.ey):(u=f,a),0<=l&&0<=u&&l<n&&u<n)if((0|l)==(0|u)){var g=0|l,m=c-h;if(!(0<=g&&g<n))throw new ge("Error");t[g]=t[g]+r.direction*(1-(l-g+(u-g))/2)*m;var v=i+g;e[v]=e[v]+r.direction*m}else{if(u<l){var b=h=a-(h-s);h=c=a-(c-s),c=b,b=u,u=l,l=b,_=-_,p=-p,b=d,d=f,f=b}var w=0|l,y=0|u,x=(1+w-d)*p+s,T=r.direction,S=T*(x-h);t[w]=t[w]+S*(1-(l-w+(1+w-w))/2);for(var k=T*p,I=1+w,E=y;I<E;){var C=I++;t[C]=t[C]+(S+k/2),S+=k}if(x+=p*(y-(1+w)),!(Math.abs(S)<=1.01))throw new ge("Error");t[y]=t[y]+(S+T*(1-(y-y+(u-y))/2)*(c-x));var B=i+y;e[B]=e[B]+T*(c-h)}else for(var N=0,L=n;N<L;){var F=N++,A=s,M=F,O=1+F,P=f,R=a,V=(F-d)/_+s,D=(1+F-d)/_+s;d<M&&O<P?(Be.stbtt__handle_clipped_edge(t,0,F,r,d,A,M,V),Be.stbtt__handle_clipped_edge(t,0,F,r,M,V,O,D),Be.stbtt__handle_clipped_edge(t,0,F,r,O,D,P,R)):P<M&&O<d?(Be.stbtt__handle_clipped_edge(t,0,F,r,d,A,O,D),Be.stbtt__handle_clipped_edge(t,0,F,r,O,D,M,V),Be.stbtt__handle_clipped_edge(t,0,F,r,M,V,P,R)):d<M&&M<P||P<M&&M<d?(Be.stbtt__handle_clipped_edge(t,0,F,r,d,A,M,V),Be.stbtt__handle_clipped_edge(t,0,F,r,M,V,P,R)):d<O&&O<P||P<O&&O<d?(Be.stbtt__handle_clipped_edge(t,0,F,r,d,A,O,D),Be.stbtt__handle_clipped_edge(t,0,F,r,O,D,P,R)):Be.stbtt__handle_clipped_edge(t,0,F,r,d,A,P,R)}}r=r.next}},Be.stbtt__rasterize_sorted_edges=function(t,e,i,n,r,s){var a,o,l=null,u=0,h=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var c=a;o=t.w;var d=s;for(e[h+i].y0=s+t.h+1;u<t.h;){for(var _=d+0,f=d+1,p=l,g=null,m=0,v=t.w;m<v;){a[m++]=0}for(var b=0,w=t.w+1;b<w;){c[o+b++]=0}for(;null!=p;){var y=p;if(y.ey<=_){if(p=(null==g?l=y.next:g.next=y.next,y.next),0==y.direction)throw new ge("Error");y.direction=0}else p=(g=p).next}for(;e[h].y0<=f;){if(e[h].y0!=e[h].y1){var x=Be.stbtt__new_active(e,h,r,_);if(!(x.ey>=_))throw new ge("Error");x.next=l,l=x}++h}null!=l&&Be.stbtt__fill_active_edges_new(a,c,o+1,t.w,l,_);for(var T=0,S=0,k=t.w;S<k;){var I=S++;T+=c[o+I];var E=a[I]+T,C=0|(E=255*Math.abs(E)+.5);255<C&&(C=255),t.pixels.writeU8(t.pixels_offset+u*t.stride+I,C)}for(g=null,p=l;null!=p;){p.fx+=p.fdx,p=(g=p).next}++d,++u}},Be.STBTT__COMPARE=function(t,e){return t.y0<e.y0},Be.stbtt__sort_edges_ins_sort=function(t,e){for(var i,n=1,r=e;n<r;){var s=n++,a=t[s],o=a;for(i=s;0<i;){var l=t[i-1];if(!Be.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}s!=i&&(t[i]=a)}},Be.stbtt__sort_edges_quicksort=function(t,e,i){for(;12<i;){var n,r=i>>1,s=Be.STBTT__COMPARE(t[e],t[e+r]),a=Be.STBTT__COMPARE(t[e+r],t[e+i-1]);if(s!=a){var o=Be.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;n=t[e+o],t[e+o]=t[e+r],t[e+r]=n}n=t[e],t[e]=t[e+r],t[e+r]=n;for(var l=1,u=i-1;;){for(;Be.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;Be.STBTT__COMPARE(t[e],t[e+u]);)--u;if(u<=l)break;n=t[e+l],t[e+l]=t[e+u],t[e+u]=n,++l,--u}u<i-l?(Be.stbtt__sort_edges_quicksort(t,e,u),e+=l,i-=l):(Be.stbtt__sort_edges_quicksort(t,e+l,i-l),i=u)}},Be.stbtt__sort_edges=function(t,e){Be.stbtt__sort_edges_quicksort(t,0,e),Be.stbtt__sort_edges_ins_sort(t,e)},Be.stbtt__rasterize=function(t,e,i,n,r,s,a,o,l,u,h){for(var c,d=h?-s:s,_=0,f=0,p=n;f<p;){_+=i[f++]}var g=new Array(_+1);if(null!=g){for(var m=0,v=g.length;m<v;){g[m++]=new Ie}for(var b=_=0,w=0,y=n;w<y;){var x=w++,T=e,S=0+b;b+=i[x],c=i[x]-1;for(var k=0,I=i[x];k<I;){var E=k++,C=E,B=c;T[S+c].y!=T[S+E].y?(g[_].invert=!1,(h?T[S+c].y>T[S+E].y:T[S+c].y<T[S+E].y)&&(g[_].invert=!0,C=c,B=E),g[_].x0=T[S+C].x*r+a,g[_].y0=+(T[S+C].y*d+o),g[_].x1=T[S+B].x*r+a,g[_].y1=+(T[S+B].y*d+o),++_,c=E):c=E}}Be.stbtt__sort_edges(g,_),Be.stbtt__rasterize_sorted_edges(t,g,_,1,l,u)}},Be.stbtt__add_point=function(t,e,i,n){null!=t&&(t[e].x=i,t[e].y=n)},Be.stbtt__tesselate_curve=function(t,e,i,n,r,s,a,o,l,u){var h=(i+2*r+a)/4,c=(n+2*s+o)/4,d=(i+a)/2-h,_=(n+o)/2-c;return 16<u||(l<d*d+_*_?(Be.stbtt__tesselate_curve(t,e,i,n,(i+r)/2,(n+s)/2,h,c,l,u+1),Be.stbtt__tesselate_curve(t,e,h,c,(r+a)/2,(s+o)/2,a,o,l,u+1)):(Be.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},Be.stbtt_FlattenCurves=function(t,e,i,n,r){for(var s=null,a=0,o=i*i,l=0,u=0,h=0,c=e;h<c;){1==t[h++].type&&++l}if(0==(r.value=l))return null;var d=new Array(l);if(n.value=d,null==n.value)return r.value=0,null;for(var _=0;_<2;){var f=0,p=0;if(1==_++){if(null==(s=new Array(a)))return n.value=null,r.value=0,null;for(var g=0,m=s.length;g<m;){s[g++]=new Ce}}l=-1;for(var v=a=0,b=e;v<b;){var w=v++;switch(t[w].type){case 1:0<=l&&(n.value[l]=a-u),++l,u=a,f=t[w].x,p=t[w].y,Be.stbtt__add_point(s,a++,f,p);break;case 2:f=t[w].x,p=t[w].y,Be.stbtt__add_point(s,a++,f,p);break;case 3:var y={value:a};Be.stbtt__tesselate_curve(s,y,f,p,t[w].cx,t[w].cy,t[w].x,t[w].y,o,0),a=y.value,f=t[w].x,p=t[w].y}}n.value[l]=a-u}return s},Be.stbtt_Rasterize=function(t,e,i,n,r,s,a,o,l,u,h){var c,d=s<r?s:r,_=0,f={value:_},p=new qt,g=Be.stbtt_FlattenCurves(i,n,e/d,p,f);_=f.value,c=p.value,null!=g&&Be.stbtt__rasterize(t,g,c,_,r,s,a,o,l,u,h)},Be.stbtt_GetGlyphBitmapSubpixel=function(t,e,i,n,r,s,a){var o=new ke,l=Be.stbtt_GetGlyphShape(t,s),u=l.length;if(0==e&&(e=i),0==i){if(0==e)return null;i=e}var h=Be.stbtt_GetGlyphBitmapBoxSubpixel(t,s,e,i,n,r),c=h.x0,d=h.y0,_=h.x1,f=h.y1;return o.w=_-c,o.h=f-d,o.pixels=null,a.width=o.w,a.height=o.h,a.xoff=c,a.yoff=d,0!=o.w&&0!=o.h&&(o.pixels=oi.alloc(o.w*o.h),null!=o.pixels&&(o.stride=o.w,Be.stbtt_Rasterize(o,.35,l,u,e,i,n,r,c,d,!0))),o.pixels},Be.stbtt_GetGlyphBitmap=function(t,e,i,n,r){return Be.stbtt_GetGlyphBitmapSubpixel(t,e,i,0,0,n,r)},Be.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,u,h){var c,d,_=Be.stbtt_GetGlyphShape(t,h),f=null==_?0:_.length,p=new ke,g=Be.stbtt_GetGlyphBitmapBoxSubpixel(t,h,a,o,l,u);c=g.x0,d=g.y0,p.pixels=e,p.pixels_offset=i,p.w=n,p.h=r,p.stride=s,0!=p.w&&0!=p.h&&Be.stbtt_Rasterize(p,.35,_,f,a,o,l,u,c,d,!0)},Be.stbtt_MakeGlyphBitmap=function(t,e,i,n,r,s,a,o,l){Be.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},Be.stbtt_GetCodepointBitmapSubpixel=function(t,e,i,n,r,s,a){return Be.stbtt_GetGlyphBitmapSubpixel(t,e,i,n,r,Be.stbtt_FindGlyphIndex(t,s),a)},Be.stbtt_MakeCodepointBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,u,h){Be.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,l,u,Be.stbtt_FindGlyphIndex(t,h))},Be.stbtt_GetCodepointBitmap=function(t,e,i,n,r){return Be.stbtt_GetCodepointBitmapSubpixel(t,e,i,0,0,n,r)},Be.stbtt_MakeCodepointBitmap=function(t,e,i,n,r,s,a,o,l){Be.stbtt_MakeCodepointBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},Be.stbtt_BakeFontBitmap=function(t,e,i,n,r,s,a,o){var l=new Te;if(!Be.stbtt_InitFont(l,t,e))return-1;for(var u=1,h=u,c=1,d=Be.stbtt_ScaleForPixelHeight(l,i),_=0,f=0;f<a.length;){var p=a[f];++f;var g=Be.stbtt_FindGlyphIndex(l,p),m=Be.stbtt_GetGlyphHMetrics(l,g),v=m.advanceWidth,b=(m.leftSideBearing,Be.stbtt_GetGlyphBitmapBox(l,g,d,d)),w=b.x0,y=b.y0,x=b.x1-w,T=b.y1-y;if(r<=h+x+1&&(u=c,h=1),s<=u+T+1)return-_;if(r<=h+x)throw new ge("Error");if(s<=u+T)throw new ge("Error");o[_].x0=h,o[_].y0=u,o[_].x1=h+x,o[_].y1=u+T,o[_].xadvance=d*v,o[_].xoff=w,o[_].yoff=y,h=h+x+1,c<u+T+1&&(c=u+T+1),++_}for(var S,k=0,I=r*s;k<I;){var E=k++;n.writeU8(E,0)}for(var C=_=0;C<a.length;){var B=a[C];++C;var N=Be.stbtt_FindGlyphIndex(l,B);S=o[_],Be.stbtt_MakeGlyphBitmap(l,n,S.x0+S.y0*r,S.x1-S.x0,S.y1-S.y0,r,d,d,N),++_}return c},Be.stbtt_GetBakedQuad=function(t,e,i,n,r,s,a,o){var l=o?0:-.5,u=1/e,h=1/i,c=t[n],d=Math.floor(r.value+c.xoff+.5),_=Math.floor(s.value+c.yoff+.5);a.x0=d+l,a.y0=_+l,a.x1=d+c.x1-c.x0+l,a.y1=_+c.y1-c.y0+l,a.s0=c.x0*u,a.t0=c.y0*h,a.s1=c.x1*u,a.t1=c.y1*h,r.value+=c.xadvance};function Ne(){}(T["kha.graphics4.ConstantLocation"]=Ne).__name__=!0,Ne.__isInterface__=!0;function Le(t){this.texture_=t}(T["kha.graphics4.CubeMap"]=Le).__name__=!0,Le.__interfaces__=[O,w],Le.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 3:return 4;case 4:return 1;default:return 0}},Le.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},Le.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},Le.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;default:return 1}},Le.createRenderTarget=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var r=new Le(null);return r.format=e,r.renderTarget_=Krom.createRenderTargetCubeMap(t,Le.getDepthBufferBits(i),Le.getRenderTargetFormat(e),Le.getStencilBufferBits(i),n),r},Le.prototype={texture_:null,renderTarget_:null,format:null,graphics4:null,unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new li(this)),this.graphics4},__class__:Le,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var Fe=function(t,e){null!=t&&(this.shader=Krom.createFragmentShader(t[0].bytes.b.bufferValue,e[0]))};(T["kha.graphics4.FragmentShader"]=Fe).__name__=!0,Fe.fromSource=function(t){var e=new Fe(null,null);return e.shader=Krom.createFragmentShaderFromSource(t),e},Fe.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Fe};function Ae(t,e){this.shader=Krom.createGeometryShader(t[0].bytes.b.bufferValue,e[0])}(T["kha.graphics4.GeometryShader"]=Ae).__name__=!0,Ae.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ae};function Me(){}(T["kha.graphics4.Graphics"]=Me).__name__=!0,Me.__isInterface__=!0,Me.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setTextureCompareMode:null,setCubeMapCompareMode:null,setCubeMap:null,setCubeMapDepth:null,maxBoundTextures:null,setStencilReferenceValue:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setInt2:null,setInt3:null,setInt4:null,setInts:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:Me};function Oe(t){this.pipeline=t;try{this.projectionLocation=t.getConstantLocation("projectionMatrix")}catch(t){L.trace(t instanceof ge?t.val:t,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:39,className:"kha.graphics4.PipelineCache",methodName:"new"})}try{this.textureLocation=t.getTextureUnit("tex")}catch(t){L.trace(t instanceof ge?t.val:t,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:40,className:"kha.graphics4.PipelineCache",methodName:"new"})}}(T["kha.graphics4.PipelineCache"]=Oe).__name__=!0,Oe.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:Oe};var Pe=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Pe.bufferIndex=0,Pe.initShaders(),this.myPipeline=Pe.standardImagePipeline,this.initBuffers()};(T["kha.graphics4.ImageShaderPainter"]=Pe).__name__=!0,Pe.initShaders=function(){if(null==Pe.structure&&(Pe.structure=De.createImageVertexStructure()),null==Pe.standardImagePipeline){var t=De.createImagePipeline(Pe.structure);t.compile(),Pe.standardImagePipeline=new Oe(t)}},Pe.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Pe.standardImagePipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Pe.rectVertexBuffer){Pe.rectVertexBuffer=new Ye(6e3,Pe.structure,1),Pe.rectVertices=Pe.rectVertexBuffer.lock(),Pe.indexBuffer=new Ue(9e3,0);for(var t=Pe.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Pe.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Pe.bufferIndex*4;Pe.rectVertices[l]=t,Pe.rectVertices[1+l]=e,Pe.rectVertices[2+l]=-5,Pe.rectVertices[9+l]=i,Pe.rectVertices[10+l]=n,Pe.rectVertices[11+l]=-5,Pe.rectVertices[18+l]=r,Pe.rectVertices[19+l]=s,Pe.rectVertices[20+l]=-5,Pe.rectVertices[27+l]=a,Pe.rectVertices[28+l]=o,Pe.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Pe.bufferIndex*4;Pe.rectVertices[3+r]=t,Pe.rectVertices[4+r]=n,Pe.rectVertices[12+r]=t,Pe.rectVertices[13+r]=e,Pe.rectVertices[21+r]=i,Pe.rectVertices[22+r]=e,Pe.rectVertices[30+r]=i,Pe.rectVertices[31+r]=n},setRectColor:function(t,e,i,n){var r=9*Pe.bufferIndex*4;Pe.rectVertices[5+r]=t,Pe.rectVertices[6+r]=e,Pe.rectVertices[7+r]=i,Pe.rectVertices[8+r]=n,Pe.rectVertices[14+r]=t,Pe.rectVertices[15+r]=e,Pe.rectVertices[16+r]=i,Pe.rectVertices[17+r]=n,Pe.rectVertices[23+r]=t,Pe.rectVertices[24+r]=e,Pe.rectVertices[25+r]=i,Pe.rectVertices[26+r]=n,Pe.rectVertices[32+r]=t,Pe.rectVertices[33+r]=e,Pe.rectVertices[34+r]=i,Pe.rectVertices[35+r]=n},drawBuffer:function(){Pe.rectVertexBuffer.unlock(4*Pe.bufferIndex),this.g.setPipeline(this.myPipeline.pipeline),this.g.setVertexBuffer(Pe.rectVertexBuffer),this.g.setIndexBuffer(Pe.indexBuffer),this.g.setTexture(this.myPipeline.textureLocation,Pe.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Pe.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Pe.bufferIndex=0,Pe.rectVertices=Pe.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setBilinearMipmapFilter:function(t){this.end(),this.bilinearMipmaps=t},drawImage:function(t,e,i,n,r,s,a,o,l,u,h){var c=t;(1500<=Pe.bufferIndex+1||null!=Pe.lastTexture&&c!=Pe.lastTexture)&&this.drawBuffer();var d=.00392156862745098*((16711680&h)>>>16),_=.00392156862745098*((65280&h)>>>8),f=.00392156862745098*(255&h),p=.00392156862745098*(h>>>24)*u,g=9*Pe.bufferIndex*4;Pe.rectVertices[5+g]=d,Pe.rectVertices[6+g]=_,Pe.rectVertices[7+g]=f,Pe.rectVertices[8+g]=p,Pe.rectVertices[14+g]=d,Pe.rectVertices[15+g]=_,Pe.rectVertices[16+g]=f,Pe.rectVertices[17+g]=p,Pe.rectVertices[23+g]=d,Pe.rectVertices[24+g]=_,Pe.rectVertices[25+g]=f,Pe.rectVertices[26+g]=p,Pe.rectVertices[32+g]=d,Pe.rectVertices[33+g]=_,Pe.rectVertices[34+g]=f,Pe.rectVertices[35+g]=p;var m=c.get_width()/c.get_realWidth(),v=c.get_height()/c.get_realHeight(),b=9*Pe.bufferIndex*4;Pe.rectVertices[3+b]=0,Pe.rectVertices[4+b]=v,Pe.rectVertices[12+b]=0,Pe.rectVertices[13+b]=0,Pe.rectVertices[21+b]=m,Pe.rectVertices[22+b]=0,Pe.rectVertices[30+b]=m,Pe.rectVertices[31+b]=v;var w=9*Pe.bufferIndex*4;Pe.rectVertices[w]=e,Pe.rectVertices[1+w]=i,Pe.rectVertices[2+w]=-5,Pe.rectVertices[9+w]=n,Pe.rectVertices[10+w]=r,Pe.rectVertices[11+w]=-5,Pe.rectVertices[18+w]=s,Pe.rectVertices[19+w]=a,Pe.rectVertices[20+w]=-5,Pe.rectVertices[27+w]=o,Pe.rectVertices[28+w]=l,Pe.rectVertices[29+w]=-5,++Pe.bufferIndex,Pe.lastTexture=c},drawImage2:function(t,e,i,n,r,s,a,o,l,u,h,c,d,_,f){var p=t;(1500<=Pe.bufferIndex+1||null!=Pe.lastTexture&&p!=Pe.lastTexture)&&this.drawBuffer();var g=e/p.get_realWidth(),m=i/p.get_realHeight(),v=(e+n)/p.get_realWidth(),b=(i+r)/p.get_realHeight(),w=9*Pe.bufferIndex*4;Pe.rectVertices[3+w]=g,Pe.rectVertices[4+w]=b,Pe.rectVertices[12+w]=g,Pe.rectVertices[13+w]=m,Pe.rectVertices[21+w]=v,Pe.rectVertices[22+w]=m,Pe.rectVertices[30+w]=v,Pe.rectVertices[31+w]=b;var y=.00392156862745098*((16711680&f)>>>16),x=.00392156862745098*((65280&f)>>>8),T=.00392156862745098*(255&f),S=.00392156862745098*(f>>>24)*_,k=9*Pe.bufferIndex*4;Pe.rectVertices[5+k]=y,Pe.rectVertices[6+k]=x,Pe.rectVertices[7+k]=T,Pe.rectVertices[8+k]=S,Pe.rectVertices[14+k]=y,Pe.rectVertices[15+k]=x,Pe.rectVertices[16+k]=T,Pe.rectVertices[17+k]=S,Pe.rectVertices[23+k]=y,Pe.rectVertices[24+k]=x,Pe.rectVertices[25+k]=T,Pe.rectVertices[26+k]=S,Pe.rectVertices[32+k]=y,Pe.rectVertices[33+k]=x,Pe.rectVertices[34+k]=T,Pe.rectVertices[35+k]=S;var I=9*Pe.bufferIndex*4;Pe.rectVertices[I]=s,Pe.rectVertices[1+I]=a,Pe.rectVertices[2+I]=-5,Pe.rectVertices[9+I]=o,Pe.rectVertices[10+I]=l,Pe.rectVertices[11+I]=-5,Pe.rectVertices[18+I]=u,Pe.rectVertices[19+I]=h,Pe.rectVertices[20+I]=-5,Pe.rectVertices[27+I]=c,Pe.rectVertices[28+I]=d,Pe.rectVertices[29+I]=-5,++Pe.bufferIndex,Pe.lastTexture=p},drawImageScale:function(t,e,i,n,r,s,a,o,l,u,h){var c=t;(1500<=Pe.bufferIndex+1||null!=Pe.lastTexture&&c!=Pe.lastTexture)&&this.drawBuffer();var d=e/c.get_realWidth(),_=i/c.get_realHeight(),f=(e+n)/c.get_realWidth(),p=(i+r)/c.get_realHeight(),g=9*Pe.bufferIndex*4;Pe.rectVertices[3+g]=d,Pe.rectVertices[4+g]=p,Pe.rectVertices[12+g]=d,Pe.rectVertices[13+g]=_,Pe.rectVertices[21+g]=f,Pe.rectVertices[22+g]=_,Pe.rectVertices[30+g]=f,Pe.rectVertices[31+g]=p;var m=.00392156862745098*((16711680&h)>>>16),v=.00392156862745098*((65280&h)>>>8),b=.00392156862745098*(255&h),w=9*Pe.bufferIndex*4;Pe.rectVertices[5+w]=m,Pe.rectVertices[6+w]=v,Pe.rectVertices[7+w]=b,Pe.rectVertices[8+w]=u,Pe.rectVertices[14+w]=m,Pe.rectVertices[15+w]=v,Pe.rectVertices[16+w]=b,Pe.rectVertices[17+w]=u,Pe.rectVertices[23+w]=m,Pe.rectVertices[24+w]=v,Pe.rectVertices[25+w]=b,Pe.rectVertices[26+w]=u,Pe.rectVertices[32+w]=m,Pe.rectVertices[33+w]=v,Pe.rectVertices[34+w]=b,Pe.rectVertices[35+w]=u;var y=9*Pe.bufferIndex*4;Pe.rectVertices[y]=s,Pe.rectVertices[1+y]=l,Pe.rectVertices[2+y]=-5,Pe.rectVertices[9+y]=s,Pe.rectVertices[10+y]=a,Pe.rectVertices[11+y]=-5,Pe.rectVertices[18+y]=o,Pe.rectVertices[19+y]=a,Pe.rectVertices[20+y]=-5,Pe.rectVertices[27+y]=o,Pe.rectVertices[28+y]=l,Pe.rectVertices[29+y]=-5,++Pe.bufferIndex,Pe.lastTexture=c},end:function(){0<Pe.bufferIndex&&this.drawBuffer(),Pe.lastTexture=null},__class__:Pe,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Re=function(t){this.myPipeline=null,this.g=t,Re.bufferIndex=0,Re.triangleBufferIndex=0,Re.initShaders(),this.myPipeline=Re.standardColorPipeline,this.initBuffers()};(T["kha.graphics4.ColoredShaderPainter"]=Re).__name__=!0,Re.initShaders=function(){if(null==Re.structure&&(Re.structure=De.createColoredVertexStructure()),null==Re.standardColorPipeline){var t=De.createColoredPipeline(Re.structure);t.compile(),Re.standardColorPipeline=new Oe(t)}},Re.prototype={projectionMatrix:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Re.standardColorPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Re.rectVertexBuffer){Re.rectVertexBuffer=new Ye(4e3,Re.structure,1),Re.rectVertices=Re.rectVertexBuffer.lock(),Re.indexBuffer=new Ue(6e3,0);for(var t=Re.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Re.indexBuffer.unlock(),Re.triangleVertexBuffer=new Ye(3e3,Re.structure,1),Re.triangleVertices=Re.triangleVertexBuffer.lock(),Re.triangleIndexBuffer=new Ue(3e3,0);for(var n=Re.triangleIndexBuffer.lock(),r=0;r<1e3;){var s=r++;n[3*s]=3*s,n[3*s+1]=3*s+1,n[3*s+2]=3*s+2}Re.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=7*Re.bufferIndex*4;Re.rectVertices[l]=t,Re.rectVertices[1+l]=e,Re.rectVertices[2+l]=-5,Re.rectVertices[7+l]=i,Re.rectVertices[8+l]=n,Re.rectVertices[9+l]=-5,Re.rectVertices[14+l]=r,Re.rectVertices[15+l]=s,Re.rectVertices[16+l]=-5,Re.rectVertices[21+l]=a,Re.rectVertices[22+l]=o,Re.rectVertices[23+l]=-5},setRectColors:function(t,e){var i=7*Re.bufferIndex*4,n=t*(.00392156862745098*(e>>>24)),r=.00392156862745098*((16711680&e)>>>16)*n,s=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Re.rectVertices[3+i]=r,Re.rectVertices[4+i]=s,Re.rectVertices[5+i]=a,Re.rectVertices[6+i]=n,Re.rectVertices[10+i]=r,Re.rectVertices[11+i]=s,Re.rectVertices[12+i]=a,Re.rectVertices[13+i]=n,Re.rectVertices[17+i]=r,Re.rectVertices[18+i]=s,Re.rectVertices[19+i]=a,Re.rectVertices[20+i]=n,Re.rectVertices[24+i]=r,Re.rectVertices[25+i]=s,Re.rectVertices[26+i]=a,Re.rectVertices[27+i]=n},setTriVertices:function(t,e,i,n,r,s){var a=7*Re.triangleBufferIndex*3;Re.triangleVertices[a]=t,Re.triangleVertices[1+a]=e,Re.triangleVertices[2+a]=-5,Re.triangleVertices[7+a]=i,Re.triangleVertices[8+a]=n,Re.triangleVertices[9+a]=-5,Re.triangleVertices[14+a]=r,Re.triangleVertices[15+a]=s,Re.triangleVertices[16+a]=-5},setTriColors:function(t,e){var i=7*Re.triangleBufferIndex*3,n=t*(.00392156862745098*(e>>>24)),r=.00392156862745098*((16711680&e)>>>16)*n,s=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Re.triangleVertices[3+i]=r,Re.triangleVertices[4+i]=s,Re.triangleVertices[5+i]=a,Re.triangleVertices[6+i]=n,Re.triangleVertices[10+i]=r,Re.triangleVertices[11+i]=s,Re.triangleVertices[12+i]=a,Re.triangleVertices[13+i]=n,Re.triangleVertices[17+i]=r,Re.triangleVertices[18+i]=s,Re.triangleVertices[19+i]=a,Re.triangleVertices[20+i]=n},drawBuffer:function(t){t||0<Re.triangleBufferIndex&&this.drawTriBuffer(!0),Re.rectVertexBuffer.unlock(4*Re.bufferIndex),this.g.setPipeline(this.myPipeline.pipeline),this.g.setVertexBuffer(Re.rectVertexBuffer),this.g.setIndexBuffer(Re.indexBuffer),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Re.bufferIndex*3),Re.bufferIndex=0,Re.rectVertices=Re.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||0<Re.bufferIndex&&this.drawBuffer(!0),Re.triangleVertexBuffer.unlock(3*Re.triangleBufferIndex),this.g.setPipeline(this.myPipeline.pipeline),this.g.setVertexBuffer(Re.triangleVertexBuffer),this.g.setIndexBuffer(Re.triangleIndexBuffer),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Re.triangleBufferIndex),Re.triangleBufferIndex=0,Re.triangleVertices=Re.triangleVertexBuffer.lock()},fillRect:function(t,e,i,n,r,s,a,o,l,u){0<Re.triangleBufferIndex&&this.drawTriBuffer(!0),1e3<=Re.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,n,r,s,a,o,l,u),++Re.bufferIndex},fillTriangle:function(t,e,i,n,r,s,a,o){0<Re.bufferIndex&&this.drawBuffer(!0),1e3<=Re.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,n,r,s,a,o),++Re.triangleBufferIndex},endTris:function(t){0<Re.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<Re.bufferIndex&&this.drawBuffer(t)},end:function(){0<Re.triangleBufferIndex&&this.drawTriBuffer(!1),0<Re.bufferIndex&&this.drawBuffer(!1)},__class__:Re,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ve=function(t){this.bakedQuadCache=new R,this.bilinear=!1,this.myPipeline=null,this.g=t,Ve.bufferIndex=0,Ve.initShaders(),this.myPipeline=Ve.standardTextPipeline,this.initBuffers()};(T["kha.graphics4.TextShaderPainter"]=Ve).__name__=!0,Ve.initShaders=function(){if(null==Ve.structure&&(Ve.structure=De.createTextVertexStructure()),null==Ve.standardTextPipeline){var t=De.createTextPipeline(Ve.structure);t.compile(),Ve.standardTextPipeline=new Oe(t)}},Ve.findIndex=function(t){Zt.fontGlyphs;for(var e=V.charBlocks,i=0,n=0,r=e.length/2|0;n<r;){var s=n++,a=e[2*s],o=e[2*s+1];if(a<=t&&t<=o)return i+t-a;i+=o-a+1}return 0},Ve.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Ve.standardTextPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ve.rectVertexBuffer){Ve.rectVertexBuffer=new Ye(4e3,Ve.structure,1),Ve.rectVertices=Ve.rectVertexBuffer.lock(),Ve.indexBuffer=new Ue(6e3,0);for(var t=Ve.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ve.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Ve.bufferIndex*4;Ve.rectVertices[l]=t,Ve.rectVertices[1+l]=e,Ve.rectVertices[2+l]=-5,Ve.rectVertices[9+l]=i,Ve.rectVertices[10+l]=n,Ve.rectVertices[11+l]=-5,Ve.rectVertices[18+l]=r,Ve.rectVertices[19+l]=s,Ve.rectVertices[20+l]=-5,Ve.rectVertices[27+l]=a,Ve.rectVertices[28+l]=o,Ve.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Ve.bufferIndex*4;Ve.rectVertices[3+r]=t,Ve.rectVertices[4+r]=n,Ve.rectVertices[12+r]=t,Ve.rectVertices[13+r]=e,Ve.rectVertices[21+r]=i,Ve.rectVertices[22+r]=e,Ve.rectVertices[30+r]=i,Ve.rectVertices[31+r]=n},setRectColors:function(t,e){var i=9*Ve.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Ve.rectVertices[5+i]=.00392156862745098*((16711680&e)>>>16),Ve.rectVertices[6+i]=.00392156862745098*((65280&e)>>>8),Ve.rectVertices[7+i]=.00392156862745098*(255&e),Ve.rectVertices[8+i]=n,Ve.rectVertices[14+i]=.00392156862745098*((16711680&e)>>>16),Ve.rectVertices[15+i]=.00392156862745098*((65280&e)>>>8),Ve.rectVertices[16+i]=.00392156862745098*(255&e),Ve.rectVertices[17+i]=n,Ve.rectVertices[23+i]=.00392156862745098*((16711680&e)>>>16),Ve.rectVertices[24+i]=.00392156862745098*((65280&e)>>>8),Ve.rectVertices[25+i]=.00392156862745098*(255&e),Ve.rectVertices[26+i]=n,Ve.rectVertices[32+i]=.00392156862745098*((16711680&e)>>>16),Ve.rectVertices[33+i]=.00392156862745098*((65280&e)>>>8),Ve.rectVertices[34+i]=.00392156862745098*(255&e),Ve.rectVertices[35+i]=n},drawBuffer:function(){Ve.rectVertexBuffer.unlock(4*Ve.bufferIndex),this.g.setPipeline(this.myPipeline.pipeline),this.g.setVertexBuffer(Ve.rectVertexBuffer),this.g.setIndexBuffer(Ve.indexBuffer),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTexture(this.myPipeline.textureLocation,Ve.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Ve.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Ve.bufferIndex=0,Ve.rectVertices=Ve.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=g.__cast(t,D)},bakedQuadCache:null,drawString:function(t,e,i,n,r,s){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Ve.lastTexture&&o!=Ve.lastTexture&&this.drawBuffer(),Ve.lastTexture=o;for(var l=n,u=r,h=0,c=t.length;h<c;){var d=h++,_=t.charCodeAt(d),f=a.getBakedQuad(this.bakedQuadCache,Ve.findIndex(_),l,u);if(null!=f){1e3<=Ve.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(f.s0*o.get_width()/o.get_realWidth(),f.t0*o.get_height()/o.get_realHeight(),f.s1*o.get_width()/o.get_realWidth(),f.t1*o.get_height()/o.get_realHeight());var p=f.x0,g=f.y1;null==g&&(g=0),null==p&&(p=0);var m=s._02*p+s._12*g+s._22,v=(s._00*p+s._10*g+s._20)/m,b=(s._01*p+s._11*g+s._21)/m;null==b&&(b=0),null==v&&(v=0);var w=v,y=b,x=f.x0,T=f.y0;null==T&&(T=0),null==x&&(x=0);var S=s._02*x+s._12*T+s._22,k=(s._00*x+s._10*T+s._20)/S,I=(s._01*x+s._11*T+s._21)/S;null==I&&(I=0),null==k&&(k=0);var E=k,C=I,B=f.x1,N=f.y0;null==N&&(N=0),null==B&&(B=0);var L=s._02*B+s._12*N+s._22,F=(s._00*B+s._10*N+s._20)/L,A=(s._01*B+s._11*N+s._21)/L;null==A&&(A=0),null==F&&(F=0);var M=F,O=A,P=f.x1,R=f.y1;null==R&&(R=0),null==P&&(P=0);var V=s._02*P+s._12*R+s._22,D=(s._00*P+s._10*R+s._20)/V,U=(s._01*P+s._11*R+s._21)/V;null==U&&(U=0),null==D&&(D=0);var H=D,W=U;this.setRectVertices(w,y,E,C,M,O,H,W),l+=f.xadvance,++Ve.bufferIndex}}},drawCharacters:function(t,e,i,n,r,s,a,o){var l=this.font._get(this.fontSize),u=l.getTexture();null!=Ve.lastTexture&&u!=Ve.lastTexture&&this.drawBuffer(),Ve.lastTexture=u;for(var h=s,c=a,d=e,_=e+i;d<_;){var f=d++,p=l.getBakedQuad(this.bakedQuadCache,Ve.findIndex(t[f]),h,c);if(null!=p){1e3<=Ve.bufferIndex+1&&this.drawBuffer(),this.setRectColors(n,r),this.setRectTexCoords(p.s0*u.get_width()/u.get_realWidth(),p.t0*u.get_height()/u.get_realHeight(),p.s1*u.get_width()/u.get_realWidth(),p.t1*u.get_height()/u.get_realHeight());var g=p.x0,m=p.y1;null==m&&(m=0),null==g&&(g=0);var v=o._02*g+o._12*m+o._22,b=(o._00*g+o._10*m+o._20)/v,w=(o._01*g+o._11*m+o._21)/v;null==w&&(w=0),null==b&&(b=0);var y=b,x=w,T=p.x0,S=p.y0;null==S&&(S=0),null==T&&(T=0);var k=o._02*T+o._12*S+o._22,I=(o._00*T+o._10*S+o._20)/k,E=(o._01*T+o._11*S+o._21)/k;null==E&&(E=0),null==I&&(I=0);var C=I,B=E,N=p.x1,L=p.y0;null==L&&(L=0),null==N&&(N=0);var F=o._02*N+o._12*L+o._22,A=(o._00*N+o._10*L+o._20)/F,M=(o._01*N+o._11*L+o._21)/F;null==M&&(M=0),null==A&&(A=0);var O=A,P=M,R=p.x1,V=p.y1;null==V&&(V=0),null==R&&(R=0);var D=o._02*R+o._12*V+o._22,U=(o._00*R+o._10*V+o._20)/D,H=(o._01*R+o._11*V+o._21)/D;null==H&&(H=0),null==U&&(U=0);var W=U,G=H;this.setRectVertices(y,x,C,B,O,P,W,G),h+=p.xadvance,++Ve.bufferIndex}}},end:function(){0<Ve.bufferIndex&&this.drawBuffer(),Ve.lastTexture=null},__class__:Ve,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var De=function(t){this.scissorH=-1,this.scissorW=-1,this.scissorY=-1,this.scissorX=-1,this.scissorEnabled=!1,this.lastPipeline=null,this.pipelineCache=new et,this.myMipmapScaleQuality=0,this.myImageScaleQuality=0,Zt.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Pe(this.g),this.coloredPainter=new Re(this.g),this.textPainter=new Ve(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new ci(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==De.videoPipeline&&(De.videoPipeline=De.createImagePipeline(De.createImageVertexStructure()),De.videoPipeline.fragmentShader=z.painter_video_frag,De.videoPipeline.vertexShader=z.painter_video_vert,De.videoPipeline.compile())};(T["kha.graphics4.Graphics2"]=De).__name__=!0,De.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},De.createImageVertexStructure=function(){var t=new qe;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},De.createImagePipeline=function(t){var e=new We;return e.fragmentShader=z.painter_image_frag,e.vertexShader=z.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},De.createColoredVertexStructure=function(){var t=new qe;return t.add("vertexPosition",2),t.add("vertexColor",3),t},De.createColoredPipeline=function(t){var e=new We;return e.fragmentShader=z.painter_colored_frag,e.vertexShader=z.painter_colored_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},De.createTextVertexStructure=function(){var t=new qe;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},De.createTextPipeline=function(t){var e=new We;return e.fragmentShader=z.painter_text_frag,e.vertexShader=z.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},De.__super__=Zt,De.prototype=r(Zt.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof A){var i=this.projectionMatrix,n=2/t,r=-t/t,s=2/(0-e),a=-e/(0-e);i._00=n,i._10=0,i._20=0,i._30=r,i._01=0,i._11=s,i._21=0,i._31=a,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if(P.get_nonPow2Supported()||(t=De.upperPowerOfTwo(t),e=De.upperPowerOfTwo(e)),P.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/t,u=-t/t,h=2/e,c=-e/e;o._00=l,o._10=0,o._20=0,o._30=u,o._01=0,o._11=h,o._21=0,o._31=c,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var d=this.projectionMatrix,_=2/t,f=-t/t,p=2/(0-e),g=-e/(0-e);d._00=_,d._10=0,d._20=0,d._30=f,d._01=0,d._11=p,d._21=0,d._31=g,d._02=0,d._12=0,d._22=-.002000200020002,d._32=-1.0002000200020003,d._03=0,d._13=0,d._23=0,d._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){var n=this.coloredPainter;0<Re.triangleBufferIndex&&n.drawTriBuffer(!1),0<Re.bufferIndex&&n.drawBuffer(!1),this.textPainter.end();var r=e+t.get_width(),s=i+t.get_height(),a=this.transformations[this.transformationIndex],o=e,l=s;null==l&&(l=0),null==o&&(o=0);var u=a._02*o+a._12*l+a._22,h=(a._00*o+a._10*l+a._20)/u,c=(a._01*o+a._11*l+a._21)/u;null==c&&(c=0),null==h&&(h=0);var d=h,_=c,f=this.transformations[this.transformationIndex],p=e,g=i;null==g&&(g=0),null==p&&(p=0);var m=f._02*p+f._12*g+f._22,v=(f._00*p+f._10*g+f._20)/m,b=(f._01*p+f._11*g+f._21)/m;null==b&&(b=0),null==v&&(v=0);var w=v,y=b,x=this.transformations[this.transformationIndex],T=r,S=i;null==S&&(S=0),null==T&&(T=0);var k=x._02*T+x._12*S+x._22,I=(x._00*T+x._10*S+x._20)/k,E=(x._01*T+x._11*S+x._21)/k;null==E&&(E=0),null==I&&(I=0);var C=I,B=E,N=this.transformations[this.transformationIndex],L=r,F=s;null==F&&(F=0),null==L&&(L=0);var A=N._02*L+N._12*F+N._22,M=(N._00*L+N._10*F+N._20)/A,O=(N._01*L+N._11*F+N._21)/A;null==O&&(O=0),null==M&&(M=0);var P=M,R=O,V=this.imagePainter,D=this.get_opacity(),U=this.get_color(),H=t;(1500<=Pe.bufferIndex+1||null!=Pe.lastTexture&&H!=Pe.lastTexture)&&V.drawBuffer();var W=.00392156862745098*((16711680&U)>>>16),G=.00392156862745098*((65280&U)>>>8),z=.00392156862745098*(255&U),X=.00392156862745098*(U>>>24)*D,K=9*Pe.bufferIndex*4;Pe.rectVertices[5+K]=W,Pe.rectVertices[6+K]=G,Pe.rectVertices[7+K]=z,Pe.rectVertices[8+K]=X,Pe.rectVertices[14+K]=W,Pe.rectVertices[15+K]=G,Pe.rectVertices[16+K]=z,Pe.rectVertices[17+K]=X,Pe.rectVertices[23+K]=W,Pe.rectVertices[24+K]=G,Pe.rectVertices[25+K]=z,Pe.rectVertices[26+K]=X,Pe.rectVertices[32+K]=W,Pe.rectVertices[33+K]=G,Pe.rectVertices[34+K]=z,Pe.rectVertices[35+K]=X;var Y=H.get_width()/H.get_realWidth(),Z=H.get_height()/H.get_realHeight(),j=9*Pe.bufferIndex*4;Pe.rectVertices[3+j]=0,Pe.rectVertices[4+j]=Z,Pe.rectVertices[12+j]=0,Pe.rectVertices[13+j]=0,Pe.rectVertices[21+j]=Y,Pe.rectVertices[22+j]=0,Pe.rectVertices[30+j]=Y,Pe.rectVertices[31+j]=Z;var q=9*Pe.bufferIndex*4;Pe.rectVertices[q]=d,Pe.rectVertices[1+q]=_,Pe.rectVertices[2+q]=-5,Pe.rectVertices[9+q]=w,Pe.rectVertices[10+q]=y,Pe.rectVertices[11+q]=-5,Pe.rectVertices[18+q]=C,Pe.rectVertices[19+q]=B,Pe.rectVertices[20+q]=-5,Pe.rectVertices[27+q]=P,Pe.rectVertices[28+q]=R,Pe.rectVertices[29+q]=-5,++Pe.bufferIndex,Pe.lastTexture=H},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){var u=this.coloredPainter;0<Re.triangleBufferIndex&&u.drawTriBuffer(!1),0<Re.bufferIndex&&u.drawBuffer(!1),this.textPainter.end();var h=this.transformations[this.transformationIndex],c=s,d=a+l;null==d&&(d=0),null==c&&(c=0);var _=h._02*c+h._12*d+h._22,f=(h._00*c+h._10*d+h._20)/_,p=(h._01*c+h._11*d+h._21)/_;null==p&&(p=0),null==f&&(f=0);var g=f,m=p,v=this.transformations[this.transformationIndex],b=s,w=a;null==w&&(w=0),null==b&&(b=0);var y=v._02*b+v._12*w+v._22,x=(v._00*b+v._10*w+v._20)/y,T=(v._01*b+v._11*w+v._21)/y;null==T&&(T=0),null==x&&(x=0);var S=x,k=T,I=this.transformations[this.transformationIndex],E=s+o,C=a;null==C&&(C=0),null==E&&(E=0);var B=I._02*E+I._12*C+I._22,N=(I._00*E+I._10*C+I._20)/B,L=(I._01*E+I._11*C+I._21)/B;null==L&&(L=0),null==N&&(N=0);var F=N,A=L,M=this.transformations[this.transformationIndex],O=s+o,P=a+l;null==P&&(P=0),null==O&&(O=0);var R=M._02*O+M._12*P+M._22,V=(M._00*O+M._10*P+M._20)/R,D=(M._01*O+M._11*P+M._21)/R;null==D&&(D=0),null==V&&(V=0);var U=V,H=D,W=this.imagePainter,G=this.get_opacity(),z=this.get_color(),X=t;(1500<=Pe.bufferIndex+1||null!=Pe.lastTexture&&X!=Pe.lastTexture)&&W.drawBuffer();var K=e/X.get_realWidth(),Y=i/X.get_realHeight(),Z=(e+n)/X.get_realWidth(),j=(i+r)/X.get_realHeight(),q=9*Pe.bufferIndex*4;Pe.rectVertices[3+q]=K,Pe.rectVertices[4+q]=j,Pe.rectVertices[12+q]=K,Pe.rectVertices[13+q]=Y,Pe.rectVertices[21+q]=Z,Pe.rectVertices[22+q]=Y,Pe.rectVertices[30+q]=Z,Pe.rectVertices[31+q]=j;var Q=.00392156862745098*((16711680&z)>>>16),J=.00392156862745098*((65280&z)>>>8),$=.00392156862745098*(255&z),tt=.00392156862745098*(z>>>24)*G,et=9*Pe.bufferIndex*4;Pe.rectVertices[5+et]=Q,Pe.rectVertices[6+et]=J,Pe.rectVertices[7+et]=$,Pe.rectVertices[8+et]=tt,Pe.rectVertices[14+et]=Q,Pe.rectVertices[15+et]=J,Pe.rectVertices[16+et]=$,Pe.rectVertices[17+et]=tt,Pe.rectVertices[23+et]=Q,Pe.rectVertices[24+et]=J,Pe.rectVertices[25+et]=$,Pe.rectVertices[26+et]=tt,Pe.rectVertices[32+et]=Q,Pe.rectVertices[33+et]=J,Pe.rectVertices[34+et]=$,Pe.rectVertices[35+et]=tt;var it=9*Pe.bufferIndex*4;Pe.rectVertices[it]=g,Pe.rectVertices[1+it]=m,Pe.rectVertices[2+it]=-5,Pe.rectVertices[9+it]=S,Pe.rectVertices[10+it]=k,Pe.rectVertices[11+it]=-5,Pe.rectVertices[18+it]=F,Pe.rectVertices[19+it]=A,Pe.rectVertices[20+it]=-5,Pe.rectVertices[27+it]=U,Pe.rectVertices[28+it]=H,Pe.rectVertices[29+it]=-5,++Pe.bufferIndex,Pe.lastTexture=X},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=this.transformations[this.transformationIndex],a=t-r/2,o=e+r/2;null==o&&(o=0),null==a&&(a=0);var l=s._02*a+s._12*o+s._22,u=(s._00*a+s._10*o+s._20)/l,h=(s._01*a+s._11*o+s._21)/l;null==h&&(h=0),null==u&&(u=0);var c=u,d=h,_=this.transformations[this.transformationIndex],f=t-r/2,p=e-r/2;null==p&&(p=0),null==f&&(f=0);var g=_._02*f+_._12*p+_._22,m=(_._00*f+_._10*p+_._20)/g,v=(_._01*f+_._11*p+_._21)/g;null==v&&(v=0),null==m&&(m=0);var b=m,w=v,y=this.transformations[this.transformationIndex],x=t+i+r/2,T=e-r/2;null==T&&(T=0),null==x&&(x=0);var S=y._02*x+y._12*T+y._22,k=(y._00*x+y._10*T+y._20)/S,I=(y._01*x+y._11*T+y._21)/S;null==I&&(I=0),null==k&&(k=0);var E=k,C=I,B=this.transformations[this.transformationIndex],N=t+i+r/2,L=e+r/2;null==L&&(L=0),null==N&&(N=0);var F=B._02*N+B._12*L+B._22,A=(B._00*N+B._10*L+B._20)/F,M=(B._01*N+B._11*L+B._21)/F;null==M&&(M=0),null==A&&(A=0);var O=A,P=M;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,d,b,w,E,C,O,P);var R=this.transformations[this.transformationIndex],V=t-r/2,D=e+n-r/2;null==D&&(D=0),null==V&&(V=0);var U=R._02*V+R._12*D+R._22,H=(R._00*V+R._10*D+R._20)/U,W=(R._01*V+R._11*D+R._21)/U;null==W&&(W=0),null==H&&(H=0),c=H,d=W;var G=this.transformations[this.transformationIndex],z=t-r/2,X=e+r/2;null==X&&(X=0),null==z&&(z=0);var K=G._02*z+G._12*X+G._22,Y=(G._00*z+G._10*X+G._20)/K,Z=(G._01*z+G._11*X+G._21)/K;null==Z&&(Z=0),null==Y&&(Y=0),b=Y,w=Z;var j=this.transformations[this.transformationIndex],q=t+r/2,Q=e+r/2;null==Q&&(Q=0),null==q&&(q=0);var J=j._02*q+j._12*Q+j._22,$=(j._00*q+j._10*Q+j._20)/J,tt=(j._01*q+j._11*Q+j._21)/J;null==tt&&(tt=0),null==$&&($=0),E=$,C=tt;var et=this.transformations[this.transformationIndex],it=t+r/2,nt=e+n-r/2;null==nt&&(nt=0),null==it&&(it=0);var rt=et._02*it+et._12*nt+et._22,st=(et._00*it+et._10*nt+et._20)/rt,at=(et._01*it+et._11*nt+et._21)/rt;null==at&&(at=0),null==st&&(st=0),O=st,P=at,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,d,b,w,E,C,O,P);var ot=this.transformations[this.transformationIndex],lt=t-r/2,ut=e+n+r/2;null==ut&&(ut=0),null==lt&&(lt=0);var ht=ot._02*lt+ot._12*ut+ot._22,ct=(ot._00*lt+ot._10*ut+ot._20)/ht,dt=(ot._01*lt+ot._11*ut+ot._21)/ht;null==dt&&(dt=0),null==ct&&(ct=0),c=ct,d=dt;var _t=this.transformations[this.transformationIndex],ft=t-r/2,pt=e+n-r/2;null==pt&&(pt=0),null==ft&&(ft=0);var gt=_t._02*ft+_t._12*pt+_t._22,mt=(_t._00*ft+_t._10*pt+_t._20)/gt,vt=(_t._01*ft+_t._11*pt+_t._21)/gt;null==vt&&(vt=0),null==mt&&(mt=0),b=mt,w=vt;var bt=this.transformations[this.transformationIndex],wt=t+i+r/2,yt=e+n-r/2;null==yt&&(yt=0),null==wt&&(wt=0);var xt=bt._02*wt+bt._12*yt+bt._22,Tt=(bt._00*wt+bt._10*yt+bt._20)/xt,St=(bt._01*wt+bt._11*yt+bt._21)/xt;null==St&&(St=0),null==Tt&&(Tt=0),E=Tt,C=St;var kt=this.transformations[this.transformationIndex],It=t+i+r/2,Et=e+n+r/2;null==Et&&(Et=0),null==It&&(It=0);var Ct=kt._02*It+kt._12*Et+kt._22,Bt=(kt._00*It+kt._10*Et+kt._20)/Ct,Nt=(kt._01*It+kt._11*Et+kt._21)/Ct;null==Nt&&(Nt=0),null==Bt&&(Bt=0),O=Bt,P=Nt,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,d,b,w,E,C,O,P);var Lt=this.transformations[this.transformationIndex],Ft=t+i-r/2,At=e+n-r/2;null==At&&(At=0),null==Ft&&(Ft=0);var Mt=Lt._02*Ft+Lt._12*At+Lt._22,Ot=(Lt._00*Ft+Lt._10*At+Lt._20)/Mt,Pt=(Lt._01*Ft+Lt._11*At+Lt._21)/Mt;null==Pt&&(Pt=0),null==Ot&&(Ot=0),c=Ot,d=Pt;var Rt=this.transformations[this.transformationIndex],Vt=t+i-r/2,Dt=e+r/2;null==Dt&&(Dt=0),null==Vt&&(Vt=0);var Ut=Rt._02*Vt+Rt._12*Dt+Rt._22,Ht=(Rt._00*Vt+Rt._10*Dt+Rt._20)/Ut,Wt=(Rt._01*Vt+Rt._11*Dt+Rt._21)/Ut;null==Wt&&(Wt=0),null==Ht&&(Ht=0),b=Ht,w=Wt;var Gt=this.transformations[this.transformationIndex],zt=t+i+r/2,Xt=e+r/2;null==Xt&&(Xt=0),null==zt&&(zt=0);var Kt=Gt._02*zt+Gt._12*Xt+Gt._22,Yt=(Gt._00*zt+Gt._10*Xt+Gt._20)/Kt,Zt=(Gt._01*zt+Gt._11*Xt+Gt._21)/Kt;null==Zt&&(Zt=0),null==Yt&&(Yt=0),E=Yt,C=Zt;var jt=this.transformations[this.transformationIndex],qt=t+i+r/2,Qt=e+n-r/2;null==Qt&&(Qt=0),null==qt&&(qt=0);var Jt=jt._02*qt+jt._12*Qt+jt._22,$t=(jt._00*qt+jt._10*Qt+jt._20)/Jt,te=(jt._01*qt+jt._11*Qt+jt._21)/Jt;null==te&&(te=0),null==$t&&($t=0),O=$t,P=te,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,d,b,w,E,C,O,P)},fillRect:function(t,e,i,n){this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformationIndex],s=t,a=e+n;null==a&&(a=0),null==s&&(s=0);var o=r._02*s+r._12*a+r._22,l=(r._00*s+r._10*a+r._20)/o,u=(r._01*s+r._11*a+r._21)/o;null==u&&(u=0),null==l&&(l=0);var h=l,c=u,d=this.transformations[this.transformationIndex],_=t,f=e;null==f&&(f=0),null==_&&(_=0);var p=d._02*_+d._12*f+d._22,g=(d._00*_+d._10*f+d._20)/p,m=(d._01*_+d._11*f+d._21)/p;null==m&&(m=0),null==g&&(g=0);var v=g,b=m,w=this.transformations[this.transformationIndex],y=t+i,x=e;null==x&&(x=0),null==y&&(y=0);var T=w._02*y+w._12*x+w._22,S=(w._00*y+w._10*x+w._20)/T,k=(w._01*y+w._11*x+w._21)/T;null==k&&(k=0),null==S&&(S=0);var I=S,E=k,C=this.transformations[this.transformationIndex],B=t+i,N=e+n;null==N&&(N=0),null==B&&(B=0);var L=C._02*B+C._12*N+C._22,F=(C._00*B+C._10*N+C._20)/L,A=(C._01*B+C._11*N+C._21)/L;null==A&&(A=0),null==F&&(F=0);var M=F,O=A;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,c,v,b,I,E,M,O)},drawString:function(t,e,i){this.imagePainter.end();var n=this.coloredPainter;0<Re.triangleBufferIndex&&n.drawTriBuffer(!1),0<Re.bufferIndex&&n.drawBuffer(!1),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.transformations[this.transformationIndex])},drawCharacters:function(t,e,i,n,r){this.imagePainter.end();var s=this.coloredPainter;0<Re.triangleBufferIndex&&s.drawTriBuffer(!1),0<Re.bufferIndex&&s.drawBuffer(!1),this.textPainter.drawCharacters(t,e,i,this.get_opacity(),this.get_color(),n,r,this.transformations[this.transformationIndex])},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return Zt.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=0,a=0;if(n==e){var o=0,l=-1;null==l&&(l=0),null==o&&(o=0),s=o,a=l}else{var u=1,h=-(i-t)/(n-e);null==h&&(h=0),null==u&&(u=0),s=u,a=h}var c=Math.sqrt(s*s+a*a);if(0!=c){var d=r/c;s*=d,a*=d}var _=t+.5*s,f=e+.5*a;null==f&&(f=0),null==_&&(_=0);var p=_,g=f,m=i+.5*s,v=n+.5*a;null==v&&(v=0),null==m&&(m=0);var b=m,w=v,y=p-s,x=g-a;null==x&&(x=0),null==y&&(y=0);var T=y,S=x,k=b-s,I=w-a;null==I&&(I=0),null==k&&(k=0);var E=k,C=I,B=this.transformations[this.transformationIndex],N=B._02*p+B._12*g+B._22,L=(B._00*p+B._10*g+B._20)/N,F=(B._01*p+B._11*g+B._21)/N;null==F&&(F=0),null==L&&(L=0),p=L,g=F;var A=this.transformations[this.transformationIndex],M=A._02*b+A._12*w+A._22,O=(A._00*b+A._10*w+A._20)/M,P=(A._01*b+A._11*w+A._21)/M;null==P&&(P=0),null==O&&(O=0),b=O,w=P;var R=this.transformations[this.transformationIndex],V=R._02*T+R._12*S+R._22,D=(R._00*T+R._10*S+R._20)/V,U=(R._01*T+R._11*S+R._21)/V;null==U&&(U=0),null==D&&(D=0),T=D,S=U;var H=this.transformations[this.transformationIndex],W=H._02*E+H._12*C+H._22,G=(H._00*E+H._10*C+H._20)/W,z=(H._01*E+H._11*C+H._21)/W;null==z&&(z=0),null==G&&(G=0),E=G,C=z,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),p,g,b,w,T,S),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),T,S,b,w,E,C)},fillTriangle:function(t,e,i,n,r,s){this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],o=t,l=e;null==l&&(l=0),null==o&&(o=0);var u=a._02*o+a._12*l+a._22,h=(a._00*o+a._10*l+a._20)/u,c=(a._01*o+a._11*l+a._21)/u;null==c&&(c=0),null==h&&(h=0);var d=h,_=c,f=this.transformations[this.transformationIndex],p=i,g=n;null==g&&(g=0),null==p&&(p=0);var m=f._02*p+f._12*g+f._22,v=(f._00*p+f._10*g+f._20)/m,b=(f._01*p+f._11*g+f._21)/m;null==b&&(b=0),null==v&&(v=0);var w=v,y=b,x=this.transformations[this.transformationIndex],T=r,S=s;null==S&&(S=0),null==T&&(T=0);var k=x._02*T+x._12*S+x._22,I=(x._00*T+x._10*S+x._20)/k,E=(x._01*T+x._11*S+x._21)/k;null==E&&(E=0),null==I&&(I=0);var C=I,B=E;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),d,_,w,y,C,B)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(t){return t==this.myImageScaleQuality?t:(this.imagePainter.setBilinearFilter(1==t),this.textPainter.setBilinearFilter(1==t),this.myImageScaleQuality=t)},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(t){return this.imagePainter.setBilinearMipmapFilter(1==t),this.myMipmapScaleQuality=t},pipelineCache:null,lastPipeline:null,setPipeline:function(t){if(t!=this.lastPipeline)if(this.lastPipeline=t,this.flush(),null==t)this.imagePainter.set_pipeline(null),this.coloredPainter.set_pipeline(null),this.textPainter.set_pipeline(null);else{var e=this.pipelineCache.h[t.__id__];null==e&&(e=new Oe(t),this.pipelineCache.set(t,e)),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e)}},scissorEnabled:null,scissorX:null,scissorY:null,scissorW:null,scissorH:null,scissor:function(t,e,i,n){this.scissorEnabled=!0,this.scissorX=t,this.scissorY=e,this.scissorW=i,this.scissorH=n,this.flush(),this.g.scissor(t,e,i,n)},disableScissor:function(){this.scissorEnabled=!1,this.flush(),this.g.disableScissor()},begin:function(t,e){if(null==t&&(t=!0),null!=De.current)throw new ge("End before you begin");(De.current=this).g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;0<Re.triangleBufferIndex&&t.drawTriBuffer(!1),0<Re.bufferIndex&&t.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),De.current!=this)throw new ge("Begin before you end");De.current=null},drawVideoInternal:function(t,e,i,n,r){},drawVideo:function(t,e,i,n,r){this.setPipeline(De.videoPipeline),this.drawVideoInternal(t,e,i,n,r),this.setPipeline(null)},__class__:De});var Ue=function(t,e,i){null==i&&(i=!1),this.indexCount=t,this.buffer=Krom.createIndexBuffer(t)};(T["kha.graphics4.IndexBuffer"]=Ue).__name__=!0,Ue.prototype={buffer:null,_data:null,indexCount:null,delete:function(){Krom.deleteIndexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockIndexBuffer(this.buffer),null==t&&(t=0),null==e&&(e=this.indexCount),this._data.subarray(t,t+e)},unlock:function(t){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},count:function(){return this.indexCount},__class__:Ue};function He(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=ze.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1}(T["kha.graphics4.PipelineStateBase"]=He).__name__=!0,He.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,set_colorWriteMask:function(t){var e=this.colorWriteMasksAlpha[0]=t,i=this.colorWriteMasksGreen[0]=e,n=this.colorWriteMasksBlue[0]=i;return this.colorWriteMasksRed[0]=n},get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:He,__properties__:{set_colorWriteMaskAlpha:"set_colorWriteMaskAlpha",get_colorWriteMaskAlpha:"get_colorWriteMaskAlpha",set_colorWriteMaskBlue:"set_colorWriteMaskBlue",get_colorWriteMaskBlue:"get_colorWriteMaskBlue",set_colorWriteMaskGreen:"set_colorWriteMaskGreen",get_colorWriteMaskGreen:"get_colorWriteMaskGreen",set_colorWriteMaskRed:"set_colorWriteMaskRed",get_colorWriteMaskRed:"get_colorWriteMaskRed",set_colorWriteMask:"set_colorWriteMask"}};var We=function(){He.call(this),this.pipeline=Krom.createPipeline()};(T["kha.graphics4.PipelineState"]=We).__name__=!0,We.convertBlendingFactor=function(t){switch(t){case 0:case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5;case 7:return 6;case 8:return 7;case 9:return 8;case 10:return 9}},We.__super__=He,We.prototype=r(He.prototype,{pipeline:null,delete:function(){Krom.deletePipeline(this.pipeline),this.pipeline=null},compile:function(){var t=0<this.inputLayout.length?this.inputLayout[0]:null,e=1<this.inputLayout.length?this.inputLayout[1]:null,i=2<this.inputLayout.length?this.inputLayout[2]:null,n=3<this.inputLayout.length?this.inputLayout[3]:null,r=null!=this.geometryShader?this.geometryShader.shader:null,s=null!=this.tessellationControlShader?this.tessellationControlShader.shader:null,a=null!=this.tessellationEvaluationShader?this.tessellationEvaluationShader.shader:null,o=0,l=this.stencilReferenceValue;1==l._hx_index&&(o=l.value);Krom.compilePipeline(this.pipeline,t,e,i,n,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,r,s,a,{cullMode:this.cullMode,depthWrite:this.depthWrite,depthMode:this.depthMode,stencilMode:this.stencilMode,stencilBothPass:this.stencilBothPass,stencilDepthFail:this.stencilDepthFail,stencilFail:this.stencilFail,stencilReferenceValue:o,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:We.convertBlendingFactor(this.blendSource),blendDestination:We.convertBlendingFactor(this.blendDestination),alphaBlendSource:We.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:We.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(t){return Krom.getConstantLocation(this.pipeline,t)},getTextureUnit:function(t){return Krom.getTextureUnit(this.pipeline,t)},__class__:We});function Ge(t,e){this.shader=Krom.createTessellationControlShader(t[0].bytes.b.bufferValue,e[0])}var ze=p["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:((e=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:i}}).__params__=["value"],e)};(T["kha.graphics4.TessellationControlShader"]=Ge).__name__=!0,Ge.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ge};function Xe(t,e){this.shader=Krom.createTessellationEvaluationShader(t[0].bytes.b.bufferValue,e[0])}(T["kha.graphics4.TessellationEvaluationShader"]=Xe).__name__=!0,Xe.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Xe};function Ke(){}(T["kha.graphics4.TextureUnit"]=Ke).__name__=!0,Ke.__isInterface__=!0;var Ye=function(t,e,i,n,r){null==r&&(r=!1),null==n&&(n=0),this.vertexCount=t,this.structure=e,this.buffer=Krom.createVertexBuffer(t,e.elements,i,n)};(T["kha.graphics4.VertexBuffer"]=Ye).__name__=!0,Ye.prototype={buffer:null,_data:null,vertexCount:null,structure:null,delete:function(){Krom.deleteVertexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},lockInt16:function(t,e){return new Int16Array(this.lock(t,e).buffer)},unlock:function(t){Krom.unlockVertexBuffer(this.buffer)},stride:function(){return this.structure.byteSize()},count:function(){return this.vertexCount},set:function(t){return Krom.setVertexBuffer(this.buffer),0},__class__:Ye};function Ze(t,e){this.name=t,this.data=e}(T["kha.graphics4.VertexElement"]=Ze).__name__=!0,Ze.prototype={name:null,data:null,__class__:Ze};var je=function(t,e){null!=t&&(this.shader=Krom.createVertexShader(t[0].bytes.b.bufferValue,e[0]))};(T["kha.graphics4.VertexShader"]=je).__name__=!0,je.fromSource=function(t){var e=new je(null,null);return e.shader=Krom.createVertexShaderFromSource(t),e},je.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:je};var qe=function(){this.elements=[],this.instanced=!1};(T["kha.graphics4.VertexStructure"]=qe).__name__=!0,qe.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new Ze(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,i=this.elements.length;e<i;){var n=e++;t+=this.dataByteSize(this.elements[n].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64;case 5:return 4;case 6:return 8}},get:function(t){return this.elements[t]},__class__:qe};var Qe=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Qe.instances[t]=this};(T["kha.input.Gamepad"]=Qe).__name__=!0,Qe.get=function(t){return null==t&&(t=0),t>=Qe.instances.length?null:Qe.instances[t]},Qe.notifyOnConnect=function(t,e){null!=t&&Qe.connectListeners.push(t),null!=e&&Qe.disconnectListeners.push(e)},Qe.removeConnect=function(t,e){null!=t&&ne.remove(Qe.connectListeners,t),null!=e&&ne.remove(Qe.disconnectListeners,e)},Qe.sendConnectEvent=function(t){Qe.instances[t].connected=!0;for(var e=0,i=Qe.connectListeners;e<i.length;){var n=i[e];++e,n(t)}},Qe.sendDisconnectEvent=function(t){Qe.instances[t].connected=!1;for(var e=0,i=Qe.disconnectListeners;e<i.length;){var n=i[e];++e,n(t)}},Qe.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},remove:function(t,e){null!=t&&ne.remove(this.axisListeners,t),null!=e&&ne.remove(this.buttonListeners,e)},axisListeners:null,buttonListeners:null,id:null,vendor:null,connected:null,get_id:function(){return Z.getGamepadId(this.index)},get_vendor:function(){return Z.getGamepadVendor(this.index)},sendAxisEvent:function(t,e){for(var i=0,n=this.axisListeners;i<n.length;){var r=n[i];++i,r(t,e)}},sendButtonEvent:function(t,e){for(var i=0,n=this.buttonListeners;i<n.length;){var r=n[i];++i,r(t,e)}},__class__:Qe,__properties__:{get_vendor:"get_vendor",get_id:"get_id"}};function Je(){this.__id=yi.nextId++,this._inputBuffer=new ht(new ArrayBuffer(1))}var $e=p["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:i},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:i},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:i},Custom:((e=function(t){return{_hx_index:3,func:t,__enum__:"kha.input.BlockInterventions",toString:i}}).__params__=["func"],e)};(T["kha.netsync.Controller"]=Je).__name__=!0,Je.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(t){},__class__:Je};var ti=t.kha.input.Keyboard=function(){Je.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],ti.instance=this};(T["kha.input.Keyboard"]=ti).__name__=!0,ti.get=function(t){return null==t&&(t=0),Z.getKeyboard(t)},ti.disableSystemInterventions=function(t){ti.keyBehavior=t},ti.__super__=Je,ti.prototype=r(Je.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},remove:function(t,e,i){null!=t&&ne.remove(this.downListeners,t),null!=e&&ne.remove(this.upListeners,e),null!=i&&ne.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){for(var e=0,i=this.downListeners;e<i.length;){var n=i[e];++e,n(t)}},sendUpEvent:function(t){for(var e=0,i=this.upListeners;e<i.length;){var n=i[e];++e,n(t)}},sendPressEvent:function(t){for(var e=0,i=this.pressListeners;e<i.length;){var n=i[e];++e,n(t)}},_receive:function(t){},__class__:ti});var ei=p["kha.input.MouseEventBlockBehavior"]={__ename__:!0,__constructs__:["Full","None","Custom"],Full:{_hx_index:0,__enum__:"kha.input.MouseEventBlockBehavior",toString:i},None:{_hx_index:1,__enum__:"kha.input.MouseEventBlockBehavior",toString:i},Custom:((e=function(t){return{_hx_index:2,func:t,__enum__:"kha.input.MouseEventBlockBehavior",toString:i}}).__params__=["func"],e)},ii=t.kha.input.Mouse=function(){Je.call(this),ii.instance=this};(T["kha.input.Mouse"]=ii).__name__=!0,ii.get=function(t){return null==t&&(t=0),Z.getMouse(t)},ii.setWheelEventBlockBehavior=function(t){ii.wheelEventBlockBehavior=t},ii.__super__=Je,ii.prototype=r(Je.prototype,{notify:function(t,e,i,n,r){this.notifyWindowed(0,t,e,i,n,r)},remove:function(t,e,i,n,r){this.removeWindowed(0,t,e,i,n,r)},notifyWindowed:function(t,e,i,n,r,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}if(null!=r){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(r)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},removeWindowed:function(t,e,i,n,r,s){null!=e&&(null!=this.windowDownListeners?t<this.windowDownListeners.length?ne.remove(this.windowDownListeners[t],e):L.trace('no downListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:130,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:134,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?t<this.windowUpListeners.length?ne.remove(this.windowUpListeners[t],i):L.trace('no upListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:144,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:148,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowMoveListeners?t<this.windowMoveListeners.length?ne.remove(this.windowMoveListeners[t],n):L.trace('no moveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:158,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:162,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowWheelListeners?t<this.windowWheelListeners.length?ne.remove(this.windowWheelListeners[t],r):L.trace('no wheelListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:172,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:176,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowLeaveListeners?t<this.windowLeaveListeners.length?ne.remove(this.windowLeaveListeners[t],s):L.trace('no leaveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:186,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:190,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(t,e){},removeFromLockChange:function(t,e){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=this.windowLeaveListeners)for(var e=0,i=this.windowLeaveListeners[t];e<i.length;){var n=i[e];++e,n()}},sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n,r){if(null!=this.windowMoveListeners)for(var s=0,a=this.windowMoveListeners[t];s<a.length;){var o=a[s];++s,o(e,i,n,r)}},sendWheelEvent:function(t,e){if(null!=this.windowWheelListeners)for(var i=0,n=this.windowWheelListeners[t];i<n.length;){var r=n[i];++i,r(e)}},_receive:function(t){},__class__:ii});var ni=function(){ii.call(this)};(T["kha.input.MouseImpl"]=ni).__name__=!0,ni.__super__=ii,ni.prototype=r(ii.prototype,{lock:function(){Z.lockMouse()},unlock:function(){Z.unlockMouse()},canLock:function(){return Z.canLockMouse()},isLocked:function(){return Z.isMouseLocked()},notifyOnLockChange:function(t,e){Z.notifyOfMouseLockChange(t,e)},removeFromLockChange:function(t,e){Z.removeFromMouseLockChange(t,e)},hideSystemCursor:function(){Z.hideSystemCursor()},showSystemCursor:function(){Z.showSystemCursor()},_receive:function(t){},__class__:ni});var ri=function(){ri.instance=this};(T["kha.input.Pen"]=ri).__name__=!0,ri.get=function(t){return null==t&&(t=0),Z.getPen(t)},ri.prototype={notify:function(t,e,i){this.notifyWindowed(0,t,e,i)},remove:function(t,e,i){this.removeWindowed(0,t,e,i)},notifyWindowed:function(t,e,i,n){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}},removeWindowed:function(t,e,i,n){null!=e&&null!=this.windowDownListeners&&t<this.windowDownListeners.length&&ne.remove(this.windowDownListeners[t],e),null!=i&&null!=this.windowUpListeners&&t<this.windowUpListeners.length&&ne.remove(this.windowUpListeners[t],i),null!=n&&null!=this.windowMoveListeners&&t<this.windowMoveListeners.length&&ne.remove(this.windowMoveListeners[t],n)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n){if(null!=this.windowMoveListeners)for(var r=0,s=this.windowMoveListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},__class__:ri};var si=p["kha.input.TouchDownEventBlockBehavior"]={__ename__:!0,__constructs__:["Full","None","Custom"],Full:{_hx_index:0,__enum__:"kha.input.TouchDownEventBlockBehavior",toString:i},None:{_hx_index:1,__enum__:"kha.input.TouchDownEventBlockBehavior",toString:i},Custom:((e=function(t){return{_hx_index:2,func:t,__enum__:"kha.input.TouchDownEventBlockBehavior",toString:i}}).__params__=["func"],e)},ai=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],ai.instance=this};(T["kha.input.Surface"]=ai).__name__=!0,ai.get=function(t){return null==t&&(t=0),0!=t?null:ai.instance},ai.setTouchDownEventBlockBehavior=function(t){ai.touchDownEventBlockBehavior=t},ai.prototype={notify:function(t,e,i){null!=t&&this.touchStartListeners.push(t),null!=e&&this.touchEndListeners.push(e),null!=i&&this.moveListeners.push(i)},remove:function(t,e,i){null!=t&&ne.remove(this.touchStartListeners,t),null!=e&&ne.remove(this.touchEndListeners,e),null!=i&&ne.remove(this.moveListeners,i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,i){for(var n=0,r=this.touchStartListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var n=0,r=this.touchEndListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendMoveEvent:function(t,e,i){for(var n=0,r=this.moveListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},__class__:ai};var oi=function(t){this.bytes=t};(T["kha.internal.BytesBlob"]=oi).__name__=!0,oi.__interfaces__=[O],oi.fromBytes=function(t){return new oi(t)},oi.alloc=function(t){return new oi(new ht(new ArrayBuffer(t)))},oi.readF32=function(t){var e=0==(-2147483648&t)?1:-1,i=t>>23&255,n=8388607&t;switch(i){case 0:return 0;case 255:return 0!=n?NaN:0<e?1/0:-1/0;default:return(8388608+n)/8388608*e*Math.pow(2,i-127)}},oi.bit=function(t,e){if(1==(t>>>e&1)){return!0}return!1},oi.toText=function(t,e){for(var i="",n=0,r=e;n<r;){var s=n++;i+=String.fromCodePoint(t[s])}return i},oi.prototype={bytes:null,sub:function(t,e){return new oi(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=e},readU8:function(t){var e=this.bytes.b[t];return++t,e},readS8:function(t){var e=this.bytes.b[t];return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*e+i},readU16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*i+e},readU32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,e+256*i+256*n*256+256*r*256*256},readU32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,r+256*n+256*i*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];t+=2;var n=0==(128&e)?1:-1;return e&=127,-1==n?256*e-32767+i:256*e+i},readS16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=0==(128&i)?1:-1;return i&=127,t+=2,-1==n?256*i-32767+e:256*i+e},readS32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&r)?1:-1;return r&=127,t+=4,-1==s?-2147483647+e+256*i+256*n*256+256*r*256*256:e+256*i+256*n*256+256*r*256*256},readS32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&e)?1:-1;return e&=127,t+=4,-1==s?-2147483647+r+256*n+256*i*256+256*e*256*256:r+256*n+256*i*256+256*e*256*256},readF32LE:function(t){return oi.readF32(this.readS32LE(t))},readF32BE:function(t){return oi.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8String:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:oi,__properties__:{get_length:"get_length"}};var li=function(t){this.renderTarget=t};(T["kha.krom.Graphics"]=li).__name__=!0,li.__interfaces__=[Me],li.prototype={renderTarget:null,begin:function(t){Krom.begin(this.renderTarget,t)},beginFace:function(t){Krom.beginFace(this.renderTarget,t)},beginEye:function(t){},end:function(){Krom.end()},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(t,e,i){var n=0;null!=t&&(n|=1),null!=e&&(n|=2),null!=i&&(n|=4),Krom.clear(n,null==t?0:t,e,i)},viewport:function(t,e,i,n){Krom.viewport(t,e,i,n)},setVertexBuffer:function(t){t.set(0)},setVertexBuffers:function(t){Krom.setVertexBuffers(t)},setIndexBuffer:function(t){t.set()},setCubeMap:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setCubeMapDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTexture:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setTextureDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTextureArray:function(t,e){},setVideoTexture:function(t,e){},setImageTexture:function(t,e){null!=e&&Krom.setImageTexture(t,e.texture_)},setTextureParameters:function(t,e,i,n,r,s){Krom.setTextureParameters(t,e,i,n,r,s)},setTexture3DParameters:function(t,e,i,n,r,s,a){Krom.setTexture3DParameters(t,e,i,n,r,s,a)},setTextureCompareMode:function(t,e){Krom.setTextureCompareMode(t,e)},setCubeMapCompareMode:function(t,e){Krom.setCubeMapCompareMode(t,e)},maxBoundTextures:function(){return 8},setPipeline:function(t){t.set()},setStencilReferenceValue:function(t){},setBool:function(t,e){Krom.setBool(t,e)},setInt:function(t,e){Krom.setInt(t,e)},setInt2:function(t,e,i){},setInt3:function(t,e,i,n){},setInt4:function(t,e,i,n,r){},setInts:function(t,e){},setFloat:function(t,e){Krom.setFloat(t,e)},setFloat2:function(t,e,i){Krom.setFloat2(t,e,i)},setFloat3:function(t,e,i,n){Krom.setFloat3(t,e,i,n)},setFloat4:function(t,e,i,n,r){Krom.setFloat4(t,e,i,n,r)},setFloats:function(t,e){Krom.setFloats(t,e.buffer)},setVector2:function(t,e){Krom.setFloat2(t,e.x,e.y)},setVector3:function(t,e){Krom.setFloat3(t,e.x,e.y,e.z)},setVector4:function(t,e){Krom.setFloat4(t,e.x,e.y,e.z,e.w)},setMatrix:function(t,e){li.mat[0]=e._00,li.mat[1]=e._01,li.mat[2]=e._02,li.mat[3]=e._03,li.mat[4]=e._10,li.mat[5]=e._11,li.mat[6]=e._12,li.mat[7]=e._13,li.mat[8]=e._20,li.mat[9]=e._21,li.mat[10]=e._22,li.mat[11]=e._23,li.mat[12]=e._30,li.mat[13]=e._31,li.mat[14]=e._32,li.mat[15]=e._33,Krom.setMatrix(t,li.mat.buffer)},setMatrix3:function(t,e){li.mat[0]=e._00,li.mat[1]=e._01,li.mat[2]=e._02,li.mat[3]=e._10,li.mat[4]=e._11,li.mat[5]=e._12,li.mat[6]=e._20,li.mat[7]=e._21,li.mat[8]=e._22,Krom.setMatrix3(t,li.mat.buffer)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0),Krom.drawIndexedVertices(t,e)},drawIndexedVerticesInstanced:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),Krom.drawIndexedVerticesInstanced(t,e,i)},instancedRenderingAvailable:function(){return!0},scissor:function(t,e,i,n){Krom.scissor(t,e,i,n)},disableScissor:function(){Krom.disableScissor()},__class__:li};var ui=function(t){K.call(this),this.sampleRate=44100;var e=t.length/4|0,i=new Float32Array(e);this.uncompressedData=i;for(var n=0,r=e;n<r;){var s=n++;this.uncompressedData[s]=t.getFloat(4*s)}this.compressedData=null};(T["kha.krom.Sound"]=ui).__name__=!0,ui.__super__=K,ui.prototype=r(K.prototype,{uncompress:function(t){t()},unload:function(){K.prototype.unload.call(this)},__class__:ui});var hi=function(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};(T["kha.math.FastMatrix3"]=hi).__name__=!0,hi.fromMatrix3=function(t){return new hi(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},hi.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:hi};var ci=function(t,e,i,n,r,s,a,o,l,u,h,c,d,_,f,p){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=c,this._03=d,this._13=_,this._23=f,this._33=p};(T["kha.math.FastMatrix4"]=ci).__name__=!0,ci.fromMatrix4=function(t){return new ci(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ci.orthogonalProjection=function(t,e,i,n,r,s){return new ci(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},ci.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new ci(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ci.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z;null==s&&(s=0),null==r&&(r=0),null==n&&(n=0);var a=n,o=r,l=s;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,c=l,d=Math.sqrt(u*u+h*h+c*c);if(0!=d){var _=1/d;u*=_,h*=_,c*=_}var f=h*i.z-c*i.y,p=c*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==p&&(p=0),null==f&&(f=0);var m=f,v=p,b=g;null==b&&(b=0),null==v&&(v=0),null==m&&(m=0);var w=m,y=v,x=b,T=Math.sqrt(w*w+y*y+x*x);if(0!=T){var S=1/T;w*=S,y*=S,x*=S}var k=y*c-x*h,I=x*u-w*c,E=w*h-y*u;null==E&&(E=0),null==I&&(I=0),null==k&&(k=0);return new ci(w,y,x,-(w*t.x+y*t.y+x*t.z),k,I,E,-(k*t.x+I*t.y+E*t.z),-u,-h,-c,u*t.x+h*t.y+c*t.z,0,0,0,1)},ci.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ci};function di(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e}(T["kha.math.FastVector2"]=di).__name__=!0,di.fromVector2=function(t){return new di(t.x,t.y)},di.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:di,__properties__:{set_length:"set_length",get_length:"get_length"}};function _i(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(T["kha.math.FastVector3"]=_i).__name__=!0,_i.fromVector3=function(t){return new _i(t.x,t.y,t.z)},_i.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:_i,__properties__:{set_length:"set_length",get_length:"get_length"}};function fi(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(T["kha.math.FastVector4"]=fi).__name__=!0,fi.fromVector4=function(t){return new fi(t.x,t.y,t.z,t.w)},fi.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:fi,__properties__:{set_length:"set_length",get_length:"get_length"}};function pi(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l}(T["kha.math.Matrix3"]=pi).__name__=!0,pi.fromFastMatrix3=function(t){return new pi(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},pi.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:pi};function gi(t,e,i,n,r,s,a,o,l,u,h,c,d,_,f,p){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=c,this._03=d,this._13=_,this._23=f,this._33=p}(T["kha.math.Matrix4"]=gi).__name__=!0,gi.fromFastMatrix4=function(t){return new gi(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},gi.orthogonalProjection=function(t,e,i,n,r,s){return new gi(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},gi.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new gi(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},gi.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z;null==s&&(s=0),null==r&&(r=0),null==n&&(n=0);var a=n,o=r,l=s;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,c=l,d=Math.sqrt(u*u+h*h+c*c);if(0!=d){var _=1/d;u*=_,h*=_,c*=_}var f=h*i.z-c*i.y,p=c*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==p&&(p=0),null==f&&(f=0);var m=f,v=p,b=g;null==b&&(b=0),null==v&&(v=0),null==m&&(m=0);var w=m,y=v,x=b,T=Math.sqrt(w*w+y*y+x*x);if(0!=T){var S=1/T;w*=S,y*=S,x*=S}var k=y*c-x*h,I=x*u-w*c,E=w*h-y*u;null==E&&(E=0),null==I&&(I=0),null==k&&(k=0);return new gi(w,y,x,-(w*t.x+y*t.y+x*t.z),k,I,E,-(k*t.x+I*t.y+E*t.z),-u,-h,-c,u*t.x+h*t.y+c*t.z,0,0,0,1)},gi.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:gi};var mi=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(T["kha.math.Vector2"]=mi).__name__=!0,mi.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:mi,__properties__:{set_length:"set_length",get_length:"get_length"}};function vi(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(T["kha.math.Vector3"]=vi).__name__=!0,vi.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},__class__:vi,__properties__:{set_length:"set_length",get_length:"get_length"}};function bi(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(T["kha.math.Vector4"]=bi).__name__=!0,bi.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},__class__:bi,__properties__:{set_length:"set_length",get_length:"get_length"}};function wi(){}(T["kha.netsync.Client"]=wi).__name__=!0,wi.__isInterface__=!0,wi.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:wi,__properties__:{get_id:"get_id"}};var yi=function(){};(T["kha.netsync.ControllerBuilder"]=yi).__name__=!0;function xi(){}(T["kha.netsync.Entity"]=xi).__name__=!0,xi.__isInterface__=!0,xi.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:xi};function Ti(t){this.myId=t}(T["kha.netsync.LocalClient"]=Ti).__name__=!0,Ti.__interfaces__=[wi],Ti.prototype={myId:null,send:function(t,e){},receive:function(t){},onClose:function(t){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:Ti,__properties__:{get_id:"get_id",get_controllers:"get_controllers"}};function Si(t,e){this.time=t,this.data=e}(T["kha.netsync.State"]=Si).__name__=!0,Si.prototype={time:null,data:null,__class__:Si};var ki=function(t,e,i){this.ping=1,this.currentPlayers=0,this.controllers=new $,this.entities=new $,(ki.instance=this).maxPlayers=t,this.address=e,this.port=i};(T["kha.netsync.Session"]=ki).__name__=!0,ki.the=function(){return ki.instance},ki.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(t){var e=this.entities,i=t._id();e.h[i]=t},addController:function(t){L.trace("Adding controller id "+t._id(),{fileName:"kha/netsync/Session.hx",lineNumber:88,className:"kha.netsync.Session",methodName:"addController"}),t._inputBufferIndex=0;var e=this.controllers,i=t._id();e.h[i]=t},sendControllerUpdate:function(t,e){if(this.controllers.h.hasOwnProperty(t)){if(this.controllers.h[t]._inputBuffer.length<this.controllers.h[t]._inputBufferIndex+4+e.length){var i=new ht(new ArrayBuffer(this.controllers.h[t]._inputBufferIndex+4+e.length));i.blit(0,this.controllers.h[t]._inputBuffer,0,this.controllers.h[t]._inputBufferIndex),this.controllers.h[t]._inputBuffer=i}this.controllers.h[t]._inputBuffer.setInt32(this.controllers.h[t]._inputBufferIndex,e.length),this.controllers.h[t]._inputBuffer.blit(this.controllers.h[t]._inputBufferIndex+4,e,0,e.length),this.controllers.h[t]._inputBufferIndex+=4+e.length}},sendPing:function(){var t=new ht(new ArrayBuffer(5));t.b[0]=4,t.setFloat(1,G.realTime()),this.sendToServer(t)},sendPlayerUpdate:function(){},receive:function(t,e){switch(t.b[0]){case 0:var i=t.b[1];this.localClient=new Ti(i),G.resetTime(),this.startCallback();break;case 1:for(var n=t.getDouble(1),r=9,s=this.entities.iterator();s.hasNext();){var a=s.next();a._receive(r,t),r+=a._size()}G.warp(n);break;case 3:switch(t.b[1]){case 0:break;case 1:this.executeRPC(t)}break;case 4:var o=t.getFloat(1);this.ping=G.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=t.getInt32(1)}},executeRPC:function(t){var e=[],i=t.getInt32(2),n=6,r=t.getUInt16(n);n+=2;for(var s="",a=0,o=r;a<o;){a++;var l=t.b[n];s+=String.fromCodePoint(l),++n}var u=t.getUInt16(n);n+=2;for(var h="",c=0,d=u;c<d;){c++;var _=t.b[n];h+=String.fromCodePoint(_),++n}for(;n<t.length;){var f=t.b[n];switch(++n,f){case 66:var p=1==t.b[n];++n,L.trace("Bool: "+(null==p?"null":""+p),{fileName:"kha/netsync/Session.hx",lineNumber:295,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(p);break;case 70:var g=t.getDouble(n);n+=8,L.trace("Float: "+g,{fileName:"kha/netsync/Session.hx",lineNumber:300,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(g);break;case 73:var m=t.getInt32(n);n+=4,L.trace("Int: "+m,{fileName:"kha/netsync/Session.hx",lineNumber:305,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(m);break;case 83:var v=t.getUInt16(n);n+=2;for(var b="",w=0,y=v;w<y;){w++;var x=t.b[n];b+=String.fromCodePoint(x),++n}L.trace("String: "+b,{fileName:"kha/netsync/Session.hx",lineNumber:315,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(b);break;default:L.trace("Unknown argument type.",{fileName:"kha/netsync/Session.hx",lineNumber:318,className:"kha.netsync.Session",methodName:"executeRPC"})}}-1==i?se.field(T[s],h+"_remotely").apply(null,e):se.field(Ii.objects[i],h+"_remotely").apply(Ii.objects[i],e)},waitForStart:function(t,e,i,n,r){var s=this;this.startCallback=t,this.refusedCallback=e,this.resetCallback=r,this.network=new kha.netsync.Network(this.address,this.port,i,function(){n(),s.reset()}),this.network.listen(function(t){s.receive(t)}),this.updateTaskId=G.addFrameTask(Mi(this,this.update),0),this.ping=1,this.pingTaskId=G.addTimeTask(Mi(this,this.sendPing),0,1)},reset:function(){G.removeFrameTask(this.updateTaskId),G.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new $,this.entities=new $,this.resetCallback()},update:function(){for(var t=this.controllers.iterator();t.hasNext();){var e=t.next();if(0<e._inputBufferIndex){var i=new ht(new ArrayBuffer(22+e._inputBufferIndex));i.b[0]=2,i.setInt32(1,e._id()),i.setDouble(5,G.time()),i.setInt32(13,ve.windowWidth(0)),i.setInt32(17,ve.windowHeight(0)),i.b[21]=0,i.blit(22,e._inputBuffer,0,e._inputBufferIndex),this.sendToServer(i),e._inputBufferIndex=0}}},sendToServer:function(t){this.network.send(t,!1)},__class__:ki,__properties__:{get_me:"get_me"}};var Ii=function(){};(T["kha.netsync.SyncBuilder"]=Ii).__name__=!0;function Ei(t,e,i,n){this._0=t,this._1=e,this._2=i,this._3=n}(T["kha.simd.Float32x4"]=Ei).__name__=!0,Ei.create=function(){return new Ei(0,0,0,0)},Ei.loadAllFast=function(t){return new Ei(t,t,t,t)},Ei.load=function(t,e,i,n){return new Ei(t,e,i,n)},Ei.loadFast=function(t,e,i,n){return new Ei(t,e,i,n)},Ei.get=function(t,e){var i=0;switch(e){case 0:i=t._0;break;case 1:i=t._1;break;case 2:i=t._2;break;case 3:i=t._3}return i},Ei.getFast=function(t,e){switch(e){case 0:return t._0;case 1:return t._1;case 2:return t._2;case 3:return t._3}return 0},Ei.abs=function(t){return new Ei(Math.abs(t._0),Math.abs(t._1),Math.abs(t._2),Math.abs(t._3))},Ei.add=function(t,e){return new Ei(t._0+e._0,t._1+e._1,t._2+e._2,t._3+e._3)},Ei.div=function(t,e){return new Ei(t._0/e._0,t._1/e._1,t._2/e._2,t._3/e._3)},Ei.mul=function(t,e){return new Ei(t._0*e._0,t._1*e._1,t._2*e._2,t._3*e._3)},Ei.neg=function(t){return new Ei(-t._0,-t._1,-t._2,-t._3)},Ei.reciprocalApproximation=function(t){return new Ei(0,0,0,0)},Ei.reciprocalSqrtApproximation=function(t){return new Ei(0,0,0,0)},Ei.sub=function(t,e){return new Ei(t._0-e._0,t._1-e._1,t._2-e._2,t._3-e._3)},Ei.sqrt=function(t){return new Ei(Math.sqrt(t._0),Math.sqrt(t._1),Math.sqrt(t._2),Math.sqrt(t._3))},Ei.prototype={_0:null,_1:null,_2:null,_3:null,__class__:Ei};var Ci=function(){};(T["zui.Canvas"]=Ci).__name__=!0,Ci.draw=function(t,e,i){Ci.screenW=ve.windowWidth(),Ci.screenH=ve.windowHeight(),Ci.events=[],Ci._ui=t,i.end(),t.begin(i),i.begin(!1),t.g=i;for(var n=0,r=e.elements;n<r.length;){var s=r[n];++n,null==s.parent&&Ci.drawElement(t,e,s)}return i.end(),t.end(),i.begin(!1),Ci.events},Ci.drawElement=function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=0),null!=i&&0!=i.visible){var s=Ci.getAnchorOffset(e,i);n+=s[0],r+=s[1],t._x=e.x+(i.x*Ci._ui.ops.scaleFactor|0)+n,t._y=e.y+(i.y*Ci._ui.ops.scaleFactor|0)+r,t._w=i.width*Ci._ui.ops.scaleFactor|0;var a=null!=i.rotation&&0!=i.rotation;switch(a&&t.g.pushRotation(i.rotation,t._x+(i.width*Ci._ui.ops.scaleFactor|0)/2,t._y+(i.height*Ci._ui.ops.scaleFactor|0)/2),i.type){case 0:var o=t.ops.font,l=t.fontSize;null!=i.asset&&he.endsWith(i.asset,".ttf")&&(t.ops.font=Ci.getAsset(e,i.asset)),t.fontSize=i.height*Ci._ui.ops.scaleFactor|0;var u=i.color_text,h=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=u?u:h,t.text(i.text,i.alignment),t.ops.font=o,t.fontSize=l;break;case 1:var c=Ci.getAsset(e,i.asset),d=null!=i.asset&&he.endsWith(i.asset,".ttf");if(null!=c&&!d){t.imageScrollAlign=!1;var _=null!=i.color?i.color:-1;if(3==t.image(c,_,i.height*Ci._ui.ops.scaleFactor|0)){var f=i.event;null!=f&&""!=f&&Ci.events.push(f)}t.imageScrollAlign=!0}break;case 2:var p=t.t.ELEMENT_H,g=t.t.BUTTON_H;t.t.ELEMENT_H=i.height,t.t.BUTTON_H=i.height;var m=i.color,v=Ci.getTheme(e.theme).BUTTON_COL;t.t.BUTTON_COL=null!=m?m:v;var b=i.color_text,w=Ci.getTheme(e.theme).BUTTON_TEXT_COL;t.t.BUTTON_TEXT_COL=null!=b?b:w;var y=i.color_hover,x=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.BUTTON_HOVER_COL=null!=y?y:x;var T=i.color_press,S=Ci.getTheme(e.theme).BUTTON_PRESSED_COL;if(t.t.BUTTON_PRESSED_COL=null!=T?T:S,t.button(i.text,i.alignment)){var k=i.event;null!=k&&""!=k&&Ci.events.push(k)}t.t.ELEMENT_H=p,t.t.BUTTON_H=g;break;case 3:break;case 6:var I=i.color_text,E=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=I?I:E;var C=i.color,B=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=C?C:B;var N=i.color_hover,L=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=N?N:L,t.check(Ci.h.nest(i.id),i.text);break;case 7:var F=i.color_text,A=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=F?F:A;var M=i.color,O=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=M?M:O;var P=i.color_hover,R=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=P?P:R,Bi.inlineRadio(t,Ci.h.nest(i.id),i.text.split(";"));break;case 8:var V=i.color_text,D=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=V?V:D;var U=i.color_text,H=Ci.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=U?U:H;var W=i.color,G=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=W?W:G;var z=i.color,X=Ci.getTheme(e.theme).BUTTON_COL;t.t.SEPARATOR_COL=null!=z?z:X;var K=i.color_hover,Y=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=K?K:Y,t.combo(Ci.h.nest(i.id),i.text.split(";"));break;case 9:var Z=i.color_text,j=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=Z?Z:j;var q=i.color_text,Q=Ci.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=q?q:Q;var J=i.color,$=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=J?J:$;var tt=i.color_hover,et=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=tt?tt:et,t.slider(Ci.h.nest(i.id),i.text,0,1,!0,100,!0,i.alignment);break;case 10:var it=i.color_text,nt=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=it?it:nt;var rt=i.color_text,st=Ci.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=rt?rt:st;var at=i.color,ot=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=at?at:ot;var lt=i.color_hover,ut=Ci.getTheme(e.theme).BUTTON_HOVER_COL;if(t.t.ACCENT_HOVER_COL=null!=lt?lt:ut,t.textInput(Ci.h.nest(i.id),i.text,i.alignment),Ci.h.nest(i.id).changed){var ht=i.event;null!=ht&&""!=ht&&Ci.events.push(ht)}break;case 11:var ct=i.color_text,dt=Ci.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=ct?ct:dt;var _t=i.color_text,ft=Ci.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=_t?_t:ft;var pt=i.color,gt=Ci.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=pt?pt:gt;var mt=i.color_hover,vt=Ci.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=mt?mt:vt,Bi.keyInput(t,Ci.h.nest(i.id),i.text);break;case 12:var bt=t.g.get_color(),wt=t.g,yt=i.color,xt=Ci.getTheme(e.theme).BUTTON_COL;wt.set_color(null!=yt?yt:xt),t.g.fillRect(t._x,t._y,t._w,i.height*Ci._ui.ops.scaleFactor|0),t.g.set_color(bt);break;case 13:var Tt=t.g.get_color(),St=t.g,kt=i.color,It=Ci.getTheme(e.theme).BUTTON_COL;St.set_color(null!=kt?kt:It),t.g.drawRect(t._x,t._y,t._w,i.height*Ci._ui.ops.scaleFactor|0,i.strength),t.g.set_color(Tt);break;case 14:var Et=t.g.get_color(),Ct=t.g,Bt=i.color,Nt=Ci.getTheme(e.theme).BUTTON_COL;Ct.set_color(null!=Bt?Bt:Nt),be.fillCircle(t.g,t._x+(i.width*Ci._ui.ops.scaleFactor|0)/2,t._y+(i.height*Ci._ui.ops.scaleFactor|0)/2,t._w/2),t.g.set_color(Et);break;case 15:var Lt=t.g.get_color(),Ft=t.g,At=i.color,Mt=Ci.getTheme(e.theme).BUTTON_COL;Ft.set_color(null!=At?At:Mt),be.drawCircle(t.g,t._x+(i.width*Ci._ui.ops.scaleFactor|0)/2,t._y+(i.height*Ci._ui.ops.scaleFactor|0)/2,t._w/2,i.strength),t.g.set_color(Lt);break;case 16:var Ot=t.g.get_color(),Pt=t.g,Rt=i.color,Vt=Ci.getTheme(e.theme).BUTTON_COL;Pt.set_color(null!=Rt?Rt:Vt),t.g.fillTriangle(t._x+t._w/2,t._y,t._x,t._y+(i.height*Ci._ui.ops.scaleFactor|0),t._x+t._w,t._y+(i.height*Ci._ui.ops.scaleFactor|0)),t.g.set_color(Ot);break;case 17:var Dt=t.g.get_color(),Ut=t.g,Ht=i.color,Wt=Ci.getTheme(e.theme).BUTTON_COL;Ut.set_color(null!=Ht?Ht:Wt),t.g.drawLine(t._x+t._w/2,t._y,t._x,t._y+(i.height*Ci._ui.ops.scaleFactor|0),i.strength),t.g.drawLine(t._x,t._y+(i.height*Ci._ui.ops.scaleFactor|0),t._x+t._w,t._y+(i.height*Ci._ui.ops.scaleFactor|0),i.strength),t.g.drawLine(t._x+t._w,t._y+(i.height*Ci._ui.ops.scaleFactor|0),t._x+t._w/2,t._y,i.strength),t.g.set_color(Dt);break;case 18:var Gt=t.g.get_color(),zt=i.progress_at,Xt=i.progress_total,Kt=t.g,Yt=i.color_progress,Zt=Ci.getTheme(e.theme).TEXT_COL;Kt.set_color(null!=Yt?Yt:Zt),t.g.fillRect(t._x,t._y,t._w/Xt*Math.min(zt,Xt),i.height*Ci._ui.ops.scaleFactor|0);var jt=t.g,qt=i.color,Qt=Ci.getTheme(e.theme).BUTTON_COL;jt.set_color(null!=qt?qt:Qt),t.g.drawRect(t._x,t._y,t._w,i.height*Ci._ui.ops.scaleFactor|0,i.strength),t.g.set_color(Gt);break;case 19:var Jt=t.g.get_color(),$t=i.progress_at,te=i.progress_total,ee=t.g,ie=i.color_progress,ne=Ci.getTheme(e.theme).TEXT_COL;ee.set_color(null!=ie?ie:ne),be.drawArc(t.g,t._x+(i.width*Ci._ui.ops.scaleFactor|0)/2,t._y+(i.height*Ci._ui.ops.scaleFactor|0)/2,t._w/2,-Math.PI/2,2*Math.PI/te*$t-Math.PI/2,i.strength);var re=t.g,se=i.color,ae=Ci.getTheme(e.theme).BUTTON_COL;re.set_color(null!=se?se:ae),be.fillCircle(t.g,t._x+(i.width*Ci._ui.ops.scaleFactor|0)/2,t._y+(i.height*Ci._ui.ops.scaleFactor|0)/2,t._w/2-10),t.g.set_color(Jt)}if(null!=i.children)for(var oe=0,le=i.children;oe<le.length;){var ue=le[oe];++oe,Ci.drawElement(t,e,Ci.elemById(e,ue),(i.x*Ci._ui.ops.scaleFactor|0)+n,(i.y*Ci._ui.ops.scaleFactor|0)+r)}a&&t.g.popTransformation()}},Ci.getText=function(t,e){return e.text},Ci.getAsset=function(t,e){for(var i=0,n=t.assets;i<n.length;){var r=n[i];if(++i,r.name==e)return Ci.assetMap.h[r.id]}return null},Ci.getElementId=function(t){if(-1==Ci.elemId)for(var e=0,i=t.elements;e<i.length;){var n=i[e];++e,Ci.elemId<n.id&&(Ci.elemId=n.id)}return++Ci.elemId},Ci.getAssetId=function(t){if(-1==Ci.assetId)for(var e=0,i=t.assets;e<i.length;){var n=i[e];++e,Ci.assetId<n.id&&(Ci.assetId=n.id)}return++Ci.assetId},Ci.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var r=n[i];if(++i,r.id==e)return r}return null},Ci.scaled=function(t){return t*Ci._ui.ops.scaleFactor|0},Ci.getColor=function(t,e){return null!=t?t:e},Ci.getTheme=function(t){for(var e=0,i=Ci.themes;e<i.length;){var n=i[e];if(++e,n.NAME==t)return n}return null},Ci.getAnchorOffset=function(t,e){var i,n,r=0,s=0;if(null==e.parent)i=t.width,n=t.height;else{var a=Ci.elemById(t,e.parent);i=a.width*Ci._ui.ops.scaleFactor|0,n=a.height*Ci._ui.ops.scaleFactor|0}switch(e.anchor){case 1:r+=i/2-(e.width*Ci._ui.ops.scaleFactor|0)/2;break;case 2:r+=i-(e.width*Ci._ui.ops.scaleFactor|0);break;case 3:s+=n/2-(e.height*Ci._ui.ops.scaleFactor|0)/2;break;case 4:r+=i/2-(e.width*Ci._ui.ops.scaleFactor|0)/2,s+=n/2-(e.height*Ci._ui.ops.scaleFactor|0)/2;break;case 5:r+=i-(e.width*Ci._ui.ops.scaleFactor|0),s+=n/2-(e.height*Ci._ui.ops.scaleFactor|0)/2;break;case 6:s+=n-(e.height*Ci._ui.ops.scaleFactor|0);break;case 7:r+=i/2-(e.width*Ci._ui.ops.scaleFactor|0)/2,s+=n-(e.height*Ci._ui.ops.scaleFactor|0);break;case 8:r+=i-(e.width*Ci._ui.ops.scaleFactor|0),s+=n-(e.height*Ci._ui.ops.scaleFactor|0)}return[r,s]};var Bi=function(){};(T["zui.Ext"]=Bi).__name__=!0,Bi.floatInput=function(t,e,i,n){null==n&&(n=0),null==i&&(i=""),e.text=null==e.value?"null":""+e.value;var r=t.textInput(e,i,n);return e.value=parseFloat(r),e.value},Bi.keyInput=function(t,e,i,n){if(null==n&&(n=0),null==i&&(i=""),!t.isVisible(t.t.ELEMENT_H*t.ops.scaleFactor))return t.endElement(),0|e.value;var r=t.getHover();r&&null!=Ai.onTextHover&&Ai.onTextHover(),t.g.set_color(r?t.t.ACCENT_HOVER_COL:t.t.ACCENT_COL);var s=t.g,a=t.t.FILL_ACCENT_BG,o=t._x+t.buttonOffsetY,l=t._y+t.buttonOffsetY,u=t._w-2*t.buttonOffsetY,h=t.t.BUTTON_H*t.ops.scaleFactor,c=0;0==c&&(c=1),t.enabled||t.fadeColor(),a?s.fillRect(o,l-1,u,1+h):s.drawRect(o,l,u,h,c);var d=t.getReleased()||t.tabPressed;if(t.textSelectedHandle!=e&&d&&t.startTextEdit(e),t.textSelectedHandle==e?Bi.listenToKey(t,e):e.changed=!1,""!=i){t.g.set_color(t.t.LABEL_COL);var _=2==n?0:2,f=0==_?7:0;t.drawString(t.g,i,f,0,_)}return e.text=Bi.keycodeToString(0|e.value),t.g.set_color(t.t.TEXT_COL),t.textSelectedHandle!=e?t.drawString(t.g,e.text,null,0,n):t.drawString(t.g,t.textSelected,null,0,n),t.endElement(),0|e.value},Bi.listenToKey=function(t,e){t.isKeyDown?(e.value=t.key,e.changed=t.changed=!0,t.textSelectedHandle=null,t.isTyping=!1,null!=ti.get()&&ti.get().hide()):t.textSelected="Press a key..."},Bi.list=function(t,e,i,n){var r=0;null==n&&(n={});for(var s=null!=n.addCb?n.addCb:function(t){i.push(t)},a=null!=n.removeCb?n.removeCb:function(t){i.splice(t,1)},o=null!=n.getNameCb?n.getNameCb:function(t){return i[t]},l=null!=n.setNameCb?n.setNameCb:function(t,e){i[t]=e},u=null!=n.getLabelCb?n.getLabelCb:function(t){return""},h=n.itemDrawCb,c=null!=n.showRadio&&n.showRadio,d=null==n.editable||n.editable,_=null==n.showAdd||n.showAdd,f=null!=n.addLabel?n.addLabel:"Add",p=0;p<i.length;){c?(t.row([.12,.68,.2]),t.radio(e.nest(0),p,"")&&(r=p)):t.row([.8,.2]);var g=e.nest(p);g.text=o(p),d?l(p,t.textInput(g,u(p))):t.text(o(p)),t.button("X")?a(p):++p,null!=h&&h(g.nest(p),p-1)}return _&&t.button(f)&&s("untitled"),r},Bi.panelList=function(t,e,i,n,r,s,a,o,l,u,h){null==h&&(h="Add"),null==u&&(u=!0),null==l&&(l=!0),null==n&&(n=function(t){i.push(t)}),null==r&&(r=function(t){i.splice(t,1)}),null==s&&(s=function(t){return i[t]}),null==a&&(a=function(t,e){i[t]=e});for(var c=0;c<i.length;){t.row([.12,.68,.2]);var d=t.panel(e.nest(c),""),_=e.nest(c);l?a(c,t.textInput(_,s(c))):t.text(s(c)),t.button("X")?r(c):++c,null!=o&&d&&o(_.nest(c),c-1)}u&&t.button(h)&&n("untitled")},Bi.colorField=function(t,e,i){null==i&&(i=!1),t.g.set_color(e.color);var n=t.g,r=t._x+2,s=t._y+t.buttonOffsetY,a=t._w-4,o=t.t.BUTTON_H*t.ops.scaleFactor,l=0;0==l&&(l=1),t.enabled||t.fadeColor(),n.fillRect(r,s-1,a,1+o),t.g.set_color(t.getHover()?t.t.ACCENT_HOVER_COL:t.t.ACCENT_COL);var u=t.g,h=t._x+2,c=t._y+t.buttonOffsetY,d=t._w-4,_=t.t.BUTTON_H*t.ops.scaleFactor,f=1;return null==f&&(f=0),0==f&&(f=1),t.enabled||t.fadeColor(),u.drawRect(h,c,d,_,f),t.getStarted()&&Li.showCustom(new Ai(t.ops),function(t){Bi.colorWheel(t,e,i)},0|t.inputX,0|t.inputY,200,500),t.endElement(),e.color},Bi.colorPicker=function(t,e,i){null==i&&(i=!1);var n=t.slider(e.nest(0,{value:.00392156862745098*((16711680&e.color)>>>16)}),"R",0,1,!0),r=t.slider(e.nest(1,{value:.00392156862745098*((65280&e.color)>>>8)}),"G",0,1,!0),s=t.slider(e.nest(2,{value:.00392156862745098*(255&e.color)}),"B",0,1,!0),a=.00392156862745098*(e.color>>>24);i&&(a=t.slider(e.nest(3,{value:a}),"A",0,1,!0));var o=N.fromFloats(n,r,s,a);return t.text("",2,o),o},Bi.initPath=function(t,e){t.text="Windows"==e?"C:\\Users":"/"},Bi.fileBrowser=function(t,e,i){null==i&&(i=!1);var n="/",r="ls ",s=ve.get_systemId();"Windows"==s&&(r="dir /b ",i&&(r+="/ad "),n="\\",e.text=he.replace(e.text,"\\\\","\\"),e.text=he.replace(e.text,"\r","")),""==e.text&&Bi.initPath(e,s);var a=Krom.getFilesLocation()+n+Bi.dataPath+"dir.txt";e.text!=Bi.lastPath&&Krom.sysCommand(r+'"'+e.text+'" > "'+a+'"'),Bi.lastPath=e.text;var o=ht.ofData(Krom.loadBlob(a)).toString().split("\n"),l=e.text.indexOf("/"),u=e.text.indexOf("\\"),h=-1<l&&e.text.length-1>l||-1<u&&e.text.length-1>u;e.changed=!1,h&&t.button("..",0)&&(e.changed=t.changed=!0,e.text=e.text.substring(0,e.text.lastIndexOf(n)),2==e.text.length&&":"==e.text.charAt(1)&&(e.text+=n));for(var c=0;c<o.length;){var d=o[c];++c,""!=d&&"."!=d.charAt(0)&&t.button(d,0)&&(e.changed=t.changed=!0,e.text.charAt(e.text.length-1)!=n&&(e.text+=n),e.text+=d)}return e.text},Bi.inlineRadio=function(t,e,i,n){if(null==n&&(n=1),!t.isVisible(t.t.ELEMENT_H*t.ops.scaleFactor))return t.endElement(),e.position;t.getReleased()?(++e.position>=i.length&&(e.position=0),e.changed=t.changed=!0):e.changed=!1;var r=t.getHover();return Bi.drawInlineRadio(t,i[e.position],r,n),t.endElement(),e.position},Bi.drawInlineRadio=function(t,e,i,n){null==n&&(n=1),i?(t.g.set_color(t.t.ACCENT_HOVER_COL),t.g.fillRect(t._x+t.buttonOffsetY,t._y+t.buttonOffsetY,t._w-2*t.buttonOffsetY,t.t.BUTTON_H*t.ops.scaleFactor)):(t.g.set_color(t.t.ACCENT_COL),t.enabled||t.fadeColor(),t.g.drawRect(t._x+t.buttonOffsetY,t._y+t.buttonOffsetY,t._w-2*t.buttonOffsetY,t.t.BUTTON_H*t.ops.scaleFactor)),t.g.set_color(t.t.TEXT_COL),t.drawString(t.g,e,t.t.TEXT_OFFSET*t.ops.scaleFactor,0,n)},Bi.colorWheel=function(t,e,i,n,r,s){null==s&&(s=!0),null==r&&(r=!1),null==i&&(i=!1),null==n&&(n=t._w),Bi.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),Bi.ar);var a=Bi.ar[0],o=Bi.ar[1],l=Bi.ar[2],u=.00392156862745098*(e.color>>>24),h=t._x,c=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(n-=t.t.SCROLL_W*t.ops.scaleFactor|0,h+=(t.t.SCROLL_W*t.ops.scaleFactor|0)/2),t.image(t.ops.color_wheel,N.fromFloats(l,l,l));var d=h+n/2,_=c+(t._y-c)/2,f=.7*n,p=f/2,g=d,m=_+o*p,v=a*(2*Math.PI),b=Math.cos(v)*(g-d)-Math.sin(v)*(m-_)+d,w=Math.sin(v)*(g-d)+Math.cos(v)*(m-_)+_;g=b,m=w,t.g.set_color(-16777216),t.g.fillRect(g-3*t.ops.scaleFactor,m-3*t.ops.scaleFactor,6*t.ops.scaleFactor,6*t.ops.scaleFactor),t.g.set_color(-1),t.g.fillRect(g-2*t.ops.scaleFactor,m-2*t.ops.scaleFactor,4*t.ops.scaleFactor,4*t.ops.scaleFactor),r&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var y=e.nest(0);if(y.value=Math.round(100*l)/100,l=t.slider(y,"Value",0,1,!0),y.changed?e.changed=t.changed=!0:e.changed=!1,i){var x=e.nest(1,{value:Math.round(100*u)/100});u=t.slider(x,"Alpha",0,1,!0),x.changed&&(e.changed=t.changed=!0)}var T=d+t._windowX,S=_+t._windowY;if(t.inputStarted&&t.getInputInRect(T-p,S-p,f,f)&&(Bi.wheelSelectedHande=e),t.inputReleased&&(Bi.wheelSelectedHande=null),t.inputDown&&Bi.wheelSelectedHande==e){var k=T-t.inputX,I=S-t.inputY;o=Math.min(Math.sqrt(k*k+I*I),p)/p;var E=Math.atan2(t.inputX-T,t.inputY-S);E<0&&(E=Math.PI+(Math.PI-Math.abs(E))),a=(E=2*Math.PI-E)/(2*Math.PI),e.changed=t.changed=!0}return Bi.hsvToRgb(a,o,l,Bi.ar),e.color=N.fromFloats(Bi.ar[0],Bi.ar[1],Bi.ar[2],u),s&&t.text("",2,e.color),e.color},Bi.textArea=function(t,e,i,n){null==n&&(n=!0),null==i&&(i=0),e.text=he.replace(e.text,"\t","    ");var r=e.text.split("\n"),s=t.textSelectedHandle==e,a=t.cursorX,o=s&&t.isKeyPressed;t.highlightOnSelect=!1,t.tabSwitchEnabled=!1,t.g.set_color(t.t.SEPARATOR_COL);var l=t.g,u=t._x+t.buttonOffsetY,h=t._y+t.buttonOffsetY,c=t._w-2*t.buttonOffsetY,d=r.length*(t.t.ELEMENT_H*t.ops.scaleFactor)-2*t.buttonOffsetY,_=0;0==_&&(_=1),t.enabled||t.fadeColor(),l.fillRect(u,h-1,c,1+d);for(var f=0,p=r.length;f<p;){var g=f++;!s&&t.getHover()||s&&g==e.position?(e.position=g,e.text=r[g],t.textInput(e,"",i,n),o&&13!=t.key&&(r[g]=t.textSelected)):t.text(r[g],i),t._y-=t.t.ELEMENT_OFFSET*t.ops.scaleFactor}return t._y+=t.t.ELEMENT_OFFSET*t.ops.scaleFactor,o&&(40==t.key&&e.position<r.length-1&&e.position++,38==t.key&&0<e.position&&e.position--,n&&13==t.key&&(e.position++,r.splice(e.position,0,ne.substr(r[e.position-1],t.cursorX,null)),r[e.position-1]=ne.substr(r[e.position-1],0,t.cursorX),t.startTextEdit(e),t.cursorX=t.highlightAnchor=0),n&&8==t.key&&0==a&&0<e.position&&(e.position--,t.cursorX=t.highlightAnchor=r[e.position].length,r[e.position]+=r[e.position+1],r.splice(e.position+1,1)),t.textSelected=r[e.position]),t.highlightOnSelect=!0,t.tabSwitchEnabled=!0,e.text=r.join("\n"),e.text},Bi.keycodeToString=function(t){switch(t){case-1:return"None";case 0:return"Unknown";case 1:return"Back";case 3:return"Cancel";case 6:return"Help";case 8:return"Backspace";case 9:return"Tab";case 12:return"Clear";case 13:return"Return";case 16:return"Shift";case 17:return"Ctrl";case 18:return"Alt";case 19:return"Pause";case 20:return"CapsLock";case 21:return"Kana";case 22:return"Eisu";case 23:return"Junja";case 24:return"Final";case 25:return"Hanja";case 27:return"Esc";case 28:return"Convert";case 29:return"NonConvert";case 30:return"Accept";case 31:return"ModeChange";case 32:return"Space";case 33:return"PageUp";case 34:return"PageDown";case 35:return"End";case 36:return"Home";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 41:return"Select";case 42:return"Print";case 43:return"Execute";case 44:return"PrintScreen";case 45:return"Insert";case 46:return"Delete";case 58:return"Colon";case 59:return"Semicolon";case 60:return"LessThan";case 61:return"Equals";case 62:return"GreaterThan";case 63:return"QuestionMark";case 64:return"At";case 91:return"Win";case 93:return"ContextMenu";case 95:return"Sleep";case 96:return"Numpad0";case 97:return"Numpad1";case 98:return"Numpad2";case 99:return"Numpad3";case 100:return"Numpad4";case 101:return"Numpad5";case 102:return"Numpad6";case 103:return"Numpad7";case 104:return"Numpad8";case 105:return"Numpad9";case 106:return"Multiply";case 107:return"Add";case 108:return"Separator";case 109:return"Subtract";case 110:return"Decimal";case 111:return"Divide";case 112:return"F1";case 113:return"F2";case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 124:return"F13";case 125:return"F14";case 126:return"F15";case 127:return"F16";case 128:return"F17";case 129:return"F18";case 130:return"F19";case 131:return"F20";case 132:return"F21";case 133:return"F22";case 134:return"F23";case 135:return"F24";case 144:return"NumLock";case 145:return"ScrollLock";case 146:return"WinOemFjJisho";case 147:return"WinOemFjMasshou";case 148:return"WinOemFjTouroku";case 149:return"WinOemFjLoya";case 150:return"WinOemFjRoya";case 160:return"Circumflex";case 161:return"Exclamation";case 162:return"DoubleQuote";case 163:return"Hash";case 164:return"Dollar";case 165:return"Percent";case 166:return"Ampersand";case 167:return"Underscore";case 168:return"OpenParen";case 169:return"CloseParen";case 170:return"Asterisk";case 171:return"Plus";case 172:return"Pipe";case 173:return"HyphenMinus";case 174:return"OpenCurlyBracket";case 175:return"CloseCurlyBracket";case 176:return"Tilde";case 181:return"VolumeMute";case 182:return"VolumeDown";case 183:return"VolumeUp";case 188:return"Comma";case 190:return"Period";case 191:return"Slash";case 192:return"BackQuote";case 219:return"OpenBracket";case 220:return"BackSlash";case 221:return"CloseBracket";case 222:return"Quote";case 224:return"Meta";case 225:return"AltGr";case 227:return"WinIcoHelp";case 228:return"WinIco00";case 230:return"WinIcoClear";case 233:return"WinOemReset";case 234:return"WinOemJump";case 235:return"WinOemPA1";case 236:return"WinOemPA2";case 237:return"WinOemPA3";case 238:return"WinOemWSCTRL";case 239:return"WinOemCUSEL";case 240:return"WinOemATTN";case 241:return"WinOemFinish";case 242:return"WinOemCopy";case 243:return"WinOemAuto";case 244:return"WinOemENLW";case 245:return"WinOemBackTab";case 246:return"ATTN";case 247:return"CRSEL";case 248:return"EXSEL";case 249:return"EREOF";case 250:return"Play";case 251:return"Zoom";case 253:return"PA1";case 254:return"WinOemClear"}return String.fromCodePoint(t)},Bi.dist=function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},Bi.fract=function(t){return t-(0|t)},Bi.mix=function(t,e,i){return t*(1-i)+e*i},Bi.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},Bi.step=function(t,e){return e<t?0:1},Bi.hsvToRgb=function(t,e,i,n){var r=t+1,s=Math.abs(6*(r-(0|r))-3),a=t+.6666666666666666,o=Math.abs(6*(a-(0|a))-3),l=t+.3333333333333333,u=Math.abs(6*(l-(0|l))-3);n[0]=i*(1-e+Math.min(Math.max(s-1,0),1)*e),n[1]=i*(1-e+Math.min(Math.max(o-1,0),1)*e),n[2]=i*(1-e+Math.min(Math.max(u-1,0),1)*e)},Bi.rgbToHsv=function(t,e,i,n){var r=e<i?0:1,s=i*(1-r)+e*r,a=e<i?0:1,o=e*(1-a)+i*a,l=e<i?0:1,u=e<i?0:1,h=t<s?0:1,c=s*(1-h)+t*h,d=t<s?0:1,_=o*(1-d)+o*d,f=t<s?0:1,p=(.6666666666666666*(1-u)+-.3333333333333333*u)*(1-f)+(-1*(1-l)+0*l)*f,g=t<s?0:1,m=t*(1-g)+s*g,v=c-Math.min(m,_);n[0]=Math.abs(p+(m-_)/(6*v+1e-10)),n[1]=v/(1e-10+c),n[2]=c};function Ni(){}(T["zui.Id"]=Ni).__name__=!0;var Li=function(){};(T["zui.Popup"]=Li).__name__=!0,Li.render=function(t){if(null==Li.boxCommands){if(Li.ui.begin(t),Li.ui.window(Li.hwnd,Li.modalX,Li.modalY,Li.modalW,Li.modalH)){Li.drawTitle(t);for(var e=0,i=Li.boxText.split("\n");e<i.length;){var n=i[e];++e,Li.ui.text(n)}Li.ui._y=Li.ui._h-Li.ui.t.BUTTON_H-10,Li.ui.row([.3333333333333333,.3333333333333333,.3333333333333333]),Li.ui.endElement(),Li.ui.button("OK")&&(Li.show=!1)}Li.ui.end()}else Li.ui.begin(t),Li.ui.window(Li.hwnd,Li.modalX,Li.modalY,Li.modalW,Li.modalH)&&(Li.drawTitle(t),Li.ui._y+=10,Li.boxCommands(Li.ui)),Li.ui.end()},Li.drawTitle=function(t){if(""!=Li.boxTitle){t.set_color(Li.ui.t.SEPARATOR_COL);var e=Li.ui,i=Li.ui._x,n=Li.ui._y,r=Li.ui._w,s=Li.ui.t.BUTTON_H,a=0;0==a&&(a=1),e.enabled||e.fadeColor(),t.fillRect(i,n-1,r,s+1),t.set_color(Li.ui.t.TEXT_COL),Li.ui.text(Li.boxTitle)}},Li.update=function(){var t=null!=Li.ui.comboSelectedHandle;Li.ui.inputStarted&&!t&&(Li.ui.inputX<Li.modalX||Li.ui.inputX>Li.modalX+Li.modalW||Li.ui.inputY<Li.modalY||Li.ui.inputY>Li.modalY+Li.modalH)&&(Li.show=!1)},Li.showMessage=function(t,e,i){Li.ui=t,Li.init(),Li.boxTitle=e,Li.boxText=i,Li.boxCommands=null},Li.showCustom=function(t,e,i,n,r,s){null==s&&(s=160),null==r&&(r=400),null==n&&(n=-1),null==i&&(i=-1),Li.ui=t,Li.init(i,n,r,s),Li.boxTitle="",Li.boxText="",Li.boxCommands=e},Li.init=function(t,e,i,n){null==n&&(n=160),null==i&&(i=400),null==e&&(e=-1),null==t&&(t=-1);var r=ve.windowWidth(),s=ve.windowHeight();Li.modalX=t,Li.modalY=e,Li.modalW=i*Li.ui.ops.scaleFactor|0,Li.modalH=n*Li.ui.ops.scaleFactor|0,-1==t&&(Li.modalX=r/2-Li.modalW/2|0),-1==e&&(Li.modalY=s/2-Li.modalH/2|0),Li.modalX=0|Math.max(0,Math.min(Li.modalX,r-Li.modalW)),Li.modalY=0|Math.max(0,Math.min(Li.modalY,s-Li.modalH)),Li.hwnd.dragX=0,Li.hwnd.dragY=0,Li.show=!0};var Fi=function(){};(T["zui.Themes"]=Fi).__name__=!0;var Ai=function(t){this.checkSelectImage=null,this.elementsBaked=!1,this.tabVertical=!1,this.tabScroll=0,this.tabHandle=null,this.tabColors=null,this.tabNames=null,this.tooltipTime=0,this.tooltipWait=!1,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImgMaxWidth=null,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.restoreY=-1,this.restoreX=-1,this.windowHeaderH=0,this.windowHeaderW=0,this.dragHandle=null,this.scrollHandle=null,this.windowEnded=!0,this._windowY=0,this._windowX=0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorX=0,this.inputStartedTime=0,this.key=null,this.isReturnDown=!1,this.isEscapeDown=!1,this.isDeleteDown=!1,this.isBackspaceDown=!1,this.isADown=!1,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.isKeyPressed=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.touchHold=!1,this.highlightFullRow=!1,this.tabSwitchEnabled=!0,this.highlightOnSelect=!0,this.alwaysRedraw=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.enabled=!0,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=Fi.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),null==Ai.copyReceiver&&(Ai.copyReceiver=this,ve.notifyOnCutCopyPaste(Mi(this,this.onCut),Mi(this,this.onCopy),Mi(this,this.onPaste)),ve.notifyOnFrames(function(t){(Ai.isCopy||Ai.isPaste)&&1<++Ai.copyFrame&&(Ai.isCopy=Ai.isCut=Ai.isPaste=!1,Ai.copyFrame=0)}));var e=De.createTextVertexStructure();this.rtTextPipeline=De.createTextPipeline(e),this.rtTextPipeline.alphaBlendSource=1,this.rtTextPipeline.compile()};function Mi(t,e){return null==e?null:(null==e.__id__&&(e.__id__=n.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}(T["zui.Zui"]=Ai).__name__=!0,Ai.clampi=function(t,e,i){return t<e?e:i<t?i:t},Ai.prototype={isScrolling:null,isTyping:null,enabled:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,imageInvertY:null,scrollEnabled:null,alwaysRedraw:null,highlightOnSelect:null,tabSwitchEnabled:null,highlightFullRow:null,touchHold:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputStartedX:null,inputStartedY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyPressed:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,isADown:null,isBackspaceDown:null,isDeleteDown:null,isEscapeDown:null,isReturnDown:null,key:null,char:null,inputStartedTime:null,cursorX:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,t:null,ops:null,globalG:null,rtTextPipeline:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollHandle:null,dragHandle:null,windowHeaderW:null,windowHeaderH:null,restoreX:null,restoreY:null,textSelectedHandle:null,textSelected:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboItemCount:null,comboItemOffset:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipImgMaxWidth:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipWait:null,tooltipTime:null,tabNames:null,tabColors:null,tabHandle:null,tabScroll:null,tabVertical:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.fontSize=this.t.FONT_SIZE*this.ops.scaleFactor|0;var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-e)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.ARROW_SIZE*this.ops.scaleFactor)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.ops.scaleFactor)/this.ops.scaleFactor,this.buttonOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.BUTTON_H*this.ops.scaleFactor)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.CHECK_SIZE*this.ops.scaleFactor)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.ops.scaleFactor-this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.CHECK_SIZE*this.ops.scaleFactor)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.ops.scaleFactor-this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=P.createRenderTarget(this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0,null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.ops.scaleFactor),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.ops.scaleFactor),t.end(),this.elementsBaked=!0},remove:function(){this.ops.autoNotifyInput&&this.unregisterInput()},registerInput:function(){var t=this;ii.get().notifyWindowed(this.ops.khaWindowId,Mi(this,this.onMouseDown),Mi(this,this.onMouseUp),Mi(this,this.onMouseMove),Mi(this,this.onMouseWheel)),ti.get().notify(Mi(this,this.onKeyDown),Mi(this,this.onKeyUp),Mi(this,this.onKeyPress)),ve.notifyOnApplicationState(function(){t.inputDX=t.inputDY=0},null,null,null,null),this.inputRegistered=!0},unregisterInput:function(){ii.get().removeWindowed(this.ops.khaWindowId,Mi(this,this.onMouseDown),Mi(this,this.onMouseUp),Mi(this,this.onMouseMove),Mi(this,this.onMouseWheel)),ti.get().remove(Mi(this,this.onKeyDown),Mi(this,this.onKeyUp),Mi(this,this.onKeyPress)),this.endInput(),this.inputX=this.inputY=0,this.inputRegistered=!1},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),this.drawCombo(),this.drawTooltip(),this.tabPressedHandle=null,t&&this.endInput()},beginRegion:function(t,e,i,n){this.elementsBaked||(t.end(),this.bakeElements(),t.begin(!1)),this.changed=!1,this.globalG=t,this.g=t,this.currentWindow=null,this.tooltipText="",this.tooltipImg=null,this._windowX=0,this._windowY=0,this._windowW=n,this._x=e,this._y=i,this._w=n},endRegion:function(t){null==t&&(t=!0),this.drawTooltip(),this.tabPressedHandle=null,t&&this.endInput()},endInput:function(){this.isKeyPressed=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,Ai.textToPaste="",Ai.keyRepeat&&this.isKeyDown&&.05<G.time()-Ai.keyRepeatTime&&(8!=this.key&&46!=this.key&&37!=this.key&&39!=this.key&&38!=this.key&&40!=this.key||(Ai.keyRepeatTime=G.time(),this.isKeyPressed=!0)),Ai.touchControls&&this.inputDown&&this.inputX==this.inputStartedX&&this.inputY==this.inputStartedY&&0<this.inputStartedTime&&.5<G.time()-this.inputStartedTime&&(this.touchHold=!0,this.inputStartedTime=0)},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyPressed},windowDirty:function(t,e,i,n,r){var s=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(s,a,n,r)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,n,r,s){return null==s&&(s=!1),null!=t.texture&&n==t.texture.get_width()&&r==t.texture.get_height()||this.resize(t,n,r,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=n,this._windowH=r,this.windowHeaderW=0,this.windowHeaderH=0,this.windowDirty(t,e,i,n,r)&&(t.redraws=2),null!=Ai.onBorderHover&&(this.getInputInRect(this._windowX-4,this._windowY,8,this._windowH)?Ai.onBorderHover(t,0):this.getInputInRect(this._windowX+this._windowW-4,this._windowY,8,this._windowH)?Ai.onBorderHover(t,1):this.getInputInRect(this._windowX,this._windowY-4,this._windowW,8)?Ai.onBorderHover(t,2):this.getInputInRect(this._windowX,this._windowY+this._windowH-4,this._windowW,8)&&Ai.onBorderHover(t,3)),!(t.redraws<=0)&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(n=this.t.ELEMENT_W*this.ops.scaleFactor|0),this._w=t.scrollEnabled?n-(this.t.SCROLL_W*this.ops.scaleFactor|0):n,this._h=r,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=s)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15*this.ops.scaleFactor|0)?this.dragHandle=t:this.inputReleased&&(this.dragHandle=null),t==this.dragHandle&&(t.redraws=2,t.dragX+=0|this.inputDX,t.dragY+=0|this.inputDY),this._y+=15*this.ops.scaleFactor|0,this.windowHeaderH+=15*this.ops.scaleFactor|0),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15*this.ops.scaleFactor|0));var i=this._windowH-this.windowHeaderH,n=this._y-e.scrollOffset-this.windowHeaderH;if(n<i||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var r=this._windowY+this.windowHeaderH,s=n-i,a=-e.scrollOffset/s,o=i*Math.abs(i/n),l=i-(o=Math.max(o,this.t.ELEMENT_H*this.ops.scaleFactor)),u=s/l,h=l*a+this.windowHeaderH,c=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),h+this._windowY,this.t.SCROLL_W*this.ops.scaleFactor|0,o);this.inputStarted&&c&&(this.scrollHandle=e,this.isScrolling=!0);var d=this.inputWheelDelta;Ai.touchControls&&this.inputDownR&&0!=this.inputDY&&(this.isScrolling=!0,d=-this.inputDY/20),e==this.scrollHandle?this.scroll(this.inputDY*u,n):0!=d&&null==this.comboSelectedHandle&&this.getInputInRect(this._windowX,r,this._windowW,i)&&this.scroll(d*(this.t.ELEMENT_H*this.ops.scaleFactor),n),0<e.scrollOffset?e.scrollOffset=0:n+e.scrollOffset<i&&(e.scrollOffset=i-n),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),r,this.t.SCROLL_W*this.ops.scaleFactor|0,i),this.g.set_color(this.t.ACCENT_COL);var _=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),r,this.t.SCROLL_W*this.ops.scaleFactor|0,i)||e==this.scrollHandle?this.t.SCROLL_W*this.ops.scaleFactor|0:(this.t.SCROLL_W*this.ops.scaleFactor|0)/3;this.g.fillRect(this._windowW-_-this.scrollAlign,h,_,o)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,(Ai.alwaysRedrawWindow||-4<e.redraws)&&(t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawImage(e.texture,this._windowX,this._windowY),t&&this.globalG.end(),e.redraws<=0&&e.redraws--)}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},tab:function(t,e,i,n){return null==n&&(n=-1),null==i&&(i=!1),null==this.tabNames&&(this.tabNames=[],this.tabColors=[],this.tabHandle=t,this.tabVertical=i,this._w-=this.tabVertical?this.t.ELEMENT_OFFSET*this.ops.scaleFactor+this.t.ELEMENT_W*this.ops.scaleFactor-this.ops.scaleFactor|0:0,i?this.windowHeaderW+=this.t.ELEMENT_W*this.ops.scaleFactor:this.windowHeaderH+=this.t.BUTTON_H*this.ops.scaleFactor+this.buttonOffsetY+this.t.ELEMENT_OFFSET*this.ops.scaleFactor,this.restoreX=this.inputX,this.restoreY=this.inputY,!i&&this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeaderH)&&(this.inputX=this.inputY=-1),i?(this._x+=this.windowHeaderW+6,this._w-=6):this._y+=this.windowHeaderH+3),this.tabNames.push(e),this.tabColors.push(n),t.position==this.tabNames.length-1},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=0,i=this.t.BUTTON_H*this.ops.scaleFactor*1.1|0,n=this._y;this._y=this.currentWindow.dragEnabled?15*this.ops.scaleFactor|0:0,this.tabHandle.changed=!1,this.g.set_color(this.t.SEPARATOR_COL),this.tabVertical?this.g.fillRect(0,this._y,this.t.ELEMENT_W*this.ops.scaleFactor,this._windowH):this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+i+2),this.g.set_color(this.t.ACCENT_COL),this.tabVertical?this.g.fillRect(this.t.ELEMENT_W*this.ops.scaleFactor,this._y,1,this._windowH):this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+i+2,this._windowW-2*this.buttonOffsetY,1);for(var r=this.tabVertical?this._y:this._y+2,s=0,a=this.tabNames.length;s<a;){var o=s++;this._x=t,this._y=r+e,this._w=this.tabVertical?this.t.ELEMENT_W*this.ops.scaleFactor-this.ops.scaleFactor|0:this.ops.font.width(this.fontSize,this.tabNames[o])+2*this.buttonOffsetY+18*this.ops.scaleFactor|0;var l=this.getReleased(),u=this.getPushed(),h=this.getHover();if(l){var c=this.tabHandle.nest(this.tabHandle.position);c.scrollOffset=this.currentWindow.scrollOffset,c=this.tabHandle.nest(o),this.tabScroll=c.scrollOffset,this.tabHandle.position=o,this.currentWindow.redraws=3,this.tabHandle.changed=!0}var d=this.tabHandle.position==o;this.g.set_color(u||h?this.t.BUTTON_HOVER_COL:-1!=this.tabColors[o]?this.tabColors[o]:d?this.t.WINDOW_BG_COL:this.t.SEPARATOR_COL),this.tabVertical?e+=1+i:t+=this._w+1;var _=this.g,f=this._x+this.buttonOffsetY,p=this._y+this.buttonOffsetY,g=this._w,m=0;0==m&&(m=1),this.enabled||this.fadeColor(),_.fillRect(f,p-1,g,1+i),this.g.set_color(d?this.t.BUTTON_TEXT_COL:this.t.LABEL_COL),this.drawString(this.g,this.tabNames[o],this.t.TEXT_OFFSET,0,0),d&&!this.tabVertical&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+i,this._w-1,1))}this._x=0,this._y=n,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0):this._windowW)}},panel:function(t,e,i,n,r){if(null==r&&(r=!0),null==n&&(n=!0),null==i&&(i=!1),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.selected;if(this.getReleased()&&(t.selected=!t.selected,t.changed=this.changed=!0),n){this.g.set_color(this.t.PANEL_BG_COL);var s=this.g,a=this._x,o=this._y,l=this._w,u=this.t.ELEMENT_H*this.ops.scaleFactor,h=0;0==h&&(h=1),this.enabled||this.fadeColor(),s.fillRect(a,o-1,l,1+u)}return i?this.drawTree(t.selected):this.drawArrow(t.selected),this.g.set_color(this.t.LABEL_COL),this.g.set_opacity(1),this.drawString(this.g,e,this.titleOffsetX,0),this.endElement(),r&&!t.selected&&(this._y-=this.t.ELEMENT_OFFSET*this.ops.scaleFactor),t.selected},image:function(t,e,i,n,r,s,a){null==a&&(a=0),null==s&&(s=0),null==r&&(r=0),null==n&&(n=0),null==e&&(e=-1);var o,l=(0<s?s:t.get_width())*this.ops.scaleFactor,u=(0<a?a:t.get_height())*this.ops.scaleFactor,h=Math.min(l,this._w),c=this._x,d=null!=this.currentWindow&&this.currentWindow.scrollEnabled;if(-1==this.curRatio)o=1;else{var _=this.ratios[this.curRatio];o=_<0?-_:_}this.imageScrollAlign?(h=Math.min(l,this._w-2*this.buttonOffsetY),c+=this.buttonOffsetY,d||(h-=(this.t.SCROLL_W*this.ops.scaleFactor|0)*o,c+=(this.t.SCROLL_W*this.ops.scaleFactor|0)*o/2)):d&&(h+=(this.t.SCROLL_W*this.ops.scaleFactor|0)*o);var f=null==i?h/l:i/u;if(null==i?i=u*f:h=l*f,!this.isVisible(i))return this.endElement(i),0;var p=this.getStarted(i),g=this.getPushed(i),m=this.getReleased(i),v=this.getHover(i);this.g.set_color(e),this.enabled||this.fadeColor();var b=i;return 0<s?this.imageInvertY?this.g.drawScaledSubImage(t,n,r,s,a,c,this._y+b,h,-b):this.g.drawScaledSubImage(t,n,r,s,a,c,this._y,h,b):this.imageInvertY?this.g.drawScaledImage(t,c,this._y+b,h,-b):this.g.drawScaledImage(t,c,this._y,h,b),this.endElement(i),p?1:m?3:g?2:v?4:0},text:function(t,e,i){if(null==i&&(i=0),null==e&&(e=0),0<=t.indexOf("\n")){var n=e,r=i;null==r&&(r=0),null==n&&(n=0);for(var s=0,a=t.split("\n");s<a.length;){var o=a[s];++s,this.text(o,n,r)}return 0}var l=Math.max(this.t.ELEMENT_H*this.ops.scaleFactor,this.ops.font.height(this.fontSize));if(!this.isVisible(l))return this.endElement(l+this.t.ELEMENT_OFFSET*this.ops.scaleFactor),0;var u=this.getStarted(l),h=this.getPushed(l),c=this.getReleased(l);this.getHover(l);return 0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.ops.scaleFactor)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET*this.ops.scaleFactor,0,e),this.endElement(l+this.t.ELEMENT_OFFSET*this.ops.scaleFactor),u?1:c?3:h?2:0},splitText:function(t,e,i){null==i&&(i=0),null==e&&(e=0);for(var n=0,r=t.split("\n");n<r.length;){var s=r[n];++n,this.text(s,e,i)}},startTextEdit:function(t){if(this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelected,this.textSelectedHandle=t,this.textSelected=t.text,this.cursorX=t.text.length,this.tabPressed)this.tabPressed=!1,this.isKeyPressed=!1;else if(!this.highlightOnSelect){var e=this.inputX-(this._windowX+this._x+this.t.TEXT_OFFSET*this.ops.scaleFactor);for(this.cursorX=0;this.cursorX<this.textSelected.length&&this.ops.font.width(this.fontSize,ne.substr(this.textSelected,0,this.cursorX))<e;)this.cursorX++}this.tabPressedHandle=t,this.highlightAnchor=this.highlightOnSelect?0:this.cursorX,null!=ti.get()&&ti.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelected=""},updateTextEdit:function(t,e){null==e&&(e=!0),null==t&&(t=0);var i=this.textSelected;this.isKeyPressed&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<i.length&&this.cursorX++:e&&8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(i=ne.substr(i,0,this.cursorX-1)+ne.substr(i,this.cursorX,i.length),this.cursorX--):this.highlightAnchor<this.cursorX?(i=ne.substr(i,0,this.highlightAnchor)+ne.substr(i,this.cursorX,i.length),this.cursorX=this.highlightAnchor):i=ne.substr(i,0,this.cursorX)+ne.substr(i,this.highlightAnchor,i.length):e&&46==this.key?this.highlightAnchor==this.cursorX?i=ne.substr(i,0,this.cursorX)+ne.substr(i,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(i=ne.substr(i,0,this.highlightAnchor)+ne.substr(i,this.cursorX,i.length),this.cursorX=this.highlightAnchor):i=ne.substr(i,0,this.cursorX)+ne.substr(i,this.highlightAnchor,i.length):13==this.key?this.deselectText():27==this.key?(this.textSelected=this.textSelectedHandle.text,this.deselectText()):9==this.key&&this.tabSwitchEnabled?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=i.length:this.isCtrlDown&&this.isADown?(this.cursorX=i.length,this.highlightAnchor=0):e&&16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&38!=this.key&&40!=this.key&&null!=this.char&&""!=this.char&&32<=ne.cca(this.char,0)&&(i=ne.substr(i,0,this.highlightAnchor)+this.char+ne.substr(i,this.cursorX,null),this.cursorX=this.cursorX+1>i.length?i.length:this.cursorX+1),this.isShiftDown&&(37==this.key||39==this.key||16==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=Ai.textToPaste&&(i=ne.substr(i,0,this.highlightAnchor)+Ai.textToPaste+ne.substr(i,this.cursorX,null),this.cursorX+=Ai.textToPaste.length,this.highlightAnchor=this.cursorX,Ai.textToPaste=""),this.highlightAnchor==this.cursorX?Ai.textToCopy=i:this.highlightAnchor<this.cursorX?Ai.textToCopy=i.substring(this.highlightAnchor,this.cursorX):Ai.textToCopy=i.substring(this.cursorX,this.highlightAnchor),Ai.isCut&&(this.highlightAnchor==this.cursorX?i="":this.highlightAnchor<this.cursorX?(i=ne.substr(i,0,this.highlightAnchor)+ne.substr(i,this.cursorX,i.length),this.cursorX=this.highlightAnchor):i=ne.substr(i,0,this.cursorX)+ne.substr(i,this.highlightAnchor,i.length));var n=this.t.TEXT_OFFSET*this.ops.scaleFactor,r=this.t.ELEMENT_H*this.ops.scaleFactor-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var s=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(s=this.highlightAnchor,a=this.cursorX);var o=ne.substr(i,s,a-s),l=this.ops.font.width(this.fontSize,o),u=this.ops.font.width(this.fontSize,ne.substr(i,0,s)),h=0==t?this._x+u+n:this._x+this._w-l-n;2==t&&(h-=this.ops.font.width(this.fontSize,ne.substr(i,a,i.length))),this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(h,this._y+1.5*this.buttonOffsetY,l,r)}var c=G.time();if(this.isKeyDown||c%1<.5){var d=0==t?ne.substr(i,0,this.cursorX):i.substring(this.cursorX,i.length),_=this.ops.font.width(this.fontSize,d),f=0==t?this._x+_+n:this._x+this._w-_-n;this.g.set_color(this.t.TEXT_COL),this.g.fillRect(f,this._y+1.5*this.buttonOffsetY,this.ops.scaleFactor,r)}this.textSelected=i},textInput:function(t,e,i,n){if(null==n&&(n=!0),null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.text;var r=this.getHover();r&&null!=Ai.onTextHover&&Ai.onTextHover(),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var s=this.g,a=this.t.FILL_ACCENT_BG,o=this._x+this.buttonOffsetY,l=this._y+this.buttonOffsetY,u=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.ops.scaleFactor,c=0;0==c&&(c=1),this.enabled||this.fadeColor(),a?s.fillRect(o,l-1,u,1+h):s.drawRect(o,l,u,h,c);var d=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&d&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i,n),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var _=2==i?0:2,f=0==_?7:0;this.drawString(this.g,e,f,0,_)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelected,null,0,i),this.endElement(),t.text},deselectText:function(){null!=this.textSelectedHandle&&(this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelected,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=ti.get()&&ti.get().hide(),this.highlightAnchor=this.cursorX)},button:function(t,e,i){if(null==i&&(i=""),null==e&&(e=1),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),!1;var n=this.getReleased(),r=this.getPushed(),s=this.getHover();n&&(this.changed=!0),this.g.set_color(r?this.t.BUTTON_PRESSED_COL:s?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var a=this.g,o=this.t.FILL_BUTTON_BG,l=this._x+this.buttonOffsetY,u=this._y+this.buttonOffsetY,h=this._w-2*this.buttonOffsetY,c=this.t.BUTTON_H*this.ops.scaleFactor,d=0;return 0==d&&(d=1),this.enabled||this.fadeColor(),o?a.fillRect(l,u-1,h,1+c):a.drawRect(l,u,h,c,d),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET*this.ops.scaleFactor,0,e),""!=i&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,this.t.TEXT_OFFSET*this.ops.scaleFactor,0,2==e?0:2)),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.position==e;0==e&&(t.changed=!1),this.getReleased()&&(t.position=e,t.changed=this.changed=!0);var n=this.getHover();return this.drawRadio(t.position==e,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},combo:function(t,e,i,n,r,s){if(null==s&&(s=-1),null==r&&(r=0),null==n&&(n=!1),null==i&&(i=""),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.position;if(this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=r,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=this._x+this._windowX|0,this.comboSelectedY=this._y+this._windowY+this.t.ELEMENT_H*this.ops.scaleFactor|0,this.comboSelectedW=0|this._w,this.comboItemCount=s<0?e.length:s,this.comboItemOffset=-1),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,0!=this.inputWheelDelta&&null!=this.comboSelectedHandle){0<this.inputWheelDelta?this.comboItemOffset+=1:--this.comboItemOffset;var a=this.comboSelectedTexts.length-this.comboItemCount;this.comboItemOffset>a&&(this.comboItemOffset=a),this.comboItemOffset<0&&(this.comboItemOffset=0)}if(this.getHover()){this.g.set_color(this.t.ACCENT_HOVER_COL);var o=this.g,l=this.t.FILL_ACCENT_BG,u=this._x+this.buttonOffsetY,h=this._y+this.buttonOffsetY,c=this._w-2*this.buttonOffsetY,d=this.t.BUTTON_H*this.ops.scaleFactor,_=0;0==_&&(_=1),this.enabled||this.fadeColor(),l?o.fillRect(u,h-1,c,1+d):o.drawRect(u,h,c,d,_)}else{this.g.set_color(this.t.ACCENT_COL);var f=this.g,p=this.t.FILL_ACCENT_BG,g=this._x+this.buttonOffsetY,m=this._y+this.buttonOffsetY,v=this._w-2*this.buttonOffsetY,b=this.t.BUTTON_H*this.ops.scaleFactor,w=0;0==w&&(w=1),this.enabled||this.fadeColor(),p?f.fillRect(g,m-1,v,1+b):f.drawRect(g,m,v,b,w)}var y=this._x+this._w-this.arrowOffsetX-8,x=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(y,x,y+this.t.ARROW_SIZE*this.ops.scaleFactor,x,y+this.t.ARROW_SIZE*this.ops.scaleFactor/2,x+this.t.ARROW_SIZE*this.ops.scaleFactor/2),n&&""!=i&&(0==r&&(this._x-=15),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,null,0,0==r?2:0),0==r&&(this._x+=15)),2==r&&(this._x-=15),this.g.set_color(this.t.TEXT_COL),t.position<e.length&&this.drawString(this.g,e[t.position],null,0,r),2==r&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,n,r,s,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==s&&(s=100),null==r&&(r=!1),null==n&&(n=1),null==i&&(i=0),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.value;if(this.getStarted()&&(this.scrollHandle=t,this.isScrolling=!0),t.changed=!1,t==this.scrollHandle){var u=n-i,h=this._x+this._windowX+this.buttonOffsetY,c=u/(this._w-2*this.buttonOffsetY),d=i+(this.inputX-h)*c;t.value=Math.round(d*s)/s,t.value<i?t.value=i:t.value>n&&(t.value=n),t.changed=this.changed=!0}var _=this.getHover();this.drawSlider(t.value,i,n,r,_),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t),t.changed=this.changed=!0);var f=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(f),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=parseFloat(t.text),t.changed=this.changed=!0),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,f):this.drawString(this.g,this.textSelected,null,0,f)),this.endElement(),t.value},separator:function(t,e){null==e&&(e=!0),null==t&&(t=4),this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor)&&e&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(this._x,this._y,this._w,t*this.ops.scaleFactor)),this._y+=t*this.ops.scaleFactor},tooltip:function(t){this.tooltipText=t,this.tooltipY=this._y+this._windowY},tooltipImage:function(t,e){this.tooltipImg=t,this.tooltipImgMaxWidth=e,this.tooltipInvertY=this.imageInvertY,this.tooltipY=this._y+this._windowY},drawArrow:function(t){var e=this._x+this.arrowOffsetX,i=this._y+this.arrowOffsetY;this.g.set_color(this.t.TEXT_COL),t?this.g.fillTriangle(e,i,e+this.t.ARROW_SIZE*this.ops.scaleFactor,i,e+this.t.ARROW_SIZE*this.ops.scaleFactor/2,i+this.t.ARROW_SIZE*this.ops.scaleFactor):this.g.fillTriangle(e,i,e,i+this.t.ARROW_SIZE*this.ops.scaleFactor,e+this.t.ARROW_SIZE*this.ops.scaleFactor,i+this.t.ARROW_SIZE*this.ops.scaleFactor/2)},drawTree:function(t){var e=7*this.ops.scaleFactor,i=this._x+this.arrowOffsetX+1,n=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.TEXT_COL),t?this.g.fillRect(i,n+e/2-1,e,e/8):(this.g.fillRect(i,n+e/2-1,e,e/8),this.g.fillRect(i+e/2-1,n,e/8,e))},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,n=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.ops.scaleFactor,o=this.t.CHECK_SIZE*this.ops.scaleFactor,l=0;if(0==l&&(l=1),this.enabled||this.fadeColor(),s?r.fillRect(i,n-1,a,1+o):r.drawRect(i,n,a,o,l),t){this.g.set_color(-1),this.enabled||this.fadeColor();var u=this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0;this.g.drawScaledImage(this.checkSelectImage,i+this.checkSelectOffsetX,n+this.checkSelectOffsetY,u,u)}},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,n=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.ops.scaleFactor,o=this.t.CHECK_SIZE*this.ops.scaleFactor,l=0;0==l&&(l=1),this.enabled||this.fadeColor(),s?r.fillRect(i,n-1,a,1+o):r.drawRect(i,n,a,o,l),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.enabled||this.fadeColor(),this.g.fillRect(i+this.radioSelectOffsetX,n+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor))},drawSlider:function(t,e,i,n,r){var s=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=this.g,u=this.t.FILL_ACCENT_BG,h=this.t.BUTTON_H*this.ops.scaleFactor,c=0;0==c&&(c=1),this.enabled||this.fadeColor(),u?l.fillRect(s,a-1,o,1+h):l.drawRect(s,a,o,h,c),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var d=(t-e)/(i-e),_=8*this.ops.scaleFactor,f=n?s:s+(o-_)*d,p=n?o*d:_;p=Math.max(Math.min(p,o),0);var g=this.g,m=this.t.BUTTON_H*this.ops.scaleFactor,v=0;0==v&&(v=1),this.enabled||this.fadeColor(),g.fillRect(f,a-1,p,1+m)},drawCombo:function(){if(null!=this.comboSelectedHandle){var t=this.g;this.globalG.set_color(this.t.SEPARATOR_COL);var e=this.t.ELEMENT_H*this.ops.scaleFactor+this.t.ELEMENT_OFFSET*this.ops.scaleFactor|0,i=0|Math.min(this.comboSelectedTexts.length,this.comboItemCount),n=(1+i)*e;this.globalG.begin(!1);var r=this.comboSelectedY-n-(this.t.ELEMENT_H*this.ops.scaleFactor|0),s=ve.windowHeight()-(this.comboSelectedY+n),a=s<0&&s<r,o=a?this.comboSelectedY-n-(this.t.ELEMENT_H*this.ops.scaleFactor|0):this.comboSelectedY;if(this.globalG.fillRect(this.comboSelectedX,o,this.comboSelectedW,n),this.beginRegion(this.globalG,this.comboSelectedX,o,this.comboSelectedW),-1==this.comboItemOffset){this.comboItemOffset=a?this.comboSelectedTexts.length-1-this.comboSelectedHandle.position:this.comboSelectedHandle.position;var l=this.comboItemOffset,u=this.comboSelectedTexts.length-i;this.comboItemOffset=l<0?0:u<l?u:l}a&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2),this._y+=e,this.fill(0,0,this._w/this.ops.scaleFactor,this.ops.scaleFactor,this.t.ACCENT_SELECT_COL)),this.inputEnabled=!0;for(var h=this.t.BUTTON_COL,c=this.comboItemOffset,d=this.comboItemOffset+i;c<d;){var _=c++,f=a?this.comboSelectedTexts.length-1-_:_;if(this.t.BUTTON_COL=f==this.comboSelectedHandle.position?this.t.ACCENT_SELECT_COL:this.t.SEPARATOR_COL,this.button(this.comboSelectedTexts[f],this.comboSelectedAlign)){this.comboToSubmit=f,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.t.BUTTON_COL=h,a||(this.fill(0,0,this._w/this.ops.scaleFactor,this.ops.scaleFactor,this.t.ACCENT_SELECT_COL),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2)),!this.inputReleased&&!this.isEscapeDown||Ai.comboFirst?Ai.comboFirst=!1:(this.comboSelectedHandle=null,Ai.comboFirst=!0),this.inputEnabled=null==this.comboSelectedHandle,this.endRegion(!1),this.globalG.end(),this.g=t}},drawTooltip:function(){""!=this.tooltipText||null!=this.tooltipImg?(this.inputChanged()&&(this.tooltipShown=!1,this.tooltipWait=0==this.inputDX&&0==this.inputDY),this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=G.time()),!this.tooltipWait&&1<G.time()-this.tooltipTime&&(""!=this.tooltipText?this.drawTooltipText():this.drawTooltipImage())):this.tooltipShown=!1},drawTooltipText:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var n=t[i];++i;var r=this.ops.font.width(this.fontSize,n);e<r&&(e=r)}this.tooltipX=Math.min(this.tooltipX,ve.windowWidth()-e-20),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.t.ELEMENT_H*this.ops.scaleFactor*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var s=0,a=t.length;s<a;){var o=s++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}this.globalG.end()},drawTooltipImage:function(){var t=this.tooltipImg.get_width();null!=this.tooltipImgMaxWidth&&t>this.tooltipImgMaxWidth&&(t=this.tooltipImgMaxWidth);var e=this.tooltipImg.get_height()*(t/this.tooltipImg.get_width());this.tooltipX=Math.min(this.tooltipX,ve.windowWidth()-t-20),this.tooltipY=Math.min(this.tooltipY,ve.windowHeight()-e-20),this.globalG.set_color(-16777216),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,t,e),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+e,t,-e):this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY,t,e),this.globalG.end()},drawString:function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);for(var s=e.length;0<e.length&&this.ops.font.width(this.fontSize,e)>this._w;)e=ne.substr(e,0,e.length-1);e.length<s&&(e+=".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.ops.scaleFactor,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==r?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==r&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.t.TEXT_OFFSET*this.ops.scaleFactor),this.enabled||this.fadeColor(),t.set_pipeline(this.rtTextPipeline),t.drawString(e,this._x+i,this._y+this.fontOffsetY+n),t.set_pipeline(null)},endElement:function(t){if(null==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor+this.t.ELEMENT_OFFSET*this.ops.scaleFactor),null==this.currentWindow||0==this.currentWindow.layout)if(-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1)this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit,this.highlightFullRow=!1);else{this.curRatio++,this._x+=this._w;var e=this.ratios[this.curRatio];this._w=0|(e<0?-e:e*this.wBeforeSplit)}else this._x+=this._w+this.t.ELEMENT_OFFSET*this.ops.scaleFactor},highlightNextRow:function(){this.highlightFullRow=!0},getRatio:function(t,e){return t<0?-t:t*e},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w;var e=t[this.curRatio];this._w=0|(e<0?-e:e*this._w)},indent:function(t){null==t&&(t=!0),this._x+=this.t.TAB_W*this.ops.scaleFactor|0,this._w-=this.t.TAB_W*this.ops.scaleFactor|0,t&&(this._w-=this.t.TAB_W*this.ops.scaleFactor|0)},unindent:function(t){null==t&&(t=!0),this._x-=this.t.TAB_W*this.ops.scaleFactor|0,this._w+=this.t.TAB_W*this.ops.scaleFactor|0,t&&(this._w+=this.t.TAB_W*this.ops.scaleFactor|0)},fadeColor:function(){this.g.set_color(N.fromFloats(.00392156862745098*((16711680&this.g.get_color())>>>16),.00392156862745098*((65280&this.g.get_color())>>>8),.00392156862745098*(255&this.g.get_color()),.25))},fill:function(t,e,i,n,r){this.g.set_color(r),this.enabled||this.fadeColor(),this.g.fillRect(this._x+t*this.ops.scaleFactor,this._y+e*this.ops.scaleFactor-1,i*this.ops.scaleFactor,n*this.ops.scaleFactor),this.g.set_color(-1)},rect:function(t,e,i,n,r,s){null==s&&(s=1),this.g.set_color(r),this.enabled||this.fadeColor(),this.g.drawRect(this._x+t*this.ops.scaleFactor,this._y+e*this.ops.scaleFactor,i*this.ops.scaleFactor,n*this.ops.scaleFactor,s),this.g.set_color(-1)},drawRect:function(t,e,i,n,r,s,a){null==a&&(a=0),0==a&&(a=1),this.enabled||this.fadeColor(),e?t.fillRect(i,n-1,r,s+1):t.drawRect(i,n,r,s,a)},isVisible:function(t){return null==this.currentWindow||this._y+t>this.windowHeaderH&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.enabled&&this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.enabled&&this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.enabled&&this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor),!!(this.enabled&&this.inputEnabled&&this.inputStartedX>=this._windowX+this._x&&this.inputStartedX<this._windowX+this._x+this._w&&this.inputStartedY>=this._windowY+this._y)&&this.inputStartedY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor),this.isHovered=this.enabled&&this.inputEnabled&&this.inputX>=this._windowX+(this.highlightFullRow?0:this._x)&&this.inputX<this._windowX+this._x+(this.highlightFullRow?this._windowW:this._w)&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,n,r){return null==r&&(r=1),!!(this.enabled&&this.inputEnabled&&this.inputX>=t*r&&this.inputX<(t+i)*r&&this.inputY>=e*r)&&this.inputY<(e+n)*r},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0,this.inputStartedTime=G.time(),this.setInputPosition(e,i),this.inputStartedX=e,this.inputStartedY=i},onMouseUp:function(t,e,i){this.isScrolling?(this.isScrolling=!1,this.scrollHandle=null,e==this.inputStartedX&&i==this.inputStartedY&&(0==t?this.inputReleased=!0:this.inputReleasedR=!0)):0==t?this.inputReleased=!0:this.inputReleasedR=!0,0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(e,i),this.deselectText(),this.touchHold&&(this.touchHold=!1,this.inputReleased=!1,this.inputReleasedR=!0)},onMouseMove:function(t,e,i,n){this.setInputPosition(t,e)},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyPressed=!0,this.isKeyDown=!0,Ai.keyRepeatTime=G.time()+.4,t){case 8:this.isBackspaceDown=!0;break;case 13:this.isReturnDown=!0;break;case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 27:this.isEscapeDown=!0;break;case 32:this.char=" ";break;case 46:this.isDeleteDown=!0;break;case 65:this.isADown=!0}},onKeyUp:function(t){switch(this.isKeyDown=!1,t){case 8:this.isBackspaceDown=!1;break;case 13:this.isReturnDown=!1;break;case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1;break;case 27:this.isEscapeDown=!1;break;case 46:this.isDeleteDown=!1;break;case 65:this.isADown=!1}},onKeyPress:function(t){this.char=t,this.isKeyPressed=!0},onCut:function(){return Ai.isCut=!0,this.onCopy()},onCopy:function(){return Ai.isCopy=!0,Ai.textToCopy},onPaste:function(t){Ai.isPaste=!0,Ai.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.ops.scaleFactor},ELEMENT_H:function(){return this.t.ELEMENT_H*this.ops.scaleFactor},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.ops.scaleFactor},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.ops.scaleFactor},BUTTON_H:function(){return this.t.BUTTON_H*this.ops.scaleFactor},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.ops.scaleFactor},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor},FONT_SIZE:function(){return this.t.FONT_SIZE*this.ops.scaleFactor|0},SCROLL_W:function(){return this.t.SCROLL_W*this.ops.scaleFactor|0},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET*this.ops.scaleFactor},TAB_W:function(){return this.t.TAB_W*this.ops.scaleFactor|0},HEADER_DRAG_H:function(){return 15*this.ops.scaleFactor|0},SCALE:function(){return this.ops.scaleFactor},FLASH_SPEED:function(){return.5},TOOLTIP_DELAY:function(){return 1},resize:function(t,e,i,n){null==n&&(n=0),t.redraws=2,null!=t.texture&&t.texture.unload(),e<1&&(e=1),i<1&&(i=1),t.texture=P.createRenderTarget(e,i,0,0,1,n),t.texture.get_g2().set_imageScaleQuality(1)},__class__:Ai},n.$haxeUID|=0,T.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=T.String=String,String.__name__=!0,T.Array=Array,Array.__name__=!0,Date.prototype.__class__=T.Date=Date,Date.__name__="Date";var Oi={},Pi={},Ri=Number,Vi=Boolean,Di={},Ui={};et.count=0;var Hi={};Object.defineProperty(ge.prototype,"message",{get:function(){return String(this.val)}}),g.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=b.sliceImpl),re.cwd="",le.defaultWindowW=240,le.windowW=le.defaultWindowW,le.coffX=160,le.coffY=40,le.currentOperation="",le.assetNames=[""],le.showFiles=!1,le.foldersOnly=!1,le.gridSnapBounds=!1,le.gridSnapPos=!0,le.gridUseRelative=!0,le.useRotationSteps=!1,le.gridSize=20,le.rotationSteps=.261799386,le.modalW=625,le.modalH=545,le.modalHeaderH=66,le.modalRectW=625,le.modalRectH=545,le.path="/",X.isManipulating=!1,X.transformStartedMouse=!1,X.drag=!1,X.dragLeft=!1,X.dragTop=!1,X.dragRight=!1,X.dragBottom=!1,X.grab=!1,X.grabX=!1,X.grabY=!1,X.rotate=!1,_e.global=new _e,fe.hwin=_e.global.nest(0,null),J.DEFAULT_RESOLVER=new a,J.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",f.helper=new DataView(new ArrayBuffer(8)),me.images=new k,me.sounds=new I,me.blobs=new E,me.fonts=new C,me.videos=new B,N.Black=-16777216,N.White=-1,N.Red=-65536,N.Blue=-16776961,N.Green=-16711936,N.Magenta=-65281,N.Yellow=-256,N.Cyan=-16711681,N.Purple=-8388480,N.Pink=-16181,N.Orange=-23296,N.Transparent=0,N.invMaxChannelValue=.00392156862745098,y.displays=[],F.Default=new F(!1,!1,!1),G.timeWarpSaveTime=10,G.DIF_COUNT=3,G.maxframetime=.5,G.startTime=0,z.painter_colored_fragData0="s274:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IGZyYWdtZW50Q29sb3I7Cn0KCg",z.painter_colored_vertData0="s439:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",z.painter_image_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",z.painter_image_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",z.painter_text_fragData0="s402:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKaW4gdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUodGV4LCB0ZXhDb29yZCkueCAqIGZyYWdtZW50Q29sb3Iudyk7Cn0KCg",z.painter_text_vertData0="s530:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",z.painter_video_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",z.painter_video_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",ve.renderListeners=[],ve.foregroundListeners=[],ve.resumeListeners=[],ve.pauseListeners=[],ve.backgroundListeners=[],ve.shutdownListeners=[],ve.dropFilesListeners=[],Z.maxGamepads=4,Z.mouseLockListeners=[],q.windows=[],Q.None=0,Q.FeatureResizable=1,Q.FeatureMinimizable=2,Q.FeatureMaximizable=4,Q.FeatureBorderless=8,Q.FeatureOnTop=16,_t.disableGcInteractions=!1,_t.intBox=new ut(0),ft.channelCount=32,ft.lastAllocationCount=0,bt.POLY=79764919,Tt.INVALID_BITS=-1,It.EOP=-1,It.M__PI=3.141592653589793,It.DIVTAB_NUMER=32,It.DIVTAB_DENOM=64,It.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Et.NO_CODE=255,Et.delay=0,Ft.PACKET_ID=1,Ft.PACKET_COMMENT=3,Ft.PACKET_SETUP=5,Dt.CONTINUED_PACKET=1,Dt.FIRST_PAGE=2,Dt.LAST_PAGE=4,Wt.MAX_CHANNELS=16,Wt.PUSHDATA_CRC_COUNT=4,Wt.FAST_HUFFMAN_LENGTH=10,Wt.FAST_HUFFMAN_TABLE_SIZE=1024,Wt.FAST_HUFFMAN_TABLE_MASK=1023,Zt.fontGlyphs=function(){for(var t=[],e=32;e<256;){var i=e++;t.push(i)}return t}(),Be.STBTT_vmove=1,Be.STBTT_vline=2,Be.STBTT_vcurve=3,Be.STBTT_MACSTYLE_DONTCARE=0,Be.STBTT_MACSTYLE_BOLD=1,Be.STBTT_MACSTYLE_ITALIC=2,Be.STBTT_MACSTYLE_UNDERSCORE=4,Be.STBTT_MACSTYLE_NONE=8,Be.STBTT_PLATFORM_ID_UNICODE=0,Be.STBTT_PLATFORM_ID_MAC=1,Be.STBTT_PLATFORM_ID_ISO=2,Be.STBTT_PLATFORM_ID_MICROSOFT=3,Be.STBTT_UNICODE_EID_UNICODE_1_0=0,Be.STBTT_UNICODE_EID_UNICODE_1_1=1,Be.STBTT_UNICODE_EID_ISO_10646=2,Be.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,Be.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,Be.STBTT_MS_EID_SYMBOL=0,Be.STBTT_MS_EID_UNICODE_BMP=1,Be.STBTT_MS_EID_SHIFTJIS=2,Be.STBTT_MS_EID_UNICODE_FULL=10,Be.STBTT_MAC_EID_ROMAN=0,Be.STBTT_MAC_EID_ARABIC=4,Be.STBTT_MAC_EID_JAPANESE=1,Be.STBTT_MAC_EID_HEBREW=5,Be.STBTT_MAC_EID_CHINESE_TRAD=2,Be.STBTT_MAC_EID_GREEK=6,Be.STBTT_MAC_EID_KOREAN=3,Be.STBTT_MAC_EID_RUSSIAN=7,Be.STBTT_MS_LANG_ENGLISH=1033,Be.STBTT_MS_LANG_ITALIAN=1040,Be.STBTT_MS_LANG_CHINESE=2052,Be.STBTT_MS_LANG_JAPANESE=1041,Be.STBTT_MS_LANG_DUTCH=1043,Be.STBTT_MS_LANG_KOREAN=1042,Be.STBTT_MS_LANG_FRENCH=1036,Be.STBTT_MS_LANG_RUSSIAN=1049,Be.STBTT_MS_LANG_GERMAN=1031,Be.STBTT_MS_LANG_SPANISH=1033,Be.STBTT_MS_LANG_HEBREW=1037,Be.STBTT_MS_LANG_SWEDISH=1053,Be.STBTT_MAC_LANG_ENGLISH=0,Be.STBTT_MAC_LANG_JAPANESE=11,Be.STBTT_MAC_LANG_ARABIC=12,Be.STBTT_MAC_LANG_KOREAN=23,Be.STBTT_MAC_LANG_DUTCH=4,Be.STBTT_MAC_LANG_RUSSIAN=32,Be.STBTT_MAC_LANG_FRENCH=1,Be.STBTT_MAC_LANG_SPANISH=6,Be.STBTT_MAC_LANG_GERMAN=2,Be.STBTT_MAC_LANG_SWEDISH=5,Be.STBTT_MAC_LANG_HEBREW=10,Be.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,Be.STBTT_MAC_LANG_ITALIAN=3,Be.STBTT_MAC_LANG_CHINESE_TRAD=19,Be.STBTT_MAX_OVERSAMPLE=8,Be.STBTT_RASTERIZER_VERSION=2,Pe.bufferSize=1500,Pe.vertexSize=9,Re.bufferSize=1e3,Re.triangleBufferSize=1e3,Ve.bufferSize=1e3,Qe.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Qe.instances=[],Qe.connectListeners=[],Qe.disconnectListeners=[],ti.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},ti.keyBehavior=$e.Default,ii.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},ii.wheelEventBlockBehavior=ei.Full,ai.touchDownEventBlockBehavior=si.Full,oi.bufferSize=2e3,li.mat=new Float32Array(16),hi.width=3,hi.height=3,ci.width=4,ci.height=4,pi.width=3,pi.height=3,gi.width=4,gi.height=4,yi.nextId=0,ki.START=0,ki.ENTITY_UPDATES=1,ki.CONTROLLER_UPDATES=2,ki.REMOTE_CALL=3,ki.PING=4,ki.SESSION_ERROR=5,ki.PLAYER_UPDATES=6,ki.RPC_SERVER=0,ki.RPC_ALL=1,Ii.nextId=0,Ii.objects=[],Ci.assetMap=new $,Ci.themes=[],Ci.events=[],Ci.screenW=-1,Ci.screenH=-1,Ci.locale="en",Ci.h=new _e,Ci.elemId=-1,Ci.assetId=-1,Bi.dataPath="",Bi.lastPath="",Bi.kx=1,Bi.ky=.6666666666666666,Bi.kz=.3333333333333333,Bi.kw=3,Bi.ar=[0,0,0],Bi.Kx=0,Bi.Ky=-.3333333333333333,Bi.Kz=.6666666666666666,Bi.Kw=-1,Bi.e=1e-10,Ni.i=0,Li.show=!1,Li.hwnd=new _e,Li.boxTitle="",Li.boxText="",Li.modalX=0,Li.modalY=0,Li.modalW=400,Li.modalH=160,Fi.dark={NAME:"Default Dark",WINDOW_BG_COL:-13421773,WINDOW_TINT_COL:-1,ACCENT_COL:-12303292,ACCENT_HOVER_COL:-11974327,ACCENT_SELECT_COL:-10461088,BUTTON_COL:-12171706,BUTTON_TEXT_COL:-1513499,BUTTON_HOVER_COL:-11974327,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-1513499,LABEL_COL:-3618616,SEPARATOR_COL:-14211289,HIGHLIGHT_COL:-14656100,CONTEXT_COL:-14540254,PANEL_BG_COL:-12895429,FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:24,ELEMENT_OFFSET:4,ARROW_SIZE:5,BUTTON_H:22,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:6,TEXT_OFFSET:8,TAB_W:6,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,LINK_STYLE:0},Fi.light={NAME:"Default Light",WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,SEPARATOR_COL:-6710887,HIGHLIGHT_COL:-14656100,CONTEXT_COL:-5592406,PANEL_BG_COL:-5592406,FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:48,ELEMENT_OFFSET:8,ARROW_SIZE:10,BUTTON_H:44,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:12,TEXT_OFFSET:16,TAB_W:24,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,LINK_STYLE:0},Ai.alwaysRedrawWindow=!0,Ai.keyRepeat=!0,Ai.touchControls=!1,Ai.keyRepeatTime=0,Ai.textToPaste="",Ai.textToCopy="",Ai.isCut=!1,Ai.isCopy=!1,Ai.isPaste=!1,Ai.copyFrame=0,Ai.comboFirst=!0,re.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);