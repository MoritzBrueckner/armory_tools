!function(t,n){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{};function i(){return g.__string_rec(this,"")}var e,x={},f=f||{};function s(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}function pe(t){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.hwin=mi.global.nest(0,null),this.selectedElem=null,this.selectedTheme=null,this.selectedFrame=0,this.rotationSteps=.261799386,this.gridSize=20,this.useRotationSteps=!1,this.gridUseRelative=!0,this.gridSnapPos=!0,this.gridSnapBounds=!1,this.filesDone=null,this.foldersOnly=!1,this.showFiles=!1,this.zoom=1,this.resizeCanvas=!1,this.dragAsset=null,this.assetNames=[""],this.rotate=!1,this.grabY=!1,this.grabX=!1,this.grab=!1,this.dragBottom=!1,this.dragRight=!1,this.dragTop=!1,this.dragLeft=!1,this.drag=!1,this.transformStartedMouse=!1,this.isManipulating=!1,this.currentOperation="",this.dropPath="",0<(this.canvas=t).assets.length){var e=t.assets;t.assets=[];for(var i=0;i<e.length;){var n=e[i];++i,this.importAsset(n.file)}}this.importThemes(),Se.loadEverything(Si(this,this.loaded))}(x.Elements=pe).__name__=!0,pe.__properties__={get_uiw:"get_uiw"},pe.get_uiw=function(){return pe.windowW*ve.prefs.scaleFactor|0},pe.toRelative=function(t,e){t=Te.normalize(t),e=Te.normalize(e);for(var i=[],n=t.split("/"),s=e.split("/"),r=0;n[r]==s[r];)++r;for(var a=0,o=s.length-r;a<o;){a++;i.push("..")}for(var l=r,u=n.length;l<u;){var h=l++;i.push(n[h])}return i.join("/")},pe.toAbsolute=function(t,e){return Te.normalize(e+"/"+t)},pe.toDegrees=function(t){return 57.29578*t},pe.toRadians=function(t){return.0174532924*t},pe.prototype={ui:null,cui:null,canvas:null,toolbarw:null,get_toolbarw:function(){return 140*this.ui.ops.scaleFactor|0},handleSize:null,get_handleSize:function(){return 8*this.ui.ops.scaleFactor|0},dropPath:null,currentOperation:null,isManipulating:null,transformInitInput:null,transformInitPos:null,transformInitRot:null,transformInitSize:null,transformStartedMouse:null,drag:null,dragLeft:null,dragTop:null,dragRight:null,dragBottom:null,grab:null,grabX:null,grabY:null,rotate:null,assetNames:null,dragAsset:null,resizeCanvas:null,zoom:null,showFiles:null,foldersOnly:null,filesDone:null,uimodal:null,gridSnapBounds:null,gridSnapPos:null,gridUseRelative:null,useRotationSteps:null,gridSize:null,rotationSteps:null,selectedFrame:null,selectedTheme:null,selectedElem:null,hwin:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var e=this,t=we.copy(xi.dark);t.FILL_WINDOW_BG=!0,this.ui=new Ti({scaleFactor:ve.prefs.scaleFactor,font:Se.fonts.font_default,theme:t,color_wheel:Se.images.color_wheel}),this.cui=new Ti({scaleFactor:1,font:Se.fonts.font_default,autoNotifyInput:!0,theme:we.copy(vi.getTheme(this.canvas.theme))}),this.uimodal=new Ti({font:Se.fonts.font_default,scaleFactor:ve.prefs.scaleFactor}),null==vi.getTheme(this.canvas.theme)&&(yi.showMessage(new Ti(this.ui.ops),"Error!",'Theme "'+this.canvas.theme+'" was not found!\nUsing first theme in list instead: "'+vi.themes[0].NAME+'"'),this.canvas.theme=vi.themes[0].NAME),Ee.notifyOnDropFiles(function(t){e.dropPath=ye.rtrim(t),e.dropPath=pe.toRelative(e.dropPath,ve.cwd)}),Ee.notifyOnFrames(Si(this,this.onFrames)),W.addTimeTask(Si(this,this.update),0,.016666666666666666)},importAsset:function(r){var a=this,t=ye.endsWith(r,".jpg")||ye.endsWith(r,".png")||ye.endsWith(r,".k")||ye.endsWith(r,".hdr"),e=ye.endsWith(r,".ttf"),i=pe.toAbsolute(r,ve.cwd);i="Windows"==Ee.get_systemId()?ye.replace(i,"/","\\"):i,t?Se.loadImageFromPath(i,!1,function(t){var e=r.split("/"),i=e[e.length-1],n=vi.getAssetId(a.canvas),s={name:i,file:r,id:n};a.canvas.assets.push(s),vi.assetMap.h[s.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:158,className:"Elements",methodName:"importAsset"}):e&&Se.loadFontFromPath(i,function(t){var e=r.split("/"),i=e[e.length-1],n=vi.getAssetId(a.canvas),s={name:i,file:r,id:n};a.canvas.assets.push(s),vi.assetMap.h[s.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:170,className:"Elements",methodName:"importAsset"})},importThemes:function(){var e=this,t=Te.directory(ve.prefs.path),i=Te.join([t,"_themes.json"]);try{Se.loadBlobFromPath(i,function(t){vi.themes=JSON.parse(t.toString()),0==vi.themes.length&&vi.themes.push(we.copy(xi.light)),e.selectedTheme=vi.themes[0]},null,{fileName:"Elements.hx",lineNumber:188,className:"Elements",methodName:"importThemes"})}catch(t){t instanceof ne&&t.val;vi.themes.push(we.copy(xi.light)),this.selectedTheme=vi.themes[0]}},unique:function(t,e,i,n){null==n&&(n=-1);var s=t,r=t.lastIndexOf(".");-1!=r&&4==t.substring(r).length&&(s=t.substring(0,r));for(var a=0;a<e.length;){var o=e[a];if(++a,we.getProperty(o,i)==t){if(-1<n){var l=(null==++n?"null":""+n).length;3<l&&(l=3);for(var u=".",h=0,c=3-l;h<c;){h++;u+="0"}return this.unique(s+u+(null==n?"null":""+n),e,i,n)}return this.unique(s,e,i,0)}}return t},makeElem:function(t){var e="",i=this.cui.t.ELEMENT_H,n=0;switch(t){case 0:e=this.unique("Text",this.canvas.elements,"name");break;case 1:e=this.unique("Image",this.canvas.elements,"name"),i=100;break;case 2:e=this.unique("Button",this.canvas.elements,"name"),n=1;break;case 3:e=this.unique("Empty",this.canvas.elements,"name"),i=100;break;case 6:e=this.unique("Check",this.canvas.elements,"name");break;case 7:e=this.unique("Radio",this.canvas.elements,"name");break;case 8:e=this.unique("Combo",this.canvas.elements,"name");break;case 9:e=this.unique("Slider",this.canvas.elements,"name"),n=2;break;case 10:e=this.unique("TextInput",this.canvas.elements,"name");break;case 11:e=this.unique("KeyInput",this.canvas.elements,"name");break;case 12:e=this.unique("Filled_Rectangle",this.canvas.elements,"name"),i=100;break;case 13:e=this.unique("Rectangle",this.canvas.elements,"name"),i=100;break;case 14:e=this.unique("Filled_Circle",this.canvas.elements,"name");break;case 15:e=this.unique("Circle",this.canvas.elements,"name");break;case 16:e=this.unique("Filled_Triangle",this.canvas.elements,"name");break;case 17:e=this.unique("Triangle",this.canvas.elements,"name");break;case 18:e=this.unique("Progress_bar",this.canvas.elements,"name");break;case 19:e=this.unique("CProgress_bar",this.canvas.elements,"name")}var s={id:vi.getElementId(this.canvas),type:t,name:e,event:"",x:0,y:0,width:150,height:i,rotation:0,text:"My "+e,asset:"",progress_at:0,progress_total:100,strength:1,alignment:g.__cast(n,Ei),anchor:0,parent:null,children:[],visible:!0};return this.canvas.elements.push(s),s},unparent:function(t){var e=this.elemById(t.parent);null!=e&&(t.x+=this.absx(e),t.y+=this.absy(e),t.parent=null,me.remove(e.children,t.id))},setParent:function(t,e){this.elemById(t.parent)!=e&&(this.unparent(t),null!=e&&(null==e.children&&(t.children=[]),e.children.push(t.id),t.parent=e.id,t.x-=this.absx(e),t.y-=this.absy(e)))},duplicateElem:function(t,e){if(null==t)return null;null==e&&(e=t.parent);var i={id:vi.getElementId(this.canvas),type:t.type,name:t.name,event:t.event,x:t.x+10,y:t.y+10,width:t.width,height:t.height,rotation:t.rotation,text:t.text,asset:t.asset,color:t.color,color_text:t.color_text,color_hover:t.color_hover,color_press:t.color_press,color_progress:t.color_progress,progress_at:t.progress_at,progress_total:t.progress_total,strength:t.strength,anchor:t.anchor,parent:e,children:[],visible:t.visible};this.canvas.elements.push(i),null!=e&&(this.elemById(e).children.push(i.id),t.parent!=e&&(i.x=t.x,i.y=t.y));for(var n=0,s=t.children;n<s.length;){var r=s[n];++n,this.duplicateElem(this.elemById(r),i.id)}return i},getEnumTexts:function(){return 0<this.assetNames.length?this.assetNames:[""]},getAssetIndex:function(t){for(var e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(t==this.canvas.assets[n].name)return 1+n}return 0},resize:function(){null!=pe.grid&&(pe.grid.unload(),pe.grid=null),null!=pe.timeline&&(pe.timeline.unload(),pe.timeline=null)},drawGrid:function(){var t=2*this.gridSize,e=Ee.windowWidth()+2*t,i=Ee.windowHeight()+2*t;(pe.grid=M.createRenderTarget(e,i)).get_g2().begin(!0,-14408668);for(var n=0,s=1+(i/t|0);n<s;){var r=n++;pe.grid.get_g2().set_color(-14145496),pe.grid.get_g2().drawLine(0,r*t,e,r*t),pe.grid.get_g2().set_color(-13487566),pe.grid.get_g2().drawLine(0,r*t+this.gridSize,e,r*t+this.gridSize)}for(var a=0,o=1+(e/t|0);a<o;){var l=a++;pe.grid.get_g2().set_color(-14145496),pe.grid.get_g2().drawLine(l*t,0,l*t,i),pe.grid.get_g2().set_color(-13487566),pe.grid.get_g2().drawLine(l*t+this.gridSize,0,l*t+this.gridSize,i)}pe.grid.get_g2().end()},drawTimeline:function(t,e){var i=this.ui.ops.scaleFactor,n=t+e,s=(pe.timeline=M.createRenderTarget(Ee.windowWidth()-pe.get_uiw()-this.get_toolbarw(),n)).get_g2();s.begin(!0,-14540254),s.set_font(Se.fonts.font_default),s.set_fontSize(16*i|0);for(var r=pe.timeline.get_width()/(11*i)|0,a=0,o=1+(r/5|0);a<o;){var l=a++,u=5*l,h=Se.fonts.font_default.width(s.get_fontSize(),u+"");s.drawString(u+"",55*l*i+5*i-h/2,t/2-s.get_fontSize()/2)}for(var c=0,A=r;c<A;){var d=c++;s.set_color(d%5==0?-12303292:-13421773),s.fillRect(11*d*i,n-e,10*i,e)}s.end()},onFrames:function(t){var o=this,e=t[0];yi.show&&this.ui.inputRegistered?(this.ui.unregisterInput(),this.cui.unregisterInput()):yi.show||this.ui.inputRegistered||(this.ui.registerInput(),this.cui.registerInput()),yi.show&&(this.hwin.redraws=1),""!=this.dropPath&&(this.importAsset(this.dropPath),this.dropPath="");var i=this.ui.ops.scaleFactor,n=30*i|0,s=40*i|0;null==pe.grid&&this.drawGrid(),null!=pe.timeline&&pe.timeline.get_height()==n+s||this.drawTimeline(n,s);var r=e.get_g2();if(r.begin(),r.set_color(-1),r.drawImage(pe.grid,pe.coffX%40-40,pe.coffY%40-40),this.canvas.x=pe.coffX,this.canvas.y=pe.coffY,r.drawRect(this.canvas.x,this.canvas.y,this.canvas.width*this.cui.ops.scaleFactor|0,this.canvas.height*this.cui.ops.scaleFactor|0,1),r.drawRect(this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-3,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-3,6,6,1),vi.screenW=this.canvas.width,vi.screenH=this.canvas.height,vi.draw(this.cui,this.canvas,r),null!=this.selectedElem){r.set_color(-1);var a=this.absx(this.selectedElem)*this.cui.ops.scaleFactor|0,l=this.absy(this.selectedElem)*this.cui.ops.scaleFactor|0,u=this.selectedElem.width*this.cui.ops.scaleFactor|0,h=this.selectedElem.height*this.cui.ops.scaleFactor|0,c=this.canvas.x+a+u/2,A=this.canvas.y+l+h/2;r.pushRotation(this.selectedElem.rotation,c,A),r.drawRect(this.canvas.x+a,this.canvas.y+l,u,h),r.set_color(-16777216),r.drawRect(this.canvas.x+a+1,this.canvas.y+l+1,u,h),r.set_color(-1);for(var d=this.rotatePoint(this.ui.inputX,this.ui.inputY,c,A,-this.selectedElem.rotation),_=0;_<3;)for(var f=_++/2,g=0;g<3;){var p=g++/2;if(.5!=f||.5!=p){var m=this.canvas.x+a+u*f-(8*this.ui.ops.scaleFactor|0)/2,v=this.canvas.y+l+h*p-(8*this.ui.ops.scaleFactor|0)/2,w=!1;0==f&&this.dragLeft?0==p&&this.dragTop?w=!0:.5!=p||this.dragTop||this.dragBottom?1==p&&this.dragBottom&&(w=!0):w=!0:.5!=f||this.dragLeft||this.dragRight?1==f&&this.dragRight&&(0==p&&this.dragTop?w=!0:.5!=p||this.dragTop||this.dragBottom?1==p&&this.dragBottom&&(w=!0):w=!0):0==p&&this.dragTop?w=!0:1==p&&this.dragBottom&&(w=!0),w=w&&this.drag,(d.x>m&&d.x<m+(8*this.ui.ops.scaleFactor|0)||w)&&(d.y>v&&d.y<v+(8*this.ui.ops.scaleFactor|0)||w)&&(r.set_color(-14656100),r.fillRect(m,v,8*this.ui.ops.scaleFactor|0,8*this.ui.ops.scaleFactor|0),r.set_color(-1)),r.drawRect(m,v,8*this.ui.ops.scaleFactor|0,8*this.ui.ops.scaleFactor|0)}}r.drawLine(c,this.canvas.y+l,c,this.canvas.y+l-2*(8*this.ui.ops.scaleFactor|0));var b=c,y=this.canvas.y+l-2*(8*this.ui.ops.scaleFactor|0);null==y&&(y=0),null==b&&(b=0);var x=b,T=y,S=d.x-x,E=d.y-T;null==E&&(E=0),null==S&&(S=0);(Math.sqrt(S*S+E*E)<=(8*this.ui.ops.scaleFactor|0)/2||this.rotate)&&(r.set_color(-14656100),Be.fillCircle(r,x,T,(8*this.ui.ops.scaleFactor|0)/2),r.set_color(-1)),Be.drawCircle(r,x,T,(8*this.ui.ops.scaleFactor|0)/2),r.popTransformation()}""!=this.currentOperation&&(r.set_fontSize(14*this.ui.ops.scaleFactor|0),r.set_color(-5592406),r.drawString(this.currentOperation,this.get_toolbarw(),Ee.windowHeight()-pe.timeline.get_height()-r.get_fontSize()));r.set_color(-1);var B=Ee.windowHeight()-pe.timeline.get_height();r.drawImage(pe.timeline,this.get_toolbarw(),B),r.set_color(-14656100),r.fillRect(this.get_toolbarw()+11*this.selectedFrame*i,B+n,10*i,s),r.set_font(Se.fonts.font_default),r.set_fontSize(16*i|0);var k=4*i,I=4*i,C=30*i,L=n-2*k,N=Se.fonts.font_default.width(r.get_fontSize(),""+this.selectedFrame);if(C+I<N&&(C=N+I),r.fillRect(this.get_toolbarw()+11*this.selectedFrame*i+5*i-C/2,B+k,C,L),r.set_color(-1),r.drawString(""+this.selectedFrame,this.get_toolbarw()+11*this.selectedFrame*i+5*i-N/2,B+n/2-r.get_fontSize()/2),r.end(),this.ui.begin(r),this.ui.window(mi.global.nest(1,null),0,0,this.get_toolbarw(),Ee.windowHeight())&&(this.ui.text("Add Elements:"),this.ui.panel(mi.global.nest(2,{selected:!0}),"Basic")&&(this.ui.indent(),this.ui.button("Empty")&&(this.selectedElem=this.makeElem(3)),this.ui.isHovered&&this.ui.tooltip("Creates empty element"),this.ui.button("Text")&&(this.selectedElem=this.makeElem(0)),this.ui.isHovered&&this.ui.tooltip("Create text element"),this.ui.button("Image")&&(this.selectedElem=this.makeElem(1)),this.ui.isHovered&&this.ui.tooltip("Creates image element"),this.ui.unindent()),this.ui.panel(mi.global.nest(3,{selected:!0}),"Buttons")&&(this.ui.indent(),this.ui.button("Button")&&(this.selectedElem=this.makeElem(2)),this.ui.isHovered&&this.ui.tooltip("Creates button element"),this.ui.button("Check")&&(this.selectedElem=this.makeElem(6)),this.ui.isHovered&&this.ui.tooltip("Creates check box element"),this.ui.button("Radio")&&(this.selectedElem=this.makeElem(7)),this.ui.isHovered&&this.ui.tooltip("Creates inline-radio element"),this.ui.unindent()),this.ui.panel(mi.global.nest(4,{selected:!0}),"Inputs")&&(this.ui.indent(),this.ui.button("Text Input")&&(this.selectedElem=this.makeElem(10)),this.ui.isHovered&&this.ui.tooltip("Creates text input element"),this.ui.button("Key Input")&&(this.selectedElem=this.makeElem(11)),this.ui.isHovered&&this.ui.tooltip("Creates key input element"),this.ui.button("Combo Box")&&(this.selectedElem=this.makeElem(8)),this.ui.isHovered&&this.ui.tooltip("Creates combo box element"),this.ui.button("Slider")&&(this.selectedElem=this.makeElem(9)),this.ui.isHovered&&this.ui.tooltip("Creates slider element"),this.ui.unindent()),this.ui.panel(mi.global.nest(5,{selected:!0}),"Shapes")&&(this.ui.indent(),this.ui.button("Rect")&&(this.selectedElem=this.makeElem(13)),this.ui.isHovered&&this.ui.tooltip("Creates rectangle shaped element"),this.ui.button("Fill Rect")&&(this.selectedElem=this.makeElem(12)),this.ui.isHovered&&this.ui.tooltip("Creates filled rectangle shaped element"),this.ui.button("Circle")&&(this.selectedElem=this.makeElem(15)),this.ui.isHovered&&this.ui.tooltip("Creates circle shaped element"),this.ui.button("Fill Circle")&&(this.selectedElem=this.makeElem(14)),this.ui.isHovered&&this.ui.tooltip("Creates filled circle shaped element"),this.ui.button("Triangle")&&(this.selectedElem=this.makeElem(17)),this.ui.isHovered&&this.ui.tooltip("Creates triangle shaped element"),this.ui.button("Fill Triangle")&&(this.selectedElem=this.makeElem(16)),this.ui.isHovered&&this.ui.tooltip("Creates filled triangle shaped element"),this.ui.unindent()),this.ui.panel(mi.global.nest(6,{selected:!0}),"ProgressBars")&&(this.ui.indent(),this.ui.button("RectPB")&&(this.selectedElem=this.makeElem(18)),this.ui.isHovered&&this.ui.tooltip("Creates rectangular progress bar"),this.ui.button("CircularPB")&&(this.selectedElem=this.makeElem(19)),this.ui.isHovered&&this.ui.tooltip("Creates circular progress bar"),this.ui.unindent())),this.ui.window(mi.global.nest(7,null),this.get_toolbarw(),0,Ee.windowWidth()-pe.get_uiw()-this.get_toolbarw(),(this.ui.t.ELEMENT_H+2)*this.ui.ops.scaleFactor|0)&&this.ui.tab(mi.global.nest(8,null),this.canvas.name),this.ui.window(this.hwin,Ee.windowWidth()-pe.get_uiw(),0,pe.get_uiw(),Ee.windowHeight())){var F=mi.global.nest(9,null);if(this.ui.tab(F,"Project")){if(this.ui.button("Save")){this.canvas.x=0,this.canvas.y=0,Krom.fileSaveBytes(ve.prefs.path,xe.ofString(JSON.stringify(this.canvas)).b.bufferValue);var P=me.substr(ve.prefs.path,0,ve.prefs.path.length-5);P+=".files";for(var M="",R=0,O=this.canvas.assets;R<O.length;){var V=O[R];++R,M+=V.file+"\n"}Krom.fileSaveBytes(P,xe.ofString(M).b.bufferValue);var D=Te.join([Te.directory(ve.prefs.path),"_themes.json"]);Krom.fileSaveBytes(D,xe.ofString(JSON.stringify(vi.themes)).b.bufferValue),this.canvas.x=pe.coffX,this.canvas.y=pe.coffY}if(this.ui.panel(mi.global.nest(10,{selected:!1}),"Canvas")){this.ui.indent(),this.ui.button("New")&&(this.canvas.elements=[],this.selectedElem=null),this.ui.isHovered&&this.ui.tooltip("Create new canvas");var U=mi.global.nest(11,{text:this.canvas.name});this.ui.textInput(U,"Name",2),U.changed&&("_themes"==U.text?(yi.showMessage(new Ti(this.ui.ops),"Sorry!",'"_themes" is not a valid canvas name as it is reserved!'),U.text=this.canvas.name):this.canvas.name=U.text),this.ui.row([.5,.5]);var H=mi.global.nest(12,{text:this.canvas.width+""}),W=mi.global.nest(13,{text:this.canvas.height+""});H.text=this.canvas.width+"",W.text=this.canvas.height+"";var G=this.ui.textInput(H,"Width",2),z=this.ui.textInput(W,"Height",2);this.canvas.width=be.parseInt(G),this.canvas.height=be.parseInt(z),this.ui.unindent()}if(this.ui.panel(mi.global.nest(14,{selected:!0}),"Outliner")){this.ui.indent();var X=null;X=function(t,e){var i=!1;o.selectedElem==e&&(o.ui.g.set_color(-14656100),o.ui.g.fillRect(0,o.ui._y,o.ui._windowW,o.ui.t.ELEMENT_H*o.ui.ops.scaleFactor),o.ui.g.set_color(-1));var n=o.ui.getStarted();if(n&&!o.ui.inputDownR&&(o.selectedElem=e),n&&o.ui.inputDownR&&(e==o.selectedElem?o.unparent(e):o.setParent(o.selectedElem,e)),null!=e.children&&0<e.children.length?(o.ui.row([.07692307692307693,.9230769230769231]),i=o.ui.panel(t.nest(e.id,{selected:!0}),"",!0),o.ui.text(e.name)):(o.ui._x+=18,o.ui.text(e.name),o.ui._x-=18),i)for(var s=e.children.length;0<s;){--s;var r=e.children[e.children.length-1-s];o.ui.indent();var a=o.elemById(r);X(t,a),o.ui.unindent()}};for(var Y=0,K=this.canvas.elements.length;Y<K;){var Q=Y++,q=this.canvas.elements[this.canvas.elements.length-1-Q];if(null==q.parent){var j=mi.global.nest(15,null);X(j,q)}}this.ui.row([.25,.25,.25,.25]);this.canvas.elements;this.ui.button("Up")&&null!=this.selectedElem&&this.moveElem(1),this.ui.isHovered&&this.ui.tooltip("Move element up"),this.ui.button("Down")&&null!=this.selectedElem&&this.moveElem(-1),this.ui.isHovered&&this.ui.tooltip("Move element down"),this.ui.button("Remove")&&null!=this.selectedElem&&this.removeSelectedElem(),this.ui.isHovered&&this.ui.tooltip("Delete element"),this.ui.button("Duplicate")&&null!=this.selectedElem&&(this.selectedElem=this.duplicateElem(this.selectedElem)),this.ui.isHovered&&this.ui.tooltip("Create duplicate of element"),this.ui.unindent()}if(null!=this.selectedElem){var Z=this.selectedElem,J=Z.id;if(this.ui.panel(mi.global.nest(16,{selected:!0}),"Properties")){this.ui.indent();var $=null==Z.visible||Z.visible;Z.visible=this.ui.check(mi.global.nest(17,null).nest(J,{selected:$}),"Visible"),Z.name=this.ui.textInput(mi.global.nest(18,null).nest(J,{text:Z.name}),"Name",2),Z.text=this.ui.textInput(mi.global.nest(19,null).nest(J,{text:Z.text}),"Text",2),this.ui.row([.25,.25,.25,.25]);var tt=Z.x+"",et=mi.global.nest(20,null).nest(J,{text:tt}),it=Z.y+"",nt=mi.global.nest(21,null).nest(J,{text:it});et.text=Z.x+"",nt.text=Z.y+"";var st=this.ui.textInput(et,"X",2),rt=this.ui.textInput(nt,"Y",2);Z.x=parseFloat(st),Z.y=parseFloat(rt);var at=Z.width+"",ot=mi.global.nest(22,null).nest(J,{text:at}),lt=Z.height+"",ut=mi.global.nest(23,null).nest(J,{text:lt});ot.text=Z.width+"",ut.text=Z.height+"";var ht=this.ui.textInput(ot,"W",2),ct=this.ui.textInput(ut,"H",2);if(Z.width=0|parseFloat(ht),Z.height=0|parseFloat(ct),13==Z.type||15==Z.type||17==Z.type||18==Z.type||19==Z.type){var At=Z.strength+"",dt=mi.global.nest(24,null).nest(J,{text:At}),_t=this.ui.textInput(dt,"Line Strength",2);Z.strength=0|parseFloat(_t)}if(18==Z.type||19==Z.type){var ft=Z.progress_at+"",gt=mi.global.nest(25,null).nest(J,{text:ft}),pt=this.ui.textInput(gt,"Progress",2),mt=Z.progress_total+"",vt=mi.global.nest(26,null).nest(J,{text:mt}),wt=this.ui.textInput(vt,"Total Progress",2);Z.progress_total=0|parseFloat(wt),Z.progress_at=0|parseFloat(pt)}var bt=mi.global.nest(27,null).nest(J,{value:this.roundPrecision(57.29578*(null==Z.rotation?0:Z.rotation),2)});bt.value=this.roundPrecision(57.29578*Z.rotation,2),360<=bt.value&&(bt.value=0),Z.rotation=.0174532924*this.ui.slider(bt,"Rotation",0,360,!0);var yt=this.ui.combo(mi.global.nest(28,null).nest(J,{position:this.getAssetIndex(Z.asset)}),this.getEnumTexts(),"Asset",!0,2);Z.asset=this.getEnumTexts()[yt],this.ui.unindent()}if(this.ui.panel(mi.global.nest(29,{selected:!1}),"Color")){var xt=function(t,e,i){o.ui.row([.5,.5]);var n=mi.global.nest(30,null).nest(J).nest(t,{color:null!=e?e:i});return wi.colorField(o.ui,n,!0),n.changed&&(e=n.color),!o.ui.button("Reset")&&null!=e||(e=null,n.color=i,n.changed=!1),e};this.ui.indent(),0==Z.type?(this.ui.text("Text:"),Z.color_text=xt(1,Z.color_text,vi.getTheme(this.canvas.theme).TEXT_COL)):2==Z.type?(this.ui.text("Text:"),Z.color_text=xt(1,Z.color_text,vi.getTheme(this.canvas.theme).BUTTON_TEXT_COL),this.ui.text("Background:"),Z.color=xt(2,Z.color,vi.getTheme(this.canvas.theme).BUTTON_COL),this.ui.text("On Hover:"),Z.color_hover=xt(3,Z.color_hover,vi.getTheme(this.canvas.theme).BUTTON_HOVER_COL),this.ui.text("On Pressed:"),Z.color_press=xt(4,Z.color_press,vi.getTheme(this.canvas.theme).BUTTON_PRESSED_COL)):12==Z.type||14==Z.type||13==Z.type||15==Z.type||17==Z.type||16==Z.type?(this.ui.text("Color:"),Z.color=xt(1,Z.color,vi.getTheme(this.canvas.theme).BUTTON_COL)):18==Z.type||19==Z.type?(this.ui.text("Progress:"),Z.color_progress=xt(1,Z.color_progress,vi.getTheme(this.canvas.theme).TEXT_COL),this.ui.text("Background:"),Z.color=xt(2,Z.color,vi.getTheme(this.canvas.theme).BUTTON_COL)):3==Z.type?this.ui.text("No color for element type empty"):(this.ui.text("Text:"),Z.color_text=xt(1,Z.color,vi.getTheme(this.canvas.theme).TEXT_COL),this.ui.text("Background:"),Z.color=xt(2,Z.color,vi.getTheme(this.canvas.theme).BUTTON_COL),this.ui.text("On Hover:"),Z.color_hover=xt(3,Z.color,vi.getTheme(this.canvas.theme).BUTTON_HOVER_COL)),this.ui.unindent()}if(this.ui.panel(mi.global.nest(31,{selected:!1}),"Align")){this.ui.indent();var Tt=mi.global.nest(32,null).nest(J,{position:Z.alignment});this.ui.row([.3333333333333333,.3333333333333333,.3333333333333333]),this.ui.radio(Tt,0,"Left"),this.ui.radio(Tt,1,"Center"),this.ui.radio(Tt,2,"Right"),this.selectedElem.alignment=Tt.position,this.ui.unindent()}if(this.ui.panel(mi.global.nest(33,{selected:!1}),"Anchor")){this.ui.indent();var St=mi.global.nest(34,null).nest(J,{position:Z.anchor});this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(St,0,"Top-Left"),this.ui.radio(St,1,"Top"),this.ui.radio(St,2,"Top-Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(St,3,"Left"),this.ui.radio(St,4,"Center"),this.ui.radio(St,5,"Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(St,6,"Bot-Left"),this.ui.radio(St,7,"Bottom"),this.ui.radio(St,8,"Bot-Right"),Z.anchor=St.position,this.ui.unindent()}this.ui.panel(mi.global.nest(35,{selected:!1}),"Script")&&(this.ui.indent(),Z.event=this.ui.textInput(mi.global.nest(36,null).nest(J,{text:Z.event}),"Event",2),this.ui.unindent());this.ui.panel(mi.global.nest(37,{selected:!1}),"Timeline")}}if(this.ui.tab(F,"Themes")){for(var Et=mi.global.nest(38,null),Bt=mi.global.nest(39,null),kt=function(t,e){if(o.selectedTheme==e&&(o.ui.g.set_color(-14656100),o.ui.g.fillRect(0,o.ui._y,o.ui._windowW,o.ui.t.ELEMENT_H*o.ui.ops.scaleFactor),o.ui.g.set_color(-1)),e==vi.getTheme(o.canvas.theme)){var i=(o.ui.t.BUTTON_H-16)/2;o.ui.g.drawSubImage(Se.images.icons,o.ui._x+i,o.ui._y+i,0,0,16,16)}o.ui.getStarted()&&!o.ui.inputDownR&&(o.selectedTheme=e),o.ui._x+=16,o.ui.text(e.NAME),o.ui._x-=16},It=0,Ct=vi.themes;It<Ct.length;){var Lt=Ct[It];++It,kt(mi.global.nest(40,null),Lt)}if(this.ui.row([.25,.25,.25,.25]),this.ui.button("Add")){var Nt=we.copy(xi.light);Nt.NAME=this.unique("New Theme",vi.themes,"NAME"),vi.themes.push(Nt),this.selectedTheme=Nt}if(null==this.selectedTheme&&(this.ui.enabled=!1),this.ui.button("Copy")){var Ft=we.copy(this.selectedTheme);Ft.NAME=this.unique(Ft.NAME,vi.themes,"NAME"),vi.themes.push(Ft),this.selectedTheme=Ft}this.ui.enabled=!0,null==this.selectedTheme&&(this.ui.enabled=!1);var Pt=Bt.nest(vi.themes.indexOf(this.selectedTheme));if(this.ui.button("Rename")&&(Pt.text=this.selectedTheme.NAME,yi.showCustom(new Ti(this.ui.ops),function(t){t.textInput(Pt),t.button("OK")&&(yi.show=!1,o.hwin.redraws=2)},0|this.ui.inputX,0|this.ui.inputY,200,60)),null!=this.selectedTheme){var Mt=this.selectedTheme.NAME;Pt.changed&&this.selectedTheme.NAME!=Pt.text&&(Mt=this.unique(Pt.text,vi.themes,"NAME"),this.canvas.theme==this.selectedTheme.NAME&&(this.canvas.theme=Mt),this.selectedTheme.NAME=Mt)}if(this.ui.enabled=!0,1!=vi.themes.length&&null!=this.selectedTheme||(this.ui.enabled=!1),this.ui.button("Delete")&&(Et.unnest(vi.themes.indexOf(this.selectedTheme)),Bt.unnest(vi.themes.indexOf(this.selectedTheme)),me.remove(vi.themes,this.selectedTheme),null==vi.getTheme(this.canvas.theme)&&(this.canvas.theme=vi.themes[0].NAME),this.selectedTheme=null),this.ui.enabled=!0,null==this.selectedTheme&&(this.ui.enabled=!1),this.ui.button("Apply to Canvas")&&(this.canvas.theme=this.selectedTheme.NAME),this.ui.enabled=!0,null==this.selectedTheme)this.ui.text("Please select a Theme!");else for(var Rt=[["Text","TEXT_COL"],["Elements","BUTTON_COL","BUTTON_TEXT_COL","BUTTON_HOVER_COL","BUTTON_PRESSED_COL","ACCENT_COL","ACCENT_HOVER_COL","ACCENT_SELECT_COL"]],Ot=0,Vt=Rt.length;Ot<Vt;){var Dt=Ot++;if(this.ui.panel(mi.global.nest(41,null).nest(Dt,{selected:!0}),Rt[Dt][0])){this.ui.indent();for(var Ut=Rt[Dt].slice(1),Ht=0,Wt=Ut.length;Ht<Wt;){var Gt=Ht++,zt=Ut[Gt];this.ui.row([.6666666666666666,.3333333333333333]),this.ui.text(zt);var Xt=we.getProperty(this.selectedTheme,zt),Yt=Et.nest(vi.themes.indexOf(this.selectedTheme)).nest(Dt).nest(Gt,{color:Xt}),Kt=wi.colorField(this.ui,Yt,!0);we.setProperty(this.selectedTheme,zt,Kt)}this.ui.unindent()}}}if(this.ui.tab(F,"Assets"))if(this.ui.button("Import Asset")&&(this.showFiles=!0,this.foldersOnly=!1,this.filesDone=function(t){t=ye.rtrim(t),t=pe.toRelative(t,ve.cwd),o.importAsset(t)}),0<this.canvas.assets.length){this.ui.text("(Drag and drop assets to canvas)",1);for(var Qt=this.canvas.assets.length-1;0<=Qt;){var qt=this.canvas.assets[Qt];ye.endsWith(qt.name,".ttf")||1!=this.ui.image(this.getImage(qt))||(this.dragAsset=qt),this.ui.row([.875,.125]),qt.name=this.ui.textInput(mi.global.nest(42,null).nest(qt.id,{text:qt.name}),"",2),this.assetNames[Qt+1]=qt.name,this.ui.button("X")&&(this.getImage(qt).unload(),this.canvas.assets.splice(Qt,1),this.assetNames.splice(Qt+1,1)),--Qt}}else this.ui.text("(Drag and drop images and fonts here)",1);if(this.ui.tab(F,"Preferences")){if(this.ui.panel(mi.global.nest(43,{selected:!0}),"Application")){this.ui.indent();var jt=mi.global.nest(44,{value:1});this.ui.slider(jt,"UI Scale",.5,4,!0),jt.changed&&!this.ui.inputDown&&(this.ui.setScale(jt.value),pe.windowW=pe.defaultWindowW*jt.value|0);var Zt=this.ui,Jt=mi.global.nest(45,{selected:!0});ve.prefs.window_vsync=Zt.check(Jt,"VSync"),this.ui.unindent()}if(this.ui.panel(mi.global.nest(46,{selected:!0}),"Grid")){this.ui.indent();var $t=mi.global.nest(47,{value:20});this.ui.slider($t,"Grid Size",1,128,!0,1),this.gridSnapPos=this.ui.check(mi.global.nest(48,{selected:!0}),"Grid Snap Position"),this.ui.isHovered&&this.ui.tooltip("Snap the element's position to the grid"),this.gridSnapBounds=this.ui.check(mi.global.nest(49,{selected:!1}),"Grid Snap Bounds"),this.ui.isHovered&&this.ui.tooltip("Snap the element's bounds to the grid"),this.gridUseRelative=this.ui.check(mi.global.nest(50,{selected:!0}),"Use Relative Grid"),this.ui.isHovered&&this.ui.tooltip("Use a grid that's relative to the selected element"),$t.changed&&!this.ui.inputDown&&(this.gridSize=0|$t.value),this.useRotationSteps=this.ui.check(mi.global.nest(51,{selected:!1}),"Use Fixed Rotation Steps"),this.ui.isHovered&&this.ui.tooltip("Rotate elements by a fixed step size");var te=mi.global.nest(52,{value:15});this.useRotationSteps&&this.ui.slider(te,"Rotation Step Size",1,180,!0,1),te.changed&&!this.ui.inputDown&&(this.rotationSteps=.0174532924*te.value),this.ui.unindent()}if(this.ui.panel(mi.global.nest(53,{selected:!0}),"Shortcuts")){this.ui.indent(),this.ui.row([.5,.5]),this.ui.text("Select");var ee=mi.global.nest(54,{position:0});this.ui.combo(ee,["Left Click","Right Click"],""),this.ui.isHovered&&this.ui.tooltip("Mouse button used for element selection."),ee.changed&&(ve.prefs.keyMap.selectMouseButton=["Left","Right"][ee.position]),this.ui.separator(8,!1),this.ui.row([.5,.5]),this.ui.text("Grab");var ie=this.ui,ne=mi.global.nest(55,{value:71});ve.prefs.keyMap.grabKey=wi.keyInput(ie,ne,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for grabbing elements"),this.ui.row([.5,.5]),this.ui.text("Rotate");var se=this.ui,re=mi.global.nest(56,{value:82});ve.prefs.keyMap.rotateKey=wi.keyInput(se,re,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for rotating elements"),this.ui.row([.5,.5]),this.ui.text("Size");var ae=this.ui,oe=mi.global.nest(57,{value:83});ve.prefs.keyMap.sizeKey=wi.keyInput(ae,oe,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for resizing elements"),this.ui.separator(8,!1),this.ui.row([.5,.5]),this.ui.text("Precision Transform");var le=this.ui,ue=mi.global.nest(58,{value:16});ve.prefs.keyMap.slowMovement=wi.keyInput(le,ue,"Key"),this.ui.isHovered&&this.ui.tooltip("More precise transformations"),this.ui.row([.5,.5]),this.ui.text("Invert Grid");var he=this.ui,ce=mi.global.nest(59,{value:17});ve.prefs.keyMap.gridInvert=wi.keyInput(he,ce,"Key"),this.ui.isHovered&&this.ui.tooltip("Invert the grid setting"),this.ui.row([.5,.5]),this.ui.text("Invert Rel. Grid");var Ae=this.ui,de=mi.global.nest(60,{value:18});ve.prefs.keyMap.gridInvertRelative=wi.keyInput(Ae,de,"Key"),this.ui.isHovered&&this.ui.tooltip("Invert the relative grid setting"),this.ui.unindent()}this.ui.panel(mi.global.nest(61,{selected:!1}),"Console")&&(this.ui.indent(),this.ui.text("Mouse X: "+this.ui.inputX),this.ui.text("Mouse Y: "+this.ui.inputY),this.ui.unindent())}}if(this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),r.begin(!1),null!=this.dragAsset){var _e=Math.min(128,this.getImage(this.dragAsset).get_width()),fe=_e/this.getImage(this.dragAsset).get_width(),ge=this.getImage(this.dragAsset).get_height()*fe;r.drawScaledImage(this.getImage(this.dragAsset),this.ui.inputX,this.ui.inputY,_e,ge)}r.end(),0<this.lastW&&(this.lastW!=Ee.windowWidth()||this.lastH!=Ee.windowHeight())?this.resize():0<this.lastCanvasW&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=Ee.windowWidth(),this.lastH=Ee.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,this.showFiles&&this.renderFiles(r),yi.show&&yi.render(r)},elemById:function(t){for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];if(++e,n.id==t)return n}return null},moveElem:function(t){for(var e=this.canvas.elements,i=e.indexOf(this.selectedElem),n=this.selectedElem.parent;!((i+=t)<0||i>=e.length);)if(e[i].parent==n){me.remove(e,this.selectedElem),e.splice(i,0,this.selectedElem);break}},getImage:function(t){return vi.assetMap.h[t.id]},removeElem:function(t){if(null!=t.children)for(var e=0,i=t.children;e<i.length;){var n=i[e];++e,this.removeElem(this.elemById(n))}me.remove(this.canvas.elements,t),null!=t.parent&&(me.remove(this.elemById(t.parent).children,t.id),t.parent=null)},removeSelectedElem:function(){this.removeElem(this.selectedElem),this.selectedElem=null},acceptDrag:function(t){var e=this.makeElem(1);e.asset=this.assetNames[t+1],e.x=this.ui.inputX-this.canvas.x,e.y=this.ui.inputY-this.canvas.y,e.width=this.getImage(this.canvas.assets[t]).get_width(),e.height=this.getImage(this.canvas.assets[t]).get_height(),this.selectedElem=e},hitbox:function(t,e,i,n,s){var r=this.rotatePoint(this.ui.inputX,this.ui.inputY,t+i/2,e+n/2,-s);return r.x>t&&r.x<t+i&&r.y>e&&r.y<e+n},update:function(){if(this.ui.inputReleased&&null!=this.dragAsset){if(this.ui.inputX<Ee.windowWidth()-pe.get_uiw()){for(var t=0,e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(this.canvas.assets[n]==this.dragAsset){t=n;break}}this.acceptDrag(t)}this.dragAsset=null}if(null==this.dragAsset){if(this.updateCanvas(),null!=pe.timeline){var s=Ee.windowHeight()-pe.timeline.get_height();this.ui.inputDown&&this.ui.inputY>s&&this.ui.inputX<Ee.windowWidth()-pe.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=(this.ui.inputX-this.get_toolbarw())/11/this.ui.ops.scaleFactor|0)}if(null!=this.selectedElem){var r=this.selectedElem,a=this.absx(r)*this.cui.ops.scaleFactor|0,o=this.absy(r)*this.cui.ops.scaleFactor|0,l=r.width*this.cui.ops.scaleFactor|0,u=r.height*this.cui.ops.scaleFactor|0,h=this.rotatePoint(this.ui.inputX,this.ui.inputY,this.canvas.x+a+l/2,this.canvas.y+o+u/2,-r.rotation);if(this.ui.inputStarted&&this.ui.inputDown)if(this.hitbox(this.canvas.x+a-(8*this.ui.ops.scaleFactor|0)/2,this.canvas.y+o-(8*this.ui.ops.scaleFactor|0)/2,l+(8*this.ui.ops.scaleFactor|0),u+(8*this.ui.ops.scaleFactor|0),this.selectedElem.rotation))this.drag=!0,this.dragLeft=this.dragRight=this.dragTop=this.dragBottom=!1,h.x>this.canvas.x+a+l-(8*this.ui.ops.scaleFactor|0)?this.dragRight=!0:h.x<this.canvas.x+a+(8*this.ui.ops.scaleFactor|0)&&(this.dragLeft=!0),h.y>this.canvas.y+o+u-(8*this.ui.ops.scaleFactor|0)?this.dragBottom=!0:h.y<this.canvas.y+o+(8*this.ui.ops.scaleFactor|0)&&(this.dragTop=!0),this.startElementManipulation(!0);else{var c=this.canvas.x+a+l/2,A=this.canvas.y+o-2*(8*this.ui.ops.scaleFactor|0);null==A&&(A=0),null==c&&(c=0);var d=c,_=A,f=h.x-d,g=h.y-_;null==g&&(g=0),null==f&&(f=0);Math.sqrt(f*f+g*g)<=(8*this.ui.ops.scaleFactor|0)&&(this.rotate=!0,this.startElementManipulation(!0))}if(this.isManipulating)if(this.hwin.redraws=2,this.transformStartedMouse&&this.ui.inputReleased||!this.transformStartedMouse&&this.ui.inputStarted)this.endElementManipulation();else if(this.ui.isKeyPressed&&this.ui.isEscapeDown||this.ui.inputStartedR)this.endElementManipulation(!0);else if(this.drag){var p=this.ui.inputX,m=this.ui.inputY;null==m&&(m=0),null==p&&(p=0);var v=p,w=m,b=this.transformInitInput,y=v-b.x,x=w-b.y;null==x&&(x=0),null==y&&(y=0);var T=y,S=x;this.transformStartedMouse||(this.ui.isKeyPressed&&88==this.ui.key&&(r.width=0|this.transformInitSize.x,r.height=0|this.transformInitSize.y,this.dragRight=!0,this.dragBottom=!this.dragBottom),this.ui.isKeyPressed&&89==this.ui.key&&(r.width=0|this.transformInitSize.x,r.height=0|this.transformInitSize.y,this.dragBottom=!0,this.dragRight=!this.dragRight)),this.dragRight?(T=this.calculateTransformDelta(T,this.transformInitPos.x+this.transformInitSize.x),r.width=this.transformInitSize.x+T|0):this.dragLeft&&(T=this.calculateTransformDelta(T,this.transformInitPos.x),r.x=this.transformInitPos.x+T,r.width=this.transformInitSize.x-T|0),this.dragBottom?(S=this.calculateTransformDelta(S,this.transformInitPos.y+this.transformInitSize.y),r.height=this.transformInitSize.y+S|0):this.dragTop&&(S=this.calculateTransformDelta(S,this.transformInitPos.y),r.y=this.transformInitPos.y+S,r.height=this.transformInitSize.y-S|0),1!=r.type&&(r.width<1&&(r.width=1),r.height<1&&(r.height=1)),this.dragLeft||this.dragRight||this.dragBottom||this.dragTop?((this.dragBottom||this.dragTop)&&(this.dragLeft||this.dragRight)||(S=0),this.currentOperation=" x: "+r.x+"  y: "+r.y+"  w: "+r.width+"  h: "+r.height+"  (dx: "+T+"  dy: "+S+")"):(this.grab=!0,this.grabX=!0,this.grabY=!0,this.drag=!1)}else if(this.grab){var E=this.ui.inputX,B=this.ui.inputY;null==B&&(B=0),null==E&&(E=0);var k=E,I=B,C=this.transformInitInput,L=k-C.x,N=I-C.y;null==N&&(N=0),null==L&&(L=0);var F=L,P=N;this.ui.isKeyPressed&&88==this.ui.key&&(r.x=this.transformInitPos.x,r.y=this.transformInitPos.y,this.grabX=!0,this.grabY=!this.grabY),this.ui.isKeyPressed&&89==this.ui.key&&(r.x=this.transformInitPos.x,r.y=this.transformInitPos.y,this.grabY=!0,this.grabX=!this.grabX),this.grabX&&(F=this.calculateTransformDelta(F,this.transformInitPos.x),r.x=this.transformInitPos.x+F|0),this.grabY&&(P=this.calculateTransformDelta(P,this.transformInitPos.y),r.y=this.transformInitPos.y+P|0),this.grabX?this.grabY||(P=0):F=0,this.currentOperation=" x: "+r.x+"  y: "+r.y+"  (dx: "+F+"  dy: "+P+")"}else if(this.rotate){var M=this.canvas.x+a+l/2,R=this.canvas.y+o+u/2;null==R&&(R=0),null==M&&(M=0);var O=M,V=R,D=this.ui.inputX,U=this.ui.inputY;null==U&&(U=0),null==D&&(D=0);var H=D-O,W=U-V;null==W&&(W=0),null==H&&(H=0);var G=H,z=W,X=-Math.atan2(G,z)+Math.PI;(this.ui.isKeyDown&&this.ui.key==ve.prefs.keyMap.gridInvert)!=this.useRotationSteps&&(X=Math.round(X/this.rotationSteps)*this.rotationSteps),r.rotation=X,this.currentOperation=" Rot: "+this.roundPrecision(57.29578*X,2)+"deg"}this.ui.isKeyPressed&&!this.ui.isTyping&&(this.grab||this.ui.key!=ve.prefs.keyMap.grabKey||(this.startElementManipulation(),this.grab=!0,this.grabX=!0,this.grabY=!0),this.drag||this.ui.key!=ve.prefs.keyMap.sizeKey||(this.startElementManipulation(),this.drag=!0,this.dragLeft=!1,this.dragTop=!1,this.dragRight=!0,this.dragBottom=!0),this.rotate||this.ui.key!=ve.prefs.keyMap.rotateKey||(this.startElementManipulation(),this.rotate=!0),this.isManipulating||(37==this.ui.key&&(this.gridSnapPos?r.x-=this.gridSize:r.x--),39==this.ui.key&&(this.gridSnapPos?r.x+=this.gridSize:r.x++),38==this.ui.key&&(this.gridSnapPos?r.y-=this.gridSize:r.y--),40==this.ui.key&&(this.gridSnapPos?r.y+=this.gridSize:r.y++),this.ui.isBackspaceDown||this.ui.isDeleteDown?this.removeSelectedElem():68==this.ui.key&&(this.selectedElem=this.duplicateElem(r))))}else this.endElementManipulation();yi.show&&yi.update(),this.updateFiles()}},startElementManipulation:function(t){null==t&&(t=!1),this.isManipulating&&this.endElementManipulation(!0),this.transformInitInput=new oi(this.ui.inputX,this.ui.inputY),this.transformInitPos=new oi(this.selectedElem.x,this.selectedElem.y),this.transformInitSize=new oi(this.selectedElem.width,this.selectedElem.height),this.transformInitRot=this.selectedElem.rotation,this.transformStartedMouse=t,this.isManipulating=!0},endElementManipulation:function(t){null==t&&(t=!1),t&&(this.selectedElem.x=this.transformInitPos.x,this.selectedElem.y=this.transformInitPos.y,this.selectedElem.width=0|this.transformInitSize.x,this.selectedElem.height=0|this.transformInitSize.y,this.selectedElem.rotation=this.transformInitRot),this.isManipulating=!1,this.grab=!1,this.drag=!1,this.rotate=!1,this.transformStartedMouse=!1,this.currentOperation=""},updateCanvas:function(){if(!(this.showFiles||this.ui.inputX>Ee.windowWidth()-pe.get_uiw())){var t=ve.prefs.keyMap.selectMouseButton;if("Left"==t&&this.ui.inputStarted&&this.ui.inputDown||"Right"==t&&this.ui.inputStartedR&&this.ui.inputDownR){this.canvas.elements.length;for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];++e;var s=this.absx(n)*this.cui.ops.scaleFactor|0,r=this.absy(n)*this.cui.ops.scaleFactor|0,a=n.width*this.cui.ops.scaleFactor|0,o=n.height*this.cui.ops.scaleFactor|0;if(this.hitbox(this.canvas.x+s,this.canvas.y+r,a,o,n.rotation)&&this.selectedElem!=n){this.selectedElem=n;break}}}this.isManipulating||(this.ui.inputDownR&&(pe.coffX+=0|this.ui.inputDX,pe.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta&&(this.zoom+=-this.ui.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.ops.scaleFactor=this.zoom)),this.ui.inputStarted&&this.hitbox(this.canvas.x+(this.canvas.width*this.cui.ops.scaleFactor|0)-3,this.canvas.y+(this.canvas.height*this.cui.ops.scaleFactor|0)-3,6,6)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,this.canvas.width<1&&(this.canvas.width=1),this.canvas.height<1&&(this.canvas.height=1))}},updateFiles:function(){if(this.showFiles&&this.ui.inputReleased){var t=Ee.windowWidth(),e=Ee.windowHeight(),i=t/2-pe.modalRectW/2,n=t/2+pe.modalRectW/2,s=e/2-pe.modalRectH/2,r=e/2+pe.modalRectH/2;(this.ui.inputX<i||this.ui.inputX>n||this.ui.inputY<s+pe.modalHeaderH||this.ui.inputY>r)&&(this.showFiles=!1)}},renderFiles:function(t){var e=Ee.windowWidth(),i=Ee.windowHeight(),n=e/2-pe.modalW/2,s=i/2-pe.modalH/2;t.begin(!1),t.set_color(-14671840),t.fillRect(n,s,pe.modalW,pe.modalH),t.end();var r=e/2-pe.modalRectW/2|0,a=e/2+pe.modalRectW/2|0,o=i/2-pe.modalRectH/2|0,l=i/2+pe.modalRectH/2|0;if(o+=pe.modalHeaderH,this.uimodal.begin(t),this.uimodal.window(mi.global.nest(62,null),r,o,pe.modalRectW,pe.modalRectH-100)){var u=mi.global.nest(63,null);u.text=this.uimodal.textInput(u),pe.path=wi.fileBrowser(this.uimodal,u,this.foldersOnly)}this.uimodal.end(!1),t.begin(!1),this.uimodal.beginRegion(t,a-100,l-30,100),this.uimodal.button("OK")&&(this.showFiles=!1,this.filesDone(pe.path)),this.uimodal.endRegion(!1),this.uimodal.beginRegion(t,a-200,l-30,100),this.uimodal.button("Cancel")&&(this.showFiles=!1),this.uimodal.endRegion(),t.end()},absx:function(t){return null==t?0:t.x+this.absx(this.elemById(t.parent))},absy:function(t){return null==t?0:t.y+this.absy(this.elemById(t.parent))},roundPrecision:function(t,e){return null==e&&(e=0),t=1*(0|(t*=Math.pow(10,e))),t/=Math.pow(10,e)},rotatePoint:function(t,e,i,n,s){e-=n;var r=(t-=i)*Math.cos(s)-e*Math.sin(s),a=t*Math.sin(s)+e*Math.cos(s);return new oi(i+r,n+a)},calculateTransformDelta:function(t,e){null==e&&(e=0);var i=this.ui.isKeyDown&&this.ui.key==ve.prefs.keyMap.slowMovement,n=this.gridSnapPos!=(this.ui.isKeyDown&&this.ui.key==ve.prefs.keyMap.gridInvert),s=this.gridUseRelative!=(this.ui.isKeyDown&&this.ui.key==ve.prefs.keyMap.gridInvertRelative);return n?(t=Math.round(t/this.gridSize)*this.gridSize,i&&(t/=2),s&&0!=e&&((e%=this.gridSize)>this.gridSize/2&&(e=-(this.gridSize-e)),t-=e),t):i?t/2:t},scaled:function(t){return t*this.cui.ops.scaleFactor|0},__class__:pe,__properties__:{get_handleSize:"get_handleSize",get_toolbarw:"get_toolbarw"}};var me=function(){};(x.HxOverrides=me).__name__=!0,me.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var s=t.split(" "),r=s[0].split("-"),a=s[1].split(":");return new Date(r[0],r[1]-1,r[2],a[0],a[1],a[2]);default:throw new ne("Invalid date format : "+t)}},me.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},me.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},me.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},me.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};function l(){}(x.Lambda=l).__name__=!0,l.array=function(t){for(var e,i=[],n=(e=t)instanceof Array?me.iter(e):e.iterator();n.hasNext();){var s=n.next();i.push(s)}return i};var ve=function(){};(x.Main=ve).__name__=!0,ve.main=function(){var t=1600,e=900;null!=w.get_primary()&&(t>w.get_primary().get_width()&&(t=w.get_primary().get_width()),e>w.get_primary().get_height()-30&&(e=w.get_primary().get_height()-30)),Ee.start(new X("Armory2D",t,e,null,new F(null,null,null,null,null,2)),ve.initialized)},ve.initialized=function(t){ve.prefs={path:"",scaleFactor:1,keyMap:{selectMouseButton:"Left",grabKey:71,rotateKey:82,sizeKey:83,slowMovement:16,gridInvert:17,gridInvertRelative:18}};var e=Krom.getArgCount();if(4<e&&(ve.prefs.path=Krom.getArg(3)),5<e){var i=parseFloat(Krom.getArg(4));ve.prefs.scaleFactor=i}var n=ve.prefs.path.split("/");n.pop(),ve.cwd=n.join("/");var s="Windows"==Ee.get_systemId()?ye.replace(ve.prefs.path,"/","\\"):ve.prefs.path;Se.loadBlobFromPath(s,function(t){var e=JSON.parse(t.toString());ve.inst=new pe(e)},null,{fileName:"Main.hx",lineNumber:51,className:"Main",methodName:"initialized"})},ve.loadDefaultKeyMap=function(){ve.prefs.keyMap.grabKey=71,ve.prefs.keyMap.rotateKey=82,ve.prefs.keyMap.sizeKey=83,ve.prefs.keyMap.slowMovement=16,ve.prefs.keyMap.gridInvert=17,ve.prefs.keyMap.gridInvertRelative=18},Math.__name__=!0;var we=function(){};(x.Reflect=we).__name__=!0,we.field=function(t,e){try{return t[e]}catch(t){t instanceof ne&&t.val;return null}},we.getProperty=function(t,e){var i;return null==t?null:!!t.__properties__&&(i=t.__properties__["get_"+e])?t[i]():t[e]},we.setProperty=function(t,e,i){var n;!!t.__properties__&&(n=t.__properties__["set_"+e])?t[n](i):t[e]=i},we.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},we.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},we.copy=function(t){if(null==t)return null;for(var e={},i=0,n=we.fields(t);i<n.length;){var s=n[i];++i,e[s]=we.field(t,s)}return e};var be=function(){};(x.Std=be).__name__=!0,be.string=function(t){return g.__string_rec(t,"")},be.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e};var ye=function(){};(x.StringTools=ye).__name__=!0,ye.endsWith=function(t,e){var i=e.length,n=t.length;return i<=n&&t.indexOf(e,n-i)==n-i},ye.isSpace=function(t,e){var i=me.cca(t,e);return 8<i&&i<14||32==i},ye.rtrim=function(t){for(var e=t.length,i=0;i<e&&ye.isSpace(t,e-i-1);)++i;return 0<i?me.substr(t,0,e-i):t},ye.replace=function(t,e,i){return t.split(e).join(i)};function T(){}(x.Type=T).__name__=!0,T.createEnum=function(t,e,i){var n=we.field(t,e);if(null==n)throw new ne("No such constructor "+e);if(we.isFunction(n)){if(null==i)throw new ne("Constructor "+e+" need parameters");return n.apply(t,i)}if(null!=i&&0!=i.length)throw new ne("Constructor "+e+" does not need parameters");return n},T.getInstanceFields=function(t){var e=[];for(var i in t.prototype)e.push(i);return me.remove(e,"__class__"),me.remove(e,"__properties__"),e};var Mt={};(x["_UInt.UInt_Impl_"]=Mt).__name__=!0,Mt.gt=function(t,e){var i=t<0;return i!=e<0?i:e<t},Mt.gte=function(t,e){var i=t<0;return i!=e<0?i:e<=t},Mt.toFloat=function(t){return t<0?4294967296+t:t+0};function r(){}(x["haxe.IMap"]=r).__name__=!0,r.__isInterface__=!0;function L(){}(x["haxe.Log"]=L).__name__=!0,L.formatOutput=function(t,e){var i=be.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e.customParams)for(var s=0,r=e.customParams;s<r.length;){var a=r[s];++s,i+=", "+be.string(a)}return n+": "+i},L.trace=function(t,e){var i=L.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};function a(){}(x["haxe._Unserializer.DefaultResolver"]=a).__name__=!0,a.prototype={resolveClass:function(t){return x[t]},resolveEnum:function(t){return f[t]},__class__:a};var J=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=J.DEFAULT_RESOLVER;null==e&&(e=new a,J.DEFAULT_RESOLVER=e),this.resolver=e};(x["haxe.Unserializer"]=J).__name__=!0,J.initCodes=function(){for(var t=[],e=0,i=J.BASE64.length;e<i;){var n=e++;t[J.BASE64.charCodeAt(n)]=n}return t},J.run=function(t){return new J(t).unserialize()},J.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||57<n)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return parseFloat(me.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new ne("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new ne("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new ne("Invalid enum format");var i=this.readDigits();if(0==i)return T.createEnum(t,e);for(var n=[];0<i--;)n.push(this.unserialize());return T.createEnum(t,e,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new ne("Class not found "+t);return e;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new ne("Enum not found "+i);return n;case 67:var s=this.unserialize(),r=this.resolver.resolveClass(s);if(null==r)throw new ne("Class not found "+s);var a=Object.create(r.prototype);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new ne("Invalid custom data");return a;case 77:var o=new et;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new ne("Invalid string reference");return this.scache[u];case 97:this.buf;var h=[];for(this.cache.push(h);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var A=this.readDigits();h[h.length+A-1]=null}else h.push(this.unserialize())}return h;case 98:var d=new it;this.cache.push(d);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var _=this.unserialize(),f=this.unserialize();null!=Ni[_]?d.setReserved(_,f):d.h[_]=f}return this.pos++,d;case 99:var g=this.unserialize(),p=this.resolver.resolveClass(g);if(null==p)throw new ne("Class not found "+g);var m=Object.create(p.prototype);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var v=this.unserialize(),w=this.resolver.resolveEnum(v);if(null==w)throw new ne("Enum not found "+v);this.pos++;var b=this.readDigits(),y=w.__constructs__.slice()[b];if(null==y)throw new ne("Unknown enum index "+v+"@"+b);var x=this.unserializeEnum(w,y);return this.cache.push(x),x;case 107:return NaN;case 108:var T=new tt;this.cache.push(T);for(this.buf;104!=this.buf.charCodeAt(this.pos);)T.add(this.unserialize());return this.pos++,T;case 109:return-1/0;case 110:return null;case 111:var S={};return this.cache.push(S),this.unserializeObject(S),S;case 112:return 1/0;case 113:var E=new $;this.cache.push(E);this.buf;for(var B=this.buf.charCodeAt(this.pos++);58==B;){var k=this.readDigits(),I=this.unserialize();E.h[k]=I,B=this.buf.charCodeAt(this.pos++)}if(104!=B)throw new ne("Invalid IntMap format");return E;case 114:var C=this.readDigits();if(C<0||C>=this.cache.length)throw new ne("Invalid reference");return this.cache[C];case 115:var L=this.readDigits(),N=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<L)throw new ne("Invalid bytes length");var F=J.CODES;null==F&&(F=J.initCodes(),J.CODES=F);for(var P=this.pos,M=3&L,R=P+(L-M),O=new xe(new ArrayBuffer(3*(L>>2)+(2<=M?M-1:0))),V=0;P<R;){var D=F[N.charCodeAt(P++)],U=F[N.charCodeAt(P++)];O.b[V++]=D<<2|U>>4;var H=F[N.charCodeAt(P++)];O.b[V++]=U<<4|H>>2;var W=F[N.charCodeAt(P++)];O.b[V++]=H<<6|W}if(2<=M){var G=F[N.charCodeAt(P++)],z=F[N.charCodeAt(P++)];if(O.b[V++]=G<<2|z>>4,3==M){var X=F[N.charCodeAt(P++)];O.b[V++]=z<<4|X>>2}}return this.pos+=L,this.cache.push(O),O;case 116:return!0;case 118:var Y;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(Y=me.strDate(me.substr(this.buf,this.pos,19)),this.pos+=19):Y=new Date(this.readFloat()),this.cache.push(Y),Y;case 119:var K=this.unserialize(),Q=this.resolver.resolveEnum(K);if(null==Q)throw new ne("Enum not found "+K);var q=this.unserializeEnum(Q,this.unserialize());return this.cache.push(q),q;case 120:throw ne.wrap(this.unserialize());case 121:var j=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<j)throw new ne("Invalid string length");var Z=me.substr(this.buf,this.pos,j);return this.pos+=j,Z=decodeURIComponent(Z.split("+").join(" ")),this.scache.push(Z),Z;case 122:return 0}throw this.pos--,new ne("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:J};var $=function(){this.h={}};(x["haxe.ds.IntMap"]=$).__name__=!0,$.__interfaces__=[r],$.prototype={h:null,remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return me.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:$};var tt=function(){this.length=0};(x["haxe.ds.List"]=tt).__name__=!0,tt.prototype={h:null,q:null,length:null,add:function(t){var e=new o(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:tt};var o=function(t,e){this.item=t,this.next=e};(x["haxe.ds._List.ListNode"]=o).__name__=!0,o.prototype={item:null,next:null,__class__:o};var et=function(){this.h={__keys__:{}}};(x["haxe.ds.ObjectMap"]=et).__name__=!0,et.__interfaces__=[r],et.prototype={h:null,set:function(t,e){var i=t.__id__||(t.__id__=n.$haxeUID++);this.h[i]=e,this.h.__keys__[i]=t},__class__:et};var it=function(){this.h={}};(x["haxe.ds.StringMap"]=it).__name__=!0,it.__interfaces__=[r],it.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:it};var xe=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(x["haxe.io.Bytes"]=xe).__name__=!0,xe.ofString=function(t,e){if(e==A.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,s=t.length;n<s;){var r=n++,a=t.charCodeAt(r);i[r<<1]=255&a,i[r<<1|1]=a>>8}return new xe(i.buffer)}for(var o=[],l=0;l<t.length;){var u=t.charCodeAt(l++);55296<=u&&u<=56319&&(u=u-55232<<10|1023&t.charCodeAt(l++)),u<=127?o.push(u):(u<=2047?o.push(192|u>>6):(u<=65535?o.push(224|u>>12):(o.push(240|u>>18),o.push(128|u>>12&63)),o.push(128|u>>6&63)),o.push(128|63&u))}return new xe(new Uint8Array(o).buffer)},xe.ofData=function(t){var e=t.hxBytes;return null!=e?e:new xe(t)},xe.prototype={length:null,b:null,data:null,blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new ne(d.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new ne(d.OutsideBounds);return new xe(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getDouble:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(t,!0)},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setDouble:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(t,e,!0)},setFloat:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(t,e,!0)},getUInt16:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(t,!0)},getInt32:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new ne(d.OutsideBounds);null==i&&(i=A.UTF8);var n="",s=this.b,r=t,a=t+e;switch(i._hx_index){case 0:for(;r<a;){var o=s[r++];if(o<128){if(0==o)break;n+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&s[r++];n+=String.fromCodePoint(l)}else if(o<240){var u=(31&o)<<12|(127&s[r++])<<6|127&s[r++];n+=String.fromCodePoint(u)}else{var h=(15&o)<<18|(127&s[r++])<<12|(127&s[r++])<<6|127&s[r++];n+=String.fromCodePoint(h)}}break;case 1:for(;r<a;){var c=s[r++]|s[r++]<<8;n+=String.fromCodePoint(c)}}return n},toString:function(){return this.getString(0,this.length)},__class__:xe};function u(){this.pos=0,this.size=0}(x["haxe.io.BytesBuffer"]=u).__name__=!0,u.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var n=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(n,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),s=new Uint8Array(n);0<this.size&&s.set(this.u8),this.size=i,this.buffer=n,this.u8=s,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new xe(new ArrayBuffer(0));var t=new xe(this.buffer);return t.length=this.pos,t},__class__:u};function h(){}(x["haxe.io.Input"]=h).__name__=!0,h.prototype={bigEndian:null,readByte:function(){throw new ne("Not implemented")},readBytes:function(t,e,i){var n=i,s=t.b;if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);try{for(;0<n;)s[e]=this.readByte(),++e,--n}catch(t){var r=t instanceof ne?t.val:t;if(!(r instanceof m))throw t}return i-n},readFullBytes:function(t,e,i){for(;0<i;){var n=this.readBytes(t,e,i);if(0==n)throw new ne(d.Blocked);e+=n,i-=n}},read:function(t){for(var e=new xe(new ArrayBuffer(t)),i=0;0<t;){var n=this.readBytes(e,i,t);if(0==n)throw new ne(d.Blocked);i+=n,t-=n}return e},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=new xe(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:h};function ht(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i}(x["haxe.io.BytesInput"]=ht).__name__=!0,ht.__super__=h,ht.prototype=s(h.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new ne(new m);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);if(0==this.len&&0<i)throw new ne(new m);this.len<i&&(i=this.len);for(var n=this.b,s=t.b,r=0,a=i;r<a;){var o=r++;s[e+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:ht,__properties__:{set_position:"set_position"}});function c(){}(x["haxe.io.Output"]=c).__name__=!0,c.prototype={bigEndian:null,writeByte:function(t){throw new ne("Not implemented")},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);for(var n=t.b,s=i;0<s;)this.writeByte(n[e]),++e,--s;return i},write:function(t){for(var e=t.length,i=0;0<e;){var n=this.writeBytes(t,i,e);if(0==n)throw new ne(d.Blocked);i+=n,e-=n}},writeFloat:function(t){this.writeInt32(_.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:c};function ct(){this.b=new u}(x["haxe.io.BytesOutput"]=ct).__name__=!0,ct.__super__=c,ct.prototype=s(c.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:ct});var A=f["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},m=function(){};(x["haxe.io.Eof"]=m).__name__=!0,m.prototype={toString:function(){return"Eof"},__class__:m};var d=f["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:((e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}}).__params__=["e"],e)},_=function(){};(x["haxe.io.FPHelper"]=_).__name__=!0,_.floatToI32=function(t){return _.helper.setFloat32(0,t,!0),_.helper.getInt32(0,!0)};var Te=function(t){switch(t){case".":case"..":return this.dir=t,void(this.file="")}var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");e<i?(this.dir=me.substr(t,0,i),t=me.substr(t,i+1,null),this.backslash=!0):i<e?(this.dir=me.substr(t,0,e),t=me.substr(t,e+1,null)):this.dir=null;var n=t.lastIndexOf(".");-1!=n?(this.ext=me.substr(t,n+1,null),this.file=me.substr(t,0,n)):(this.ext=null,this.file=t)};(x["haxe.io.Path"]=Te).__name__=!0,Te.directory=function(t){var e=new Te(t);return null==e.dir?"":e.dir},Te.join=function(t){for(var e=[],i=0,n=t;i<n.length;){var s=n[i];++i,null!=s&&""!=s&&e.push(s)}var r=e;if(0==r.length)return"";for(var a=r[0],o=1,l=r.length;o<l;){var u=o++;a=Te.addTrailingSlash(a),a+=r[u]}return Te.normalize(a)},Te.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,n=t.split("/");i<n.length;){var s=n[i];++i,".."==s&&0<e.length&&".."!=e[e.length-1]?e.pop():""==s?(0<e.length||47==me.cca(t,0))&&e.push(s):"."!=s&&e.push(s)}for(var r="",a=!1,o=!1,l=0,u=e.join("/");l<u.length;){var h=u,c=l++,A=h.charCodeAt(c);55296<=A&&A<=56319&&(A=A-55232<<10|1023&h.charCodeAt(1+c));65536<=A&&++l;var d=A;switch(d){case 47:if(a){var _=d;a=!1,o&&(r+="/",o=!1),r+=String.fromCodePoint(_)}else o=!0;break;case 58:r+=":",a=!0;break;default:var f=d;a=!1,o&&(r+="/",o=!1),r+=String.fromCodePoint(f)}}return r},Te.addTrailingSlash=function(t){if(0==t.length)return"/";var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");return e<i?i!=t.length-1?t+"\\":t:e!=t.length-1?t+"/":t},Te.prototype={dir:null,file:null,ext:null,backslash:null,__class__:Te};var ne=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,ne)};(x["js._Boot.HaxeError"]=ne).__name__=!0,ne.wrap=function(t){return t instanceof Error?t:new ne(t)},ne.__super__=Error,ne.prototype=s(Error.prototype,{val:null,__class__:ne});var g=function(){};(x["js.Boot"]=g).__name__=!0,g.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var i=g.__nativeClassName(t);return null!=i?g.__resolveNativeClass(i):null},g.__string_rec=function(s,r){if(null==s)return"null";if(5<=r.length)return"<...>";var t=typeof s;switch("function"==t&&(s.__name__||s.__ename__)&&(t="object"),t){case"function":return"<function>";case"object":if(s.__enum__){var e=f[s.__enum__],i=e.__constructs__[s._hx_index],a=e[i];return a.__params__?(r+="\t",i+"("+function(){for(var t=[],e=0,i=a.__params__;e<i.length;){var n=i[e];e+=1,t.push(g.__string_rec(s[n],r))}return t}().join(",")+")"):i}if(s instanceof Array){var n="[";r+="\t";for(var o=0,l=s.length;o<l;){var u=o++;n+=(0<u?",":"")+g.__string_rec(s[u],r)}return n+="]"}var h;try{h=s.toString}catch(t){t instanceof ne&&t.val;return"???"}if(null!=h&&h!=Object.toString&&"function"==typeof h){var c=s.toString();if("[object Object]"!=c)return c}var A="{\n";r+="\t";var d=null!=s.hasOwnProperty,_=null;for(_ in s)d&&!s.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=A.length&&(A+=", \n"),A+=r+_+" : "+g.__string_rec(s[_],r));return A+="\n"+(r=r.substring(1))+"}";case"string":return s;default:return String(s)}},g.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;if(Object.prototype.hasOwnProperty.call(t,"__interfaces__"))for(var i=t.__interfaces__,n=0,s=i.length;n<s;){var r=i[n++];if(r==e||g.__interfLoop(r,e))return!0}return g.__interfLoop(t.__super__,e)},g.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case Ii:return"boolean"==typeof t;case Bi:return null!=t;case ki:return"number"==typeof t;case Ei:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(g.__downcastCheck(t,e))return!0}else if("object"==typeof e&&g.__isNativeObj(e)&&t instanceof e)return!0;return e==Ci&&null!=t.__name__||(e==Li&&null!=t.__ename__||null!=t.__enum__&&f[t.__enum__]==e)}},g.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&g.__interfLoop(g.getClass(t),e)},g.__cast=function(t,e){if(null==t||g.__instanceof(t,e))return t;throw new ne("Cannot cast "+be.string(t)+" to "+be.string(e))},g.__nativeClassName=function(t){var e=g.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},g.__isNativeObj=function(t){return null!=g.__nativeClassName(t)},g.__resolveNativeClass=function(t){return n[t]};function p(){}(x["js.lib._ArrayBuffer.ArrayBufferCompat"]=p).__name__=!0,p.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),n=new Uint8Array(i.byteLength);return n.set(i),n.buffer};function S(){this.names=["color_wheel","icons"],this.iconsDescription={name:"icons",original_height:512,original_width:512,files:["icons.png"],type:"image"},this.iconsName="icons",this.icons=null,this.color_wheelDescription={name:"color_wheel",original_height:270,original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null}(x["kha._Assets.ImageList"]=S).__name__=!0,S.prototype={get:function(t){return we.field(this,t)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(e,t){Se.loadImage("color_wheel",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:126,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},icons:null,iconsName:null,iconsDescription:null,iconsLoad:function(e,t){Se.loadImage("icons",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:126,className:"kha._Assets.ImageList",methodName:"iconsLoad"})},iconsUnload:function(){this.icons.unload(),this.icons=null},names:null,__class__:S};function E(){this.names=[]}(x["kha._Assets.SoundList"]=E).__name__=!0,E.prototype={get:function(t){return we.field(this,t)},names:null,__class__:E};function B(){this.names=[]}(x["kha._Assets.BlobList"]=B).__name__=!0,B.prototype={get:function(t){return we.field(this,t)},names:null,__class__:B};function k(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null}(x["kha._Assets.FontList"]=k).__name__=!0,k.prototype={get:function(t){return we.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){Se.loadFont("font_default",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:138,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:k};function I(){this.names=[]}(x["kha._Assets.VideoList"]=I).__name__=!0,I.prototype={get:function(t){return we.field(this,t)},names:null,__class__:I};var Se=function(){};(x["kha.Assets"]=Se).__name__=!0,Se.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},Se.loadEverything=function(t,e,s,i){for(var n=[S,E,B,k,I],r=[Se.images,Se.sounds,Se.blobs,Se.fonts,Se.videos],a=0,o=0;o<n.length;){var l=n[o];++o;for(var u=0,h=T.getInstanceFields(l);u<h.length;){var c=h[u];++u,ye.endsWith(c,"Description")&&(a+=1)}}if(0!=a)for(var A=a,d=function(e,i,t){var n=e.name;switch(e.type){case"blob":Se.loadBlob(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:122,className:"kha.Assets",methodName:"loadEverything"});break;case"font":Se.loadFont(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:124,className:"kha.Assets",methodName:"loadEverything"});break;case"image":Se.loadImage(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:113,className:"kha.Assets",methodName:"loadEverything"});break;case"sound":Se.loadSound(n,function(t){null==s||s(e)?t.uncompress(i):i()},t,{fileName:"kha/Assets.hx",lineNumber:115,className:"kha.Assets",methodName:"loadEverything"});break;case"video":Se.loadVideo(n,function(t){i()},t,{fileName:"kha/Assets.hx",lineNumber:126,className:"kha.Assets",methodName:"loadEverything"})}},_=function(){--A,Se.progress=1-A/a,0==A&&t()},f=function(t){Se.reporter(i,{fileName:"kha/Assets.hx",lineNumber:137,className:"kha.Assets",methodName:"loadEverything"})(t),_()},g=0,p=n.length;g<p;)for(var m=g++,v=r[m],w=0,b=T.getInstanceFields(n[m]);w<b.length;){var y=b[w];if(++w,ye.endsWith(y,"Description")){var x=we.field(v,y);null==e||e(x)?d(x,_,f):_()}}else t()},Se.loadImage=function(e,i,t,n){var s=we.field(Se.images,e+"Description");D.loadImageFromDescription(s,function(t){Se.images[e]=t,i(t)},Se.reporter(t,n))},Se.loadImageFromPath=function(t,e,i,n,s){var r={files:[t],readable:e};D.loadImageFromDescription(r,i,Se.reporter(n,s))},Se.get_imageFormats=function(){return D.getImageFormats()},Se.loadBlob=function(e,i,t,n){var s=we.field(Se.blobs,e+"Description");D.loadBlobFromDescription(s,function(t){Se.blobs[e]=t,i(t)},Se.reporter(t,n))},Se.loadBlobFromPath=function(t,e,i,n){var s={files:[t]};D.loadBlobFromDescription(s,e,Se.reporter(i,n))},Se.loadSound=function(e,i,t,n){var s=we.field(Se.sounds,e+"Description");D.loadSoundFromDescription(s,function(t){Se.sounds[e]=t,i(t)},Se.reporter(t,n))},Se.loadSoundFromPath=function(t,e,i,n){var s={files:[t]};D.loadSoundFromDescription(s,e,Se.reporter(i,n))},Se.get_soundFormats=function(){return D.getSoundFormats()},Se.loadFont=function(e,i,t,n){var s=we.field(Se.fonts,e+"Description");D.loadFontFromDescription(s,function(t){Se.fonts[e]=t,i(t)},Se.reporter(t,n))},Se.loadFontFromPath=function(t,e,i,n){var s={files:[t]};D.loadFontFromDescription(s,e,Se.reporter(i,n))},Se.get_fontFormats=function(){return["ttf"]},Se.loadVideo=function(e,i,t,n){var s=we.field(Se.videos,e+"Description");D.loadVideoFromDescription(s,function(t){Se.videos[e]=t,i(t)},Se.reporter(t,n))},Se.loadVideoFromPath=function(t,e,i,n){var s={files:[t]};D.loadVideoFromDescription(s,e,Se.reporter(i,n))},Se.get_videoFormats=function(){return D.getVideoFormats()},Se.reporter=function(t,e){if(null!=t)return t;var i=L.trace,n=e;return function(t){i(t,n)}};function v(){}(x["kha.Canvas"]=v).__name__=!0,v.__isInterface__=!0,v.prototype={get_width:null,get_height:null,get_g1:null,get_g2:null,get_g4:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:v,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var C={};(x["kha._Color.Color_Impl_"]=C).__name__=!0,C.__properties__={set_value:"set_value",get_value:"get_value",set_A:"set_A",get_A:"get_A",set_B:"set_B",get_B:"get_B",set_G:"set_G",get_G:"get_G",set_R:"set_R",get_R:"get_R",set_Ab:"set_Ab",get_Ab:"get_Ab",set_Bb:"set_Bb",get_Bb:"get_Bb",set_Gb:"set_Gb",get_Gb:"get_Gb",set_Rb:"set_Rb",get_Rb:"get_Rb"},C.fromValue=function(t){return C._new(t)},C.fromBytes=function(t,e,i,n){return null==n&&(n=255),C._new(n<<24|t<<16|e<<8|i)},C.fromFloats=function(t,e,i,n){return null==n&&(n=1),C._new((255*n|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*i|0)},C.fromString=function(t){if(7!=t.length&&9!=t.length||35!=t.charCodeAt(0))throw new ne("Invalid Color string: '"+t+"'");var e=be.parseInt("0x"+me.substr(t,1,null));return 7==t.length&&(e+=-16777216),C._new(e)},C._new=function(t){return t},C.get_value=function(t){return t},C.set_value=function(t,e){return e},C.get_Rb=function(t){return(16711680&t)>>>16},C.get_Gb=function(t){return(65280&t)>>>8},C.get_Bb=function(t){return 255&t},C.get_Ab=function(t){return t>>>24},C.set_Rb=function(t,e){return t=t>>>24<<24|e<<16|(65280&t)>>>8<<8|255&t,e},C.set_Gb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|e<<8|255&t,e},C.set_Bb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|e,e},C.set_Ab=function(t,e){return t=e<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|255&t,e},C.get_R=function(t){return.00392156862745098*((16711680&t)>>>16)},C.get_G=function(t){return.00392156862745098*((65280&t)>>>8)},C.get_B=function(t){return.00392156862745098*(255&t)},C.get_A=function(t){return.00392156862745098*(t>>>24)},C.set_R=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(255*e|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e},C.set_G=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(255*e|0)<<8|.00392156862745098*(255&t)*255|0,e},C.set_B=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|255*e|0,e},C.set_A=function(t,e){return t=(255*e|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e};var w=function(t,e){this.num=t,this.isPrimary=e};(x["kha.Display"]=w).__name__=!0,w.__properties__={get_all:"get_all",get_primary:"get_primary"},w.init=function(){for(var t=0,e=Krom.displayCount();t<e;){var i=t++;w.displays.push(new w(i,Krom.displayIsPrimary(i)))}},w.get_primary=function(){w.init();for(var t=0,e=w.displays;t<e.length;){var i=e[t];if(++t,i.isPrimary)return i}return null},w.get_all=function(){return w.init(),w.displays},w.prototype={num:null,isPrimary:null,get_available:function(){return!0},get_name:function(){return"Display"},get_x:function(){return Krom.displayX(this.num)},get_y:function(){return Krom.displayY(this.num)},get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},get_pixelsPerInch:function(){return Krom.screenDpi()},get_modes:function(){return[]},__class__:w,__properties__:{get_modes:"get_modes",get_pixelsPerInch:"get_pixelsPerInch",get_frequency:"get_frequency",get_height:"get_height",get_width:"get_width",get_y:"get_y",get_x:"get_x",get_name:"get_name",get_available:"get_available"}};function b(t,e,i,n){this.width=t,this.height=e,this.frequency=i,this.bitsPerPixel=n}(x["kha.DisplayMode"]=b).__name__=!0,b.prototype={width:null,height:null,frequency:null,bitsPerPixel:null,__class__:b};function y(t,e,i){this.bold=t,this.italic=e,this.underlined=i}(x["kha.FontStyle"]=y).__name__=!0,y.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:y};function N(t,e,i,n){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=n}(x["kha.Framebuffer"]=N).__name__=!0,N.__interfaces__=[v],N.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(t,e,i){this.graphics1=t,this.graphics2=e,this.graphics4=i},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return Ee.windowWidth(this.window)},height:null,get_height:function(){return Ee.windowHeight(this.window)},__class__:N,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1"}};var F=function(t,e,i,n,s,r){null==r&&(r=1),null==s&&(s=8),null==n&&(n=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=n,this.stencilBufferBits=s,this.samplesPerPixel=r};(x["kha.FramebufferOptions"]=F).__name__=!0,F.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:F};function P(){}(x["kha.Resource"]=P).__name__=!0,P.__isInterface__=!0,P.prototype={unload:null,__class__:P};var M=function(t){this.pixels=null,this.texture_=t};(x["kha.Image"]=M).__name__=!0,M.__interfaces__=[P,v],M.__properties__={get_nonPow2Supported:"get_nonPow2Supported",get_maxSize:"get_maxSize"},M.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 1:return 5;case 2:return 3;case 3:return 4;case 4:return 1;case 5:return 2;case 6:return 6;default:return 0}},M.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},M.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},M.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;case 6:return 7;default:return 1}},M._fromTexture=function(t){return new M(t)},M.fromBytes=function(t,e,i,n,s){null==n&&(n=0);var r=new M(null);return r.format=n,r.texture_=Krom.createTextureFromBytes(t.b.bufferValue,e,i,M.getTextureFormat(n),!0),r},M.fromBytes3D=function(t,e,i,n,s,r){null==s&&(s=0);var a=new M(null);return a.format=s,a.texture_=Krom.createTextureFromBytes3D(t.b.bufferValue,e,i,n,M.getTextureFormat(s),!0),a},M.fromEncodedBytes=function(t,e,i,n,s){null==s&&(s=!1);var r=new M(null);r.texture_=Krom.createTextureFromEncodedBytes(t.b.bufferValue,e,s),i(r)},M.create=function(t,e,i,n){null==i&&(i=0);var s=new M(null);return s.format=i,s.texture_=Krom.createTexture(t,e,M.getTextureFormat(i)),s},M.create3D=function(t,e,i,n,s){null==n&&(n=0);var r=new M(null);return r.format=n,r.texture_=Krom.createTexture3D(t,e,i,M.getTextureFormat(n)),r},M.createRenderTarget=function(t,e,i,n,s,r){null==r&&(r=0),null==s&&(s=1),null==n&&(n=0),null==i&&(i=0);var a=new M(null);return a.format=i,a.renderTarget_=Krom.createRenderTarget(t,e,M.getDepthBufferBits(n),M.getRenderTargetFormat(i),M.getStencilBufferBits(n),r),a},M.get_maxSize=function(){return 4096},M.get_nonPow2Supported=function(){return!0},M.renderTargetsInvertedY=function(){return Krom.renderTargetsInvertedY()},M.formatByteSize=function(t){switch(t){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},M.prototype={texture_:null,renderTarget_:null,format:null,readable:null,graphics1:null,graphics2:null,graphics4:null,isOpaque:function(t,e){return!1},at:function(t,e){return-16777216},unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(t){return null==t&&(t=0),xe.ofData(Krom.lockTexture(this.texture_,t))},unlock:function(){Krom.unlockTexture(this.texture_)},pixels:null,getPixels:function(){return null!=this.renderTarget_?(null==this.pixels&&(this.pixels=new xe(new ArrayBuffer(M.formatByteSize(this.format)*this.get_width()*this.get_height()))),Krom.getRenderTargetPixels(this.renderTarget_,this.pixels.b.bufferValue),this.pixels):xe.ofData(Krom.getTexturePixels(this.texture_))},generateMipmaps:function(t){null==this.texture_?Krom.generateRenderTargetMipmaps(this.renderTarget_,t):Krom.generateTextureMipmaps(this.texture_,t)},setMipmaps:function(t){Krom.setMipmaps(this.texture_,t)},setDepthStencilFrom:function(t){Krom.setDepthStencilFrom(this.renderTarget_,t.renderTarget_)},clear:function(t,e,i,n,s,r,a){Krom.clearTexture(this.texture_,t,e,i,n,s,r,a)},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},depth:null,get_depth:function(){return null!=this.texture_?this.texture_.depth:1},realWidth:null,get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},realHeight:null,get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},g1:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new zt(this)),this.graphics1},g2:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new Le(this)),this.graphics2},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new Je(this)),this.graphics4},__class__:M,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};function R(){}(x["kha.AlignedQuad"]=R).__name__=!0,R.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:R};function O(t,e,i,n,s,r,a,o){this.mySize=t,this.width=s,this.height=r,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var u=a[l];++l,u.yoff+=this.baseline}this.texture=M.fromBytes(o.toBytes(),s,r,1)}(x["kha.KravurImage"]=O).__name__=!0,O.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,n){if(e>=this.chars.length)return null;var s=1/this.width,r=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*s,t.t0=a.y0*r,t.s1=a.x1*s,t.t1=a.y1*r,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=O.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,n=O.charBlocks.length/2|0;i<n;){var s=i++,r=O.charBlocks[2*s-1],a=O.charBlocks[2*s];a-1<t&&(e+=a-1-r)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,n=t.length;i<n;){var s=i++;e+=this.getCharWidth(me.cca(t,s))}return e},charactersWidth:function(t,e,i){for(var n=0,s=e,r=e+i;s<r;){var a=s++;n+=this.getCharWidth(t[a])}return n},getBaselinePosition:function(){return this.baseline},__class__:O};function V(t){this.images=new $,this.blob=t}(x["kha.Kravur"]=V).__name__=!0,V.__interfaces__=[P],V.fromBytes=function(t){return new V(Ze.fromBytes(t))},V.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=Gt.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(O.charBlocks=[e[0]])[0]+1,n=1,s=e.length;n<s;){var r=n++;e[r]!=i?(O.charBlocks.push(e[r-1]),O.charBlocks.push(e[r]),i=e[r]+1):++i}O.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(this.images.h.hasOwnProperty(a))return this.images.h[a];for(var o=64,l=32,u=new Array(e.length),h=0,c=u.length;h<c;){u[h++]=new Jt}for(var A=null,d=-1;d<=0;)l<o?l*=2:o*=2,A=Ze.alloc(o*l),d=he.stbtt_BakeFontBitmap(this.blob,0,t,A,o,l,e,u);var _=new se;he.stbtt_InitFont(_,this.blob,0);var f=he.stbtt_GetFontVMetrics(_),g=he.stbtt_ScaleForPixelHeight(_,t),p=Math.round(f.ascent*g),m=Math.round(f.descent*g),v=Math.round(f.lineGap*g),w=new O(0|t,p,m,v,o,l,u,A);return this.images.h[a]=w},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},widthOfCharacters:function(t,e,i,n){return this._get(t).charactersWidth(e,i,n)},baseline:function(t){return this._get(t).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:V};var D=function(){};(x["kha.LoaderImpl"]=D).__name__=!0,D.getImageFormats=function(){return["png","jpg"]},D.loadImageFromDescription=function(t,e,i){var n=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;e(M._fromTexture(Krom.loadImage(t.files[0],n)))},D.getSoundFormats=function(){return["wav","ogg"]},D.loadSoundFromDescription=function(t,e,i){e(new $e(xe.ofData(Krom.loadSound(t.files[0]))))},D.getVideoFormats=function(){return["webm"]},D.loadVideoFromDescription=function(t,e,i){},D.loadBlobFromDescription=function(t,e,i){e(new Ze(xe.ofData(Krom.loadBlob(t.files[0]))))},D.loadFontFromDescription=function(t,e,i){D.loadBlobFromDescription(t,function(t){e(new V(t))},i)};function U(){}(x["kha.TimeTask"]=U).__name__=!0,U.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:U};function H(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1}(x["kha.FrameTask"]=H).__name__=!0,H.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:H};var W=function(){};(x["kha.Scheduler"]=W).__name__=!0,W.init=function(){W.deltas=[];for(var t=0,e=W.DIF_COUNT;t<e;){var i=t++;W.deltas[i]=0}W.stopped=!0,W.frame_tasks_sorted=!0,W.current=W.lastTime=W.realTime(),W.currentFrameTaskId=0,W.currentTimeTaskId=0,W.currentGroupId=0,W.timeTasks=[],W.pausedTimeTasks=[],W.outdatedTimeTasks=[],W.timeTasksScratchpad=[],W.frameTasks=[],W.toDeleteFrame=[]},W.start=function(t){null==t&&(t=!1),W.vsync=Q.get(0).get_vSynced();var e=w.get_primary().get_frequency();57<=e&&e<=63&&(e=60),W.onedifhz=1/e,W.stopped=!1,W.resetTime(),W.lastTime=W.realTime()-W.startTime;for(var i=0,n=W.DIF_COUNT;i<n;){var s=i++;W.deltas[s]=0}if(t){for(var r=0,a=W.timeTasks;r<a.length;){var o=a[r];++r,o.paused=!1}for(var l=0,u=W.frameTasks;l<u.length;){var h=u[l];++l,h.paused=!1}}},W.stop=function(){W.stopped=!0},W.isStopped=function(){return W.stopped},W.warpTimeTasksBack=function(t,e){for(var i=0;i<e.length;){var n=e[i];if(++i,n.start>=t)n.next=n.start;else if(0<n.period){var s=t-n.start,r=Math.ceil(s/n.period);n.next=n.start+r*n.period}}},W.warp=function(t){if(t<W.lastTime){W.current=t,W.lastTime=t,W.warpTimeTasksBack(t,W.outdatedTimeTasks),W.warpTimeTasksBack(t,W.timeTasks);for(var e=0,i=W.outdatedTimeTasks;e<i.length;){var n=i[e];++e,n.next>=t&&W.timeTasksScratchpad.push(n)}for(var s=0,r=W.timeTasksScratchpad;s<r.length;){var a=r[s];++s,me.remove(W.outdatedTimeTasks,a)}for(var o=0,l=W.timeTasksScratchpad;o<l.length;){var u=l[o];++o,W.insertSorted(W.timeTasks,u)}for(;0<W.timeTasksScratchpad.length;)me.remove(W.timeTasksScratchpad,W.timeTasksScratchpad[0])}else t>W.lastTime&&(W.startTime-=t-W.lastTime,W.current=t,W.lastTime=t,W.executeTimeTasks(t))},W.executeFrame=function(){var t=W.realTime()-W.startTime-W.lastTime,e=W.current;if(0<=t){if(null==fi.the())if(t>W.maxframetime)W.startTime+=t-W.maxframetime,e+=t=W.maxframetime;else if(W.vsync){for(var i=W.onedifhz;i<t-W.onedifhz;)i+=W.onedifhz;t=i;for(var n=0,s=W.DIF_COUNT-2;n<s;){var r=n++;t+=W.deltas[r],W.deltas[r]=W.deltas[1+r]}t+=W.deltas[W.DIF_COUNT-2],t/=W.DIF_COUNT,W.deltas[W.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=W.DIF_COUNT-1;a<o;){var l=a++;W.deltas[l]=W.deltas[1+l]}W.deltas[W.DIF_COUNT-1]=t;for(var u=0,h=0,c=W.DIF_COUNT;h<c;){var A=h++;u+=W.deltas[A]}e+=u/=W.DIF_COUNT}else e+=t;W.lastTime=e,W.stopped||(W.current=e);for(var d=0,_=W.pausedTimeTasks;d<_.length;){var f=_[d];++d,f.next+=t}if(W.stopped)for(var g=0,p=W.timeTasks;g<p.length;){var m=p[g];++g,m.next+=t}W.executeTimeTasks(e);for(var v=0,w=W.outdatedTimeTasks;v<w.length;){var b=w[v];++v,b.next<e-10&&W.timeTasksScratchpad.push(b)}for(var y=0,x=W.timeTasksScratchpad;y<x.length;){var T=x[y];++y,me.remove(W.outdatedTimeTasks,T)}for(;0<W.timeTasksScratchpad.length;)me.remove(W.timeTasksScratchpad,W.timeTasksScratchpad[0])}W.sortFrameTasks();for(var S=0,E=W.frameTasks;S<E.length;){var B=E[S];++S,W.stopped||B.paused||!B.active||B.task()||(B.active=!1)}for(var k=0,I=W.frameTasks;k<I.length;){var C=I[k];++k,C.active||W.toDeleteFrame.push(C)}for(;0<W.toDeleteFrame.length;)me.remove(W.frameTasks,W.toDeleteFrame.pop())},W.executeTimeTasks=function(t){for(;0<W.timeTasks.length&&(W.activeTimeTask=W.timeTasks[0],W.activeTimeTask.next<=t);)W.activeTimeTask.next+=W.activeTimeTask.period,me.remove(W.timeTasks,W.activeTimeTask),W.activeTimeTask.active&&W.activeTimeTask.task()?0<W.activeTimeTask.period&&(0==W.activeTimeTask.duration||W.activeTimeTask.duration>=W.activeTimeTask.start+W.activeTimeTask.next)?W.insertSorted(W.timeTasks,W.activeTimeTask):W.archiveTimeTask(W.activeTimeTask,t):(W.activeTimeTask.active=!1,W.archiveTimeTask(W.activeTimeTask,t));W.activeTimeTask=null},W.archiveTimeTask=function(t,e){},W.time=function(){return W.current},W.realTime=function(){return Ee.get_time()},W.resetTime=function(){var t=Ee.get_time(),e=t-W.startTime;W.startTime=t;for(var i=0,n=W.timeTasks;i<n.length;){var s=n[i];++i,s.start-=e,s.next-=e}for(var r=0,a=W.DIF_COUNT;r<a;){var o=r++;W.deltas[o]=0}W.current=0,W.lastTime=0},W.addBreakableFrameTask=function(t,e){return W.frameTasks.push(new H(t,e,++W.currentFrameTaskId)),W.frame_tasks_sorted=!1,W.currentFrameTaskId},W.addFrameTask=function(t,e){return W.addBreakableFrameTask(function(){return t(),!0},e)},W.pauseFrameTask=function(t,e){for(var i=0,n=W.frameTasks;i<n.length;){var s=n[i];if(++i,s.id==t){s.paused=e;break}}},W.removeFrameTask=function(t){for(var e=0,i=W.frameTasks;e<i.length;){var n=i[e];if(++e,n.id==t){n.active=!1;break}}},W.generateGroupId=function(){return++W.currentGroupId},W.addBreakableTimeTaskToGroup=function(t,e,i,n,s){null==s&&(s=0),null==n&&(n=0);var r=new U;return r.active=!0,r.task=e,r.id=++W.currentTimeTaskId,r.groupId=t,r.start=W.current+i,(r.period=0)!=n&&(r.period=n),(r.duration=0)!=s&&(r.duration=r.start+s),r.next=r.start,W.insertSorted(W.timeTasks,r),r.id},W.addTimeTaskToGroup=function(t,e,i,n,s){return null==s&&(s=0),null==n&&(n=0),W.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,n,s)},W.addBreakableTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),W.addBreakableTimeTaskToGroup(0,t,e,i,n)},W.addTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),W.addTimeTaskToGroup(0,t,e,i,n)},W.getTimeTask=function(t){if(null!=W.activeTimeTask&&W.activeTimeTask.id==t)return W.activeTimeTask;for(var e=0,i=W.timeTasks;e<i.length;){var n=i[e];if(++e,n.id==t)return n}for(var s=0,r=W.pausedTimeTasks;s<r.length;){var a=r[s];if(++s,a.id==t)return a}return null},W.pauseTimeTask=function(t,e){var i=W.getTimeTask(t);null!=i&&W.pauseRunningTimeTask(i,e),null!=W.activeTimeTask&&W.activeTimeTask.id==t&&(W.activeTimeTask.paused=e)},W.pauseRunningTimeTask=function(t,e){(t.paused=e)?(me.remove(W.timeTasks,t),W.pausedTimeTasks.push(t)):(W.insertSorted(W.timeTasks,t),me.remove(W.pausedTimeTasks,t))},W.pauseTimeTasks=function(t,e){for(var i=0,n=W.timeTasks;i<n.length;){var s=n[i];++i,s.groupId==t&&W.pauseRunningTimeTask(s,e)}null!=W.activeTimeTask&&W.activeTimeTask.groupId==t&&(W.activeTimeTask.paused=e)},W.removeTimeTask=function(t){var e=W.getTimeTask(t);null!=e&&(e.active=!1,me.remove(W.timeTasks,e))},W.removeTimeTasks=function(t){for(var e=0,i=W.timeTasks;e<i.length;){var n=i[e];++e,n.groupId==t&&(n.active=!1,W.timeTasksScratchpad.push(n))}for(var s=0,r=W.timeTasksScratchpad;s<r.length;){var a=r[s];++s,me.remove(W.timeTasks,a)}for(;0<W.timeTasksScratchpad.length;)me.remove(W.timeTasksScratchpad,W.timeTasksScratchpad[0]);null!=W.activeTimeTask&&W.activeTimeTask.groupId==t&&(W.activeTimeTask.active=!1)},W.numTasksInSchedule=function(){return W.timeTasks.length+W.frameTasks.length},W.insertSorted=function(t,e){for(var i=0,n=t.length;i<n;){var s=i++;if(t[s].next>e.next)return void t.splice(s,0,e)}t.push(e)},W.sortFrameTasks=function(){W.frame_tasks_sorted||(W.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),W.frame_tasks_sorted=!0)};function G(){}(x["kha.Shaders"]=G).__name__=!0,G.init=function(){var t=[],e=we.field(G,"painter_colored_fragData0"),i=J.run(e);t.push(Ze.fromBytes(i)),G.painter_colored_frag=new de(t,["painter-colored.frag.d3d11"]);var n=[],s=we.field(G,"painter_colored_vertData0"),r=J.run(s);n.push(Ze.fromBytes(r)),G.painter_colored_vert=new He(n,["painter-colored.vert.d3d11"]);var a=[],o=we.field(G,"painter_image_fragData0"),l=J.run(o);a.push(Ze.fromBytes(l)),G.painter_image_frag=new de(a,["painter-image.frag.d3d11"]);var u=[],h=we.field(G,"painter_image_vertData0"),c=J.run(h);u.push(Ze.fromBytes(c)),G.painter_image_vert=new He(u,["painter-image.vert.d3d11"]);var A=[],d=we.field(G,"painter_text_fragData0"),_=J.run(d);A.push(Ze.fromBytes(_)),G.painter_text_frag=new de(A,["painter-text.frag.d3d11"]);var f=[],g=we.field(G,"painter_text_vertData0"),p=J.run(g);f.push(Ze.fromBytes(p)),G.painter_text_vert=new He(f,["painter-text.vert.d3d11"]);var m=[],v=we.field(G,"painter_video_fragData0"),w=J.run(v);m.push(Ze.fromBytes(w)),G.painter_video_frag=new de(m,["painter-video.frag.d3d11"]);var b=[],y=we.field(G,"painter_video_vertData0"),x=J.run(y);b.push(Ze.fromBytes(x)),G.painter_video_vert=new He(b,["painter-video.vert.d3d11"])};function z(){this.sampleRate=0,this.channels=0,this.length=0}(x["kha.Sound"]=z).__name__=!0,z.__interfaces__=[P],z.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(t){if(null==this.uncompressedData){var e=new ct,i=vt.readAll(this.compressedData,e,!0),n=e.getBytes(),s=n.length/4|0;if(1==i.channel){this.length=s/lt.samplesPerSecond;var r=new Float32Array(2*s);this.uncompressedData=r;for(var a=0,o=s;a<o;){var l=a++;this.uncompressedData[2*l]=n.getFloat(4*l),this.uncompressedData[2*l+1]=n.getFloat(4*l)}}else{this.length=s/2/lt.samplesPerSecond;var u=new Float32Array(s);this.uncompressedData=u;for(var h=0,c=s;h<c;){var A=h++;this.uncompressedData[A]=n.getFloat(4*A)}}this.channels=i.channel,this.sampleRate=i.sampleRate,this.compressedData=null,t()}else t()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:z};var X=function(t,e,i,n,s){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==n?new j(null,null,null,null,null,null,null,null,null):n,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<i?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==s?new F(null,null,null,null,null,null):s};(x["kha.SystemOptions"]=X).__name__=!0,X.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:X};var Ee=function(){};(x["kha.System"]=Ee).__name__=!0,Ee.__properties__={get_refreshRate:"get_refreshRate",get_vsync:"get_vsync",get_language:"get_language",get_systemId:"get_systemId",get_screenRotation:"get_screenRotation",get_time:"get_time",get_title:"get_title"},Ee.init=function(t,e){var i=0;t.resizable&&(i|=1),t.maximizable&&(i|=4),t.minimizable&&(i|=2);var n=new X(t.title,t.width,t.height,new j(null,null,null,null,null,null,null,i,t.windowMode),new F(null,t.vSync,null,null,null,t.samplesPerPixel));Ee.start(n,function(t){e()})},Ee.start=function(t,e){Ee.theTitle=t.title,Y.init(t,e)},Ee.get_title=function(){return Ee.theTitle},Ee.notifyOnRender=function(e,i){null==i&&(i=0),Ee.renderListeners.push(function(t){i<t.length&&e(t[i])})},Ee.notifyOnFrames=function(t){Ee.renderListeners.push(t)},Ee.removeFramesListener=function(t){me.remove(Ee.renderListeners,t)},Ee.notifyOnApplicationState=function(t,e,i,n,s){null!=t&&Ee.foregroundListeners.push(t),null!=e&&Ee.resumeListeners.push(e),null!=i&&Ee.pauseListeners.push(i),null!=n&&Ee.backgroundListeners.push(n),null!=s&&Ee.shutdownListeners.push(s)},Ee.notifyOnDropFiles=function(t){Ee.dropFilesListeners.push(t)},Ee.removeDropListerer=function(t){me.remove(Ee.dropFilesListeners,t)},Ee.notifyOnCutCopyPaste=function(t,e,i){Ee.cutListener=t,Ee.copyListener=e,Ee.pasteListener=i},Ee.notifyOnLoginLogout=function(t,e){Ee.loginListener=t,Ee.logoutListener=e},Ee.login=function(){Y.login()},Ee.render=function(t){for(var e=0,i=Ee.renderListeners;e<i.length;){var n=i[e];++e,n(t)}},Ee.foreground=function(){for(var t=0,e=Ee.foregroundListeners;t<e.length;){var i=e[t];++t,i()}},Ee.resume=function(){for(var t=0,e=Ee.resumeListeners;t<e.length;){var i=e[t];++t,i()}},Ee.pause=function(){for(var t=0,e=Ee.pauseListeners;t<e.length;){var i=e[t];++t,i()}},Ee.background=function(){for(var t=0,e=Ee.backgroundListeners;t<e.length;){var i=e[t];++t,i()}},Ee.shutdown=function(){for(var t=0,e=Ee.shutdownListeners;t<e.length;){var i=e[t];++t,i()}},Ee.dropFiles=function(t){for(var e=0,i=Ee.dropFilesListeners;e<i.length;){var n=i[e];++e,n(t)}},Ee.get_time=function(){return Y.getTime()},Ee.windowWidth=function(t){return null==t&&(t=0),Q.get(t).get_width()},Ee.windowHeight=function(t){return null==t&&(t=0),Q.get_all()[t].get_height()},Ee.get_screenRotation=function(){return 0},Ee.get_systemId=function(){return Y.getSystemId()},Ee.vibrate=function(t){Y.vibrate(t)},Ee.get_language=function(){return Y.getLanguage()},Ee.stop=function(){return Y.requestShutdown()},Ee.loadUrl=function(t){Y.loadUrl(t)},Ee.canSwitchFullscreen=function(){return!0},Ee.isFullscreen=function(){return 1==Q.get(0).get_mode()||2==Q.get(0).get_mode()},Ee.requestFullscreen=function(){Q.get(0).set_mode(1)},Ee.exitFullscreen=function(){Q.get(0).set_mode(0)},Ee.notifyOnFullscreenChange=function(t,e){},Ee.removeFullscreenListener=function(t,e){},Ee.changeResolution=function(t,e){},Ee.requestShutdown=function(){Ee.stop()},Ee.get_vsync=function(){return Q.get(0).get_vSynced()},Ee.get_refreshRate=function(){return w.get_primary().get_frequency()},Ee.screenDpi=function(){return w.get_primary().get_pixelsPerInch()},Ee.safeZone=function(){return Y.safeZone()},Ee.automaticSafeZone=function(){return Y.automaticSafeZone()},Ee.setSafeZone=function(t){Y.setSafeZone(t)},Ee.unlockAchievement=function(t){Y.unlockAchievement(t)};var Y=function(){};(x["kha.SystemImpl"]=Y).__name__=!0,Y.renderCallback=function(){W.executeFrame(),Ee.render([Y.framebuffer])},Y.dropFilesCallback=function(t){Ee.dropFiles(t)},Y.copyCallback=function(){return null!=Ee.copyListener?Ee.copyListener():null},Y.cutCallback=function(){return null!=Ee.cutListener?Ee.cutListener():null},Y.pasteCallback=function(t){null!=Ee.pasteListener&&Ee.pasteListener(t)},Y.foregroundCallback=function(){Ee.foreground()},Y.resumeCallback=function(){Ee.resume()},Y.pauseCallback=function(){Ee.pause()},Y.backgroundCallback=function(){Ee.background()},Y.shutdownCallback=function(){Ee.shutdown()},Y.keyboardDownCallback=function(t){Y.keyboard.sendDownEvent(t)},Y.keyboardUpCallback=function(t){Y.keyboard.sendUpEvent(t)},Y.keyboardPressCallback=function(t){Y.keyboard.sendPressEvent(String.fromCodePoint(t))},Y.mouseDownCallback=function(t,e,i){Y.mouse.sendDownEvent(0,t,e,i)},Y.mouseUpCallback=function(t,e,i){Y.mouse.sendUpEvent(0,t,e,i)},Y.mouseMoveCallback=function(t,e,i,n){Y.mouse.sendMoveEvent(0,t,e,i,n)},Y.mouseWheelCallback=function(t){Y.mouse.sendWheelEvent(0,t)},Y.penDownCallback=function(t,e,i){Y.pen.sendDownEvent(0,t,e,i)},Y.penUpCallback=function(t,e,i){Y.pen.sendUpEvent(0,t,e,i)},Y.penMoveCallback=function(t,e,i){Y.pen.sendMoveEvent(0,t,e,i)},Y.gamepadAxisCallback=function(t,e,i){Y.gamepads[t].sendAxisEvent(e,i)},Y.gamepadButtonCallback=function(t,e,i){Y.gamepads[t].sendButtonEvent(e,i)},Y.audioCallback=function(t){lt._callCallback(t);var e=lt.buffer;Krom.writeAudioBuffer(e.data.buffer,t)},Y.init=function(t,e){Krom.init(t.title,t.width,t.height,t.framebuffer.samplesPerPixel,t.framebuffer.verticalSync,t.window.mode,t.window.windowFeatures,3),Y.start=Krom.getTime(),L.trace=function(t,e){var i=null!=e?e.className+":"+e.lineNumber+": "+be.string(t):be.string(t);Krom.log(me.substr(i,0,511))},new Q(0),W.init(),G.init();var i=new Je;Y.framebuffer=new N(0,null,null,i),Y.framebuffer.init(new zt(Y.framebuffer),new Le(Y.framebuffer),i),Krom.setCallback(Y.renderCallback),Krom.setDropFilesCallback(Y.dropFilesCallback),Krom.setCutCopyPasteCallback(Y.cutCallback,Y.copyCallback,Y.pasteCallback),Krom.setApplicationStateCallback(Y.foregroundCallback,Y.resumeCallback,Y.pauseCallback,Y.backgroundCallback,Y.shutdownCallback),Y.keyboard=new Ye,Y.mouse=new Qe,Y.pen=new qe,Y.gamepads=[];for(var n=0,s=Y.maxGamepads;n<s;){var r=n++;Y.gamepads[r]=new Ge(r)}Krom.setKeyboardDownCallback(Y.keyboardDownCallback),Krom.setKeyboardUpCallback(Y.keyboardUpCallback),Krom.setKeyboardPressCallback(Y.keyboardPressCallback),Krom.setMouseDownCallback(Y.mouseDownCallback),Krom.setMouseUpCallback(Y.mouseUpCallback),Krom.setMouseMoveCallback(Y.mouseMoveCallback),Krom.setMouseWheelCallback(Y.mouseWheelCallback),Krom.setPenDownCallback(Y.penDownCallback),Krom.setPenUpCallback(Y.penUpCallback),Krom.setPenMoveCallback(Y.penMoveCallback),Krom.setGamepadAxisCallback(Y.gamepadAxisCallback),Krom.setGamepadButtonCallback(Y.gamepadButtonCallback),lt._init(),ut._init(),Krom.setAudioCallback(Y.audioCallback),W.start(),e(Q.get(0))},Y.initEx=function(t,e,i,n){},Y.translateWindowMode=function(t){if(null==t)return 0;switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},Y.getScreenRotation=function(){return 0},Y.getTime=function(){return Krom.getTime()-Y.start},Y.getVsync=function(){return!0},Y.getRefreshRate=function(){return 60},Y.getSystemId=function(){return Krom.systemId()},Y.vibrate=function(t){},Y.getLanguage=function(){return"en"},Y.requestShutdown=function(){return Krom.requestShutdown(),!0},Y.getMouse=function(t){return Y.mouse},Y.getPen=function(t){return Y.pen},Y.getKeyboard=function(t){return Y.keyboard},Y.lockMouse=function(){if(!Y.isMouseLocked()){Krom.lockMouse();for(var t=0,e=Y.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},Y.unlockMouse=function(){if(Y.isMouseLocked()){Krom.unlockMouse();for(var t=0,e=Y.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},Y.canLockMouse=function(){return Krom.canLockMouse()},Y.isMouseLocked=function(){return Krom.isMouseLocked()},Y.notifyOfMouseLockChange=function(t,e){Y.canLockMouse()&&null!=t&&Y.mouseLockListeners.push(t)},Y.removeFromMouseLockChange=function(t,e){Y.canLockMouse()&&null!=t&&me.remove(Y.mouseLockListeners,t)},Y.hideSystemCursor=function(){Krom.showMouse(!1)},Y.showSystemCursor=function(){Krom.showMouse(!0)},Y.unload=function(){},Y.canSwitchFullscreen=function(){return!1},Y.isFullscreen=function(){return!1},Y.requestFullscreen=function(){},Y.exitFullscreen=function(){},Y.notifyOfFullscreenChange=function(t,e){},Y.removeFromFullscreenChange=function(t,e){},Y.changeResolution=function(t,e){},Y.setKeepScreenOn=function(t){},Y.loadUrl=function(t){},Y.getGamepadId=function(t){return"unkown"},Y.safeZone=function(){return 1},Y.login=function(){},Y.automaticSafeZone=function(){return!0},Y.setSafeZone=function(t){},Y.unlockAchievement=function(t){};function K(){}(x["kha.Video"]=K).__name__=!0,K.__interfaces__=[P],K.prototype={width:function(){return 100},height:function(){return 100},play:function(t){null==t&&(t=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(t){return 0},getVolume:function(){return 1},setVolume:function(t){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:K,__properties__:{set_position:"set_position",get_position:"get_position"}};var Q=function(t){this.num=t,Q.windows.push(this)};(x["kha.Window"]=Q).__name__=!0,Q.__properties__={get_all:"get_all"},Q.create=function(t,e){return null},Q.destroy=function(t){},Q.get=function(t){return Q.windows[t]},Q.get_all=function(){return Q.windows},Q.prototype={num:null,windowTitle:null,resize:function(t,e){},move:function(t,e){},changeWindowFeatures:function(t){},changeFramebuffer:function(t){},get_x:function(){return 0},set_x:function(t){return 0},get_y:function(){return 0},set_y:function(t){return 0},get_width:function(){return Krom.windowWidth(this.num)},set_width:function(t){return 800},get_height:function(){return Krom.windowHeight(this.num)},set_height:function(t){return 600},get_mode:function(){return 0},set_mode:function(t){return 0},get_visible:function(){return!0},set_visible:function(t){return!0},get_title:function(){return this.windowTitle},set_title:function(t){return Krom.setWindowTitle(this.num,t),this.windowTitle=t,this.windowTitle},notifyOnResize:function(t){},get_vSynced:function(){return!0},__class__:Q,__properties__:{get_vSynced:"get_vSynced",set_title:"set_title",get_title:"get_title",set_visible:"set_visible",get_visible:"get_visible",set_mode:"set_mode",get_mode:"get_mode",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var q={};(x["kha._WindowOptions.WindowFeatures_Impl_"]=q).__name__=!0,q._new=function(t){return t};var j=function(t,e,i,n,s,r,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==r&&(r=-1),null==s&&(s=600),null==n&&(n=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=n,this.height=s,this.display=r,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(x["kha.WindowOptions"]=j).__name__=!0,j.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:j};var Z={};(x["kha.arrays._Float32Array.Float32Array_Impl_"]=Z).__name__=!0,Z.__properties__={get_length:"get_length",get_buffer:"get_buffer"},Z._new=function(t){return new Float32Array(t)},Z.get_buffer=function(t){return t.buffer},Z.get_length=function(t){return t.length},Z.set=function(t,e,i){return t[e]=i},Z.get=function(t,e){return t[e]},Z.data=function(t){return t},Z.subarray=function(t,e,i){return t.subarray(e,i)};var nt={};(x["kha.arrays._Int16Array.Int16Array_Impl_"]=nt).__name__=!0,nt.__properties__={get_length:"get_length"},nt._new=function(t){return new Int16Array(t)},nt.get_length=function(t){return t.length},nt.set=function(t,e,i){return t[e]=i},nt.get=function(t,e){return t[e]},nt.data=function(t){return t},nt.arrayRead=function(t,e){return t[e]},nt.arrayWrite=function(t,e,i){return t[e]=i},nt.subarray=function(t,e,i){return t.subarray(e,i)};var st={};(x["kha.arrays._Int32Array.Int32Array_Impl_"]=st).__name__=!0,st.__properties__={get_length:"get_length"},st._new=function(t){return new Int32Array(t)},st.get_length=function(t){return t.length},st.set=function(t,e,i){return t[e]=i},st.get=function(t,e){return t[e]},st.data=function(t){return t},st.arrayRead=function(t,e){return t[e]},st.arrayWrite=function(t,e,i){return t[e]=i},st.subarray=function(t,e,i){return t.subarray(e,i)};var rt={};(x["kha.arrays._Uint32Array.Uint32Array_Impl_"]=rt).__name__=!0,rt.__properties__={get_length:"get_length"},rt._new=function(t){return new Uint32Array(t)},rt.get_length=function(t){return t.length},rt.set=function(t,e,i){return t[e]=i},rt.get=function(t,e){return t[e]},rt.data=function(t){return t},rt.arrayRead=function(t,e){return t[e]},rt.arrayWrite=function(t,e,i){return t[e]=i},rt.subarray=function(t,e,i){return t.subarray(e,i)};function at(){}(x["kha.audio1.AudioChannel"]=at).__name__=!0,at.__isInterface__=!0,at.prototype={play:null,pause:null,stop:null,length:null,get_length:null,get_position:null,set_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:at,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};function ot(t){this.value=t}(x["kha.internal.IntBox"]=ot).__name__=!0,ot.prototype={value:null,__class__:ot};var lt=function(){};(x["kha.audio2.Audio"]=lt).__name__=!0,lt._init=function(){lt.buffer=new dt(8192,2,44100),lt.samplesPerSecond=44100},lt._callCallback=function(t){if(null!=lt.buffer)if(null!=lt.audioCallback)lt.intBox.value=t,lt.audioCallback(lt.intBox,lt.buffer);else for(var e=0,i=t;e<i;){e++;lt.buffer.data[lt.buffer.writeLocation]=0,lt.buffer.writeLocation+=1,lt.buffer.writeLocation>=lt.buffer.size&&(lt.buffer.writeLocation=0)}},lt._readSample=function(){if(null==lt.buffer)return 0;var t=lt.buffer.data[lt.buffer.readLocation];return lt.buffer.readLocation+=1,lt.buffer.readLocation>=lt.buffer.size&&(lt.buffer.readLocation=0),t},lt.play=function(t,e){return null==e&&(e=!1),null},lt.stream=function(t,e){return null==e&&(e=!1),null};var ut=function(){};(x["kha.audio2.Audio1"]=ut).__name__=!0,ut._init=function(){var t=new Array(32);ut.soundChannels=t;var e=new Array(32);ut.streamChannels=e;var i=new Array(32);ut.internalSoundChannels=i;var n=new Array(32);ut.internalStreamChannels=n;var s=new Float32Array(512);ut.sampleCache1=s;var r=new Float32Array(512);ut.sampleCache2=r,ut.lastAllocationCount=0,lt.audioCallback=ut.mix},ut.max=function(t,e){return e<t?t:e},ut.min=function(t,e){return t<e?t:e},ut.mix=function(t,e){var i=t.value;if(ut.sampleCache1.length<i){if(lt.disableGcInteractions){L.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:45,className:"kha.audio2.Audio1",methodName:"mix"});for(var n=0,s=i;n<s;){n++;e.data[e.writeLocation]=0,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}return ut.lastAllocationCount=0,void(lt.disableGcInteractions=!1)}var r=new Float32Array(2*i);ut.sampleCache1=r;var a=new Float32Array(2*i);ut.sampleCache2=a,ut.lastAllocationCount=0}else 100<ut.lastAllocationCount?lt.disableGcInteractions=!0:ut.lastAllocationCount+=1;for(var o=0,l=i;o<l;){var u=o++;ut.sampleCache2[u]=0}for(var h=0;h<32;){var c=h++;ut.internalSoundChannels[c]=ut.soundChannels[c]}for(var A=0;A<32;){var d=A++;ut.internalStreamChannels[d]=ut.streamChannels[d]}for(var _=0,f=ut.internalSoundChannels;_<f.length;){var g=f[_];if(++_,null!=g&&!g.get_finished()){g.nextSamples(ut.sampleCache1,i,e.samplesPerSecond);for(var p=0,m=i;p<m;){var v=p++;ut.sampleCache2[v]+=ut.sampleCache1[v]*g.get_volume()}}}for(var w=0,b=ut.internalStreamChannels;w<b.length;){var y=b[w];if(++w,null!=y&&!y.get_finished()){y.nextSamples(ut.sampleCache1,i,e.samplesPerSecond);for(var x=0,T=i;x<T;){var S=x++;ut.sampleCache2[S]+=ut.sampleCache1[S]*y.get_volume()}}}for(var E=0,B=i;E<B;){var k=E++,I=ut.sampleCache2[k],C=I<1?I:1;e.data[e.writeLocation]=-1<C?C:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},ut.play=function(t,e){null==e&&(e=!1);var i=null;(i=lt.samplesPerSecond!=t.sampleRate?new _t(e,t.sampleRate):new At(e)).data=t.uncompressedData;for(var n=!1,s=0;s<32;){var r=s++;if(null==ut.soundChannels[r]||ut.soundChannels[r].get_finished()){ut.soundChannels[r]=i,n=!0;break}}return n?i:null},ut._playAgain=function(t){for(var e=0;e<32;){var i=e++;ut.soundChannels[i]==t&&(ut.soundChannels[i]=null)}for(var n=0;n<32;){var s=n++;if(null==ut.soundChannels[s]||ut.soundChannels[s].get_finished()||ut.soundChannels[s]==t){ut.soundChannels[s]=t;break}}},ut.stream=function(t,e){null==e&&(e=!1);var i=lt.stream(t,e);if(null!=i)return i;for(var n=new ft(t.compressedData,e),s=!1,r=0;r<32;){var a=r++;if(null==ut.streamChannels[a]||ut.streamChannels[a].get_finished()){ut.streamChannels[a]=n,s=!0;break}}return s?n:null};var At=function(t){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=t};(x["kha.audio2.AudioChannel"]=At).__name__=!0,At.__interfaces__=[at],At.max=function(t,e){return e<t?t:e},At.min=function(t,e){return t<e?t:e},At.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,s=e;n<s;){t[n++]=0}else{for(var r=0;r<e;){for(var a=0,o=this.data.length-this.myPosition,l=e-r,u=o<l?o:l;a<u;){a++;t[r++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;r<e;)t[r++]=0}},play:function(){this.paused=!1,this.stopped=!1,ut._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},length:null,get_length:function(){return this.data.length/lt.samplesPerSecond/2},get_position:function(){return this.myPosition/lt.samplesPerSecond/2},set_position:function(t){this.myPosition=Math.round(t*lt.samplesPerSecond*2);var e=this.myPosition,i=this.data.length,n=e<i?e:i;return this.myPosition=0<n?n:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.stopped},__class__:At,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};var dt=function(t,e,i){this.size=t;var n=new Float32Array(t);this.data=n,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(x["kha.audio2.Buffer"]=dt).__name__=!0,dt.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:dt};var _t=function(t,e){At.call(this,t),this.sampleRate=e};(x["kha.audio2.ResamplingAudioChannel"]=_t).__name__=!0,_t.max=function(t,e){return e<t?t:e},_t.min=function(t,e){return t<e?t:e},_t.__super__=At,_t.prototype=s(At.prototype,{sampleRate:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,s=e;n<s;){t[n++]=0}else{for(var r=0;r<e;){for(var a=0,o=Math.ceil(this.data.length*(i/this.sampleRate)),l=(o%2==0?o:o+1)-this.myPosition,u=e-r,h=l<u?l:u;a<h;){a++;var c,A=r++,d=this.myPosition++,_=d%2==0,f=this.sampleRate/i;if(_){var g=f*(d=d/2|0),p=Math.floor(g),m=Math.floor(1+g);p*=2,m*=2;var v=this.data.length-1;v%2==0?v=v:--v;var w=p<0||v<p?0:this.data[p],b=m<0||v<m?0:this.data[m],y=g-Math.floor(g);c=(1-y)*w+y*b}else{var x=f*(d=d/2|0),T=Math.floor(x),S=Math.floor(1+x);T=2*T+1,S=2*S+1;var E=this.data.length-1;E%2!=0?E=E:--E;var B=T<1||E<T?0:this.data[T],k=S<1||E<S?0:this.data[S],I=x-Math.floor(x);c=(1-I)*B+I*k}t[A]=c}var C=Math.ceil(this.data.length*(i/this.sampleRate));if(this.myPosition>=(C%2==0?C:C+1)&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;r<e;)t[r++]=0}},sample:function(t,e){var i=t%2==0,n=this.sampleRate/e;if(i){var s=n*(t=t/2|0),r=Math.floor(s),a=Math.floor(1+s);r*=2,a*=2;var o=this.data.length-1;o%2==0?o=o:--o;var l=r<0||o<r?0:this.data[r],u=a<0||o<a?0:this.data[a],h=s-Math.floor(s);return(1-h)*l+h*u}var c=n*(t=t/2|0),A=Math.floor(c),d=Math.floor(1+c);A=2*A+1,d=2*d+1;var _=this.data.length-1;_%2!=0?_=_:--_;var f=A<1||_<A?0:this.data[A],g=d<1||_<d?0:this.data[d],p=c-Math.floor(c);return(1-p)*f+p*g},lerp:function(t,e,i){return(1-i)*t+i*e},sampleLength:function(t){var e=Math.ceil(this.data.length*(t/this.sampleRate));return e%2==0?e:e+1},play:function(){this.paused=!1,this.stopped=!1,ut._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},get_length:function(){return this.data.length/this.sampleRate/2},get_position:function(){return this.myPosition/this.sampleRate/2},set_position:function(t){this.myPosition=Math.round(t*this.sampleRate*2);var e=this.myPosition,i=Math.ceil(this.data.length*(lt.samplesPerSecond/this.sampleRate)),n=i%2==0?i:i+1,s=e<n?e:n;return this.myPosition=0<s?s:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.stopped},__class__:_t});var ft=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=vt.openFromBytes(t)};(x["kha.audio2.StreamChannel"]=ft).__name__=!0,ft.__interfaces__=[at],ft.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,i){if(this.paused)for(var n=0,s=e;n<s;){t[n++]=0}else{var r=2*this.reader.read(t,e/2|0,2,i,!0);if(r<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=r,o=e;a<o;){t[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},set_position:function(t){return t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.atend},__class__:ft,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume",set_position:"set_position",get_position:"get_position",get_length:"get_length"}};function gt(){}(x["kha.audio2.ogg.tools.Crc32"]=gt).__name__=!0,gt.init=function(){if(null==gt.table){var t=new Array(256);gt.table=t;for(var e=0;e<256;){var i=e++,n=i<<24;n=(n=(n=(n=(n=(n=(n=(n=n<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0),gt.table[i]=n}}},gt.update=function(t,e){return t<<8^gt.table[e^t>>>24]};function pt(){}(x["kha.audio2.ogg.tools.MathTools"]=pt).__name__=!0,pt.ilog=function(t){var e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return t<16384?t<16?e[t]:t<512?5+e[t>>5]:10+e[t>>10]:t<16777216?t<524288?15+e[t>>15]:20+e[t>>20]:t<536870912?25+e[t>>25]:t<-2147483648?30+e[t>>30]:0};function mt(){}(x["kha.audio2.ogg.tools.Mdct"]=mt).__name__=!0,mt.inverseTransform=function(t,e,i,n,s,r){for(var a=e>>1,o=e>>2,l=e>>3,u=new Array(a),h=a-2,c=0,A=0,d=a;A!=d;)u[h+1]=t[A]*i[c]-t[A+2]*i[c+1],u[h]=t[A]*i[c+1]+t[A+2]*i[c],h-=2,c+=2,A+=4;for(A=a-3;0<=h;)u[h+1]=-t[A+2]*i[c]- -t[A]*i[c+1],u[h]=-t[A+2]*i[c+1]+-t[A]*i[c],h-=2,c+=2,A-=4;for(var _=t,f=u,g=a-8,p=o,m=0,v=o,w=0;0<=g;){var b=f[p+1]-f[m+1],y=f[p]-f[m];_[v+1]=f[p+1]+f[m+1],_[v]=f[p]+f[m],_[w+1]=b*i[g+4]-y*i[g+5],_[w]=y*i[g+4]+b*i[g+5],b=f[p+3]-f[m+3],y=f[p+2]-f[m+2],_[v+3]=f[p+3]+f[m+3],_[v+2]=f[p+2]+f[m+2],_[w+3]=b*i[g]-y*i[g+1],_[w+2]=y*i[g]+b*i[g+1],g-=8,v+=4,w+=4,p+=4,m+=4}for(var x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],T=(e<16384?e<16?x[e]:e<512?5+x[e>>5]:10+x[e>>10]:e<16777216?e<524288?15+x[e>>15]:20+x[e>>20]:e<536870912?25+x[e>>25]:e<-2147483648?30+x[e>>30]:0)-1,S=a-1-0*o,E=S,B=S-(e>>3),k=0,I=1+(e>>4>>2);0<--I;){var C=_[E]-_[B],L=_[E+-1]-_[B+-1];_[E]=_[E]+_[B];var N=E+-1;_[N]=_[N]+_[B+-1],_[B]=C*i[k]-L*i[k+1],_[B+-1]=L*i[k]+C*i[k+1],k+=8,C=_[E+-2]-_[B+-2],L=_[E+-3]-_[B+-3];var F=E+-2;_[F]=_[F]+_[B+-2];var P=E+-3;_[P]=_[P]+_[B+-3],_[B+-2]=C*i[k]-L*i[k+1],_[B+-3]=L*i[k]+C*i[k+1],k+=8,C=_[E+-4]-_[B+-4],L=_[E+-5]-_[B+-5];var M=E+-4;_[M]=_[M]+_[B+-4];var R=E+-5;_[R]=_[R]+_[B+-5],_[B+-4]=C*i[k]-L*i[k+1],_[B+-5]=L*i[k]+C*i[k+1],k+=8,C=_[E+-6]-_[B+-6],L=_[E+-7]-_[B+-7];var O=E+-6;_[O]=_[O]+_[B+-6];var V=E+-7;_[V]=_[V]+_[B+-7],_[B+-6]=C*i[k]-L*i[k+1],_[B+-7]=L*i[k]+C*i[k+1],k+=8,E-=8,B-=8}for(var D=a-1-o,U=D,H=D-(e>>3),W=0,G=1+(e>>4>>2);0<--G;){var z=_[U]-_[H],X=_[U+-1]-_[H+-1];_[U]=_[U]+_[H];var Y=U+-1;_[Y]=_[Y]+_[H+-1],_[H]=z*i[W]-X*i[W+1],_[H+-1]=X*i[W]+z*i[W+1],W+=8,z=_[U+-2]-_[H+-2],X=_[U+-3]-_[H+-3];var K=U+-2;_[K]=_[K]+_[H+-2];var Q=U+-3;_[Q]=_[Q]+_[H+-3],_[H+-2]=z*i[W]-X*i[W+1],_[H+-3]=X*i[W]+z*i[W+1],W+=8,z=_[U+-4]-_[H+-4],X=_[U+-5]-_[H+-5];var q=U+-4;_[q]=_[q]+_[H+-4];var j=U+-5;_[j]=_[j]+_[H+-5],_[H+-4]=z*i[W]-X*i[W+1],_[H+-5]=X*i[W]+z*i[W+1],W+=8,z=_[U+-6]-_[H+-6],X=_[U+-7]-_[H+-7];var Z=U+-6;_[Z]=_[Z]+_[H+-6];var J=U+-7;_[J]=_[J]+_[H+-7],_[H+-6]=z*i[W]-X*i[W+1],_[H+-7]=X*i[W]+z*i[W+1],W+=8,U-=8,H-=8}for(var $=a-1-0*l,tt=0,et=$,it=$-(e>>4),nt=1+(e>>5>>2);0<--nt;){var st=_[et]-_[it],rt=_[et+-1]-_[it+-1];_[et]=_[et]+_[it];var at=et+-1;_[at]=_[at]+_[it+-1],_[it]=st*i[tt]-rt*i[tt+1],_[it+-1]=rt*i[tt]+st*i[tt+1],tt+=16,st=_[et+-2]-_[it+-2],rt=_[et+-3]-_[it+-3];var ot=et+-2;_[ot]=_[ot]+_[it+-2];var lt=et+-3;_[lt]=_[lt]+_[it+-3],_[it+-2]=st*i[tt]-rt*i[tt+1],_[it+-3]=rt*i[tt]+st*i[tt+1],tt+=16,st=_[et+-4]-_[it+-4],rt=_[et+-5]-_[it+-5];var ut=et+-4;_[ut]=_[ut]+_[it+-4];var ht=et+-5;_[ht]=_[ht]+_[it+-5],_[it+-4]=st*i[tt]-rt*i[tt+1],_[it+-5]=rt*i[tt]+st*i[tt+1],tt+=16,st=_[et+-6]-_[it+-6],rt=_[et+-7]-_[it+-7];var ct=et+-6;_[ct]=_[ct]+_[it+-6];var At=et+-7;_[At]=_[At]+_[it+-7],_[it+-6]=st*i[tt]-rt*i[tt+1],_[it+-7]=rt*i[tt]+st*i[tt+1],et-=8,it-=8,tt+=16}for(var dt=a-1-l,_t=0,ft=dt,gt=dt-(e>>4),pt=1+(e>>5>>2);0<--pt;){var mt=_[ft]-_[gt],vt=_[ft+-1]-_[gt+-1];_[ft]=_[ft]+_[gt];var wt=ft+-1;_[wt]=_[wt]+_[gt+-1],_[gt]=mt*i[_t]-vt*i[_t+1],_[gt+-1]=vt*i[_t]+mt*i[_t+1],_t+=16,mt=_[ft+-2]-_[gt+-2],vt=_[ft+-3]-_[gt+-3];var bt=ft+-2;_[bt]=_[bt]+_[gt+-2];var yt=ft+-3;_[yt]=_[yt]+_[gt+-3],_[gt+-2]=mt*i[_t]-vt*i[_t+1],_[gt+-3]=vt*i[_t]+mt*i[_t+1],_t+=16,mt=_[ft+-4]-_[gt+-4],vt=_[ft+-5]-_[gt+-5];var xt=ft+-4;_[xt]=_[xt]+_[gt+-4];var Tt=ft+-5;_[Tt]=_[Tt]+_[gt+-5],_[gt+-4]=mt*i[_t]-vt*i[_t+1],_[gt+-5]=vt*i[_t]+mt*i[_t+1],_t+=16,mt=_[ft+-6]-_[gt+-6],vt=_[ft+-7]-_[gt+-7];var St=ft+-6;_[St]=_[St]+_[gt+-6];var Et=ft+-7;_[Et]=_[Et]+_[gt+-7],_[gt+-6]=mt*i[_t]-vt*i[_t+1],_[gt+-7]=vt*i[_t]+mt*i[_t+1],ft-=8,gt-=8,_t+=16}for(var Bt=a-1-2*l,kt=0,It=Bt,Ct=Bt-(e>>4),Lt=1+(e>>5>>2);0<--Lt;){var Nt=_[It]-_[Ct],Ft=_[It+-1]-_[Ct+-1];_[It]=_[It]+_[Ct];var Pt=It+-1;_[Pt]=_[Pt]+_[Ct+-1],_[Ct]=Nt*i[kt]-Ft*i[kt+1],_[Ct+-1]=Ft*i[kt]+Nt*i[kt+1],kt+=16,Nt=_[It+-2]-_[Ct+-2],Ft=_[It+-3]-_[Ct+-3];var Mt=It+-2;_[Mt]=_[Mt]+_[Ct+-2];var Rt=It+-3;_[Rt]=_[Rt]+_[Ct+-3],_[Ct+-2]=Nt*i[kt]-Ft*i[kt+1],_[Ct+-3]=Ft*i[kt]+Nt*i[kt+1],kt+=16,Nt=_[It+-4]-_[Ct+-4],Ft=_[It+-5]-_[Ct+-5];var Ot=It+-4;_[Ot]=_[Ot]+_[Ct+-4];var Vt=It+-5;_[Vt]=_[Vt]+_[Ct+-5],_[Ct+-4]=Nt*i[kt]-Ft*i[kt+1],_[Ct+-5]=Ft*i[kt]+Nt*i[kt+1],kt+=16,Nt=_[It+-6]-_[Ct+-6],Ft=_[It+-7]-_[Ct+-7];var Dt=It+-6;_[Dt]=_[Dt]+_[Ct+-6];var Ut=It+-7;_[Ut]=_[Ut]+_[Ct+-7],_[Ct+-6]=Nt*i[kt]-Ft*i[kt+1],_[Ct+-7]=Ft*i[kt]+Nt*i[kt+1],It-=8,Ct-=8,kt+=16}for(var Ht=a-1-3*l,Wt=0,Gt=Ht,zt=Ht-(e>>4),Xt=1+(e>>5>>2);0<--Xt;){var Yt=_[Gt]-_[zt],Kt=_[Gt+-1]-_[zt+-1];_[Gt]=_[Gt]+_[zt];var Qt=Gt+-1;_[Qt]=_[Qt]+_[zt+-1],_[zt]=Yt*i[Wt]-Kt*i[Wt+1],_[zt+-1]=Kt*i[Wt]+Yt*i[Wt+1],Wt+=16,Yt=_[Gt+-2]-_[zt+-2],Kt=_[Gt+-3]-_[zt+-3];var qt=Gt+-2;_[qt]=_[qt]+_[zt+-2];var jt=Gt+-3;_[jt]=_[jt]+_[zt+-3],_[zt+-2]=Yt*i[Wt]-Kt*i[Wt+1],_[zt+-3]=Kt*i[Wt]+Yt*i[Wt+1],Wt+=16,Yt=_[Gt+-4]-_[zt+-4],Kt=_[Gt+-5]-_[zt+-5];var Zt=Gt+-4;_[Zt]=_[Zt]+_[zt+-4];var Jt=Gt+-5;_[Jt]=_[Jt]+_[zt+-5],_[zt+-4]=Yt*i[Wt]-Kt*i[Wt+1],_[zt+-5]=Kt*i[Wt]+Yt*i[Wt+1],Wt+=16,Yt=_[Gt+-6]-_[zt+-6],Kt=_[Gt+-7]-_[zt+-7];var $t=Gt+-6;_[$t]=_[$t]+_[zt+-6];var te=Gt+-7;_[te]=_[te]+_[zt+-7],_[zt+-6]=Yt*i[Wt]-Kt*i[Wt+1],_[zt+-7]=Kt*i[Wt]+Yt*i[Wt+1],Gt-=8,zt-=8,Wt+=16}for(var ee=2,ie=T-3>>1;ee<ie;)for(var ne=ee++,se=e>>2+ne,re=se>>1,ae=0,oe=1<<1+ne;ae<oe;)for(var le=a-1-se*ae++,ue=1<<3+ne,he=0,ce=le,Ae=le-re,de=1+(e>>4+ne>>2);0<--de;){var _e=_[ce]-_[Ae],fe=_[ce+-1]-_[Ae+-1];_[ce]=_[ce]+_[Ae];var ge=ce+-1;_[ge]=_[ge]+_[Ae+-1],_[Ae]=_e*i[he]-fe*i[he+1],_[Ae+-1]=fe*i[he]+_e*i[he+1],he+=ue,_e=_[ce+-2]-_[Ae+-2],fe=_[ce+-3]-_[Ae+-3];var pe=ce+-2;_[pe]=_[pe]+_[Ae+-2];var me=ce+-3;_[me]=_[me]+_[Ae+-3],_[Ae+-2]=_e*i[he]-fe*i[he+1],_[Ae+-3]=fe*i[he]+_e*i[he+1],he+=ue,_e=_[ce+-4]-_[Ae+-4],fe=_[ce+-5]-_[Ae+-5];var ve=ce+-4;_[ve]=_[ve]+_[Ae+-4];var we=ce+-5;_[we]=_[we]+_[Ae+-5],_[Ae+-4]=_e*i[he]-fe*i[he+1],_[Ae+-5]=fe*i[he]+_e*i[he+1],he+=ue,_e=_[ce+-6]-_[Ae+-6],fe=_[ce+-7]-_[Ae+-7];var be=ce+-6;_[be]=_[be]+_[Ae+-6];var ye=ce+-7;_[ye]=_[ye]+_[Ae+-7],_[Ae+-6]=_e*i[he]-fe*i[he+1],_[Ae+-7]=fe*i[he]+_e*i[he+1],ce-=8,Ae-=8,he+=ue}for(var xe=T-3>>1,Te=T-6;xe<Te;)for(var Se=xe++,Ee=e>>2+Se,Be=1<<3+Se,ke=Ee>>1,Ie=1<<1+Se,Ce=0,Le=a-1,Ne=1+(e>>6+Se);0<--Ne;){for(var Fe=i[Ce],Pe=i[Ce+1],Me=i[Ce+Be],Re=i[Ce+Be+1],Oe=i[Ce+2*Be],Ve=i[Ce+2*Be+1],De=i[Ce+3*Be],Ue=i[Ce+3*Be+1],He=Le,We=Le+-ke,Ge=1+Ie;0<--Ge;){var ze=_[He]-_[We],Xe=_[He+-1]-_[We+-1];_[He]=_[He]+_[We],_[He+-1]=_[He+-1]+_[We+-1],_[We]=ze*Fe-Xe*Pe,_[We+-1]=Xe*Fe+ze*Pe,ze=_[He+-2]-_[We+-2],Xe=_[He+-3]-_[We+-3],_[He+-2]=_[He+-2]+_[We+-2],_[He+-3]=_[He+-3]+_[We+-3],_[We+-2]=ze*Me-Xe*Re,_[We+-3]=Xe*Me+ze*Re,ze=_[He+-4]-_[We+-4],Xe=_[He+-5]-_[We+-5],_[He+-4]=_[He+-4]+_[We+-4],_[He+-5]=_[He+-5]+_[We+-5],_[We+-4]=ze*Oe-Xe*Ve,_[We+-5]=Xe*Oe+ze*Ve,ze=_[He+-6]-_[We+-6],Xe=_[He+-7]-_[We+-7],_[He+-6]=_[He+-6]+_[We+-6],_[He+-7]=_[He+-7]+_[We+-7],_[We+-6]=ze*De-Xe*Ue,_[We+-7]=Xe*De+ze*Ue,He-=Ee,We-=Ee}Ce+=4*Be,Le-=8}for(var Ye=a-1,Ke=i[e>>3],Qe=Ye,qe=Ye-16*(e>>5);qe<Qe;){var je=_[Qe],Ze=_[Qe+-8];_[Qe+-8]=je-Ze,_[Qe]=je+Ze,je=_[Qe+-1],Ze=_[Qe+-9],_[Qe+-9]=je-Ze,_[Qe+-1]=je+Ze;var Je=(je=_[Qe+-2])-(Ze=_[Qe+-10]);_[Qe+-2]=je+Ze;var $e=(je=_[Qe+-3])-(Ze=_[Qe+-11]);_[Qe+-3]=je+Ze,_[Qe+-10]=(Je+$e)*Ke,_[Qe+-11]=($e-Je)*Ke,je=_[Qe+-4],Je=(Ze=_[Qe+-12])-je,_[Qe+-4]=je+Ze,$e=(je=_[Qe+-5])-(Ze=_[Qe+-13]),_[Qe+-5]=je+Ze,_[Qe+-12]=$e,_[Qe+-13]=Je,je=_[Qe+-6],Je=(Ze=_[Qe+-14])-je,_[Qe+-6]=je+Ze,$e=(je=_[Qe+-7])-(Ze=_[Qe+-15]),_[Qe+-7]=je+Ze,_[Qe+-14]=(Je+$e)*Ke,_[Qe+-15]=(Je-$e)*Ke;var ti=_[Qe],ei=_[Qe+-4],ii=ti-ei,ni=ti+ei,si=(ti=_[Qe+-2])+(ei=_[Qe+-6]),ri=ti-ei;_[Qe]=ni+si,_[Qe+-2]=ni-si;var ai=_[Qe+-3]-_[Qe+-7];_[Qe+-4]=ii+ai,_[Qe+-6]=ii-ai;var oi=(ti=_[Qe+-1])-(ei=_[Qe+-5]),li=ti+ei,ui=_[Qe+-3]+_[Qe+-7];_[Qe+-1]=li+ui,_[Qe+-3]=li-ui,_[Qe+-5]=oi-ri,_[Qe+-7]=oi+ri;var hi=Qe-8,ci=_[hi],Ai=_[hi-4],di=ci-Ai,_i=ci+Ai,fi=(ci=_[hi-2])+(Ai=_[hi-6]),gi=ci-Ai;_[hi]=_i+fi,_[hi-2]=_i-fi;var pi=_[hi-3]-_[hi-7];_[hi-4]=di+pi,_[hi-6]=di-pi;var mi=(ci=_[hi-1])-(Ai=_[hi-5]),vi=ci+Ai,wi=_[hi-3]+_[hi-7];_[hi-1]=vi+wi,_[hi-3]=vi-wi,_[hi-5]=mi-gi,_[hi-7]=mi+gi,Qe-=16}for(var bi=0,yi=o-4,xi=a-4;0<=yi;){var Ti=r[bi];f[xi+3]=_[Ti],f[xi+2]=_[Ti+1],f[yi+3]=_[Ti+2],f[yi+2]=_[Ti+3],Ti=r[bi+1],f[xi+1]=_[Ti],f[xi]=_[Ti+1],f[yi+1]=_[Ti+2],f[yi]=_[Ti+3],yi-=4,xi-=4,bi+=2}for(var Si=0,Ei=0,Bi=a-4;Ei<Bi;){var ki=f[Ei]-f[Bi+2],Ii=f[Ei+1]+f[Bi+3],Ci=s[Si+1]*ki+s[Si]*Ii,Li=s[Si+1]*Ii-s[Si]*ki,Ni=f[Ei]+f[Bi+2],Fi=f[Ei+1]-f[Bi+3];f[Ei]=Ni+Ci,f[Ei+1]=Fi+Li,f[Bi+2]=Ni-Ci,f[Bi+3]=Li-Fi,ki=f[Ei+2]-f[Bi],Ii=f[Ei+3]+f[Bi+1],Ci=s[Si+3]*ki+s[Si+2]*Ii,Li=s[Si+3]*Ii-s[Si+2]*ki,Ni=f[Ei+2]+f[Bi],Fi=f[Ei+3]-f[Bi+1],f[Ei+2]=Ni+Ci,f[Ei+3]=Fi+Li,f[Bi]=Ni-Ci,f[Bi+1]=Li-Fi,Si+=4,Ei+=4,Bi-=4}for(var Pi=a-8,Mi=a-8,Ri=0,Oi=a-4,Vi=a,Di=e-4;0<=Mi;){var Ui=u[Mi+6]*n[Pi+7]-u[Mi+7]*n[Pi+6],Hi=-u[Mi+6]*n[Pi+6]-u[Mi+7]*n[Pi+7];t[Ri]=Ui,t[Oi+3]=-Ui,t[Vi]=Hi,t[Di+3]=Hi;var Wi=u[Mi+4]*n[Pi+5]-u[Mi+5]*n[Pi+4],Gi=-u[Mi+4]*n[Pi+4]-u[Mi+5]*n[Pi+5];t[Ri+1]=Wi,t[Oi+2]=-Wi,t[Vi+1]=Gi,t[Di+2]=Gi,Ui=u[Mi+2]*n[Pi+3]-u[Mi+3]*n[Pi+2],Hi=-u[Mi+2]*n[Pi+2]-u[Mi+3]*n[Pi+3],t[Ri+2]=Ui,t[Oi+1]=-Ui,t[Vi+2]=Hi,t[Di+1]=Hi,Wi=u[Mi]*n[Pi+1]-u[Mi+1]*n[Pi],Gi=-u[Mi]*n[Pi]-u[Mi+1]*n[Pi+1],t[Ri+3]=Wi,t[Oi]=-Wi,t[Vi+3]=Gi,t[Di]=Gi,Pi-=8,Mi-=8,Ri+=4,Vi+=4,Oi-=4,Di-=4}},mt.step3Iter0Loop=function(t,e,i,n,s){for(var r=i,a=i+n,o=0,l=1+(t>>2);0<--l;){var u=e[r]-e[a],h=e[r+-1]-e[a+-1];e[r]=e[r]+e[a];var c=r+-1;e[c]=e[c]+e[a+-1],e[a]=u*s[o]-h*s[o+1],e[a+-1]=h*s[o]+u*s[o+1],o+=8,u=e[r+-2]-e[a+-2],h=e[r+-3]-e[a+-3];var A=r+-2;e[A]=e[A]+e[a+-2];var d=r+-3;e[d]=e[d]+e[a+-3],e[a+-2]=u*s[o]-h*s[o+1],e[a+-3]=h*s[o]+u*s[o+1],o+=8,u=e[r+-4]-e[a+-4],h=e[r+-5]-e[a+-5];var _=r+-4;e[_]=e[_]+e[a+-4];var f=r+-5;e[f]=e[f]+e[a+-5],e[a+-4]=u*s[o]-h*s[o+1],e[a+-5]=h*s[o]+u*s[o+1],o+=8,u=e[r+-6]-e[a+-6],h=e[r+-7]-e[a+-7];var g=r+-6;e[g]=e[g]+e[a+-6];var p=r+-7;e[p]=e[p]+e[a+-7],e[a+-6]=u*s[o]-h*s[o+1],e[a+-7]=h*s[o]+u*s[o+1],o+=8,r-=8,a-=8}},mt.step3InnerRLoop=function(t,e,i,n,s,r){for(var a=0,o=i,l=i+n,u=1+(t>>2);0<--u;){var h=e[o]-e[l],c=e[o+-1]-e[l+-1];e[o]=e[o]+e[l];var A=o+-1;e[A]=e[A]+e[l+-1],e[l]=h*s[a]-c*s[a+1],e[l+-1]=c*s[a]+h*s[a+1],a+=r,h=e[o+-2]-e[l+-2],c=e[o+-3]-e[l+-3];var d=o+-2;e[d]=e[d]+e[l+-2];var _=o+-3;e[_]=e[_]+e[l+-3],e[l+-2]=h*s[a]-c*s[a+1],e[l+-3]=c*s[a]+h*s[a+1],a+=r,h=e[o+-4]-e[l+-4],c=e[o+-5]-e[l+-5];var f=o+-4;e[f]=e[f]+e[l+-4];var g=o+-5;e[g]=e[g]+e[l+-5],e[l+-4]=h*s[a]-c*s[a+1],e[l+-5]=c*s[a]+h*s[a+1],a+=r,h=e[o+-6]-e[l+-6],c=e[o+-7]-e[l+-7];var p=o+-6;e[p]=e[p]+e[l+-6];var m=o+-7;e[m]=e[m]+e[l+-7],e[l+-6]=h*s[a]-c*s[a+1],e[l+-7]=c*s[a]+h*s[a+1],o-=8,l-=8,a+=r}},mt.step3InnerSLoop=function(t,e,i,n,s,r,a,o){for(var l=s[r],u=s[r+1],h=s[r+a],c=s[r+a+1],A=s[r+2*a],d=s[r+2*a+1],_=s[r+3*a],f=s[r+3*a+1],g=i,p=i+n,m=t+1;0<--m;){var v=e[g]-e[p],w=e[g+-1]-e[p+-1];e[g]=e[g]+e[p],e[g+-1]=e[g+-1]+e[p+-1],e[p]=v*l-w*u,e[p+-1]=w*l+v*u,v=e[g+-2]-e[p+-2],w=e[g+-3]-e[p+-3],e[g+-2]=e[g+-2]+e[p+-2],e[g+-3]=e[g+-3]+e[p+-3],e[p+-2]=v*h-w*c,e[p+-3]=w*h+v*c,v=e[g+-4]-e[p+-4],w=e[g+-5]-e[p+-5],e[g+-4]=e[g+-4]+e[p+-4],e[g+-5]=e[g+-5]+e[p+-5],e[p+-4]=v*A-w*d,e[p+-5]=w*A+v*d,v=e[g+-6]-e[p+-6],w=e[g+-7]-e[p+-7],e[g+-6]=e[g+-6]+e[p+-6],e[g+-7]=e[g+-7]+e[p+-7],e[p+-6]=v*_-w*f,e[p+-7]=w*_+v*f,g-=o,p-=o}},mt.iter54=function(t,e){var i=t[e],n=t[e+-4],s=i-n,r=i+n,a=(i=t[e+-2])+(n=t[e+-6]),o=i-n;t[e]=r+a,t[e+-2]=r-a;var l=t[e+-3]-t[e+-7];t[e+-4]=s+l,t[e+-6]=s-l;var u=(i=t[e+-1])-(n=t[e+-5]),h=i+n,c=t[e+-3]+t[e+-7];t[e+-1]=h+c,t[e+-3]=h-c,t[e+-5]=u-o,t[e+-7]=u+o},mt.step3InnerSLoopLd654=function(t,e,i,n,s){for(var r=n[s>>3],a=i,o=i-16*t;o<a;){var l=e[a],u=e[a+-8];e[a+-8]=l-u,e[a]=l+u,l=e[a+-1],u=e[a+-9],e[a+-9]=l-u,e[a+-1]=l+u;var h=(l=e[a+-2])-(u=e[a+-10]);e[a+-2]=l+u;var c=(l=e[a+-3])-(u=e[a+-11]);e[a+-3]=l+u,e[a+-10]=(h+c)*r,e[a+-11]=(c-h)*r,l=e[a+-4],h=(u=e[a+-12])-l,e[a+-4]=l+u,c=(l=e[a+-5])-(u=e[a+-13]),e[a+-5]=l+u,e[a+-12]=c,e[a+-13]=h,l=e[a+-6],h=(u=e[a+-14])-l,e[a+-6]=l+u,c=(l=e[a+-7])-(u=e[a+-15]),e[a+-7]=l+u,e[a+-14]=(h+c)*r,e[a+-15]=(h-c)*r;var A=e[a],d=e[a+-4],_=A-d,f=A+d,g=(A=e[a+-2])+(d=e[a+-6]),p=A-d;e[a]=f+g,e[a+-2]=f-g;var m=e[a+-3]-e[a+-7];e[a+-4]=_+m,e[a+-6]=_-m;var v=(A=e[a+-1])-(d=e[a+-5]),w=A+d,b=e[a+-3]+e[a+-7];e[a+-1]=w+b,e[a+-3]=w-b,e[a+-5]=v-p,e[a+-7]=v+p;var y=a-8,x=e[y],T=e[y-4],S=x-T,E=x+T,B=(x=e[y-2])+(T=e[y-6]),k=x-T;e[y]=E+B,e[y-2]=E-B;var I=e[y-3]-e[y-7];e[y-4]=S+I,e[y-6]=S-I;var C=(x=e[y-1])-(T=e[y-5]),L=x+T,N=e[y-3]+e[y-7];e[y-1]=L+N,e[y-3]=L-N,e[y-5]=C-k,e[y-7]=C+k,a-=16}};var vt=function(t,e,i){this.seekFunc=e,this.inputLength=i,this.decoder=yt.start(t),this.decoder.setupSampleNumber(e,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(x["kha.audio2.ogg.vorbis.Reader"]=vt).__name__=!0,vt.openFromBytes=function(t){var e=new ht(t),i=e;return new vt(e,function(t){vt.seekBytes(i,t)},t.length)},vt.seekBytes=function(t,e){t.set_position(e)},vt.readAll=function(t,e,i){null==i&&(i=!1);var n=new ht(t),s=yt.start(n),r=n;s.setupSampleNumber(function(t){vt.seekBytes(r,t)},t.length);for(var a=s.header,o=new Float32Array(4096*a.channel);;){for(var l=s.read(o,4096,a.channel,a.sampleRate,i),u=0,h=l*a.channel;u<h;){var c=u++;e.writeFloat(o[c])}if(0==l)break;l}return s.header},vt.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var t=this.decoder.totalSample,e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},set_currentMillisecond:function(t){return this.set_currentSample(Math.floor(Mt.toFloat(this.get_header().sampleRate)*(t/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,i,n,s){return null==s&&(s=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==n&&(n=this.get_header().sampleRate),this.decoder.read(t,e,i,n,s)},clone:function(){var t=Object.create(vt.prototype);return t.seekFunc=this.seekFunc,t.inputLength=this.inputLength,t.decoder=this.decoder.clone(this.seekFunc),t.loopStart=this.loopStart,t.loopLength=this.loopLength,t},sampleToMillisecond:function(t){var e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},millisecondToSample:function(t){return Math.floor(Mt.toFloat(this.get_header().sampleRate)*(t/1e3))},__class__:vt,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_totalMillisecond:"get_totalMillisecond",get_totalSample:"get_totalSample",get_header:"get_header"}};function wt(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Pt,gt.init()}(x["kha.audio2.ogg.vorbis.VorbisDecodeState"]=wt).__name__=!0,wt.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var n=new Array(i),s=0,r=i;s<r;){n[s++]=this.input.readByte()}if(this.segments=n,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=t),--a;if(this.firstDecode){for(var o=0,l=new Ot,u=0,h=i;u<h;){var c=u++;o+=this.segments[c]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(wt.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof ne?t.val:t;if(e instanceof Xt)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new ne(new Xt(Yt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new ne(new Xt(Yt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,i=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var n=t instanceof ne?t.val:t;if(!(n instanceof m))throw t;i=!0,e=0}if(i)return!1;if(!!(!!(79!=e||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ne(new Xt(Yt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(24<t)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var i=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var t;return t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,t},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){var t,e,i,n,s,r,a=new xe(new ArrayBuffer(6));if(t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[0]=t,e=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[1]=e,i=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[2]=i,n=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[3]=n,s=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[4]=s,r=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[5]=r,"vorbis"!=a.toString())throw new ne(new Xt(Yt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){if(this.inputPosition+=1,!!(!!(79!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ne(new Xt(Yt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(t){this.validBits<10&&this.prepHuffman();var e,i=t.fastHuffman[1023&this.acc];if(0<=i){var n=t.codewordLengths[i];this.acc=this.acc>>>n,this.validBits-=n,e=this.validBits<0?(this.validBits=0,-1):i}else e=this.decodeScalarRaw(t);return t.sparse&&(e=t.sortedValues[e]),e},decodeRaw:function(t){this.validBits<10&&this.prepHuffman();var e=t.fastHuffman[1023&this.acc];if(0<=e){var i=t.codewordLengths[e];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):e}return this.decodeScalarRaw(t)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(t,e,i){var n=i.left.start,s=!1,r=e>>1;if(this.firstDecode)this.currentLoc=-r,this.discardSamplesDeferred=e-i.right.end,s=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,n=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(s&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(e-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:n,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(r-i.left.start),s=!0}return s&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:n,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}return e},readBytes:function(t){return this.inputPosition+=t,this.input.read(t)},readString:function(t){return this.inputPosition+=t,this.input.readString(t)},getSampleNumber:function(t,e){var i=this.inputPosition,n=Mt.gte(e,65536)&&Mt.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=n);var s=0,r=!1,a=this.findPage(t,e);switch(a._hx_index){case 0:var o=a.last;s=a.end,r=o;break;case 1:throw new ne(new Xt(Yt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!r;){t(this.inputPosition=s);var u=this.findPage(t,e);switch(u._hx_index){case 0:var h=u.last;s=u.end,r=h;break;case 1:break t}n=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var c=new Array(6),A=0;A<6;){c[A++]=this.input.readByte()}this.inputPosition+=4;var d=this.input.readInt32();this.inputPosition+=4;var _=this.input.readInt32();if(-1==d&&-1==_||0<_)throw new ne(new Xt(Yt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Ot,this.pLast.pageStart=l,this.pLast.pageEnd=s,this.pLast.lastDecodedSample=d,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=n,t(this.inputPosition=i),d},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(t,e){t(this.inputPosition=e)},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i=this.inputPosition;if(e<i-25)return bt.NotFound;if(this.inputPosition+=1,!!(103!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))continue;var n=new Array(27);if(n[0]=79,n[1]=103,n[2]=103,n[3]=83,this.inputPosition+=1,n[4]=this.input.readByte(),this.inputPosition+=1,n[5]=this.input.readByte(),this.inputPosition+=1,n[6]=this.input.readByte(),this.inputPosition+=1,n[7]=this.input.readByte(),this.inputPosition+=1,n[8]=this.input.readByte(),this.inputPosition+=1,n[9]=this.input.readByte(),this.inputPosition+=1,n[10]=this.input.readByte(),this.inputPosition+=1,n[11]=this.input.readByte(),this.inputPosition+=1,n[12]=this.input.readByte(),this.inputPosition+=1,n[13]=this.input.readByte(),this.inputPosition+=1,n[14]=this.input.readByte(),this.inputPosition+=1,n[15]=this.input.readByte(),this.inputPosition+=1,n[16]=this.input.readByte(),this.inputPosition+=1,n[17]=this.input.readByte(),this.inputPosition+=1,n[18]=this.input.readByte(),this.inputPosition+=1,n[19]=this.input.readByte(),this.inputPosition+=1,n[20]=this.input.readByte(),this.inputPosition+=1,n[21]=this.input.readByte(),this.inputPosition+=1,n[22]=this.input.readByte(),this.inputPosition+=1,n[23]=this.input.readByte(),this.inputPosition+=1,n[24]=this.input.readByte(),this.inputPosition+=1,n[25]=this.input.readByte(),this.inputPosition+=1,n[26]=this.input.readByte(),0!=n[4]){t(this.inputPosition=i);continue}var s=n[22]+(n[23]<<8)+(n[24]<<16)+(n[25]<<24);n[22]=0,n[23]=0,n[24]=0;for(var r=n[25]=0,a=0;a<27;){var o=a++;r=r<<8^gt.table[n[o]^r>>>24]}var l=0;try{for(var u=0,h=n[26];u<h;){u++;this.inputPosition+=1;var c=this.input.readByte();r=r<<8^gt.table[c^r>>>24],l+=c}for(var A=0,d=l;A<d;){A++;this.inputPosition+=1;var _=this.input.readByte();r=r<<8^gt.table[_^r>>>24]}}catch(t){var f=t instanceof ne?t.val:t;if(f instanceof m){return bt.NotFound}throw t}if(r==s){var g=this.inputPosition;return t(this.inputPosition=i-1),bt.Found(g,0!=(4&n[5]))}}}}catch(t){var p=t instanceof ne?t.val:t;if(p instanceof m){return bt.NotFound}throw t}},analyzePage:function(t,e){var i=new Ot,n=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var s=new Array(27),r=0;r<27;){s[r++]=this.input.readByte()}var a=s,o=a[26];this.inputPosition+=o;for(var l=new Array(o),u=0,h=o;u<h;){l[u++]=this.input.readByte()}for(var c=l,A=0,d=0,_=a[26];d<_;){A+=c[d++]}if(i.pageEnd=i.pageStart+27+a[26]+A,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,t(this.inputPosition=i.pageStart),i;for(var f=0,g=0==(1&a[5]),p=e.modes.length,m=0,v=a[26];m<v;){var w=m++;if(g){if(0==c[w])return t(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var b=this.input.readByte();if(0!=(1&b))return t(this.inputPosition=i.pageStart),null;b>>=1;var y=p-1,x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(p<=(b&=(1<<(y<16384?y<16?x[y]:y<512?5+x[y>>5]:10+x[y>>10]:y<16777216?y<524288?15+x[y>>15]:20+x[y>>20]:y<536870912?25+x[y>>25]:y<-2147483648?30+x[y>>30]:0))-1))return t(this.inputPosition=i.pageStart),null;n[f++]=e.modes[b].blockflag;var T=c[w]-1;this.inputPosition+=T;for(var S=new Array(T),E=0,B=T;E<B;){S[E++]=this.input.readByte()}}else{var k=c[w];this.inputPosition+=k;for(var I=new Array(k),C=0,L=k;C<L;){I[C++]=this.input.readByte()}}g=c[w]<255}var N=0;1<f&&(N+=n[f-1]?e.blocksize1:e.blocksize0);for(var F=f-2;1<=F;)n[--F]?n[F+1]?N+=e.blocksize1>>1:N+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):N+=e.blocksize0>>1,--F;return i.firstDecodedSample=i.lastDecodedSample-N,t(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,i=t.codewords,n=t.sortedCodewords;if(8<t.entries?null!=n:null!=i){for(var s=this.acc,r=(s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8)>>>16|s<<16,a=0,o=t.sortedEntries;1<o;){var l=a+(o>>1);Mt.gte(r,n[l])?(a=l,o-=o>>1):o>>=1}t.sparse||(a=t.sortedValues[a]);var u=e[a];return this.validBits>=u?(this.acc=this.acc>>>u,this.validBits-=u,a):(this.validBits=0,-1)}for(var h=0,c=t.entries;h<c;){var A=h++,d=e[A];if(255!=d&&i[A]==(this.acc&(1<<d)-1))return this.validBits>=d?(this.acc=this.acc>>>d,this.validBits-=d,A):(this.validBits=0,-1)}return this.error=new Xt(Yt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:wt};var bt=f["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:((e=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}}).__params__=["end","last"],e),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}},yt=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(t.channel);this.channelBuffers=i;var n=new Array(t.channel);this.previousWindow=n;var s=new Array(t.channel);this.finalY=s;for(var r=0,a=t.channel;r<a;){var o=r++,l=this.channelBuffers,u=new Array(t.blocksize1);l[o]=u;var h=this.previousWindow,c=new Array(t.blocksize1/2|0);h[o]=c,this.finalY[o]=[]}var A=new Array(2);this.a=A;var d=new Array(2);this.b=d;var _=new Array(2);this.c=_;var f=new Array(2);this.window=f;var g=new Array(2);this.bitReverseData=g,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};(x["kha.audio2.ogg.vorbis.VorbisDecoder"]=yt).__name__=!0,yt.start=function(t){var e=new wt(t),i=It.read(e),n=new yt(i,e);return e.startFirstDecode(),n.pumpFirstFrame(),n},yt.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,i,n,s){var r=this.header.sampleRate;if(0!=(Mt.toFloat(n)%Mt.toFloat(r)|0)){var a=this.header.sampleRate;throw new ne("Unsupported sampleRate : can't convert "+be.string(null==a?null:Mt.toFloat(a))+" to "+n)}if(i%this.header.channel!=0)throw new ne("Unsupported channels : can't convert "+this.header.channel+" to "+i);var o=this.header.sampleRate,l=Mt.toFloat(n)/Mt.toFloat(o)|0,u=i/this.header.channel|0,h=0,c=Math.floor(e/l);null!=this.totalSample&&c>this.totalSample-this.currentSample&&(c=this.totalSample-this.currentSample);for(var A=0;h<c;){var d=this.channelBufferEnd-this.channelBufferStart;c-h<=d&&(d=c-h);for(var _=this.channelBufferStart,f=this.channelBufferStart+d;_<f;)for(var g=_++,p=0,m=l;p<m;){p++;for(var v=0,w=this.header.channel;v<w;)for(var b=v++,y=0,x=u;y<x;){y++;var T=this.channelBuffers[b][g];1<T?T=1:T<-1&&(T=-1),s&&(t[A]=T,++A)}}if(h+=d,this.channelBufferStart+=d,h==c||0==this.getFrameFloat())break}for(var S=h,E=c;S<E;){S++;for(var B=0,k=l;B<k;){B++;for(var I=0,C=this.header.channel;I<C;){I++;for(var L=0,N=u;L<N;){L++;s&&(t[A]=0,++A)}}}}return this.currentSample+=c,c*l},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var i=this.channelBufferEnd-this.channelBufferStart;if(t-e<=i&&(i=t-e),e+=i,this.channelBufferStart+=i,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new ne(new Xt(Yt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var n=this.decodeState.pFirst,s=this.decodeState.pLast;if(i>=s.lastDecodedSample&&(i=s.lastDecodedSample-1),i<n.lastDecodedSample)this.seekFrameFromPage(t,n.pageStart,0,i);else{for(var r=0;n.pageEnd<s.pageStart;){var a=n.pageEnd,o=s.afterPreviousPageStart,l=n.lastDecodedSample,u=s.lastDecodedSample;if(null==l||null==u)throw new ne(new Xt(Yt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));Mt.gt(o,a+4e3)&&(o-=4e3);var h=a+Math.floor(Mt.toFloat(o-a)/Mt.toFloat(u-l)*(i-l));if(4<=r){var c=a+(o-a>>>1);h=8<=r?c:Mt.gt(c,h)?h+(c-h>>>1):c+(h-c>>>1)}++r,t(this.decodeState.inputPosition=h);var A=this.decodeState.findPage(t,e);switch(A._hx_index){case 0:A.last,A.end;break;case 1:throw new ne(new Xt(Yt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var d=this.decodeState.analyzePage(t,this.header);if(null==d)throw new ne(new Xt(Yt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));d.afterPreviousPageStart=h,d.pageStart!=s.pageStart?i<d.lastDecodedSample?s=d:n=d:s=d}if(!(n.lastDecodedSample<=i&&i<s.lastDecodedSample))throw new ne(new Xt(Yt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,s.pageStart,n.lastDecodedSample,i)}}},seekFrameFromPage:function(t,e,i,n){var s=0,r=i;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,u=null;;){l=u,u=this.decodeState.clone(t);var h=this.decodeInitial();if(null==h){u=l;break}o=h.left.start,a=h.left.end;var c=0==s?a:o;if(n<r+h.right.start-c)break;for(var A=this.decodeState;0!=A.bytesInSeg||!A.lastSeg&&0!=A.next();)A.bytesInSeg--,A.inputPosition+=1,A.input.readByte();r+=h.right.start-c,++s}this.decodeState=u,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=r,this.skipSamples(n-r)},clone:function(t){var e=Object.create(yt.prototype);e.currentSample=this.currentSample,e.totalSample=this.totalSample,e.previousLength=this.previousLength,e.channelBufferStart=this.channelBufferStart,e.channelBufferEnd=this.channelBufferEnd,e.a=this.a,e.b=this.b,e.c=this.c,e.window=this.window,e.bitReverseData=this.bitReverseData,e.header=this.header,e.decodeState=this.decodeState.clone(t);var i=new Array(this.header.channel);e.channelBuffers=i;var n=new Array(this.header.channel);e.previousWindow=n;var s=new Array(this.header.channel);e.finalY=s;for(var r=0,a=this.header.channel;r<a;){var o=r++;e.channelBuffers[o]=xt.copyVector(this.channelBuffers[o]),e.previousWindow[o]=xt.copyVector(this.previousWindow[o]),e.finalY[o]=l.array(this.finalY[o])}return e},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,i=t.right,n=t.left;if(0!=this.previousLength)for(var s=this.previousLength,r=this.getWindow(s),a=0,o=this.header.channel;a<o;)for(var l=a++,u=this.channelBuffers[l],h=this.previousWindow[l],c=0,A=s;c<A;){var d=c++;u[n+d]=u[n+d]*r[d]+h[d]*r[s-1-d]}var _=this.previousLength;this.previousLength=e-i;for(var f=0,g=this.header.channel;f<g;)for(var p=f++,m=this.previousWindow[p],v=this.channelBuffers[p],w=0,b=e-i;w<b;){var y=w++;m[y]=v[i+y]}return 0==_?0:(e<i&&(i=e),i-n)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var i=e>>1,n=e>>2,s=e>>3,r=this.a,a=new Array(i);r[t]=a;var o=this.b,l=new Array(i);o[t]=l;var u=this.c,h=new Array(n);u[t]=h;var c=this.window,A=new Array(i);c[t]=A;var d=this.bitReverseData,_=new Array(s);d[t]=_,xt.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),xt.computeWindow(e,this.window[t]),xt.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,i){for(var n=i?1:0,s=this.a[n],r=this.b[n],a=this.c[n],o=this.bitReverseData[n],l=e>>1,u=e>>2,h=e>>3,c=new Array(l),A=l-2,d=0,_=0,f=l;_!=f;)c[A+1]=t[_]*s[d]-t[_+2]*s[d+1],c[A]=t[_]*s[d+1]+t[_+2]*s[d],A-=2,d+=2,_+=4;for(_=l-3;0<=A;)c[A+1]=-t[_+2]*s[d]- -t[_]*s[d+1],c[A]=-t[_+2]*s[d+1]+-t[_]*s[d],A-=2,d+=2,_-=4;for(var g=t,p=c,m=l-8,v=u,w=0,b=u,y=0;0<=m;){var x=p[v+1]-p[w+1],T=p[v]-p[w];g[b+1]=p[v+1]+p[w+1],g[b]=p[v]+p[w],g[y+1]=x*s[m+4]-T*s[m+5],g[y]=T*s[m+4]+x*s[m+5],x=p[v+3]-p[w+3],T=p[v+2]-p[w+2],g[b+3]=p[v+3]+p[w+3],g[b+2]=p[v+2]+p[w+2],g[y+3]=x*s[m]-T*s[m+1],g[y+2]=T*s[m]+x*s[m+1],m-=8,b+=4,y+=4,v+=4,w+=4}for(var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],E=(e<16384?e<16?S[e]:e<512?5+S[e>>5]:10+S[e>>10]:e<16777216?e<524288?15+S[e>>15]:20+S[e>>20]:e<536870912?25+S[e>>25]:e<-2147483648?30+S[e>>30]:0)-1,B=l-1-0*u,k=B,I=B-(e>>3),C=0,L=1+(e>>4>>2);0<--L;){var N=g[k]-g[I],F=g[k+-1]-g[I+-1];g[k]=g[k]+g[I];var P=k+-1;g[P]=g[P]+g[I+-1],g[I]=N*s[C]-F*s[C+1],g[I+-1]=F*s[C]+N*s[C+1],C+=8,N=g[k+-2]-g[I+-2],F=g[k+-3]-g[I+-3];var M=k+-2;g[M]=g[M]+g[I+-2];var R=k+-3;g[R]=g[R]+g[I+-3],g[I+-2]=N*s[C]-F*s[C+1],g[I+-3]=F*s[C]+N*s[C+1],C+=8,N=g[k+-4]-g[I+-4],F=g[k+-5]-g[I+-5];var O=k+-4;g[O]=g[O]+g[I+-4];var V=k+-5;g[V]=g[V]+g[I+-5],g[I+-4]=N*s[C]-F*s[C+1],g[I+-5]=F*s[C]+N*s[C+1],C+=8,N=g[k+-6]-g[I+-6],F=g[k+-7]-g[I+-7];var D=k+-6;g[D]=g[D]+g[I+-6];var U=k+-7;g[U]=g[U]+g[I+-7],g[I+-6]=N*s[C]-F*s[C+1],g[I+-7]=F*s[C]+N*s[C+1],C+=8,k-=8,I-=8}for(var H=l-1-u,W=H,G=H-(e>>3),z=0,X=1+(e>>4>>2);0<--X;){var Y=g[W]-g[G],K=g[W+-1]-g[G+-1];g[W]=g[W]+g[G];var Q=W+-1;g[Q]=g[Q]+g[G+-1],g[G]=Y*s[z]-K*s[z+1],g[G+-1]=K*s[z]+Y*s[z+1],z+=8,Y=g[W+-2]-g[G+-2],K=g[W+-3]-g[G+-3];var q=W+-2;g[q]=g[q]+g[G+-2];var j=W+-3;g[j]=g[j]+g[G+-3],g[G+-2]=Y*s[z]-K*s[z+1],g[G+-3]=K*s[z]+Y*s[z+1],z+=8,Y=g[W+-4]-g[G+-4],K=g[W+-5]-g[G+-5];var Z=W+-4;g[Z]=g[Z]+g[G+-4];var J=W+-5;g[J]=g[J]+g[G+-5],g[G+-4]=Y*s[z]-K*s[z+1],g[G+-5]=K*s[z]+Y*s[z+1],z+=8,Y=g[W+-6]-g[G+-6],K=g[W+-7]-g[G+-7];var $=W+-6;g[$]=g[$]+g[G+-6];var tt=W+-7;g[tt]=g[tt]+g[G+-7],g[G+-6]=Y*s[z]-K*s[z+1],g[G+-7]=K*s[z]+Y*s[z+1],z+=8,W-=8,G-=8}for(var et=l-1-0*h,it=0,nt=et,st=et-(e>>4),rt=1+(e>>5>>2);0<--rt;){var at=g[nt]-g[st],ot=g[nt+-1]-g[st+-1];g[nt]=g[nt]+g[st];var lt=nt+-1;g[lt]=g[lt]+g[st+-1],g[st]=at*s[it]-ot*s[it+1],g[st+-1]=ot*s[it]+at*s[it+1],it+=16,at=g[nt+-2]-g[st+-2],ot=g[nt+-3]-g[st+-3];var ut=nt+-2;g[ut]=g[ut]+g[st+-2];var ht=nt+-3;g[ht]=g[ht]+g[st+-3],g[st+-2]=at*s[it]-ot*s[it+1],g[st+-3]=ot*s[it]+at*s[it+1],it+=16,at=g[nt+-4]-g[st+-4],ot=g[nt+-5]-g[st+-5];var ct=nt+-4;g[ct]=g[ct]+g[st+-4];var At=nt+-5;g[At]=g[At]+g[st+-5],g[st+-4]=at*s[it]-ot*s[it+1],g[st+-5]=ot*s[it]+at*s[it+1],it+=16,at=g[nt+-6]-g[st+-6],ot=g[nt+-7]-g[st+-7];var dt=nt+-6;g[dt]=g[dt]+g[st+-6];var _t=nt+-7;g[_t]=g[_t]+g[st+-7],g[st+-6]=at*s[it]-ot*s[it+1],g[st+-7]=ot*s[it]+at*s[it+1],nt-=8,st-=8,it+=16}for(var ft=l-1-h,gt=0,pt=ft,mt=ft-(e>>4),vt=1+(e>>5>>2);0<--vt;){var wt=g[pt]-g[mt],bt=g[pt+-1]-g[mt+-1];g[pt]=g[pt]+g[mt];var yt=pt+-1;g[yt]=g[yt]+g[mt+-1],g[mt]=wt*s[gt]-bt*s[gt+1],g[mt+-1]=bt*s[gt]+wt*s[gt+1],gt+=16,wt=g[pt+-2]-g[mt+-2],bt=g[pt+-3]-g[mt+-3];var xt=pt+-2;g[xt]=g[xt]+g[mt+-2];var Tt=pt+-3;g[Tt]=g[Tt]+g[mt+-3],g[mt+-2]=wt*s[gt]-bt*s[gt+1],g[mt+-3]=bt*s[gt]+wt*s[gt+1],gt+=16,wt=g[pt+-4]-g[mt+-4],bt=g[pt+-5]-g[mt+-5];var St=pt+-4;g[St]=g[St]+g[mt+-4];var Et=pt+-5;g[Et]=g[Et]+g[mt+-5],g[mt+-4]=wt*s[gt]-bt*s[gt+1],g[mt+-5]=bt*s[gt]+wt*s[gt+1],gt+=16,wt=g[pt+-6]-g[mt+-6],bt=g[pt+-7]-g[mt+-7];var Bt=pt+-6;g[Bt]=g[Bt]+g[mt+-6];var kt=pt+-7;g[kt]=g[kt]+g[mt+-7],g[mt+-6]=wt*s[gt]-bt*s[gt+1],g[mt+-7]=bt*s[gt]+wt*s[gt+1],pt-=8,mt-=8,gt+=16}for(var It=l-1-2*h,Ct=0,Lt=It,Nt=It-(e>>4),Ft=1+(e>>5>>2);0<--Ft;){var Pt=g[Lt]-g[Nt],Mt=g[Lt+-1]-g[Nt+-1];g[Lt]=g[Lt]+g[Nt];var Rt=Lt+-1;g[Rt]=g[Rt]+g[Nt+-1],g[Nt]=Pt*s[Ct]-Mt*s[Ct+1],g[Nt+-1]=Mt*s[Ct]+Pt*s[Ct+1],Ct+=16,Pt=g[Lt+-2]-g[Nt+-2],Mt=g[Lt+-3]-g[Nt+-3];var Ot=Lt+-2;g[Ot]=g[Ot]+g[Nt+-2];var Vt=Lt+-3;g[Vt]=g[Vt]+g[Nt+-3],g[Nt+-2]=Pt*s[Ct]-Mt*s[Ct+1],g[Nt+-3]=Mt*s[Ct]+Pt*s[Ct+1],Ct+=16,Pt=g[Lt+-4]-g[Nt+-4],Mt=g[Lt+-5]-g[Nt+-5];var Dt=Lt+-4;g[Dt]=g[Dt]+g[Nt+-4];var Ut=Lt+-5;g[Ut]=g[Ut]+g[Nt+-5],g[Nt+-4]=Pt*s[Ct]-Mt*s[Ct+1],g[Nt+-5]=Mt*s[Ct]+Pt*s[Ct+1],Ct+=16,Pt=g[Lt+-6]-g[Nt+-6],Mt=g[Lt+-7]-g[Nt+-7];var Ht=Lt+-6;g[Ht]=g[Ht]+g[Nt+-6];var Wt=Lt+-7;g[Wt]=g[Wt]+g[Nt+-7],g[Nt+-6]=Pt*s[Ct]-Mt*s[Ct+1],g[Nt+-7]=Mt*s[Ct]+Pt*s[Ct+1],Lt-=8,Nt-=8,Ct+=16}for(var Gt=l-1-3*h,zt=0,Xt=Gt,Yt=Gt-(e>>4),Kt=1+(e>>5>>2);0<--Kt;){var Qt=g[Xt]-g[Yt],qt=g[Xt+-1]-g[Yt+-1];g[Xt]=g[Xt]+g[Yt];var jt=Xt+-1;g[jt]=g[jt]+g[Yt+-1],g[Yt]=Qt*s[zt]-qt*s[zt+1],g[Yt+-1]=qt*s[zt]+Qt*s[zt+1],zt+=16,Qt=g[Xt+-2]-g[Yt+-2],qt=g[Xt+-3]-g[Yt+-3];var Zt=Xt+-2;g[Zt]=g[Zt]+g[Yt+-2];var Jt=Xt+-3;g[Jt]=g[Jt]+g[Yt+-3],g[Yt+-2]=Qt*s[zt]-qt*s[zt+1],g[Yt+-3]=qt*s[zt]+Qt*s[zt+1],zt+=16,Qt=g[Xt+-4]-g[Yt+-4],qt=g[Xt+-5]-g[Yt+-5];var $t=Xt+-4;g[$t]=g[$t]+g[Yt+-4];var te=Xt+-5;g[te]=g[te]+g[Yt+-5],g[Yt+-4]=Qt*s[zt]-qt*s[zt+1],g[Yt+-5]=qt*s[zt]+Qt*s[zt+1],zt+=16,Qt=g[Xt+-6]-g[Yt+-6],qt=g[Xt+-7]-g[Yt+-7];var ee=Xt+-6;g[ee]=g[ee]+g[Yt+-6];var ie=Xt+-7;g[ie]=g[ie]+g[Yt+-7],g[Yt+-6]=Qt*s[zt]-qt*s[zt+1],g[Yt+-7]=qt*s[zt]+Qt*s[zt+1],Xt-=8,Yt-=8,zt+=16}for(var ne=2,se=E-3>>1;ne<se;)for(var re=ne++,ae=e>>2+re,oe=ae>>1,le=0,ue=1<<1+re;le<ue;)for(var he=l-1-ae*le++,ce=1<<3+re,Ae=0,de=he,_e=he-oe,fe=1+(e>>4+re>>2);0<--fe;){var ge=g[de]-g[_e],pe=g[de+-1]-g[_e+-1];g[de]=g[de]+g[_e];var me=de+-1;g[me]=g[me]+g[_e+-1],g[_e]=ge*s[Ae]-pe*s[Ae+1],g[_e+-1]=pe*s[Ae]+ge*s[Ae+1],Ae+=ce,ge=g[de+-2]-g[_e+-2],pe=g[de+-3]-g[_e+-3];var ve=de+-2;g[ve]=g[ve]+g[_e+-2];var we=de+-3;g[we]=g[we]+g[_e+-3],g[_e+-2]=ge*s[Ae]-pe*s[Ae+1],g[_e+-3]=pe*s[Ae]+ge*s[Ae+1],Ae+=ce,ge=g[de+-4]-g[_e+-4],pe=g[de+-5]-g[_e+-5];var be=de+-4;g[be]=g[be]+g[_e+-4];var ye=de+-5;g[ye]=g[ye]+g[_e+-5],g[_e+-4]=ge*s[Ae]-pe*s[Ae+1],g[_e+-5]=pe*s[Ae]+ge*s[Ae+1],Ae+=ce,ge=g[de+-6]-g[_e+-6],pe=g[de+-7]-g[_e+-7];var xe=de+-6;g[xe]=g[xe]+g[_e+-6];var Te=de+-7;g[Te]=g[Te]+g[_e+-7],g[_e+-6]=ge*s[Ae]-pe*s[Ae+1],g[_e+-7]=pe*s[Ae]+ge*s[Ae+1],de-=8,_e-=8,Ae+=ce}for(var Se=E-3>>1,Ee=E-6;Se<Ee;)for(var Be=Se++,ke=e>>2+Be,Ie=1<<3+Be,Ce=ke>>1,Le=1<<1+Be,Ne=0,Fe=l-1,Pe=1+(e>>6+Be);0<--Pe;){for(var Me=s[Ne],Re=s[Ne+1],Oe=s[Ne+Ie],Ve=s[Ne+Ie+1],De=s[Ne+2*Ie],Ue=s[Ne+2*Ie+1],He=s[Ne+3*Ie],We=s[Ne+3*Ie+1],Ge=Fe,ze=Fe+-Ce,Xe=1+Le;0<--Xe;){var Ye=g[Ge]-g[ze],Ke=g[Ge+-1]-g[ze+-1];g[Ge]=g[Ge]+g[ze],g[Ge+-1]=g[Ge+-1]+g[ze+-1],g[ze]=Ye*Me-Ke*Re,g[ze+-1]=Ke*Me+Ye*Re,Ye=g[Ge+-2]-g[ze+-2],Ke=g[Ge+-3]-g[ze+-3],g[Ge+-2]=g[Ge+-2]+g[ze+-2],g[Ge+-3]=g[Ge+-3]+g[ze+-3],g[ze+-2]=Ye*Oe-Ke*Ve,g[ze+-3]=Ke*Oe+Ye*Ve,Ye=g[Ge+-4]-g[ze+-4],Ke=g[Ge+-5]-g[ze+-5],g[Ge+-4]=g[Ge+-4]+g[ze+-4],g[Ge+-5]=g[Ge+-5]+g[ze+-5],g[ze+-4]=Ye*De-Ke*Ue,g[ze+-5]=Ke*De+Ye*Ue,Ye=g[Ge+-6]-g[ze+-6],Ke=g[Ge+-7]-g[ze+-7],g[Ge+-6]=g[Ge+-6]+g[ze+-6],g[Ge+-7]=g[Ge+-7]+g[ze+-7],g[ze+-6]=Ye*He-Ke*We,g[ze+-7]=Ke*He+Ye*We,Ge-=ke,ze-=ke}Ne+=4*Ie,Fe-=8}for(var Qe=l-1,qe=s[e>>3],je=Qe,Ze=Qe-16*(e>>5);Ze<je;){var Je=g[je],$e=g[je+-8];g[je+-8]=Je-$e,g[je]=Je+$e,Je=g[je+-1],$e=g[je+-9],g[je+-9]=Je-$e,g[je+-1]=Je+$e;var ti=(Je=g[je+-2])-($e=g[je+-10]);g[je+-2]=Je+$e;var ei=(Je=g[je+-3])-($e=g[je+-11]);g[je+-3]=Je+$e,g[je+-10]=(ti+ei)*qe,g[je+-11]=(ei-ti)*qe,Je=g[je+-4],ti=($e=g[je+-12])-Je,g[je+-4]=Je+$e,ei=(Je=g[je+-5])-($e=g[je+-13]),g[je+-5]=Je+$e,g[je+-12]=ei,g[je+-13]=ti,Je=g[je+-6],ti=($e=g[je+-14])-Je,g[je+-6]=Je+$e,ei=(Je=g[je+-7])-($e=g[je+-15]),g[je+-7]=Je+$e,g[je+-14]=(ti+ei)*qe,g[je+-15]=(ti-ei)*qe;var ii=g[je],ni=g[je+-4],si=ii-ni,ri=ii+ni,ai=(ii=g[je+-2])+(ni=g[je+-6]),oi=ii-ni;g[je]=ri+ai,g[je+-2]=ri-ai;var li=g[je+-3]-g[je+-7];g[je+-4]=si+li,g[je+-6]=si-li;var ui=(ii=g[je+-1])-(ni=g[je+-5]),hi=ii+ni,ci=g[je+-3]+g[je+-7];g[je+-1]=hi+ci,g[je+-3]=hi-ci,g[je+-5]=ui-oi,g[je+-7]=ui+oi;var Ai=je-8,di=g[Ai],_i=g[Ai-4],fi=di-_i,gi=di+_i,pi=(di=g[Ai-2])+(_i=g[Ai-6]),mi=di-_i;g[Ai]=gi+pi,g[Ai-2]=gi-pi;var vi=g[Ai-3]-g[Ai-7];g[Ai-4]=fi+vi,g[Ai-6]=fi-vi;var wi=(di=g[Ai-1])-(_i=g[Ai-5]),bi=di+_i,yi=g[Ai-3]+g[Ai-7];g[Ai-1]=bi+yi,g[Ai-3]=bi-yi,g[Ai-5]=wi-mi,g[Ai-7]=wi+mi,je-=16}for(var xi=0,Ti=u-4,Si=l-4;0<=Ti;){var Ei=o[xi];p[Si+3]=g[Ei],p[Si+2]=g[Ei+1],p[Ti+3]=g[Ei+2],p[Ti+2]=g[Ei+3],Ei=o[xi+1],p[Si+1]=g[Ei],p[Si]=g[Ei+1],p[Ti+1]=g[Ei+2],p[Ti]=g[Ei+3],Ti-=4,Si-=4,xi+=2}for(var Bi=0,ki=0,Ii=l-4;ki<Ii;){var Ci=p[ki]-p[Ii+2],Li=p[ki+1]+p[Ii+3],Ni=a[Bi+1]*Ci+a[Bi]*Li,Fi=a[Bi+1]*Li-a[Bi]*Ci,Pi=p[ki]+p[Ii+2],Mi=p[ki+1]-p[Ii+3];p[ki]=Pi+Ni,p[ki+1]=Mi+Fi,p[Ii+2]=Pi-Ni,p[Ii+3]=Fi-Mi,Ci=p[ki+2]-p[Ii],Li=p[ki+3]+p[Ii+1],Ni=a[Bi+3]*Ci+a[Bi+2]*Li,Fi=a[Bi+3]*Li-a[Bi+2]*Ci,Pi=p[ki+2]+p[Ii],Mi=p[ki+3]-p[Ii+1],p[ki+2]=Pi+Ni,p[ki+3]=Mi+Fi,p[Ii]=Pi-Ni,p[Ii+1]=Fi-Mi,Bi+=4,ki+=4,Ii-=4}for(var Ri=l-8,Oi=l-8,Vi=0,Di=l-4,Ui=l,Hi=e-4;0<=Oi;){var Wi=c[Oi+6]*r[Ri+7]-c[Oi+7]*r[Ri+6],Gi=-c[Oi+6]*r[Ri+6]-c[Oi+7]*r[Ri+7];t[Vi]=Wi,t[Di+3]=-Wi,t[Ui]=Gi,t[Hi+3]=Gi;var zi=c[Oi+4]*r[Ri+5]-c[Oi+5]*r[Ri+4],Xi=-c[Oi+4]*r[Ri+4]-c[Oi+5]*r[Ri+5];t[Vi+1]=zi,t[Di+2]=-zi,t[Ui+1]=Xi,t[Hi+2]=Xi,Wi=c[Oi+2]*r[Ri+3]-c[Oi+3]*r[Ri+2],Gi=-c[Oi+2]*r[Ri+2]-c[Oi+3]*r[Ri+3],t[Vi+2]=Wi,t[Di+1]=-Wi,t[Ui+2]=Gi,t[Hi+1]=Gi,zi=c[Oi]*r[Ri+1]-c[Oi+1]*r[Ri],Xi=-c[Oi]*r[Ri]-c[Oi+1]*r[Ri+1],t[Vi+3]=zi,t[Di]=-zi,t[Ui+3]=Xi,t[Hi]=Xi,Ri-=8,Oi-=8,Vi+=4,Ui+=4,Di-=4,Hi-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(t=0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,e.input.readByte()):-1,e.validBits=0,-1==t)break}}var i=this.header.modes.length-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],s=this.decodeState.readBits(i<16384?i<16?n[i]:i<512?5+n[i>>5]:10+n[i>>10]:i<16777216?i<524288?15+n[i>>15]:20+n[i>>20]:i<536870912?25+n[i>>25]:i<-2147483648?30+n[i>>30]:0);if(-1==s||s>=this.header.modes.length)throw new ne(new Xt(Yt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var r,a,o,l=this.header.modes[s];l.blockflag?(r=this.header.blocksize1,a=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(a=o=0,r=this.header.blocksize0);var u=r>>1;return{mode:s,left:l.blockflag&&0==a?{start:r-this.header.blocksize0>>2,end:r+this.header.blocksize0>>2}:{start:0,end:u},right:l.blockflag&&0==o?{start:3*r-this.header.blocksize0>>2,end:3*r+this.header.blocksize0>>2}:{start:u,end:r}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],i=new Array(256),n=new Array(256),s=e.blockflag?this.header.blocksize1:this.header.blocksize0,r=this.header.mapping[e.mapping],a=s>>1,o=[256,128,86,64],l=this.header.codebooks,u=0,h=this.header.channel;u<h;){var c=u++,A=r.chan[c].mux;i[c]=!1;var d=this.header.floorConfig[r.submapFloor[A]];if(0==d.type)throw new ne(new Xt(Yt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var _=d.floor1;if(0!=this.decodeState.readBits(1)){var f=[],g=new Array(256),p=o[_.floor1Multiplier-1],m=2,v=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(f=this.finalY[c])[0]=this.decodeState.readBits((p<16384?p<16?v[p]:p<512?5+v[p>>5]:10+v[p>>10]:p<16777216?p<524288?15+v[p>>15]:20+v[p>>20]:p<536870912?25+v[p>>25]:p<-2147483648?30+v[p>>30]:0)-1);var w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];f[1]=this.decodeState.readBits((p<16384?p<16?w[p]:p<512?5+w[p>>5]:10+w[p>>10]:p<16777216?p<524288?15+w[p>>15]:20+w[p>>20]:p<536870912?25+w[p>>25]:p<-2147483648?30+w[p>>30]:0)-1);for(var b=0,y=_.partitions;b<y;){var x=b++,T=_.partitionClassList[x],S=_.classDimensions[T],E=_.classSubclasses[T],B=(1<<E)-1,k=0;if(0!=E){var I=l[_.classMasterbooks[T]],C=this.decodeState;C.validBits<10&&C.prepHuffman();var L,N=I.fastHuffman[1023&C.acc];if(0<=N){var F=I.codewordLengths[N];C.acc=C.acc>>>F,C.validBits-=F,L=C.validBits<0?(C.validBits=0,-1):N}else L=C.decodeScalarRaw(I);I.sparse&&(L=I.sortedValues[L]),k=L}for(var P=_.subclassBooks[T],M=0,R=S;M<R;){M++;var O=P[k&B];k>>=E;var V,D=m++;if(0<=O){var U=this.decodeState,H=l[O];U.validBits<10&&U.prepHuffman();var W,G=H.fastHuffman[1023&U.acc];if(0<=G){var z=H.codewordLengths[G];U.acc=U.acc>>>z,U.validBits-=z,W=U.validBits<0?(U.validBits=0,-1):G}else W=U.decodeScalarRaw(H);H.sparse&&(W=H.sortedValues[W]),V=W}else V=0;f[D]=V}}if(-1==this.decodeState.validBits){i[c]=!0;continue}g[0]=g[1]=!0;for(var X=_.neighbors,Y=_.xlist,K=2,Q=_.values;K<Q;){var q=K++,j=X[q][0],Z=X[q][1],J=Y[j],$=f[j],tt=f[Z]-$,et=Y[Z]-J,it=Math.abs(tt)*(Y[q]-J)/et|0,nt=tt<0?$-it:$+it,st=f[q],rt=p-nt,at=rt<nt?2*rt:2*nt;0!=st?(g[j]=g[Z]=!0,g[q]=!0,f[q]=at<=st?nt<rt?st-nt+nt:nt-st+rt-1:0!=(1&st)?nt-(st+1>>1):nt+(st>>1)):(g[q]=!1,f[q]=nt)}for(var ot=0,lt=_.values;ot<lt;){var ut=ot++;g[ut]||(f[ut]=-1)}}else i[c]=!0}for(var ht=0,ct=this.header.channel;ht<ct;){var At=ht++;n[At]=i[At]}for(var dt=0,_t=r.couplingSteps;dt<_t;){var ft=dt++;i[r.chan[ft].magnitude]&&i[r.chan[ft].angle]||(i[r.chan[ft].magnitude]=i[r.chan[ft].angle]=!1)}for(var gt=0,pt=r.submaps;gt<pt;){for(var mt=gt++,vt=new Array(this.header.channel),wt=new Array(256),bt=0,yt=0,xt=this.header.channel;yt<xt;){var Tt=yt++;r.chan[Tt].mux==mt&&(i[Tt]?(wt[bt]=!0,vt[bt]=null):(wt[bt]=!1,vt[bt]=this.channelBuffers[Tt]),++bt)}var St=r.submapResidue[mt];this.header.residueConfig[St].decode(this.decodeState,this.header,vt,bt,a,wt,this.channelBuffers)}for(var Et=r.couplingSteps,Bt=s>>1;0<=--Et;)for(var kt=this.channelBuffers[r.chan[Et].magnitude],It=this.channelBuffers[r.chan[Et].angle],Ct=0,Lt=Bt;Ct<Lt;){var Nt,Ft,Pt=Ct++;0<kt[Pt]?0<It[Pt]?(Ft=kt[Pt],Nt=kt[Pt]-It[Pt]):(Nt=kt[Pt],Ft=kt[Pt]+It[Pt]):0<It[Pt]?(Ft=kt[Pt],Nt=kt[Pt]+It[Pt]):(Nt=kt[Pt],Ft=kt[Pt]-It[Pt]),kt[Pt]=Ft,It[Pt]=Nt}for(var Mt=0,Rt=this.header.channel;Mt<Rt;){var Ot=Mt++;if(n[Ot])for(var Vt=0,Dt=Bt;Vt<Dt;){var Ut=Vt++;this.channelBuffers[Ot][Ut]=0}else r.doFloor(this.header.floorConfig,Ot,s,this.channelBuffers[Ot],this.finalY[Ot],null)}for(var Ht=0,Wt=this.header.channel;Ht<Wt;){var Gt=Ht++;this.inverseMdct(this.channelBuffers[Gt],s,e.blockflag)}for(var zt=this.decodeState;0!=zt.bytesInSeg||!zt.lastSeg&&0!=zt.next();)zt.bytesInSeg--,zt.inputPosition+=1,zt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,s,t)},__class__:yt};var xt=function(){};(x["kha.audio2.ogg.vorbis.VorbisTools"]=xt).__name__=!0,xt.assert=function(t,e){},xt.neighbors=function(t,e){for(var i=-1,n=65536,s=0,r=0,a=0,o=e;a<o;){var l=a++;t[l]>i&&t[l]<t[e]&&(i=t[s=l]),t[l]<n&&t[l]>t[e]&&(n=t[r=l])}return{low:s,high:r}},xt.floatUnpack=function(t){var e=Mt.toFloat(2097151&t),i=(2145386496&t)>>>21;return(0!=(-2147483648&t)?-e:e)*Math.pow(2,i-788)},xt.bitReverse=function(t){return(t=(-16711936&(t=(-252645136&(t=(-858993460&(t=(-1431655766&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8)>>>16|t<<16},xt.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},xt.uintAsc=function(t,e){return Mt.gt(e,t)?-1:t==e?0:1},xt.lookup1Values=function(t,e){var i=0|Math.exp(Math.log(t)/e);return(0|Math.pow(i+1,e))<=t&&++i,i},xt.computeWindow=function(t,e){for(var i=t>>1,n=0,s=i;n<s;){var r=n++;e[r]=Math.sin(1.5707963267948966*xt.square(Math.sin((.5+r)/i*.5*3.141592653589793)))}},xt.square=function(t){return t*t},xt.computeBitReverse=function(t,e){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=(t<16384?t<16?i[t]:t<512?5+i[t>>5]:10+i[t>>10]:t<16777216?t<524288?15+i[t>>15]:20+i[t>>20]:t<536870912?25+i[t>>25]:t<-2147483648?30+i[t>>30]:0)-1,s=0,r=t>>3;s<r;){var a=s++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[a]=(o>>>16|o<<16)>>>32-n+3<<2}},xt.computeTwiddleFactors=function(t,e,i,n){for(var s=t>>3,r=0,a=0,o=t>>2;a<o;){var l=a++;e[r]=Math.cos(4*l*3.141592653589793/t),e[r+1]=-Math.sin(4*l*3.141592653589793/t),i[r]=.5*Math.cos(3.141592653589793*(r+1)/t/2),i[r+1]=.5*Math.sin(3.141592653589793*(r+1)/t/2),r+=2}for(var u=0,h=0,c=s;h<c;){h++;n[u]=Math.cos(2*(u+1)*3.141592653589793/t),n[u+1]=-Math.sin(2*(u+1)*3.141592653589793/t),u+=2}},xt.drawLine=function(t,e,i,n,s,r){if(null==xt.integerDivideTable){var a=new Array(32);xt.integerDivideTable=a;for(var o=0;o<32;){var l=o++,u=xt.integerDivideTable,h=new Array(64);u[l]=h;for(var c=1;c<64;){var A=c++;xt.integerDivideTable[l][A]=l/A|0}}}var d,_,f=s-i,g=n-e,p=f<0?-f:f,m=e,v=i,w=0;_=g<64&&p<32?f<0?(d=-xt.integerDivideTable[p][g])-1:(d=xt.integerDivideTable[p][g])+1:(d=f/g|0,f<0?d-1:d+1),p-=(d<0?-d:d)*g,r<n&&(n=r);t[m]=t[m]*xt.INVERSE_DB_TABLE[v];for(var b=m+1,y=n;b<y;){var x=b++;g<=(w+=p)?(w-=g,v+=_):v+=d;t[x]=t[x]*xt.INVERSE_DB_TABLE[v]}},xt.predictPoint=function(t,e,i,n,s){var r=s-n,a=i-e,o=Math.abs(r)*(t-e)/a|0;return r<0?n-o:n+o},xt.emptyFloatVector=function(t){return new Array(t)},xt.copyVector=function(t){for(var e=new Array(t.length),i=0,n=t.length;i<n;){var s=i++;e[s]=t[s]}return e};function Tt(){}(x["kha.audio2.ogg.vorbis.data.Codebook"]=Tt).__name__=!0,Tt.read=function(t){var e=new Tt;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+i;var n=t.readBits(8),s=t.readBits(8);e.entries=(t.readBits(8)<<16)+(s<<8)+n;var r=t.readBits(1);e.sparse=0==r&&0!=t.readBits(1);var a=new Array(e.entries);e.sparse||(e.codewordLengths=a);var o,l=0;if(0!=r)for(var u=0,h=t.readBits(5)+1;u<e.entries;){var c=e.entries-u,A=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],d=t.readBits(c<16384?c<16?A[c]:c<512?5+A[c>>5]:10+A[c>>10]:c<16777216?c<524288?15+A[c>>15]:20+A[c>>20]:c<536870912?25+A[c>>25]:c<-2147483648?30+A[c>>30]:0);if(u+d>e.entries)throw new ne(new Xt(Yt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var _=0,f=d;_<f;){a[u+_++]=h}u+=d,++h}else for(var g=0,p=e.entries;g<p;){var m=g++;0!=(e.sparse?t.readBits(1):1)?(a[m]=t.readBits(5)+1,++l):a[m]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=a,e.sparse=!1),e.sparse)o=l;else{for(var v=0,w=0,b=e.entries;w<b;){var y=a[w++];10<y&&255!=y&&++v}o=v}e.sortedEntries=o;var x=null;if(e.sparse){if(0!=e.sortedEntries){var T=new Array(e.sortedEntries);e.codewordLengths=T;var S=new Array(e.entries);e.codewords=S,x=new Array(e.entries)}e.entries,e.sortedEntries}else{var E=new Array(e.entries);e.codewords=E}if(!e.computeCodewords(a,e.entries,x))throw new ne(new Xt(Yt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var B=new Array(e.sortedEntries);e.sortedValues=B,e.computeSortedHuffman(a,x)}if(e.sparse&&(x=null,a=e.codewords=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),2<e.lookupType)throw new ne(new Xt(Yt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<e.lookupType){var k=t.readBits(32),I=Mt.toFloat(2097151&k),C=(2145386496&k)>>>21,L=0!=(-2147483648&k)?-I:I;e.minimumValue=L*Math.pow(2,C-788);var N=t.readBits(32),F=Mt.toFloat(2097151&N),P=(2145386496&N)>>>21,M=0!=(-2147483648&N)?-F:F;e.deltaValue=M*Math.pow(2,P-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=xt.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var R=new Array(e.lookupValues),O=0,V=e.lookupValues;O<V;){var D=O++,U=t.readBits(e.valueBits);if(-1==U)throw new ne(new Xt(Yt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));R[D]=U}var H=new Array(e.lookupValues);e.multiplicands=H;for(var W=0,G=e.lookupValues;W<G;){var z=W++;e.multiplicands[z]=R[z]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var X=1,Y=e.lookupValues;X<Y;){var K=X++;e.multiplicands[K]=e.multiplicands[K-1]}e.sequenceP=!1}}return e},Tt.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(t,e,i,n,s){this.sparse?(this.codewords[i]=t,this.codewordLengths[i]=n,s[i]=e):this.codewords[e]=t},includeInSort:function(t){return!!this.sparse||255!=t&&10<t},computeCodewords:function(t,e,i){var n=new Array(32);n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,n[16]=0,n[17]=0,n[18]=0,n[19]=0,n[20]=0,n[21]=0,n[22]=0,n[23]=0,n[24]=0,n[25]=0,n[26]=0,n[27]=0,n[28]=0,n[29]=0,n[30]=0;for(var s=n[31]=0;s<e&&!(t[s]<255);)++s;if(s==e)return!0;var r=0,a=r++;this.sparse?(this.codewords[a]=0,this.codewordLengths[a]=t[s],i[a]=s):this.codewords[s]=0;for(var o=0;++o<=t[s];)n[o]=1<<32-o;for(o=s;++o<e;){var l=t[o];if(255!=l){for(;0<l&&0==n[l];)--l;if(0==l)return!1;var u=n[l];n[l]=0;var h=u,c=(h=(-16711936&(h=(-252645136&(h=(-858993460&(h=(-1431655766&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8)>>>16|h<<16,A=r++;if(this.sparse?(this.codewords[A]=c,this.codewordLengths[A]=t[o],i[A]=o):this.codewords[o]=c,l!=t[o])for(var d=t[o];l<d;)n[d]=u+(1<<32-d),--d}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var i=0,n=this.sortedEntries;i<n;){var s=i++,r=this.codewords[s];r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,this.sortedCodewords[s]=r>>>16|r<<16}else for(var a=0,o=0,l=this.entries;o<l;){var u=o++,h=t[u];if(this.sparse||255!=h&&10<h){var c=this.codewords[u];c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,this.sortedCodewords[a++]=c>>>16|c<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(xt.uintAsc);for(var A=0,d=this.sparse?this.sortedEntries:this.entries;A<d;){var _=A++,f=this.sparse?t[e[_]]:t[_];if(this.sparse||255!=f&&10<f){for(var g=this.codewords[_],p=(g=(-16711936&(g=(-252645136&(g=(-858993460&(g=(-1431655766&g)>>>1|(1431655765&g)<<1))>>>2|(858993459&g)<<2))>>>4|(252645135&g)<<4))>>>8|(16711935&g)<<8)>>>16|g<<16,m=0,v=this.sortedEntries;1<v;){var w=m+(v>>1);Mt.gte(p,this.sortedCodewords[w])?(m=w,v-=v>>1):v>>=1}this.sparse?(this.sortedValues[m]=e[_],this.codewordLengths[m]=f):this.sortedValues[m]=_}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var i=e++;this.fastHuffman[i]=-1}for(var n=0,s=this.sparse?this.sortedEntries:this.entries;n<s;){var r=n++;if(this.codewordLengths[r]<=10){var a;if(this.sparse){var o=this.sortedCodewords[r];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[r];for(;a<1024;)this.fastHuffman[a]=r,a+=1<<this.codewordLengths[r]}}},codebookDecode:function(t,e,i,n){t.validBits<10&&t.prepHuffman();var s,r=this.fastHuffman[1023&t.acc];if(0<=r){var a=this.codewordLengths[r];t.acc=t.acc>>>a,t.validBits-=a,s=t.validBits<0?(t.validBits=0,-1):r}else s=t.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var o=s,l=this.lookupValues,u=this.sequenceP,h=this.multiplicands,c=this.minimumValue;if(o<0)return!1;if(n>this.dimensions&&(n=this.dimensions),1==this.lookupType){for(var A=1,d=0,_=0,f=n;_<f;){var g=_++,p=h[Mt.toFloat(o/A|0)%Mt.toFloat(l)|0]+d,m=i+g;e[m]=e[m]+p,u&&(d=p+c),A*=l}return!0}if(o*=this.dimensions,u)for(var v=0,w=0,b=n;w<b;){var y=w++,x=h[o+y]+v,T=i+y;e[T]=e[T]+x,v=x+c}else for(var S=0,E=n;S<E;){var B=S++,k=i+B;e[k]=e[k]+(h[o+B]+0)}return!0},codebookDecodeStep:function(t,e,i,n,s){t.validBits<10&&t.prepHuffman();var r,a=this.fastHuffman[1023&t.acc];if(0<=a){var o=this.codewordLengths[a];t.acc=t.acc>>>o,t.validBits-=o,r=t.validBits<0?(t.validBits=0,-1):a}else r=t.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var l=r,u=0;if(l<0)return!1;n>this.dimensions&&(n=this.dimensions);var h=this.lookupValues,c=this.sequenceP,A=this.multiplicands;if(1==this.lookupType){for(var d=1,_=0,f=n;_<f;){var g=_++,p=A[Mt.toFloat(l/d|0)%Mt.toFloat(h)|0]+u,m=i+g*s;e[m]=e[m]+p,c&&(u=p),d*=h}return!0}l*=this.dimensions;for(var v=0,w=n;v<w;){var b=v++,y=A[l+b]+u,x=i+b*s;e[x]=e[x]+y,c&&(u=y)}return!0},decodeStart:function(t){t.validBits<10&&t.prepHuffman();var e,i=this.fastHuffman[1023&t.acc];if(0<=i){var n=this.codewordLengths[i];t.acc=t.acc>>>n,t.validBits-=n,e=t.validBits<0?(t.validBits=0,-1):i}else e=t.decodeScalarRaw(this);return this.sparse&&(e=this.sortedValues[e]),e},decodeDeinterleaveRepeat:function(t,e,i,n,s,r,a){var o=this.dimensions;if(0==this.lookupType)throw new ne(new Xt(Yt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,u=this.sequenceP,h=this.lookupValues;0<a;){var c=0;t.validBits<10&&t.prepHuffman();var A,d=this.fastHuffman[1023&t.acc];if(0<=d){var _=this.codewordLengths[d];t.acc=t.acc>>>_,t.validBits-=_,A=t.validBits<0?(t.validBits=0,-1):d}else A=t.decodeScalarRaw(this);this.sparse&&(A=this.sortedValues[A]);var f=A;if(f<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new ne(new Xt(Yt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(r*i<n+s*i+o&&(o=r*i-(s*i-n)),1==this.lookupType){var g=1;if(u)for(var p=0,m=o;p<m;){p++;var v=l[Mt.toFloat(f/g|0)%Mt.toFloat(h)|0]+c,w=e[n];w[s]=w[s]+v,++n==i&&(n=0,++s),c=v,g*=h}else for(var b=0,y=o;b<y;){b++;var x=l[Mt.toFloat(f/g|0)%Mt.toFloat(h)|0]+c,T=e[n];T[s]=T[s]+x,++n==i&&(n=0,++s),g*=h}}else if(f*=this.dimensions,u)for(var S=0,E=o;S<E;){var B=l[f+S++]+c,k=e[n];k[s]=k[s]+B,++n==i&&(n=0,++s),c=B}else for(var I=0,C=o;I<C;){var L=l[f+I++]+c,N=e[n];N[s]=N[s]+L,++n==i&&(n=0,++s)}a-=o}return{cInter:n,pInter:s}},residueDecode:function(t,e,i,n,s){if(0==s)for(var r=n/this.dimensions|0,a=0,o=r;a<o;){var l=a++;if(!this.codebookDecodeStep(t,e,i+l,n-i-l,r))return!1}else for(var u=0;u<n;){if(!this.codebookDecode(t,e,i,n-u))return!1;u+=this.dimensions,i+=this.dimensions}return!0},__class__:Tt};function St(){this.data=new it}(x["kha.audio2.ogg.vorbis.data.Comment"]=St).__name__=!0,St.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return be.parseInt(this.getString("loopstart"))},get_loopLength:function(){return be.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(t,e){t=t.toLowerCase();var i=this.data;if(null!=Ni[t]?i.existsReserved(t):i.h.hasOwnProperty(t)){var n=this.data;(null!=Ni[t]?n.getReserved(t):n.h[t]).push(e)}else{var s=[e],r=this.data;null!=Ni[t]?r.setReserved(t,s):r.h[t]=s}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ni[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return(null!=Ni[t]?i.getReserved(t):i.h[t])[0]}return null},getArray:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ni[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return null!=Ni[t]?i.getReserved(t):i.h[t]}return null},__class__:St,__properties__:{get_artists:"get_artists",get_isrc:"get_isrc",get_contact:"get_contact",get_location:"get_location",get_date:"get_date",get_genre:"get_genre",get_description:"get_description",get_artist:"get_artist",get_license:"get_license",get_copyright:"get_copyright",get_performer:"get_performer",get_tracknumber:"get_tracknumber",get_organization:"get_organization",get_album:"get_album",get_version:"get_version",get_loopLength:"get_loopLength",get_loopStart:"get_loopStart",get_title:"get_title"}};function Et(){}(x["kha.audio2.ogg.vorbis.data.Floor"]=Et).__name__=!0,Et.read=function(t,e){var i=new Et;if(i.type=t.readBits(16),1<i.type)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var n=i.floor0=new Bt;n.order=t.readBits(8),n.rate=t.readBits(16),n.barkMapSize=t.readBits(16),n.amplitudeBits=t.readBits(6),n.amplitudeOffset=t.readBits(8),n.numberOfBooks=t.readBits(4)+1;for(var s=0,r=n.numberOfBooks;s<r;){var a=s++;n.bookList[a]=t.readBits(8)}throw new ne(new Xt(Yt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new kt,u=-1;l.partitions=t.readBits(5);var h=new Array(l.partitions);l.partitionClassList=h;for(var c=0,A=l.partitions;c<A;){var d=c++;l.partitionClassList[d]=t.readBits(4),l.partitionClassList[d]>u&&(u=l.partitionClassList[d])}var _=new Array(u+1);l.classDimensions=_;var f=new Array(u+1);l.classMasterbooks=f;var g=new Array(u+1);l.classSubclasses=g;var p=new Array(u+1);l.subclassBooks=p;for(var m=0,v=u+1;m<v;){var w=m++;if(l.classDimensions[w]=t.readBits(3)+1,l.classSubclasses[w]=t.readBits(2),0!=l.classSubclasses[w]&&(l.classMasterbooks[w]=t.readBits(8),l.classMasterbooks[w]>=e.length))throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var b=1<<l.classSubclasses[w],y=l.subclassBooks,x=new Array(b);y[w]=x;for(var T=0,S=b;T<S;){var E=T++;if(l.subclassBooks[w][E]=t.readBits(8)-1,l.subclassBooks[w][E]>=e.length)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var B=new Array(250);l.xlist=B,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var k=0,I=l.partitions;k<I;)for(var C=k++,L=l.partitionClassList[C],N=0,F=l.classDimensions[L];N<F;){N++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var P=0,M=l.values;P<M;){var R=P++;o.push(new Ct),o[R].x=l.xlist[R],o[R].y=R}o.sort(xt.pointCompare);var O=new Array(l.values);l.sortedOrder=O;for(var V=0,D=l.values;V<D;){var U=V++;l.sortedOrder[U]=o[U].y}var H=new Array(l.values);l.neighbors=H;for(var W=2,G=l.values;W<G;){for(var z=W++,X=l.xlist,Y=-1,K=65536,Q=0,q=0,j=0,Z=z;j<Z;){var J=j++;X[J]>Y&&X[J]<X[z]&&(Y=X[Q=J]),X[J]<K&&X[J]>X[z]&&(K=X[q=J])}var $=Q,tt=q,et=l.neighbors,it=new Array(l.values);et[z]=it,l.neighbors[z][0]=$,l.neighbors[z][1]=tt}return i},Et.prototype={floor0:null,floor1:null,type:null,__class__:Et};var Bt=function(){};(x["kha.audio2.ogg.vorbis.data.Floor0"]=Bt).__name__=!0,Bt.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Bt};var kt=function(){};(x["kha.audio2.ogg.vorbis.data.Floor1"]=kt).__name__=!0,kt.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:kt};var It=function(){};(x["kha.audio2.ogg.vorbis.data.Header"]=It).__name__=!0,It.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,n,s,r,a,o,l=new xe(new ArrayBuffer(6));if(i=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[0]=i,n=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[1]=n,s=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[2]=s,r=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[3]=r,a=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[4]=a,o=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new ne(new Xt(Yt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var u=t.input.readInt32();if(0!=u)throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"vorbis version : "+u,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var h=new It;if(t.inputPosition+=1,h.channel=t.input.readByte(),0==h.channel)throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<h.channel)throw new ne(new Xt(Yt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,h.sampleRate=t.input.readInt32(),0==h.sampleRate)throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,h.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,h.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,h.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var c=t.input.readByte(),A=15&c,d=c>>4;if(h.blocksize0=1<<A,h.blocksize1=1<<d,A<6||13<A)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(d<6||13<d)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(d<A)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var _=t.input.readByte();if(0==(1&_))throw new ne(new Xt(Yt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var f=0,g=new ct;0!=(f=t.next());)t.inputPosition+=f,g.write(t.input.read(f)),t.bytesInSeg=0;var p=new ht(g.getBytes());p.readByte(),p.read(6);var m,v=p.readInt32();h.vendor=p.readString(v),h.comment=new St;for(var w=0,b=p.readInt32();w<b;){w++;var y=p.readInt32(),x=p.readString(y),T=x.indexOf("=");-1!=T&&h.comment.add(x.substring(0,T),x.substring(T+1))}if(0==(1&p.readByte()))throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),m=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,5!=m)throw new ne(new Xt(Yt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var S,E,B,k,I,C,L=new xe(new ArrayBuffer(6));if(S=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[0]=S,E=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[1]=E,B=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[2]=B,k=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[3]=k,I=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[4]=I,C=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[5]=C,"vorbis"!=L.toString())throw new ne(new Xt(Yt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var N=t.readBits(8)+1,F=new Array(N);h.codebooks=F;for(var P=0,M=N;P<M;){var R=P++;h.codebooks[R]=Tt.read(t)}for(var O=0,V=_=t.readBits(6)+1;O<V;){O++;if(0!=t.readBits(16))throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var D=t.readBits(6)+1,U=new Array(D);h.floorConfig=U;for(var H=0,W=D;H<W;){var G=H++;h.floorConfig[G]=Et.read(t,h.codebooks)}var z=t.readBits(6)+1,X=new Array(z);h.residueConfig=X;for(var Y=0,K=z;Y<K;){var Q=Y++;h.residueConfig[Q]=Vt.read(t,h.codebooks)}var q=t.readBits(6)+1,j=new Array(q);h.mapping=j;for(var Z=0,J=q;Z<J;)for(var $=Z++,tt=Lt.read(t,h.channel),et=0,it=(h.mapping[$]=tt).submaps;et<it;){var nt=et++;if(tt.submapFloor[nt]>=h.floorConfig.length)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(tt.submapResidue[nt]>=h.residueConfig.length)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var st=t.readBits(6)+1,rt=new Array(st);h.modes=rt;for(var at=0,ot=st;at<ot;){var lt=at++,ut=Ft.read(t);if((h.modes[lt]=ut).mapping>=h.mapping.length)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return h},It.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:It};var Ct=function(){};(x["kha.audio2.ogg.vorbis.data.IntPoint"]=Ct).__name__=!0,Ct.prototype={x:null,y:null,__class__:Ct};var Lt=function(){};(x["kha.audio2.ogg.vorbis.data.Mapping"]=Lt).__name__=!0,Lt.read=function(t,e){var i=new Lt,n=t.readBits(16);if(0!=n)throw new ne(new Xt(Yt.INVALID_SETUP,"mapping type "+n,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var s=new Array(e);i.chan=s;for(var r=0,a=e;r<a;){var o=r++;i.chan[o]=new Nt}if(0!=t.readBits(1)?i.submaps=t.readBits(4)+1:i.submaps=1,0!=t.readBits(1)){i.couplingSteps=t.readBits(8)+1;for(var l=0,u=i.couplingSteps;l<u;){var h=l++,c=e-1,A=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[h].magnitude=t.readBits(c<16384?c<16?A[c]:c<512?5+A[c>>5]:10+A[c>>10]:c<16777216?c<524288?15+A[c>>15]:20+A[c>>20]:c<536870912?25+A[c>>25]:c<-2147483648?30+A[c>>30]:0);var d=e-1,_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[h].angle=t.readBits(d<16384?d<16?_[d]:d<512?5+_[d>>5]:10+_[d>>10]:d<16777216?d<524288?15+_[d>>15]:20+_[d>>20]:d<536870912?25+_[d>>25]:d<-2147483648?30+_[d>>30]:0),i.chan[h].magnitude>=e)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].angle>=e)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].magnitude==i.chan[h].angle)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=t.readBits(2))throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<i.submaps)for(var f=0,g=e;f<g;){var p=f++;if(i.chan[p].mux=t.readBits(4),i.chan[p].mux>=i.submaps)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var m=0,v=e;m<v;){var w=m++;i.chan[w].mux=0}var b=new Array(i.submaps);i.submapFloor=b;var y=new Array(i.submaps);i.submapResidue=y;for(var x=0,T=i.submaps;x<T;){var S=x++;t.readBits(8),i.submapFloor[S]=t.readBits(8),i.submapResidue[S]=t.readBits(8)}return i},Lt.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,i,n,s,r){var a=i>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new ne(new Xt(Yt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var u=l.floor1,h=0,c=s[0]*u.floor1Multiplier,A=1,d=u.values;A<d;){var _=A++,f=u.sortedOrder[_];if(0<=s[f]){var g=s[f]*u.floor1Multiplier,p=u.xlist[f];xt.drawLine(n,h,c,p,g,a),h=p,c=g}}if(h<a)for(var m=h,v=a;m<v;){var w=m++;n[w]=n[w]*xt.INVERSE_DB_TABLE[c]}},__class__:Lt};var Nt=function(){};(x["kha.audio2.ogg.vorbis.data.MappingChannel"]=Nt).__name__=!0,Nt.prototype={magnitude:null,angle:null,mux:null,__class__:Nt};var Ft=function(){};(x["kha.audio2.ogg.vorbis.data.Mode"]=Ft).__name__=!0,Ft.read=function(t){var e=new Ft;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},Ft.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:Ft};var Pt=function(){};(x["kha.audio2.ogg.vorbis.data.Page"]=Pt).__name__=!0,Pt.prototype={flag:null,clone:function(){var t=new Pt;return t.flag=this.flag,t},start:function(t){if(t.inputPosition+=1,!!(!!(79!=t.input.readByte()||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,83!=t.input.readByte()))throw new ne(new Xt(Yt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new ne(new Xt(Yt.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4;var n=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(i,n)},__class__:Pt};function Rt(){}(x["kha.audio2.ogg.vorbis.data.PageFlag"]=Rt).__name__=!0;var Ot=function(){};(x["kha.audio2.ogg.vorbis.data.ProbedPage"]=Ot).__name__=!0,Ot.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Ot};var Xt=function(t,e,i){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=i};(x["kha.audio2.ogg.vorbis.data.ReaderError"]=Xt).__name__=!0,Xt.prototype={type:null,message:null,posInfos:null,__class__:Xt};var Yt=f["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i}},Vt=function(){};(x["kha.audio2.ogg.vorbis.data.Residue"]=Vt).__name__=!0,Vt.read=function(t,e){var i=new Vt;if(i.type=t.readBits(16),2<i.type)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var n=new Array(64);i.begin=t.readBits(24),i.end=t.readBits(24),i.partSize=t.readBits(24)+1;var s=i.classifications=t.readBits(6)+1;i.classbook=t.readBits(8);for(var r=0,a=i.classifications;r<a;){var o=r++,l=0,u=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),n[o]=8*l+u}var h=new Array(i.classifications);i.residueBooks=h;for(var c=0,A=i.classifications;c<A;){var d=c++,_=i.residueBooks,f=new Array(8);_[d]=f;for(var g=0;g<8;){var p=g++;if(0!=(n[d]&1<<p)){if(i.residueBooks[d][p]=t.readBits(8),i.residueBooks[d][p]>=e.length)throw new ne(new Xt(Yt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[d][p]=-1}}var m=e[i.classbook].entries,v=e[i.classbook].dimensions,w=new Array(m);i.classdata=w;for(var b=0,y=m;b<y;)for(var x=b++,T=x,S=v,E=i.classdata,B=new Array(v),k=E[x]=B;0<=--S;)k[S]=T%s,T=T/s|0;return i},Vt.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,i,n,s,r,a){for(var o=e.codebooks,l=o[this.classbook].dimensions,u=this.end-this.begin,h=this.partSize,c=Mt.toFloat(u)/Mt.toFloat(h)|0,A=new Array(e.channel*c+1),d=0,_=n;d<_;){var f=d++;if(!r[f])for(var g=i[f],p=0,m=g.length;p<m;){g[p++]=0}}if(2!=this.type||1==n)for(var v=0;v<8;)for(var w=v++,b=0;b<c;){if(0==w)for(var y=0,x=n;y<x;){var T=y++;if(!r[T]){var S=o[this.classbook];t.validBits<10&&t.prepHuffman();var E,B=S.fastHuffman[1023&t.acc];if(0<=B){var k=S.codewordLengths[B];t.acc=t.acc>>>k,t.validBits-=k,E=t.validBits<0?(t.validBits=0,-1):B}else E=t.decodeScalarRaw(S);S.sparse&&(E=S.sortedValues[E]);var I=E;if(-1==I)return;for(var C=l;0<=--C;)A[T*c+C+b]=I%this.classifications,I=I/this.classifications|0}}for(var L=0,N=l;L<N;){L++;if(c<=b)break;for(var F=0,P=n;F<P;){var M=F++;if(!r[M]){var R=A[M*c+b],O=this.residueBooks[R][w];if(0<=O){var V=i[M],D=this.begin+b*h,U=h;if(!o[O].residueDecode(t,V,D,U,this.type))return}}}++b}}else{for(var H=0,W=n;H<W;){var G=H++;if(!r[G])break;if(G==n-1)return}for(var z=0;z<8;){var X=z++,Y=0;if(2==n)for(;Y<c;){var K=this.begin+Y*h,Q=1&K,q=K>>>1;if(0==X){var j=o[this.classbook];t.validBits<10&&t.prepHuffman();var Z,J=j.fastHuffman[1023&t.acc];if(0<=J){var $=j.codewordLengths[J];t.acc=t.acc>>>$,t.validBits-=$,Z=t.validBits<0?(t.validBits=0,-1):J}else Z=t.decodeScalarRaw(j);j.sparse&&(Z=j.sortedValues[Z]);var tt=Z;if(-1==tt)return;for(var et=l;0<=--et;)A[et+Y]=tt%this.classifications,tt=tt/this.classifications|0}for(var it=0,nt=l;it<nt;){it++;if(c<=Y)break;var st=this.begin+Y*h,rt=A[Y],at=this.residueBooks[rt][X];if(0<=at){var ot=o[at].decodeDeinterleaveRepeat(t,i,n,Q,q,s,h);if(null==ot)return;Q=ot.cInter,q=ot.pInter}else Q=1&(st+=h),q=st>>>1;++Y}}else if(1==n)for(;Y<c;){var lt=0,ut=this.begin+Y*h;if(0==X){var ht=o[this.classbook];t.validBits<10&&t.prepHuffman();var ct,At=ht.fastHuffman[1023&t.acc];if(0<=At){var dt=ht.codewordLengths[At];t.acc=t.acc>>>dt,t.validBits-=dt,ct=t.validBits<0?(t.validBits=0,-1):At}else ct=t.decodeScalarRaw(ht);ht.sparse&&(ct=ht.sortedValues[ct]);var _t=ct;if(-1==_t)return;for(var ft=l;0<=--ft;)A[ft+Y]=_t%this.classifications,_t=_t/this.classifications|0}for(var gt=0,pt=l;gt<pt;){gt++;if(c<=Y)break;var mt=this.begin+Y*h,vt=this.residueBooks[A[Y]][X];if(0<=vt){var wt=o[vt].decodeDeinterleaveRepeat(t,i,n,lt,ut,s,h);if(null==wt)return;lt=wt.cInter,ut=wt.pInter}else lt=0,ut=mt+=h;++Y}}else for(;Y<c;){var bt=this.begin+Y*h,yt=Mt.toFloat(bt)%Mt.toFloat(n)|0,xt=Mt.toFloat(bt)/Mt.toFloat(n)|0;if(0==X){var Tt=o[this.classbook];t.validBits<10&&t.prepHuffman();var St,Et=Tt.fastHuffman[1023&t.acc];if(0<=Et){var Bt=Tt.codewordLengths[Et];t.acc=t.acc>>>Bt,t.validBits-=Bt,St=t.validBits<0?(t.validBits=0,-1):Et}else St=t.decodeScalarRaw(Tt);Tt.sparse&&(St=Tt.sortedValues[St]);var kt=St;if(-1==kt)return;for(var It=l;0<=--It;)A[It+Y]=kt%this.classifications,kt=kt/this.classifications|0}for(var Ct=0,Lt=l;Ct<Lt;){Ct++;if(c<=Y)break;var Nt=this.begin+Y*h,Ft=this.residueBooks[A[Y]][X];if(0<=Ft){var Pt=o[Ft].decodeDeinterleaveRepeat(t,i,n,yt,xt,s,h);if(null==Pt)return;yt=Pt.cInter,xt=Pt.pInter}else Nt+=h,yt=Mt.toFloat(Nt)%Mt.toFloat(n)|0,xt=Mt.toFloat(Nt)/Mt.toFloat(n)|0;++Y}}}}},__class__:Vt};function Dt(){}(x["kha.audio2.ogg.vorbis.data.Setting"]=Dt).__name__=!0;function Ut(){}(x["kha.compute.ConstantLocation"]=Ut).__name__=!0,Ut.prototype={__class__:Ut};function Ht(){}(x["kha.compute.TextureUnit"]=Ht).__name__=!0,Ht.prototype={__class__:Ht};function Wt(){}(x["kha.graphics1.Graphics"]=Wt).__name__=!0,Wt.__isInterface__=!0,Wt.prototype={begin:null,end:null,setPixel:null,__class__:Wt};var Gt=function(){this.transformations=[new ti(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};(x["kha.graphics2.Graphics"]=Gt).__name__=!0,Gt.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},flush:function(){},clear:function(t){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,n,s,r,a){this.drawScaledSubImage(t,n,s,r,a,e,i,r,a)},drawScaledImage:function(t,e,i,n,s){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,n,s)},drawScaledSubImage:function(t,e,i,n,s,r,a,o,l){},drawRect:function(t,e,i,n,s){null==s&&(s=1)},fillRect:function(t,e,i,n){},drawString:function(t,e,i){},drawCharacters:function(t,e,i,n,s){},drawLine:function(t,e,i,n,s){null==s&&(s=1)},drawVideo:function(t,e,i,n,s){},fillTriangle:function(t,e,i,n,s,r){},get_imageScaleQuality:function(){return 0},set_imageScaleQuality:function(t){return 1},get_mipmapScaleQuality:function(){return 0},set_mipmapScaleQuality:function(t){return 1},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},get_transformation:function(){return this.transformations[this.transformationIndex]},set_transformation:function(t){this.setTransformation(t);var e=this.transformations[this.transformationIndex];return e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,t},pushTransformation:function(t){this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var e=this.transformations[this.transformationIndex];e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(this.transformations[this.transformationIndex])},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},scale:function(t,e){var i=this.transformations[this.transformationIndex],n=this.transformations[this.transformationIndex],s=t*n._00+0*n._01+0*n._02,r=t*n._10+0*n._11+0*n._12,a=t*n._20+0*n._21+0*n._22,o=0*n._00+e*n._01+0*n._02,l=0*n._10+e*n._11+0*n._12,u=0*n._20+e*n._21+0*n._22,h=0*n._00+0*n._01+1*n._02,c=0*n._10+0*n._11+1*n._12,A=0*n._20+0*n._21+1*n._22;i._00=s,i._10=r,i._20=a,i._01=o,i._11=l,i._21=u,i._02=h,i._12=c,i._22=A},translation:function(t,e){var i=this.transformations[this.transformationIndex];return new ti(1*i._00+0*i._01+t*i._02,1*i._10+0*i._11+t*i._12,1*i._20+0*i._21+t*i._22,0*i._00+1*i._01+e*i._02,0*i._10+1*i._11+e*i._12,0*i._20+1*i._21+e*i._22,0*i._00+0*i._01+1*i._02,0*i._10+0*i._11+1*i._12,0*i._20+0*i._21+1*i._22)},translate:function(t,e){var i=this.transformations[this.transformationIndex],n=this.transformations[this.transformationIndex],s=1*n._00+0*n._01+t*n._02,r=1*n._10+0*n._11+t*n._12,a=1*n._20+0*n._21+t*n._22,o=0*n._00+1*n._01+e*n._02,l=0*n._10+1*n._11+e*n._12,u=0*n._20+1*n._21+e*n._22,h=0*n._00+0*n._01+1*n._02,c=0*n._10+0*n._11+1*n._12,A=0*n._20+0*n._21+1*n._22;i._00=s,i._10=r,i._20=a,i._01=o,i._11=l,i._21=u,i._02=h,i._12=c,i._22=A},pushTranslation:function(t,e){var i=this.transformations[this.transformationIndex],n=1*i._00+0*i._01+t*i._02,s=1*i._10+0*i._11+t*i._12,r=1*i._20+0*i._21+t*i._22,a=0*i._00+1*i._01+e*i._02,o=0*i._10+1*i._11+e*i._12,l=0*i._20+1*i._21+e*i._22,u=0*i._00+0*i._01+1*i._02,h=0*i._10+0*i._11+1*i._12,c=0*i._20+0*i._21+1*i._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var A=this.transformations[this.transformationIndex];A._00=n,A._10=s,A._20=r,A._01=a,A._11=o,A._21=l,A._02=u,A._12=h,A._22=c,this.setTransformation(this.transformations[this.transformationIndex])},rotation:function(t,e,i){var n=e,s=i,r=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=1*r+0*o+0*n,h=1*a+0*l+0*n,c=0+1*n,A=0*r+1*o+0*s,d=0*a+1*l+0*s,_=0+1*s,f=0*r+0*o+0,g=0*a+0*l+0,p=-e,m=-i,v=1*u+0*h+0*c,w=0*u+1*h+0*c,b=u*p+h*m+1*c,y=1*A+0*d+0*_,x=0*A+1*d+0*_,T=A*p+d*m+1*_,S=1*f+0*g+0,E=0*f+1*g+0,B=f*p+g*m+1,k=this.transformations[this.transformationIndex];return new ti(v*k._00+w*k._01+b*k._02,v*k._10+w*k._11+b*k._12,v*k._20+w*k._21+b*k._22,y*k._00+x*k._01+T*k._02,y*k._10+x*k._11+T*k._12,y*k._20+x*k._21+T*k._22,S*k._00+E*k._01+B*k._02,S*k._10+E*k._11+B*k._12,S*k._20+E*k._21+B*k._22)},rotate:function(t,e,i){var n=this.transformations[this.transformationIndex],s=e,r=i,a=Math.cos(t),o=-Math.sin(t),l=Math.sin(t),u=Math.cos(t),h=1*a+0*l+0*s,c=1*o+0*u+0*s,A=0+1*s,d=0*a+1*l+0*r,_=0*o+1*u+0*r,f=0+1*r,g=0*a+0*l+0,p=0*o+0*u+0,m=-e,v=-i,w=1*h+0*c+0*A,b=0*h+1*c+0*A,y=h*m+c*v+1*A,x=1*d+0*_+0*f,T=0*d+1*_+0*f,S=d*m+_*v+1*f,E=1*g+0*p+0,B=0*g+1*p+0,k=g*m+p*v+1,I=this.transformations[this.transformationIndex],C=w*I._00+b*I._01+y*I._02,L=w*I._10+b*I._11+y*I._12,N=w*I._20+b*I._21+y*I._22,F=x*I._00+T*I._01+S*I._02,P=x*I._10+T*I._11+S*I._12,M=x*I._20+T*I._21+S*I._22,R=E*I._00+B*I._01+k*I._02,O=E*I._10+B*I._11+k*I._12,V=E*I._20+B*I._21+k*I._22;n._00=C,n._10=L,n._20=N,n._01=F,n._11=P,n._21=M,n._02=R,n._12=O,n._22=V},pushRotation:function(t,e,i){var n=e,s=i,r=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=1*r+0*o+0*n,h=1*a+0*l+0*n,c=0+1*n,A=0*r+1*o+0*s,d=0*a+1*l+0*s,_=0+1*s,f=0*r+0*o+0,g=0*a+0*l+0,p=-e,m=-i,v=1*u+0*h+0*c,w=0*u+1*h+0*c,b=u*p+h*m+1*c,y=1*A+0*d+0*_,x=0*A+1*d+0*_,T=A*p+d*m+1*_,S=1*f+0*g+0,E=0*f+1*g+0,B=f*p+g*m+1,k=this.transformations[this.transformationIndex],I=v*k._00+w*k._01+b*k._02,C=v*k._10+w*k._11+b*k._12,L=v*k._20+w*k._21+b*k._22,N=y*k._00+x*k._01+T*k._02,F=y*k._10+x*k._11+T*k._12,P=y*k._20+x*k._21+T*k._22,M=S*k._00+E*k._01+B*k._02,R=S*k._10+E*k._11+B*k._12,O=S*k._20+E*k._21+B*k._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var V=this.transformations[this.transformationIndex];V._00=I,V._10=C,V._20=L,V._01=N,V._11=F,V._21=P,V._02=M,V._12=R,V._22=O,this.setTransformation(this.transformations[this.transformationIndex])},pushOpacity:function(t){this.setOpacity(t),this.opacities.push(t)},popOpacity:function(){var t=this.opacities.pop();return this.setOpacity(this.get_opacity()),t},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(t){return this.setOpacity(t),this.opacities[this.opacities.length-1]=t},scissor:function(t,e,i,n){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(t){return this.setPipeline(t),this.pipe=t},transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(t){},setOpacity:function(t){},setPipeline:function(t){},__class__:Gt,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline",set_opacity:"set_opacity",get_opacity:"get_opacity",set_transformation:"set_transformation",get_transformation:"get_transformation",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_mipmapScaleQuality:"set_mipmapScaleQuality",get_mipmapScaleQuality:"get_mipmapScaleQuality",set_imageScaleQuality:"set_imageScaleQuality",get_imageScaleQuality:"get_imageScaleQuality"}};var zt=function(t){this.canvas=t};(x["kha.graphics2.Graphics1"]=zt).__name__=!0,zt.__interfaces__=[Wt],zt.prototype={canvas:null,texture:null,pixels:null,begin:function(){null!=this.texture&&this.texture.get_realWidth()==this.canvas.get_width()&&this.texture.get_realHeight()==this.canvas.get_height()||(this.texture=M.create(this.canvas.get_width(),this.canvas.get_height(),0,2)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(t,e,i){this.pixels.setInt32(e*this.texture.get_realWidth()*4+4*t,i)},__class__:zt};var Be=function(){};(x["kha.graphics2.GraphicsExtension"]=Be).__name__=!0,Be.drawArc=function(t,e,i,n,s,r,a,o,l){null==l&&(l=0),null==o&&(o=!1),null==a&&(a=1),s%=2*Math.PI,r%=2*Math.PI,o?s<r&&(r-=2*Math.PI):r<s&&(r+=2*Math.PI),l<=0&&(l=Math.floor(10*Math.sqrt(n)));for(var u=(r-s)/l,h=Math.cos(u),c=Math.sin(u),A=Math.cos(s)*n,d=Math.sin(s)*n,_=0,f=l;_<f;){_++;var g=A+e,p=d+i,m=A;A=h*A-c*d,d=h*d+c*m,t.drawLine(g,p,A+e,d+i,a)}},Be.fillArc=function(t,e,i,n,s,r,a,o){null==o&&(o=0),null==a&&(a=!1),s%=2*Math.PI,r%=2*Math.PI,a?s<r&&(r-=2*Math.PI):r<s&&(r+=2*Math.PI),o<=0&&(o=Math.floor(10*Math.sqrt(n)));for(var l=(r-s)/o,u=Math.cos(l),h=Math.sin(l),c=Math.cos(s)*n,A=Math.sin(s)*n,d=c+e,_=A+i,f=0,g=o;f<g;){f++;var p=c+e,m=A+i,v=c;c=u*c-h*A,A=u*A+h*v,t.fillTriangle(p,m,c+e,A+i,d,_)}},Be.drawCircle=function(t,e,i,n,s,r){null==r&&(r=0),null==s&&(s=1),r<=0&&(r=Math.floor(10*Math.sqrt(n)));for(var a=2*Math.PI/r,o=Math.cos(a),l=Math.sin(a),u=n,h=0,c=0,A=r;c<A;){c++;var d=u+e,_=h+i,f=u;u=o*u-l*h,h=o*h+l*f,t.drawLine(d,_,u+e,h+i,s)}},Be.fillCircle=function(t,e,i,n,s){null==s&&(s=0),s<=0&&(s=Math.floor(10*Math.sqrt(n)));for(var r=2*Math.PI/s,a=Math.cos(r),o=Math.sin(r),l=n,u=0,h=0,c=s;h<c;){h++;var A=l+e,d=u+i,_=l;l=a*l-o*u,u=a*u+o*_,t.fillTriangle(A,d,l+e,u+i,e,i)}},Be.drawPolygon=function(t,e,i,n,s){null==s&&(s=1);for(var r=me.iter(n),a=r.next(),o=a;r.hasNext();){var l=r.next();t.drawLine(o.x+e,o.y+i,l.x+e,l.y+i,s),o=l}t.drawLine(o.x+e,o.y+i,a.x+e,a.y+i,s)},Be.fillPolygon=function(t,e,i,n){var s=me.iter(n);if(s.hasNext()){var r=s.next();if(s.hasNext())for(var a=s.next();s.hasNext();){var o=s.next();t.fillTriangle(r.x+e,r.y+i,a.x+e,a.y+i,o.x+e,o.y+i),a=o}}},Be.drawCubicBezier=function(t,e,i,n,s){var r;null==s&&(s=1),null==n&&(n=20);for(var a,o=Be.calculateCubicBezierPoint(0,e,i),l=1,u=n+1;l<u;){r=l++/n,a=Be.calculateCubicBezierPoint(r,e,i),t.drawLine(o[0],o[1],a[0],a[1],s),o=a}},Be.drawCubicBezierPath=function(t,e,i,n,s){null==s&&(s=1),null==n&&(n=20);for(var r,a=0,o=null,l=null;a<e.length-3;){0==a&&(o=Be.calculateCubicBezierPoint(0,[e[a],e[a+1],e[a+2],e[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]));for(var u=1,h=n+1;u<h;){r=u++/n,l=Be.calculateCubicBezierPoint(r,[e[a],e[a+1],e[a+2],e[a+3]],[i[a],i[a+1],i[a+2],i[a+3]]),t.drawLine(o[0],o[1],l[0],l[1],s),o=l}a+=3}},Be.calculateCubicBezierPoint=function(t,e,i){var n=1-t,s=t*t,r=n*n,a=r*n,o=s*t,l=[a*e[0],a*i[0]];return l[0]+=3*r*t*e[1],l[1]+=3*r*t*i[1],l[0]+=3*n*s*e[2],l[1]+=3*n*s*i[2],l[0]+=o*e[3],l[1]+=o*i[3],l},Be.drawAlignedString=function(t,e,i,n,s,r){var a=0;if(1==s||2==s){var o=t.get_font().width(t.get_fontSize(),e);a=1==s?.5*-o:-o}var l=0;if(1==r||2==r){var u=t.get_font().height(t.get_fontSize());l=1==r?.5*-u:-u}t.drawString(e,i+a,n+l)},Be.drawAlignedCharacters=function(t,e,i,n,s,r,a,o){var l=0;if(1==a||2==a){var u=t.get_font().widthOfCharacters(t.get_fontSize(),e,i,n);l=1==a?.5*-u:-u}var h=0;if(1==o||2==o){var c=t.get_font().height(t.get_fontSize());h=1==o?.5*-c:-c}t.drawCharacters(e,i,n,s+l,r+h)};function Kt(){}(x["kha.graphics2.truetype.VectorOfIntPointer"]=Kt).__name__=!0,Kt.prototype={value:null,__class__:Kt};function Qt(){}(x["kha.graphics2.truetype.Stbtt_temp_rect"]=Qt).__name__=!0,Qt.prototype={x0:null,y0:null,x1:null,y1:null,__class__:Qt};function qt(){}(x["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=qt).__name__=!0,qt.prototype={advanceWidth:null,leftSideBearing:null,__class__:qt};function jt(){}(x["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=jt).__name__=!0,jt.prototype={ascent:null,descent:null,lineGap:null,__class__:jt};function Zt(){}(x["kha.graphics2.truetype.Stbtt_temp_region"]=Zt).__name__=!0,Zt.prototype={width:null,height:null,xoff:null,yoff:null,__class__:Zt};var Jt=function(){};(x["kha.graphics2.truetype.Stbtt_bakedchar"]=Jt).__name__=!0,Jt.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Jt};function $t(){}(x["kha.graphics2.truetype.Stbtt_aligned_quad"]=$t).__name__=!0,$t.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:$t};function te(){}(x["kha.graphics2.truetype.Stbtt_packedchar"]=te).__name__=!0,te.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:te};function ee(){}(x["kha.graphics2.truetype.Stbtt_pack_range"]=ee).__name__=!0,ee.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:ee};function ie(){}(x["kha.graphics2.truetype.Stbtt_pack_context"]=ie).__name__=!0,ie.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:ie};var se=function(){};(x["kha.graphics2.truetype.Stbtt_fontinfo"]=se).__name__=!0,se.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:se};function re(){}(x["kha.graphics2.truetype.Stbtt_vertex"]=re).__name__=!0,re.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:re};function ae(){}(x["kha.graphics2.truetype.Stbtt__bitmap"]=ae).__name__=!0,ae.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:ae};function oe(){}(x["kha.graphics2.truetype.Stbtt__edge"]=oe).__name__=!0,oe.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:oe};function le(){}(x["kha.graphics2.truetype.Stbtt__active_edge"]=le).__name__=!0,le.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:le};function ue(){}(x["kha.graphics2.truetype.Stbtt__point"]=ue).__name__=!0,ue.prototype={x:null,y:null,__class__:ue};var he=function(){};(x["kha.graphics2.truetype.StbTruetype"]=he).__name__=!0,he.STBTT_assert=function(t){if(!t)throw new ne("Error")},he.STBTT_POINT_SIZE=function(t){return-t},he.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},he.ttCHAR=function(t,e){null==e&&(e=0);var i=t.readU8(e);return 128<=i?i-256:i},he.ttUSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e);return t.readU8(e+1)|i<<8},he.ttSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1)|i<<8;return 0!=(32768&n)?n-65536:n},he.ttULONG=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),s=t.readU8(i+1),r=t.readU8(i+2);return t.readU8(i+3)|r<<8|s<<16|n<<24},he.ttLONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),s=t.readU8(e+2);return t.readU8(e+3)|s<<8|n<<16|i<<24},he.ttFixed=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),s=t.readU8(i+1),r=t.readU8(i+2);return t.readU8(i+3)|r<<8|s<<16|n<<24},he.stbtt_tag4=function(t,e,i,n,s,r){return t.readU8(e)==i&&t.readU8(e+1)==n&&t.readU8(e+2)==s&&t.readU8(e+3)==r},he.stbtt_tag=function(t,e,i){var n=me.cca(i,0),s=me.cca(i,1),r=me.cca(i,2),a=me.cca(i,3);return t.readU8(e)==n&&t.readU8(e+1)==s&&t.readU8(e+2)==r&&t.readU8(e+3)==a},he.stbtt__isfont=function(t){var e=me.cca("1",0);if(t.readU8(0)==e&&0==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3))return!0;var i=me.cca("typ1",0),n=me.cca("typ1",1),s=me.cca("typ1",2),r=me.cca("typ1",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==s&&t.readU8(3)==r)return!0;var a=me.cca("OTTO",0),o=me.cca("OTTO",1),l=me.cca("OTTO",2),u=me.cca("OTTO",3);return t.readU8(0)==a&&t.readU8(1)==o&&t.readU8(2)==l&&t.readU8(3)==u||0==t.readU8(0)&&1==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3)},he.stbtt__find_table=function(t,e,i){var n=e+4;null==n&&(n=0);for(var s=t.readU8(n),r=e+12,a=0,o=t.readU8(n+1)|s<<8;a<o;){var l=r+16*a++,u=me.cca(i,0),h=me.cca(i,1),c=me.cca(i,2),A=me.cca(i,3);if(t.readU8(l)==u&&t.readU8(l+1)==h&&t.readU8(l+2)==c&&t.readU8(l+3)==A){var d=l+8;null==d&&(d=0);var _=d;null==_&&(_=0);var f=t.readU8(_),g=t.readU8(_+1),p=t.readU8(_+2);return t.readU8(_+3)|p<<8|g<<16|f<<24}}return 0},he.stbtt_GetFontOffsetForIndex=function(t,e){if(he.stbtt__isfont(t))return 0==e?0:-1;var i=me.cca("ttcf",0),n=me.cca("ttcf",1),s=me.cca("ttcf",2),r=me.cca("ttcf",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==s&&t.readU8(3)==r){var a,o=4;null==o&&(o=0);var l=o;null==l&&(l=0);var u=t.readU8(l),h=t.readU8(l+1),c=t.readU8(l+2);if(65536!=(t.readU8(l+3)|c<<8|h<<16|u<<24)){var A=4;null==A&&(A=0);var d=A;null==d&&(d=0);var _=t.readU8(d),f=t.readU8(d+1),g=t.readU8(d+2);a=131072==(t.readU8(d+3)|g<<8|f<<16|_<<24)}else a=!0;if(a){var p=8;null==p&&(p=0);var m=t.readU8(p),v=t.readU8(p+1),w=t.readU8(p+2);if((t.readU8(p+3)|w<<8|v<<16|m<<24)<=e)return-1;var b=12+4*e;null==b&&(b=0);var y=b;null==y&&(y=0);var x=t.readU8(y),T=t.readU8(y+1),S=t.readU8(y+2);return t.readU8(y+3)|S<<8|T<<16|x<<24}}return-1},he.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var n=he.stbtt__find_table(e,i,"cmap");if(t.loca=he.stbtt__find_table(e,i,"loca"),t.head=he.stbtt__find_table(e,i,"head"),t.glyf=he.stbtt__find_table(e,i,"glyf"),t.hhea=he.stbtt__find_table(e,i,"hhea"),t.hmtx=he.stbtt__find_table(e,i,"hmtx"),t.kern=he.stbtt__find_table(e,i,"kern"),0==n||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var s=he.stbtt__find_table(e,i,"maxp");if(0!=s){var r=s+4;null==r&&(r=0);var a=e.readU8(r),o=e.readU8(r+1);t.numGlyphs=o|a<<8}else t.numGlyphs=65535;var l=n+2;null==l&&(l=0);for(var u=e.readU8(l),h=e.readU8(l+1)|u<<8,c=t.index_map=0,A=h;c<A;){var d=n+4+8*c++,_=d;null==_&&(_=0);var f=e.readU8(_);switch(e.readU8(_+1)|f<<8){case 0:var g=d+4;null==g&&(g=0);var p=g;null==p&&(p=0);var m=e.readU8(p),v=e.readU8(p+1),w=e.readU8(p+2),b=e.readU8(p+3);t.index_map=n+(b|w<<8|v<<16|m<<24);break;case 3:var y=d+2;null==y&&(y=0);var x=e.readU8(y);switch(e.readU8(y+1)|x<<8){case 1:case 10:var T=d+4;null==T&&(T=0);var S=T;null==S&&(S=0);var E=e.readU8(S),B=e.readU8(S+1),k=e.readU8(S+2),I=e.readU8(S+3);t.index_map=n+(I|k<<8|B<<16|E<<24)}}}if(0==t.index_map)return!1;var C=t.head+50;null==C&&(C=0);var L=e.readU8(C),N=e.readU8(C+1);return t.indexToLocFormat=N|L<<8,!0},he.stbtt_FindGlyphIndex=function(t,e){var i=t.data,n=t.index_map,s=n;null==s&&(s=0);var r=i.readU8(s),a=i.readU8(s+1)|r<<8;if(0==a){var o=n+2;null==o&&(o=0);var l=i.readU8(o);if(e<(i.readU8(o+1)|l<<8)-6){var u=n+6+e;return null==u&&(u=0),i.readU8(u)}return 0}if(6==a){var h=n+6;null==h&&(h=0);var c=i.readU8(h),A=i.readU8(h+1)|c<<8,d=n+8;null==d&&(d=0);var _=i.readU8(d),f=i.readU8(d+1);if(A<=e&&e<A+(f|_<<8)){var g=n+10+2*(e-A);null==g&&(g=0);var p=i.readU8(g);return i.readU8(g+1)|p<<8}return 0}if(2==a)throw new ne("Error");if(4==a){var m=n+6;null==m&&(m=0);var v=i.readU8(m),w=(i.readU8(m+1)|v<<8)>>1,b=n+8;null==b&&(b=0);var y=i.readU8(b),x=(i.readU8(b+1)|y<<8)>>1,T=n+10;null==T&&(T=0);var S=i.readU8(T),E=i.readU8(T+1)|S<<8,B=n+12;null==B&&(B=0);var k=i.readU8(B),I=(i.readU8(B+1)|k<<8)>>1,C=n+14,L=C;if(65535<e)return 0;var N=L+2*I;null==N&&(N=0);var F=i.readU8(N);for((i.readU8(N+1)|F<<8)<=e&&(L+=2*I),L-=2;0!=E;){var P=L+2*(x>>=1);null==P&&(P=0);var M=i.readU8(P);(i.readU8(P+1)|M<<8)<e&&(L+=2*x),--E}var R=(L+=2)-C>>1,O=C+2*R;null==O&&(O=0);var V=i.readU8(O);if((i.readU8(O+1)|V<<8)<e)throw new ne("Error");var D=n+14+2*w+2+2*R;null==D&&(D=0);var U=i.readU8(D),H=i.readU8(D+1)|U<<8;if(e<H)return 0;var W=n+14+6*w+2+2*R;null==W&&(W=0);var G=i.readU8(W),z=i.readU8(W+1)|G<<8;if(0==z){var X=n+14+4*w+2+2*R;null==X&&(X=0);var Y=i.readU8(X),K=i.readU8(X+1)|Y<<8;return e+(0!=(32768&K)?K-65536:K)}var Q=z+2*(e-H)+n+14+6*w+2+2*R;null==Q&&(Q=0);var q=i.readU8(Q);return i.readU8(Q+1)|q<<8}if(12!=a&&13!=a)throw new ne("Error");var j=n+12;null==j&&(j=0);var Z=j;null==Z&&(Z=0);for(var J=i.readU8(Z),$=i.readU8(Z+1),tt=i.readU8(Z+2),et=0,it=i.readU8(Z+3)|tt<<8|$<<16|J<<24;et<it;){var nt=et+(it-et>>1),st=n+16+12*nt;null==st&&(st=0);var rt=st;null==rt&&(rt=0);var at=i.readU8(rt),ot=i.readU8(rt+1),lt=i.readU8(rt+2),ut=i.readU8(rt+3)|lt<<8|ot<<16|at<<24,ht=n+16+12*nt+4;null==ht&&(ht=0);var ct=ht;null==ct&&(ct=0);var At=i.readU8(ct),dt=i.readU8(ct+1),_t=i.readU8(ct+2),ft=i.readU8(ct+3);if(e<ut)it=nt;else{if(!((ft|_t<<8|dt<<16|At<<24)<e)){var gt=n+16+12*nt+8;null==gt&&(gt=0);var pt=gt;null==pt&&(pt=0);var mt=i.readU8(pt),vt=i.readU8(pt+1),wt=i.readU8(pt+2),bt=i.readU8(pt+3)|wt<<8|vt<<16|mt<<24;return 12==a?bt+e-ut:bt}et=nt+1}}return 0},he.stbtt_GetCodepointShape=function(t,e){return he.stbtt_GetGlyphShape(t,he.stbtt_FindGlyphIndex(t,e))},he.stbtt_setvertex=function(t,e,i,n,s,r){t.type=e,t.x=i,t.y=n,t.cx=s,t.cy=r},he.stbtt__GetGlyfOffset=function(t,e){var i,n;if(e>=t.numGlyphs)return-1;if(2<=t.indexToLocFormat)return-1;if(0==t.indexToLocFormat){var s=t.glyf,r=t.data,a=t.loca+2*e;null==a&&(a=0);var o=r.readU8(a);i=s+2*(r.readU8(a+1)|o<<8);var l=t.glyf,u=t.data,h=t.loca+2*e+2;null==h&&(h=0);var c=u.readU8(h);n=l+2*(u.readU8(h+1)|c<<8)}else{var A=t.glyf,d=t.data,_=t.loca+4*e;null==_&&(_=0);var f=_;null==f&&(f=0);var g=d.readU8(f),p=d.readU8(f+1),m=d.readU8(f+2);i=A+(d.readU8(f+3)|m<<8|p<<16|g<<24);var v=t.glyf,w=t.data,b=t.loca+4*e+4;null==b&&(b=0);var y=b;null==y&&(y=0);var x=w.readU8(y),T=w.readU8(y+1),S=w.readU8(y+2);n=v+(w.readU8(y+3)|S<<8|T<<16|x<<24)}return i==n?-1:i},he.stbtt_GetGlyphBox=function(t,e,i){var n=he.stbtt__GetGlyfOffset(t,e);if(n<0)return!1;var s=t.data,r=n+2;null==r&&(r=0);var a=s.readU8(r),o=s.readU8(r+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=t.data,u=n+4;null==u&&(u=0);var h=l.readU8(u),c=l.readU8(u+1)|h<<8;i.y0=0!=(32768&c)?c-65536:c;var A=t.data,d=n+6;null==d&&(d=0);var _=A.readU8(d),f=A.readU8(d+1)|_<<8;i.x1=0!=(32768&f)?f-65536:f;var g=t.data,p=n+8;null==p&&(p=0);var m=g.readU8(p),v=g.readU8(p+1)|m<<8;return i.y1=0!=(32768&v)?v-65536:v,!0},he.stbtt_GetCodepointBox=function(t,e,i){return he.stbtt_GetGlyphBox(t,he.stbtt_FindGlyphIndex(t,e),i)},he.stbtt_IsGlyphEmpty=function(t,e){var i=he.stbtt__GetGlyfOffset(t,e);if(i<0)return!0;var n=t.data,s=i;null==s&&(s=0);var r=n.readU8(s),a=n.readU8(s+1)|r<<8;return 0==(0!=(32768&a)?a-65536:a)},he.stbtt__close_shape=function(t,e,i,n,s,r,a,o,l,u){return n?(i&&he.stbtt_setvertex(t[e++],3,l+a>>1,u+o>>1,l,u),he.stbtt_setvertex(t[e++],3,s,r,a,o)):i?he.stbtt_setvertex(t[e++],3,s,r,l,u):he.stbtt_setvertex(t[e++],2,s,r,0,0),e},he.copyVertices=function(t,e,i,n){for(var s=0,r=n;s<r;){var a=s++;e[i+a]=t[a]}},he.stbtt_GetGlyphShape=function(t,e){var i=t.data,n=null,s=0,r=he.stbtt__GetGlyfOffset(t,e);if(r<0)return null;var a=r;null==a&&(a=0);var o=i.readU8(a),l=i.readU8(a+1)|o<<8,u=0!=(32768&l)?l-65536:l;if(0<u){var h,c=0,A=0,d=0,_=!1,f=!1,g=r+10,p=g+2*u;null==p&&(p=0);var m=i.readU8(p),v=g+2*u+2+(i.readU8(p+1)|m<<8),w=g+2*u-2;null==w&&(w=0);var b=i.readU8(w),y=1+(i.readU8(w+1)|b<<8),x=y+2*u;if(null==(n=new Array(x)))return null;for(var T=0,S=n.length;T<S;){n[T++]=new re}var E=d=0;h=x-y;for(var B=0,k=y;B<k;){var I=B++;0==E?0!=(8&(c=i.readU8(v++)))&&(E=i.readU8(v++)):--E,n[h+I].type=c}for(var C=0,L=0,N=y;L<N;){var F=L++;if(0!=(2&(c=n[h+F].type))){var P=i.readU8(v++);C+=0!=(16&c)?P:-P}else if(0==(16&c)){var M=i.readU8(v),R=i.readU8(v+1)|M<<8;C+=0!=(32768&R)?R-65536:R,v+=2}n[h+F].x=C}for(var O=0,V=0,D=y;V<D;){var U=V++;if(0!=(4&(c=n[h+U].type))){var H=i.readU8(v++);O+=0!=(32&c)?H:-H}else if(0==(32&c)){var W=i.readU8(v),G=i.readU8(v+1)|W<<8;O+=0!=(32768&G)?G-65536:G,v+=2}n[h+U].y=O}for(var z=s=0,X=z,Y=X,K=Y,Q=K,q=Q,j=0;j<y;){if(c=n[h+j].type,C=n[h+j].x,O=n[h+j].y,d==j){0!=j&&(s=he.stbtt__close_shape(n,s,_,f,q,Q,X,z,K,Y)),(f=0==(1&c))?(X=C,z=O,0==(1&n[h+j+1].type)?(q=C+n[h+j+1].x>>1,Q=O+n[h+j+1].y>>1):(q=n[h+j+1].x,Q=n[h+j+1].y,++j)):(q=C,Q=O),he.stbtt_setvertex(n[s++],1,q,Q,0,0),_=!1;var Z=g+2*A;null==Z&&(Z=0);var J=i.readU8(Z);d=1+(i.readU8(Z+1)|J<<8),++A}else _=0==(1&c)?(_&&he.stbtt_setvertex(n[s++],3,K+C>>1,Y+O>>1,K,Y),K=C,Y=O,!0):(_?he.stbtt_setvertex(n[s++],3,C,O,K,Y):he.stbtt_setvertex(n[s++],2,C,O,0,0),!1);++j}s=he.stbtt__close_shape(n,s,_,f,q,Q,X,z,K,Y)}else if(-1==u){var $=1,tt=r+10;for(s=0,n=null;0!=$;){var et,it,nt=null,st=1,rt=0,at=0,ot=1,lt=0,ut=0,ht=tt;null==ht&&(ht=0);var ct=i.readU8(ht),At=i.readU8(ht+1)|ct<<8,dt=0!=(32768&At)?At-65536:At,_t=tt+=2;null==_t&&(_t=0);var ft=i.readU8(_t),gt=i.readU8(_t+1)|ft<<8,pt=0!=(32768&gt)?gt-65536:gt;if(tt+=2,0==(2&dt))throw new ne("Error");if(0!=(1&dt)){var mt=tt;null==mt&&(mt=0);var vt=i.readU8(mt),wt=i.readU8(mt+1)|vt<<8;lt=0!=(32768&wt)?wt-65536:wt;var bt=tt+=2;null==bt&&(bt=0);var yt=i.readU8(bt),xt=i.readU8(bt+1)|yt<<8;ut=0!=(32768&xt)?xt-65536:xt,tt+=2}else{var Tt=tt;null==Tt&&(Tt=0);var St=i.readU8(Tt);lt=128<=St?St-256:St;var Et=++tt;null==Et&&(Et=0);var Bt=i.readU8(Et);ut=128<=Bt?Bt-256:Bt,++tt}if(0!=(8&dt)){var kt=tt;null==kt&&(kt=0);var It=i.readU8(kt),Ct=i.readU8(kt+1)|It<<8;st=ot=(0!=(32768&Ct)?Ct-65536:Ct)/16384,tt+=2,rt=at=0}else if(0!=(64&dt)){var Lt=tt;null==Lt&&(Lt=0);var Nt=i.readU8(Lt),Ft=i.readU8(Lt+1)|Nt<<8;st=(0!=(32768&Ft)?Ft-65536:Ft)/16384,rt=at=0;var Pt=tt+=2;null==Pt&&(Pt=0);var Mt=i.readU8(Pt),Rt=i.readU8(Pt+1)|Mt<<8;ot=(0!=(32768&Rt)?Rt-65536:Rt)/16384,tt+=2}else if(0!=(128&dt)){var Ot=tt;null==Ot&&(Ot=0);var Vt=i.readU8(Ot),Dt=i.readU8(Ot+1)|Vt<<8;st=(0!=(32768&Dt)?Dt-65536:Dt)/16384;var Ut=tt+=2;null==Ut&&(Ut=0);var Ht=i.readU8(Ut),Wt=i.readU8(Ut+1)|Ht<<8;rt=(0!=(32768&Wt)?Wt-65536:Wt)/16384;var Gt=tt+=2;null==Gt&&(Gt=0);var zt=i.readU8(Gt),Xt=i.readU8(Gt+1)|zt<<8;at=(0!=(32768&Xt)?Xt-65536:Xt)/16384;var Yt=tt+=2;null==Yt&&(Yt=0);var Kt=i.readU8(Yt),Qt=i.readU8(Yt+1)|Kt<<8;ot=(0!=(32768&Qt)?Qt-65536:Qt)/16384,tt+=2}var qt=Math.sqrt(st*st+rt*rt),jt=Math.sqrt(at*at+ot*ot);if(0<(et=null==(it=he.stbtt_GetGlyphShape(t,pt))?0:it.length)){for(var Zt=0,Jt=et;Zt<Jt;){var $t=it[Zt++],te=$t.x,ee=$t.y;$t.x=qt*(st*te+at*ee+lt)|0,$t.y=jt*(rt*te+ot*ee+ut)|0,te=$t.cx,ee=$t.cy,$t.cx=qt*(st*te+at*ee+lt)|0,$t.cy=jt*(rt*te+ot*ee+ut)|0}if(null==(nt=new Array(s+et)))return null;0<s&&he.copyVertices(n,nt,0,s),he.copyVertices(it,nt,s,et),n=nt,s+=et}$=32&dt}}else if(u<0)throw new ne("Error");if(null==n)return null;if(n.length<s)throw new ne("Error");if(s<n.length){var ie=new Array(s);return he.copyVertices(n,ie,0,s),ie}return n},he.stbtt_GetGlyphHMetrics=function(t,e){var i=t.data,n=t.hhea+34;null==n&&(n=0);var s=i.readU8(n),r=i.readU8(n+1)|s<<8,a=new qt;if(e<r){var o=t.data,l=t.hmtx+4*e;null==l&&(l=0);var u=o.readU8(l),h=o.readU8(l+1)|u<<8;a.advanceWidth=0!=(32768&h)?h-65536:h;var c=t.data,A=t.hmtx+4*e+2;null==A&&(A=0);var d=c.readU8(A),_=c.readU8(A+1)|d<<8;a.leftSideBearing=0!=(32768&_)?_-65536:_}else{var f=t.data,g=t.hmtx+4*(r-1);null==g&&(g=0);var p=f.readU8(g),m=f.readU8(g+1)|p<<8;a.advanceWidth=0!=(32768&m)?m-65536:m;var v=t.data,w=t.hmtx+4*r+2*(e-r);null==w&&(w=0);var b=v.readU8(w),y=v.readU8(w+1)|b<<8;a.leftSideBearing=0!=(32768&y)?y-65536:y}return a},he.stbtt_GetGlyphKernAdvance=function(t,e,i){var n,s,r=t.kern,a=t.data;if(0==t.kern)return 0;var o=r+2;null==o&&(o=0);var l=a.readU8(o);if((a.readU8(o+1)|l<<8)<1)return 0;var u=r+8;null==u&&(u=0);var h=a.readU8(u);if(1!=(a.readU8(u+1)|h<<8))return 0;var c=0,A=r+10;null==A&&(A=0);for(var d=a.readU8(A),_=(a.readU8(A+1)|d<<8)-1,f=e<<16|i;c<=_;){var g=r+18+6*(s=c+_>>1);null==g&&(g=0);var p=g;null==p&&(p=0);var m=a.readU8(p),v=a.readU8(p+1),w=a.readU8(p+2);if(f<(n=a.readU8(p+3)|w<<8|v<<16|m<<24))_=s-1;else{if(!(n<f)){var b=r+22+6*s;null==b&&(b=0);var y=a.readU8(b),x=a.readU8(b+1)|y<<8;return 0!=(32768&x)?x-65536:x}c=1+s}}return 0},he.stbtt_GetCodepointKernAdvance=function(t,e,i){return 0==t.kern?0:he.stbtt_GetGlyphKernAdvance(t,he.stbtt_FindGlyphIndex(t,e),he.stbtt_FindGlyphIndex(t,i))},he.stbtt_GetCodepointHMetrics=function(t,e){return he.stbtt_GetGlyphHMetrics(t,he.stbtt_FindGlyphIndex(t,e))},he.stbtt_GetFontVMetrics=function(t){var e=new jt,i=t.data,n=t.hhea+4;null==n&&(n=0);var s=i.readU8(n),r=i.readU8(n+1)|s<<8;e.ascent=0!=(32768&r)?r-65536:r;var a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.descent=0!=(32768&u)?u-65536:u;var h=t.data,c=t.hhea+8;null==c&&(c=0);var A=h.readU8(c),d=h.readU8(c+1)|A<<8;return e.lineGap=0!=(32768&d)?d-65536:d,e},he.stbtt_GetFontBoundingBox=function(t){var e=new Qt,i=t.data,n=t.head+36;null==n&&(n=0);var s=i.readU8(n),r=i.readU8(n+1)|s<<8;e.x0=0!=(32768&r)?r-65536:r;var a=t.data,o=t.head+38;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.y0=0!=(32768&u)?u-65536:u;var h=t.data,c=t.head+40;null==c&&(c=0);var A=h.readU8(c),d=h.readU8(c+1)|A<<8;e.x1=0!=(32768&d)?d-65536:d;var _=t.data,f=t.head+42;null==f&&(f=0);var g=_.readU8(f),p=_.readU8(f+1)|g<<8;return e.y1=0!=(32768&p)?p-65536:p,e},he.stbtt_ScaleForPixelHeight=function(t,e){var i=t.data,n=t.hhea+4;null==n&&(n=0);var s=i.readU8(n),r=i.readU8(n+1)|s<<8,a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;return e/((0!=(32768&r)?r-65536:r)-(0!=(32768&u)?u-65536:u))},he.stbtt_ScaleForMappingEmToPixels=function(t,e){var i=t.data,n=t.head+18;null==n&&(n=0);var s=i.readU8(n);return e/(i.readU8(n+1)|s<<8)},he.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,n,s,r){var a=new Qt;if(he.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,u=a.y0,h=a.y1;a.x0=Math.floor(o*i+s),a.y0=Math.floor(-h*n+r),a.x1=Math.ceil(l*i+s),a.y1=Math.ceil(-u*n+r)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},he.stbtt_GetGlyphBitmapBox=function(t,e,i,n){return he.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,n,0,0)},he.stbtt_GetCodepointBitmapBoxSubpixel=function(t,e,i,n,s,r){return he.stbtt_GetGlyphBitmapBoxSubpixel(t,he.stbtt_FindGlyphIndex(t,e),i,n,s,r)},he.stbtt_GetCodepointBitmapBox=function(t,e,i,n){return he.stbtt_GetCodepointBitmapBoxSubpixel(t,e,i,n,0,0)},he.stbtt__new_active=function(t,e,i,n){var s=new le,r=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==s||(s.fdx=r,s.fdy=0!=r?1/r:0,s.fx=t[e].x0+r*(n-t[e].y0),s.fx-=i,s.direction=t[e].invert?1:-1,s.sy=t[e].y0,s.ey=t[e].y1,s.next=null),s},he.stbtt__handle_clipped_edge=function(t,e,i,n,s,r,a,o){if(r!=o){if(!(r<o))throw new ne("Error");if(!(n.sy<=n.ey))throw new ne("Error");if(!(r>n.ey||o<n.sy)){if(r<n.sy&&(s+=(a-s)*(n.sy-r)/(o-r),r=n.sy),o>n.ey&&(a+=(a-s)*(n.ey-o)/(o-r),o=n.ey),s==i){if(!(a<=i+1))throw new ne("Error")}else if(s==i+1){if(!(i<=a))throw new ne("Error")}else if(s<=i){if(!(a<=i))throw new ne("Error")}else if(i+1<=s){if(!(i+1<=a))throw new ne("Error")}else if(!(i<=a&&a<=i+1))throw new ne("Error");if(s<=i&&a<=i){var l=e+i;t[l]=t[l]+n.direction*(o-r)}else if(!(i+1<=s&&i+1<=a)){if(!(i<=s&&s<=i+1&&i<=a&&a<=i+1))throw new ne("Error");var u=e+i;t[u]=t[u]+n.direction*(o-r)*(1-(s-i+(a-i))/2)}}}},he.stbtt__fill_active_edges_new=function(t,e,i,n,s,r){for(var a=r+1;null!=s;){if(!(s.ey>=r))throw new ne("Error");if(0==s.fdx){var o=s.fx;o<n&&(0<=o?(he.stbtt__handle_clipped_edge(t,0,0|o,s,o,r,o,a),he.stbtt__handle_clipped_edge(e,i-1,o+1|0,s,o,r,o,a)):he.stbtt__handle_clipped_edge(e,i-1,0,s,o,r,o,a))}else{var l,u,h,c,A=s.fx,d=s.fdx,_=A+d,f=s.fdy;if(!(s.sy<=a&&s.ey>=r))throw new ne("Error");if(h=s.sy>r?(l=A+d*(s.sy-r),s.sy):(l=A,r),c=s.ey<a?(u=A+d*(s.ey-r),s.ey):(u=_,a),0<=l&&0<=u&&l<n&&u<n)if((0|l)==(0|u)){var g=0|l,p=c-h;if(!(0<=g&&g<n))throw new ne("Error");t[g]=t[g]+s.direction*(1-(l-g+(u-g))/2)*p;var m=i+g;e[m]=e[m]+s.direction*p}else{if(u<l){var v=h=a-(h-r);h=c=a-(c-r),c=v,v=u,u=l,l=v,d=-d,f=-f,v=A,A=_,_=v}var w=0|l,b=0|u,y=(1+w-A)*f+r,x=s.direction,T=x*(y-h);t[w]=t[w]+T*(1-(l-w+(1+w-w))/2);for(var S=x*f,E=1+w,B=b;E<B;){var k=E++;t[k]=t[k]+(T+S/2),T+=S}if(y+=f*(b-(1+w)),!(Math.abs(T)<=1.01))throw new ne("Error");t[b]=t[b]+(T+x*(1-(b-b+(u-b))/2)*(c-y));var I=i+b;e[I]=e[I]+x*(c-h)}else for(var C=0,L=n;C<L;){var N=C++,F=r,P=N,M=1+N,R=_,O=a,V=(N-A)/d+r,D=(1+N-A)/d+r;A<P&&M<R?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,P,V),he.stbtt__handle_clipped_edge(t,0,N,s,P,V,M,D),he.stbtt__handle_clipped_edge(t,0,N,s,M,D,R,O)):R<P&&M<A?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,M,D),he.stbtt__handle_clipped_edge(t,0,N,s,M,D,P,V),he.stbtt__handle_clipped_edge(t,0,N,s,P,V,R,O)):A<P&&P<R?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,P,V),he.stbtt__handle_clipped_edge(t,0,N,s,P,V,R,O)):R<P&&P<A?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,P,V),he.stbtt__handle_clipped_edge(t,0,N,s,P,V,R,O)):A<M&&M<R?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,M,D),he.stbtt__handle_clipped_edge(t,0,N,s,M,D,R,O)):R<M&&M<A?(he.stbtt__handle_clipped_edge(t,0,N,s,A,F,M,D),he.stbtt__handle_clipped_edge(t,0,N,s,M,D,R,O)):he.stbtt__handle_clipped_edge(t,0,N,s,A,F,R,O)}}s=s.next}},he.stbtt__rasterize_sorted_edges=function(t,e,i,n,s,r){var a,o,l=null,u=0,h=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var c=a;o=t.w;var A=r;for(e[h+i].y0=r+t.h+1;u<t.h;){for(var d=A+0,_=A+1,f=l,g=null,p=0,m=t.w;p<m;){a[p++]=0}for(var v=0,w=t.w+1;v<w;){c[o+v++]=0}for(;null!=f;){var b=f;if(b.ey<=d){if(f=(null==g?l=b.next:g.next=b.next,b.next),0==b.direction)throw new ne("Error");b.direction=0}else f=(g=f).next}for(;e[h].y0<=_;){if(e[h].y0!=e[h].y1){var y=he.stbtt__new_active(e,h,s,d);if(!(y.ey>=d))throw new ne("Error");y.next=l,l=y}++h}null!=l&&he.stbtt__fill_active_edges_new(a,c,o+1,t.w,l,d);for(var x=0,T=0,S=t.w;T<S;){var E=T++;x+=c[o+E];var B=a[E]+x,k=0|(B=255*Math.abs(B)+.5);255<k&&(k=255),t.pixels.writeU8(t.pixels_offset+u*t.stride+E,k)}for(g=null,f=l;null!=f;){f.fx+=f.fdx,f=(g=f).next}++A,++u}},he.STBTT__COMPARE=function(t,e){return t.y0<e.y0},he.stbtt__sort_edges_ins_sort=function(t,e){for(var i,n=1,s=e;n<s;){var r=n++,a=t[r],o=a;for(i=r;0<i;){var l=t[i-1];if(!he.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}r!=i&&(t[i]=a)}},he.stbtt__sort_edges_quicksort=function(t,e,i){for(;12<i;){var n,s=i>>1,r=he.STBTT__COMPARE(t[e],t[e+s]),a=he.STBTT__COMPARE(t[e+s],t[e+i-1]);if(r!=a){var o=he.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;n=t[e+o],t[e+o]=t[e+s],t[e+s]=n}n=t[e],t[e]=t[e+s],t[e+s]=n;for(var l=1,u=i-1;;){for(;he.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;he.STBTT__COMPARE(t[e],t[e+u]);)--u;if(u<=l)break;n=t[e+l],t[e+l]=t[e+u],t[e+u]=n,++l,--u}u<i-l?(he.stbtt__sort_edges_quicksort(t,e,u),e+=l,i-=l):(he.stbtt__sort_edges_quicksort(t,e+l,i-l),i=u)}},he.stbtt__sort_edges=function(t,e){he.stbtt__sort_edges_quicksort(t,0,e),he.stbtt__sort_edges_ins_sort(t,e)},he.stbtt__rasterize=function(t,e,i,n,s,r,a,o,l,u,h){for(var c,A=h?-r:r,d=0,_=0,f=n;_<f;){d+=i[_++]}var g=new Array(d+1);if(null!=g){for(var p=0,m=g.length;p<m;){g[p++]=new oe}for(var v=d=0,w=0,b=n;w<b;){var y=w++,x=e,T=0+v;v+=i[y],c=i[y]-1;for(var S=0,E=i[y];S<E;){var B=S++,k=B,I=c;x[T+c].y!=x[T+B].y?(g[d].invert=!1,(h?x[T+c].y>x[T+B].y:x[T+c].y<x[T+B].y)&&(g[d].invert=!0,k=c,I=B),g[d].x0=x[T+k].x*s+a,g[d].y0=1*(x[T+k].y*A+o),g[d].x1=x[T+I].x*s+a,g[d].y1=1*(x[T+I].y*A+o),++d,c=B):c=B}}he.stbtt__sort_edges(g,d),he.stbtt__rasterize_sorted_edges(t,g,d,1,l,u)}},he.stbtt__add_point=function(t,e,i,n){null!=t&&(t[e].x=i,t[e].y=n)},he.stbtt__tesselate_curve=function(t,e,i,n,s,r,a,o,l,u){var h=(i+2*s+a)/4,c=(n+2*r+o)/4,A=(i+a)/2-h,d=(n+o)/2-c;return 16<u||(l<A*A+d*d?(he.stbtt__tesselate_curve(t,e,i,n,(i+s)/2,(n+r)/2,h,c,l,u+1),he.stbtt__tesselate_curve(t,e,h,c,(s+a)/2,(r+o)/2,a,o,l,u+1)):(he.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},he.stbtt_FlattenCurves=function(t,e,i,n,s){for(var r=null,a=0,o=i*i,l=0,u=0,h=0,c=e;h<c;){1==t[h++].type&&++l}if(0==(s.value=l))return null;var A=new Array(l);if(n.value=A,null==n.value)return s.value=0,null;for(var d=0;d<2;){var _=0,f=0;if(1==d++){if(null==(r=new Array(a)))return n.value=null,s.value=0,null;for(var g=0,p=r.length;g<p;){r[g++]=new ue}}l=-1;for(var m=a=0,v=e;m<v;){var w=m++;switch(t[w].type){case 1:0<=l&&(n.value[l]=a-u),++l,u=a,_=t[w].x,f=t[w].y,he.stbtt__add_point(r,a++,_,f);break;case 2:_=t[w].x,f=t[w].y,he.stbtt__add_point(r,a++,_,f);break;case 3:var b={value:a};he.stbtt__tesselate_curve(r,b,_,f,t[w].cx,t[w].cy,t[w].x,t[w].y,o,0),a=b.value,_=t[w].x,f=t[w].y}}n.value[l]=a-u}return r},he.stbtt_Rasterize=function(t,e,i,n,s,r,a,o,l,u,h){var c,A=r<s?r:s,d=0,_={value:d},f=new Kt,g=he.stbtt_FlattenCurves(i,n,e/A,f,_);d=_.value,c=f.value,null!=g&&he.stbtt__rasterize(t,g,c,d,s,r,a,o,l,u,h)},he.stbtt_GetGlyphBitmapSubpixel=function(t,e,i,n,s,r,a){var o=new ae,l=he.stbtt_GetGlyphShape(t,r),u=l.length;if(0==e&&(e=i),0==i){if(0==e)return null;i=e}var h=he.stbtt_GetGlyphBitmapBoxSubpixel(t,r,e,i,n,s),c=h.x0,A=h.y0,d=h.x1,_=h.y1;return o.w=d-c,o.h=_-A,o.pixels=null,a.width=o.w,a.height=o.h,a.xoff=c,a.yoff=A,0!=o.w&&0!=o.h&&(o.pixels=Ze.alloc(o.w*o.h),null!=o.pixels&&(o.stride=o.w,he.stbtt_Rasterize(o,.35,l,u,e,i,n,s,c,A,!0))),o.pixels},he.stbtt_GetGlyphBitmap=function(t,e,i,n,s){return he.stbtt_GetGlyphBitmapSubpixel(t,e,i,0,0,n,s)},he.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,n,s,r,a,o,l,u,h){var c,A,d=he.stbtt_GetGlyphShape(t,h),_=null==d?0:d.length,f=new ae,g=he.stbtt_GetGlyphBitmapBoxSubpixel(t,h,a,o,l,u);c=g.x0,A=g.y0,f.pixels=e,f.pixels_offset=i,f.w=n,f.h=s,f.stride=r,0!=f.w&&0!=f.h&&he.stbtt_Rasterize(f,.35,d,_,a,o,l,u,c,A,!0)},he.stbtt_MakeGlyphBitmap=function(t,e,i,n,s,r,a,o,l){he.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,s,r,a,o,0,0,l)},he.stbtt_GetCodepointBitmapSubpixel=function(t,e,i,n,s,r,a){return he.stbtt_GetGlyphBitmapSubpixel(t,e,i,n,s,he.stbtt_FindGlyphIndex(t,r),a)},he.stbtt_MakeCodepointBitmapSubpixel=function(t,e,i,n,s,r,a,o,l,u,h){he.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,s,r,a,o,l,u,he.stbtt_FindGlyphIndex(t,h))},he.stbtt_GetCodepointBitmap=function(t,e,i,n,s){return he.stbtt_GetCodepointBitmapSubpixel(t,e,i,0,0,n,s)},he.stbtt_MakeCodepointBitmap=function(t,e,i,n,s,r,a,o,l){he.stbtt_MakeCodepointBitmapSubpixel(t,e,i,n,s,r,a,o,0,0,l)},he.stbtt_BakeFontBitmap=function(t,e,i,n,s,r,a,o){var l=new se;if(!he.stbtt_InitFont(l,t,e))return-1;for(var u=1,h=u,c=1,A=he.stbtt_ScaleForPixelHeight(l,i),d=0,_=0;_<a.length;){var f=a[_];++_;var g=he.stbtt_FindGlyphIndex(l,f),p=he.stbtt_GetGlyphHMetrics(l,g),m=p.advanceWidth,v=(p.leftSideBearing,he.stbtt_GetGlyphBitmapBox(l,g,A,A)),w=v.x0,b=v.y0,y=v.x1-w,x=v.y1-b;if(s<=h+y+1&&(u=c,h=1),r<=u+x+1)return-d;if(s<=h+y)throw new ne("Error");if(r<=u+x)throw new ne("Error");o[d].x0=h,o[d].y0=u,o[d].x1=h+y,o[d].y1=u+x,o[d].xadvance=A*m,o[d].xoff=w,o[d].yoff=b,h=h+y+1,c<u+x+1&&(c=u+x+1),++d}for(var T,S=0,E=s*r;S<E;){var B=S++;n.writeU8(B,0)}for(var k=d=0;k<a.length;){var I=a[k];++k;var C=he.stbtt_FindGlyphIndex(l,I);T=o[d],he.stbtt_MakeGlyphBitmap(l,n,T.x0+T.y0*s,T.x1-T.x0,T.y1-T.y0,s,A,A,C),++d}return c},he.stbtt_GetBakedQuad=function(t,e,i,n,s,r,a,o){var l=o?0:-.5,u=1/e,h=1/i,c=t[n],A=Math.floor(s.value+c.xoff+.5),d=Math.floor(r.value+c.yoff+.5);a.x0=A+l,a.y0=d+l,a.x1=A+c.x1-c.x0+l,a.y1=d+c.y1-c.y0+l,a.s0=c.x0*u,a.t0=c.y0*h,a.s1=c.x1*u,a.t1=c.y1*h,s.value+=c.xadvance};function ce(){}(x["kha.graphics4.ConstantLocation"]=ce).__name__=!0,ce.__isInterface__=!0;function Ae(t){this.texture_=t}(x["kha.graphics4.CubeMap"]=Ae).__name__=!0,Ae.__interfaces__=[P,v],Ae.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 3:return 4;case 4:return 1;default:return 0}},Ae.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},Ae.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},Ae.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;default:return 1}},Ae.createRenderTarget=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var s=new Ae(null);return s.format=e,s.renderTarget_=Krom.createRenderTargetCubeMap(t,Ae.getDepthBufferBits(i),Ae.getRenderTargetFormat(e),Ae.getStencilBufferBits(i),n),s},Ae.prototype={texture_:null,renderTarget_:null,format:null,graphics4:null,unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new Je(this)),this.graphics4},__class__:Ae,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_g1:"get_g1",get_height:"get_height",get_width:"get_width"}};var de=function(t,e){null!=t&&(this.shader=Krom.createFragmentShader(t[0].bytes.b.bufferValue,e[0]))};(x["kha.graphics4.FragmentShader"]=de).__name__=!0,de.fromSource=function(t){var e=new de(null,null);return e.shader=Krom.createFragmentShaderFromSource(t),e},de.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:de};function _e(t,e){this.shader=Krom.createGeometryShader(t[0].bytes.b.bufferValue,e[0])}(x["kha.graphics4.GeometryShader"]=_e).__name__=!0,_e.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:_e};function fe(){}(x["kha.graphics4.Graphics"]=fe).__name__=!0,fe.__isInterface__=!0,fe.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setTextureCompareMode:null,setCubeMapCompareMode:null,setCubeMap:null,setCubeMapDepth:null,setStencilReferenceValue:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setInt2:null,setInt3:null,setInt4:null,setInts:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:fe};function ge(t){this.pipeline=t;try{this.projectionLocation=t.getConstantLocation("projectionMatrix")}catch(t){L.trace(t instanceof ne?t.val:t,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:39,className:"kha.graphics4.PipelineCache",methodName:"new"})}try{this.textureLocation=t.getTextureUnit("tex")}catch(t){L.trace(t instanceof ne?t.val:t,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:40,className:"kha.graphics4.PipelineCache",methodName:"new"})}}(x["kha.graphics4.PipelineCache"]=ge).__name__=!0,ge.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:ge};var ke=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,ke.bufferIndex=0,ke.initShaders(),this.myPipeline=ke.standardImagePipeline,this.initBuffers()};(x["kha.graphics4.ImageShaderPainter"]=ke).__name__=!0,ke.initShaders=function(){if(null==ke.structure&&(ke.structure=Le.createImageVertexStructure()),null==ke.standardImagePipeline){var t=Le.createImagePipeline(ke.structure);t.compile(),ke.standardImagePipeline=new ge(t)}},ke.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:ke.standardImagePipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==ke.rectVertexBuffer){ke.rectVertexBuffer=new De(6e3,ke.structure,1),ke.rectVertices=ke.rectVertexBuffer.lock(),ke.indexBuffer=new Ne(9e3,0);for(var t=ke.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}ke.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,s,r,a,o){var l=9*ke.bufferIndex*4;ke.rectVertices[l]=t,ke.rectVertices[1+l]=e,ke.rectVertices[2+l]=-5,ke.rectVertices[9+l]=i,ke.rectVertices[10+l]=n,ke.rectVertices[11+l]=-5,ke.rectVertices[18+l]=s,ke.rectVertices[19+l]=r,ke.rectVertices[20+l]=-5,ke.rectVertices[27+l]=a,ke.rectVertices[28+l]=o,ke.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var s=9*ke.bufferIndex*4;ke.rectVertices[3+s]=t,ke.rectVertices[4+s]=n,ke.rectVertices[12+s]=t,ke.rectVertices[13+s]=e,ke.rectVertices[21+s]=i,ke.rectVertices[22+s]=e,ke.rectVertices[30+s]=i,ke.rectVertices[31+s]=n},setRectColor:function(t,e,i,n){var s=9*ke.bufferIndex*4;ke.rectVertices[5+s]=t,ke.rectVertices[6+s]=e,ke.rectVertices[7+s]=i,ke.rectVertices[8+s]=n,ke.rectVertices[14+s]=t,ke.rectVertices[15+s]=e,ke.rectVertices[16+s]=i,ke.rectVertices[17+s]=n,ke.rectVertices[23+s]=t,ke.rectVertices[24+s]=e,ke.rectVertices[25+s]=i,ke.rectVertices[26+s]=n,ke.rectVertices[32+s]=t,ke.rectVertices[33+s]=e,ke.rectVertices[34+s]=i,ke.rectVertices[35+s]=n},drawBuffer:function(){ke.rectVertexBuffer.unlock(4*ke.bufferIndex),this.g.setVertexBuffer(ke.rectVertexBuffer),this.g.setIndexBuffer(ke.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,ke.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*ke.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),ke.bufferIndex=0,ke.rectVertices=ke.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setBilinearMipmapFilter:function(t){this.end(),this.bilinearMipmaps=t},drawImage:function(t,e,i,n,s,r,a,o,l,u,h){var c=t;(1500<=ke.bufferIndex+1||null!=ke.lastTexture&&c!=ke.lastTexture)&&this.drawBuffer();var A=.00392156862745098*((16711680&h)>>>16),d=.00392156862745098*((65280&h)>>>8),_=.00392156862745098*(255&h),f=.00392156862745098*(h>>>24)*u,g=9*ke.bufferIndex*4;ke.rectVertices[5+g]=A,ke.rectVertices[6+g]=d,ke.rectVertices[7+g]=_,ke.rectVertices[8+g]=f,ke.rectVertices[14+g]=A,ke.rectVertices[15+g]=d,ke.rectVertices[16+g]=_,ke.rectVertices[17+g]=f,ke.rectVertices[23+g]=A,ke.rectVertices[24+g]=d,ke.rectVertices[25+g]=_,ke.rectVertices[26+g]=f,ke.rectVertices[32+g]=A,ke.rectVertices[33+g]=d,ke.rectVertices[34+g]=_,ke.rectVertices[35+g]=f;var p=c.get_width()/c.get_realWidth(),m=c.get_height()/c.get_realHeight(),v=9*ke.bufferIndex*4;ke.rectVertices[3+v]=0,ke.rectVertices[4+v]=m,ke.rectVertices[12+v]=0,ke.rectVertices[13+v]=0,ke.rectVertices[21+v]=p,ke.rectVertices[22+v]=0,ke.rectVertices[30+v]=p,ke.rectVertices[31+v]=m;var w=9*ke.bufferIndex*4;ke.rectVertices[w]=e,ke.rectVertices[1+w]=i,ke.rectVertices[2+w]=-5,ke.rectVertices[9+w]=n,ke.rectVertices[10+w]=s,ke.rectVertices[11+w]=-5,ke.rectVertices[18+w]=r,ke.rectVertices[19+w]=a,ke.rectVertices[20+w]=-5,ke.rectVertices[27+w]=o,ke.rectVertices[28+w]=l,ke.rectVertices[29+w]=-5,++ke.bufferIndex,ke.lastTexture=c},drawImage2:function(t,e,i,n,s,r,a,o,l,u,h,c,A,d,_){var f=t;(1500<=ke.bufferIndex+1||null!=ke.lastTexture&&f!=ke.lastTexture)&&this.drawBuffer();var g=e/f.get_realWidth(),p=i/f.get_realHeight(),m=(e+n)/f.get_realWidth(),v=(i+s)/f.get_realHeight(),w=9*ke.bufferIndex*4;ke.rectVertices[3+w]=g,ke.rectVertices[4+w]=v,ke.rectVertices[12+w]=g,ke.rectVertices[13+w]=p,ke.rectVertices[21+w]=m,ke.rectVertices[22+w]=p,ke.rectVertices[30+w]=m,ke.rectVertices[31+w]=v;var b=.00392156862745098*((16711680&_)>>>16),y=.00392156862745098*((65280&_)>>>8),x=.00392156862745098*(255&_),T=.00392156862745098*(_>>>24)*d,S=9*ke.bufferIndex*4;ke.rectVertices[5+S]=b,ke.rectVertices[6+S]=y,ke.rectVertices[7+S]=x,ke.rectVertices[8+S]=T,ke.rectVertices[14+S]=b,ke.rectVertices[15+S]=y,ke.rectVertices[16+S]=x,ke.rectVertices[17+S]=T,ke.rectVertices[23+S]=b,ke.rectVertices[24+S]=y,ke.rectVertices[25+S]=x,ke.rectVertices[26+S]=T,ke.rectVertices[32+S]=b,ke.rectVertices[33+S]=y,ke.rectVertices[34+S]=x,ke.rectVertices[35+S]=T;var E=9*ke.bufferIndex*4;ke.rectVertices[E]=r,ke.rectVertices[1+E]=a,ke.rectVertices[2+E]=-5,ke.rectVertices[9+E]=o,ke.rectVertices[10+E]=l,ke.rectVertices[11+E]=-5,ke.rectVertices[18+E]=u,ke.rectVertices[19+E]=h,ke.rectVertices[20+E]=-5,ke.rectVertices[27+E]=c,ke.rectVertices[28+E]=A,ke.rectVertices[29+E]=-5,++ke.bufferIndex,ke.lastTexture=f},drawImageScale:function(t,e,i,n,s,r,a,o,l,u,h){var c=t;(1500<=ke.bufferIndex+1||null!=ke.lastTexture&&c!=ke.lastTexture)&&this.drawBuffer();var A=e/c.get_realWidth(),d=i/c.get_realHeight(),_=(e+n)/c.get_realWidth(),f=(i+s)/c.get_realHeight(),g=9*ke.bufferIndex*4;ke.rectVertices[3+g]=A,ke.rectVertices[4+g]=f,ke.rectVertices[12+g]=A,ke.rectVertices[13+g]=d,ke.rectVertices[21+g]=_,ke.rectVertices[22+g]=d,ke.rectVertices[30+g]=_,ke.rectVertices[31+g]=f;var p=.00392156862745098*((16711680&h)>>>16),m=.00392156862745098*((65280&h)>>>8),v=.00392156862745098*(255&h),w=9*ke.bufferIndex*4;ke.rectVertices[5+w]=p,ke.rectVertices[6+w]=m,ke.rectVertices[7+w]=v,ke.rectVertices[8+w]=u,ke.rectVertices[14+w]=p,ke.rectVertices[15+w]=m,ke.rectVertices[16+w]=v,ke.rectVertices[17+w]=u,ke.rectVertices[23+w]=p,ke.rectVertices[24+w]=m,ke.rectVertices[25+w]=v,ke.rectVertices[26+w]=u,ke.rectVertices[32+w]=p,ke.rectVertices[33+w]=m,ke.rectVertices[34+w]=v,ke.rectVertices[35+w]=u;var b=9*ke.bufferIndex*4;ke.rectVertices[b]=r,ke.rectVertices[1+b]=l,ke.rectVertices[2+b]=-5,ke.rectVertices[9+b]=r,ke.rectVertices[10+b]=a,ke.rectVertices[11+b]=-5,ke.rectVertices[18+b]=o,ke.rectVertices[19+b]=a,ke.rectVertices[20+b]=-5,ke.rectVertices[27+b]=o,ke.rectVertices[28+b]=l,ke.rectVertices[29+b]=-5,++ke.bufferIndex,ke.lastTexture=c},end:function(){0<ke.bufferIndex&&this.drawBuffer(),ke.lastTexture=null},__class__:ke,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ie=function(t){this.myPipeline=null,this.g=t,Ie.bufferIndex=0,Ie.triangleBufferIndex=0,Ie.initShaders(),this.myPipeline=Ie.standardColorPipeline,this.initBuffers()};(x["kha.graphics4.ColoredShaderPainter"]=Ie).__name__=!0,Ie.initShaders=function(){if(null==Ie.structure&&(Ie.structure=Le.createColoredVertexStructure()),null==Ie.standardColorPipeline){var t=Le.createColoredPipeline(Ie.structure);t.compile(),Ie.standardColorPipeline=new ge(t)}},Ie.prototype={projectionMatrix:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Ie.standardColorPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ie.rectVertexBuffer){Ie.rectVertexBuffer=new De(4e3,Ie.structure,1),Ie.rectVertices=Ie.rectVertexBuffer.lock(),Ie.indexBuffer=new Ne(6e3,0);for(var t=Ie.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ie.indexBuffer.unlock(),Ie.triangleVertexBuffer=new De(3e3,Ie.structure,1),Ie.triangleVertices=Ie.triangleVertexBuffer.lock(),Ie.triangleIndexBuffer=new Ne(3e3,0);for(var n=Ie.triangleIndexBuffer.lock(),s=0;s<1e3;){var r=s++;n[3*r]=3*r,n[3*r+1]=3*r+1,n[3*r+2]=3*r+2}Ie.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,n,s,r,a,o){var l=7*Ie.bufferIndex*4;Ie.rectVertices[l]=t,Ie.rectVertices[1+l]=e,Ie.rectVertices[2+l]=-5,Ie.rectVertices[7+l]=i,Ie.rectVertices[8+l]=n,Ie.rectVertices[9+l]=-5,Ie.rectVertices[14+l]=s,Ie.rectVertices[15+l]=r,Ie.rectVertices[16+l]=-5,Ie.rectVertices[21+l]=a,Ie.rectVertices[22+l]=o,Ie.rectVertices[23+l]=-5},setRectColors:function(t,e){var i=7*Ie.bufferIndex*4,n=t*(.00392156862745098*(e>>>24)),s=.00392156862745098*((16711680&e)>>>16)*n,r=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Ie.rectVertices[3+i]=s,Ie.rectVertices[4+i]=r,Ie.rectVertices[5+i]=a,Ie.rectVertices[6+i]=n,Ie.rectVertices[10+i]=s,Ie.rectVertices[11+i]=r,Ie.rectVertices[12+i]=a,Ie.rectVertices[13+i]=n,Ie.rectVertices[17+i]=s,Ie.rectVertices[18+i]=r,Ie.rectVertices[19+i]=a,Ie.rectVertices[20+i]=n,Ie.rectVertices[24+i]=s,Ie.rectVertices[25+i]=r,Ie.rectVertices[26+i]=a,Ie.rectVertices[27+i]=n},setTriVertices:function(t,e,i,n,s,r){var a=7*Ie.triangleBufferIndex*3;Ie.triangleVertices[a]=t,Ie.triangleVertices[1+a]=e,Ie.triangleVertices[2+a]=-5,Ie.triangleVertices[7+a]=i,Ie.triangleVertices[8+a]=n,Ie.triangleVertices[9+a]=-5,Ie.triangleVertices[14+a]=s,Ie.triangleVertices[15+a]=r,Ie.triangleVertices[16+a]=-5},setTriColors:function(t,e){var i=7*Ie.triangleBufferIndex*3,n=t*(.00392156862745098*(e>>>24)),s=.00392156862745098*((16711680&e)>>>16)*n,r=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Ie.triangleVertices[3+i]=s,Ie.triangleVertices[4+i]=r,Ie.triangleVertices[5+i]=a,Ie.triangleVertices[6+i]=n,Ie.triangleVertices[10+i]=s,Ie.triangleVertices[11+i]=r,Ie.triangleVertices[12+i]=a,Ie.triangleVertices[13+i]=n,Ie.triangleVertices[17+i]=s,Ie.triangleVertices[18+i]=r,Ie.triangleVertices[19+i]=a,Ie.triangleVertices[20+i]=n},drawBuffer:function(t){t||0<Ie.triangleBufferIndex&&this.drawTriBuffer(!0),Ie.rectVertexBuffer.unlock(4*Ie.bufferIndex),this.g.setVertexBuffer(Ie.rectVertexBuffer),this.g.setIndexBuffer(Ie.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ie.bufferIndex*3),Ie.bufferIndex=0,Ie.rectVertices=Ie.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||0<Ie.bufferIndex&&this.drawBuffer(!0),Ie.triangleVertexBuffer.unlock(3*Ie.triangleBufferIndex),this.g.setVertexBuffer(Ie.triangleVertexBuffer),this.g.setIndexBuffer(Ie.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ie.triangleBufferIndex),Ie.triangleBufferIndex=0,Ie.triangleVertices=Ie.triangleVertexBuffer.lock()},fillRect:function(t,e,i,n,s,r,a,o,l,u){0<Ie.triangleBufferIndex&&this.drawTriBuffer(!0),1e3<=Ie.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,n,s,r,a,o,l,u),++Ie.bufferIndex},fillTriangle:function(t,e,i,n,s,r,a,o){0<Ie.bufferIndex&&this.drawBuffer(!0),1e3<=Ie.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,n,s,r,a,o),++Ie.triangleBufferIndex},endTris:function(t){0<Ie.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<Ie.bufferIndex&&this.drawBuffer(t)},end:function(){0<Ie.triangleBufferIndex&&this.drawTriBuffer(!1),0<Ie.bufferIndex&&this.drawBuffer(!1)},__class__:Ie,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Ce=function(t){this.bakedQuadCache=new R,this.bilinear=!1,this.myPipeline=null,this.g=t,Ce.bufferIndex=0,Ce.initShaders(),this.myPipeline=Ce.standardTextPipeline,this.initBuffers()};(x["kha.graphics4.TextShaderPainter"]=Ce).__name__=!0,Ce.initShaders=function(){if(null==Ce.structure&&(Ce.structure=Le.createTextVertexStructure()),null==Ce.standardTextPipeline){var t=Le.createTextPipeline(Ce.structure);t.compile(),Ce.standardTextPipeline=new ge(t)}},Ce.findIndex=function(t){Gt.fontGlyphs;for(var e=O.charBlocks,i=0,n=0,s=e.length/2|0;n<s;){var r=n++,a=e[2*r],o=e[2*r+1];if(a<=t&&t<=o)return i+t-a;i+=o-a+1}return 0},Ce.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Ce.standardTextPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ce.rectVertexBuffer){Ce.rectVertexBuffer=new De(4e3,Ce.structure,1),Ce.rectVertices=Ce.rectVertexBuffer.lock(),Ce.indexBuffer=new Ne(6e3,0);for(var t=Ce.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ce.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,s,r,a,o){var l=9*Ce.bufferIndex*4;Ce.rectVertices[l]=t,Ce.rectVertices[1+l]=e,Ce.rectVertices[2+l]=-5,Ce.rectVertices[9+l]=i,Ce.rectVertices[10+l]=n,Ce.rectVertices[11+l]=-5,Ce.rectVertices[18+l]=s,Ce.rectVertices[19+l]=r,Ce.rectVertices[20+l]=-5,Ce.rectVertices[27+l]=a,Ce.rectVertices[28+l]=o,Ce.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var s=9*Ce.bufferIndex*4;Ce.rectVertices[3+s]=t,Ce.rectVertices[4+s]=n,Ce.rectVertices[12+s]=t,Ce.rectVertices[13+s]=e,Ce.rectVertices[21+s]=i,Ce.rectVertices[22+s]=e,Ce.rectVertices[30+s]=i,Ce.rectVertices[31+s]=n},setRectColors:function(t,e){var i=9*Ce.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Ce.rectVertices[5+i]=.00392156862745098*((16711680&e)>>>16),Ce.rectVertices[6+i]=.00392156862745098*((65280&e)>>>8),Ce.rectVertices[7+i]=.00392156862745098*(255&e),Ce.rectVertices[8+i]=n,Ce.rectVertices[14+i]=.00392156862745098*((16711680&e)>>>16),Ce.rectVertices[15+i]=.00392156862745098*((65280&e)>>>8),Ce.rectVertices[16+i]=.00392156862745098*(255&e),Ce.rectVertices[17+i]=n,Ce.rectVertices[23+i]=.00392156862745098*((16711680&e)>>>16),Ce.rectVertices[24+i]=.00392156862745098*((65280&e)>>>8),Ce.rectVertices[25+i]=.00392156862745098*(255&e),Ce.rectVertices[26+i]=n,Ce.rectVertices[32+i]=.00392156862745098*((16711680&e)>>>16),Ce.rectVertices[33+i]=.00392156862745098*((65280&e)>>>8),Ce.rectVertices[34+i]=.00392156862745098*(255&e),Ce.rectVertices[35+i]=n},drawBuffer:function(){Ce.rectVertexBuffer.unlock(4*Ce.bufferIndex),this.g.setVertexBuffer(Ce.rectVertexBuffer),this.g.setIndexBuffer(Ce.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Ce.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Ce.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Ce.bufferIndex=0,Ce.rectVertices=Ce.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=g.__cast(t,V)},bakedQuadCache:null,drawString:function(t,e,i,n,s,r){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Ce.lastTexture&&o!=Ce.lastTexture&&this.drawBuffer(),Ce.lastTexture=o;for(var l=n,u=s,h=0,c=t.length;h<c;){var A=h++,d=t.charCodeAt(A),_=a.getBakedQuad(this.bakedQuadCache,Ce.findIndex(d),l,u);if(null!=_){1e3<=Ce.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(_.s0*o.get_width()/o.get_realWidth(),_.t0*o.get_height()/o.get_realHeight(),_.s1*o.get_width()/o.get_realWidth(),_.t1*o.get_height()/o.get_realHeight());var f=_.x0,g=_.y1;null==g&&(g=0),null==f&&(f=0);var p=r._02*f+r._12*g+r._22,m=(r._00*f+r._10*g+r._20)/p,v=(r._01*f+r._11*g+r._21)/p;null==v&&(v=0),null==m&&(m=0);var w=m,b=v,y=_.x0,x=_.y0;null==x&&(x=0),null==y&&(y=0);var T=r._02*y+r._12*x+r._22,S=(r._00*y+r._10*x+r._20)/T,E=(r._01*y+r._11*x+r._21)/T;null==E&&(E=0),null==S&&(S=0);var B=S,k=E,I=_.x1,C=_.y0;null==C&&(C=0),null==I&&(I=0);var L=r._02*I+r._12*C+r._22,N=(r._00*I+r._10*C+r._20)/L,F=(r._01*I+r._11*C+r._21)/L;null==F&&(F=0),null==N&&(N=0);var P=N,M=F,R=_.x1,O=_.y1;null==O&&(O=0),null==R&&(R=0);var V=r._02*R+r._12*O+r._22,D=(r._00*R+r._10*O+r._20)/V,U=(r._01*R+r._11*O+r._21)/V;null==U&&(U=0),null==D&&(D=0);var H=D,W=U;this.setRectVertices(w,b,B,k,P,M,H,W),l+=_.xadvance,++Ce.bufferIndex}}},drawCharacters:function(t,e,i,n,s,r,a,o){var l=this.font._get(this.fontSize),u=l.getTexture();null!=Ce.lastTexture&&u!=Ce.lastTexture&&this.drawBuffer(),Ce.lastTexture=u;for(var h=r,c=a,A=e,d=e+i;A<d;){var _=A++,f=l.getBakedQuad(this.bakedQuadCache,Ce.findIndex(t[_]),h,c);if(null!=f){1e3<=Ce.bufferIndex+1&&this.drawBuffer(),this.setRectColors(n,s),this.setRectTexCoords(f.s0*u.get_width()/u.get_realWidth(),f.t0*u.get_height()/u.get_realHeight(),f.s1*u.get_width()/u.get_realWidth(),f.t1*u.get_height()/u.get_realHeight());var g=f.x0,p=f.y1;null==p&&(p=0),null==g&&(g=0);var m=o._02*g+o._12*p+o._22,v=(o._00*g+o._10*p+o._20)/m,w=(o._01*g+o._11*p+o._21)/m;null==w&&(w=0),null==v&&(v=0);var b=v,y=w,x=f.x0,T=f.y0;null==T&&(T=0),null==x&&(x=0);var S=o._02*x+o._12*T+o._22,E=(o._00*x+o._10*T+o._20)/S,B=(o._01*x+o._11*T+o._21)/S;null==B&&(B=0),null==E&&(E=0);var k=E,I=B,C=f.x1,L=f.y0;null==L&&(L=0),null==C&&(C=0);var N=o._02*C+o._12*L+o._22,F=(o._00*C+o._10*L+o._20)/N,P=(o._01*C+o._11*L+o._21)/N;null==P&&(P=0),null==F&&(F=0);var M=F,R=P,O=f.x1,V=f.y1;null==V&&(V=0),null==O&&(O=0);var D=o._02*O+o._12*V+o._22,U=(o._00*O+o._10*V+o._20)/D,H=(o._01*O+o._11*V+o._21)/D;null==H&&(H=0),null==U&&(U=0);var W=U,G=H;this.setRectVertices(b,y,k,I,M,R,W,G),h+=f.xadvance,++Ce.bufferIndex}}},end:function(){0<Ce.bufferIndex&&this.drawBuffer(),Ce.lastTexture=null},__class__:Ce,__properties__:{set_pipeline:"set_pipeline",get_pipeline:"get_pipeline"}};var Le=function(t){this.scissorH=-1,this.scissorW=-1,this.scissorY=-1,this.scissorX=-1,this.scissorEnabled=!1,this.lastPipeline=null,this.pipelineCache=new et,this.myMipmapScaleQuality=0,this.myImageScaleQuality=0,Gt.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new ke(this.g),this.coloredPainter=new Ie(this.g),this.textPainter=new Ce(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new ei(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Le.videoPipeline&&(Le.videoPipeline=Le.createImagePipeline(Le.createImageVertexStructure()),Le.videoPipeline.fragmentShader=G.painter_video_frag,Le.videoPipeline.vertexShader=G.painter_video_vert,Le.videoPipeline.compile())};(x["kha.graphics4.Graphics2"]=Le).__name__=!0,Le.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},Le.createImageVertexStructure=function(){var t=new We;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Le.createImagePipeline=function(t){var e=new Pe;return e.fragmentShader=G.painter_image_frag,e.vertexShader=G.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Le.createColoredVertexStructure=function(){var t=new We;return t.add("vertexPosition",2),t.add("vertexColor",3),t},Le.createColoredPipeline=function(t){var e=new Pe;return e.fragmentShader=G.painter_colored_frag,e.vertexShader=G.painter_colored_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Le.createTextVertexStructure=function(){var t=new We;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Le.createTextPipeline=function(t){var e=new Pe;return e.fragmentShader=G.painter_text_frag,e.vertexShader=G.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},Le.__super__=Gt,Le.prototype=s(Gt.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof N){var i=this.projectionMatrix,n=2/t,s=-t/t,r=2/(0-e),a=-e/(0-e);i._00=n,i._10=0,i._20=0,i._30=s,i._01=0,i._11=r,i._21=0,i._31=a,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if(M.get_nonPow2Supported()||(t=Le.upperPowerOfTwo(t),e=Le.upperPowerOfTwo(e)),M.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/t,u=-t/t,h=2/e,c=-e/e;o._00=l,o._10=0,o._20=0,o._30=u,o._01=0,o._11=h,o._21=0,o._31=c,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var A=this.projectionMatrix,d=2/t,_=-t/t,f=2/(0-e),g=-e/(0-e);A._00=d,A._10=0,A._20=0,A._30=_,A._01=0,A._11=f,A._21=0,A._31=g,A._02=0,A._12=0,A._22=-.002000200020002,A._32=-1.0002000200020003,A._03=0,A._13=0,A._23=0,A._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){var n=this.coloredPainter;0<Ie.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ie.bufferIndex&&n.drawBuffer(!1),this.textPainter.end();var s=e+t.get_width(),r=i+t.get_height(),a=this.transformations[this.transformationIndex],o=e,l=r;null==l&&(l=0),null==o&&(o=0);var u=a._02*o+a._12*l+a._22,h=(a._00*o+a._10*l+a._20)/u,c=(a._01*o+a._11*l+a._21)/u;null==c&&(c=0),null==h&&(h=0);var A=h,d=c,_=this.transformations[this.transformationIndex],f=e,g=i;null==g&&(g=0),null==f&&(f=0);var p=_._02*f+_._12*g+_._22,m=(_._00*f+_._10*g+_._20)/p,v=(_._01*f+_._11*g+_._21)/p;null==v&&(v=0),null==m&&(m=0);var w=m,b=v,y=this.transformations[this.transformationIndex],x=s,T=i;null==T&&(T=0),null==x&&(x=0);var S=y._02*x+y._12*T+y._22,E=(y._00*x+y._10*T+y._20)/S,B=(y._01*x+y._11*T+y._21)/S;null==B&&(B=0),null==E&&(E=0);var k=E,I=B,C=this.transformations[this.transformationIndex],L=s,N=r;null==N&&(N=0),null==L&&(L=0);var F=C._02*L+C._12*N+C._22,P=(C._00*L+C._10*N+C._20)/F,M=(C._01*L+C._11*N+C._21)/F;null==M&&(M=0),null==P&&(P=0);var R=P,O=M,V=this.imagePainter,D=this.get_opacity(),U=this.get_color(),H=t;(1500<=ke.bufferIndex+1||null!=ke.lastTexture&&H!=ke.lastTexture)&&V.drawBuffer();var W=.00392156862745098*((16711680&U)>>>16),G=.00392156862745098*((65280&U)>>>8),z=.00392156862745098*(255&U),X=.00392156862745098*(U>>>24)*D,Y=9*ke.bufferIndex*4;ke.rectVertices[5+Y]=W,ke.rectVertices[6+Y]=G,ke.rectVertices[7+Y]=z,ke.rectVertices[8+Y]=X,ke.rectVertices[14+Y]=W,ke.rectVertices[15+Y]=G,ke.rectVertices[16+Y]=z,ke.rectVertices[17+Y]=X,ke.rectVertices[23+Y]=W,ke.rectVertices[24+Y]=G,ke.rectVertices[25+Y]=z,ke.rectVertices[26+Y]=X,ke.rectVertices[32+Y]=W,ke.rectVertices[33+Y]=G,ke.rectVertices[34+Y]=z,ke.rectVertices[35+Y]=X;var K=H.get_width()/H.get_realWidth(),Q=H.get_height()/H.get_realHeight(),q=9*ke.bufferIndex*4;ke.rectVertices[3+q]=0,ke.rectVertices[4+q]=Q,ke.rectVertices[12+q]=0,ke.rectVertices[13+q]=0,ke.rectVertices[21+q]=K,ke.rectVertices[22+q]=0,ke.rectVertices[30+q]=K,ke.rectVertices[31+q]=Q;var j=9*ke.bufferIndex*4;ke.rectVertices[j]=A,ke.rectVertices[1+j]=d,ke.rectVertices[2+j]=-5,ke.rectVertices[9+j]=w,ke.rectVertices[10+j]=b,ke.rectVertices[11+j]=-5,ke.rectVertices[18+j]=k,ke.rectVertices[19+j]=I,ke.rectVertices[20+j]=-5,ke.rectVertices[27+j]=R,ke.rectVertices[28+j]=O,ke.rectVertices[29+j]=-5,++ke.bufferIndex,ke.lastTexture=H},drawScaledSubImage:function(t,e,i,n,s,r,a,o,l){var u=this.coloredPainter;0<Ie.triangleBufferIndex&&u.drawTriBuffer(!1),0<Ie.bufferIndex&&u.drawBuffer(!1),this.textPainter.end();var h=this.transformations[this.transformationIndex],c=r,A=a+l;null==A&&(A=0),null==c&&(c=0);var d=h._02*c+h._12*A+h._22,_=(h._00*c+h._10*A+h._20)/d,f=(h._01*c+h._11*A+h._21)/d;null==f&&(f=0),null==_&&(_=0);var g=_,p=f,m=this.transformations[this.transformationIndex],v=r,w=a;null==w&&(w=0),null==v&&(v=0);var b=m._02*v+m._12*w+m._22,y=(m._00*v+m._10*w+m._20)/b,x=(m._01*v+m._11*w+m._21)/b;null==x&&(x=0),null==y&&(y=0);var T=y,S=x,E=this.transformations[this.transformationIndex],B=r+o,k=a;null==k&&(k=0),null==B&&(B=0);var I=E._02*B+E._12*k+E._22,C=(E._00*B+E._10*k+E._20)/I,L=(E._01*B+E._11*k+E._21)/I;null==L&&(L=0),null==C&&(C=0);var N=C,F=L,P=this.transformations[this.transformationIndex],M=r+o,R=a+l;null==R&&(R=0),null==M&&(M=0);var O=P._02*M+P._12*R+P._22,V=(P._00*M+P._10*R+P._20)/O,D=(P._01*M+P._11*R+P._21)/O;null==D&&(D=0),null==V&&(V=0);var U=V,H=D,W=this.imagePainter,G=this.get_opacity(),z=this.get_color(),X=t;(1500<=ke.bufferIndex+1||null!=ke.lastTexture&&X!=ke.lastTexture)&&W.drawBuffer();var Y=e/X.get_realWidth(),K=i/X.get_realHeight(),Q=(e+n)/X.get_realWidth(),q=(i+s)/X.get_realHeight(),j=9*ke.bufferIndex*4;ke.rectVertices[3+j]=Y,ke.rectVertices[4+j]=q,ke.rectVertices[12+j]=Y,ke.rectVertices[13+j]=K,ke.rectVertices[21+j]=Q,ke.rectVertices[22+j]=K,ke.rectVertices[30+j]=Q,ke.rectVertices[31+j]=q;var Z=.00392156862745098*((16711680&z)>>>16),J=.00392156862745098*((65280&z)>>>8),$=.00392156862745098*(255&z),tt=.00392156862745098*(z>>>24)*G,et=9*ke.bufferIndex*4;ke.rectVertices[5+et]=Z,ke.rectVertices[6+et]=J,ke.rectVertices[7+et]=$,ke.rectVertices[8+et]=tt,ke.rectVertices[14+et]=Z,ke.rectVertices[15+et]=J,ke.rectVertices[16+et]=$,ke.rectVertices[17+et]=tt,ke.rectVertices[23+et]=Z,ke.rectVertices[24+et]=J,ke.rectVertices[25+et]=$,ke.rectVertices[26+et]=tt,ke.rectVertices[32+et]=Z,ke.rectVertices[33+et]=J,ke.rectVertices[34+et]=$,ke.rectVertices[35+et]=tt;var it=9*ke.bufferIndex*4;ke.rectVertices[it]=g,ke.rectVertices[1+it]=p,ke.rectVertices[2+it]=-5,ke.rectVertices[9+it]=T,ke.rectVertices[10+it]=S,ke.rectVertices[11+it]=-5,ke.rectVertices[18+it]=N,ke.rectVertices[19+it]=F,ke.rectVertices[20+it]=-5,ke.rectVertices[27+it]=U,ke.rectVertices[28+it]=H,ke.rectVertices[29+it]=-5,++ke.bufferIndex,ke.lastTexture=X},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,n,s){null==s&&(s=1),this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformationIndex],a=t-s/2,o=e+s/2;null==o&&(o=0),null==a&&(a=0);var l=r._02*a+r._12*o+r._22,u=(r._00*a+r._10*o+r._20)/l,h=(r._01*a+r._11*o+r._21)/l;null==h&&(h=0),null==u&&(u=0);var c=u,A=h,d=this.transformations[this.transformationIndex],_=t-s/2,f=e-s/2;null==f&&(f=0),null==_&&(_=0);var g=d._02*_+d._12*f+d._22,p=(d._00*_+d._10*f+d._20)/g,m=(d._01*_+d._11*f+d._21)/g;null==m&&(m=0),null==p&&(p=0);var v=p,w=m,b=this.transformations[this.transformationIndex],y=t+i+s/2,x=e-s/2;null==x&&(x=0),null==y&&(y=0);var T=b._02*y+b._12*x+b._22,S=(b._00*y+b._10*x+b._20)/T,E=(b._01*y+b._11*x+b._21)/T;null==E&&(E=0),null==S&&(S=0);var B=S,k=E,I=this.transformations[this.transformationIndex],C=t+i+s/2,L=e+s/2;null==L&&(L=0),null==C&&(C=0);var N=I._02*C+I._12*L+I._22,F=(I._00*C+I._10*L+I._20)/N,P=(I._01*C+I._11*L+I._21)/N;null==P&&(P=0),null==F&&(F=0);var M=F,R=P;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,A,v,w,B,k,M,R);var O=this.transformations[this.transformationIndex],V=t-s/2,D=e+n-s/2;null==D&&(D=0),null==V&&(V=0);var U=O._02*V+O._12*D+O._22,H=(O._00*V+O._10*D+O._20)/U,W=(O._01*V+O._11*D+O._21)/U;null==W&&(W=0),null==H&&(H=0),c=H,A=W;var G=this.transformations[this.transformationIndex],z=t-s/2,X=e+s/2;null==X&&(X=0),null==z&&(z=0);var Y=G._02*z+G._12*X+G._22,K=(G._00*z+G._10*X+G._20)/Y,Q=(G._01*z+G._11*X+G._21)/Y;null==Q&&(Q=0),null==K&&(K=0),v=K,w=Q;var q=this.transformations[this.transformationIndex],j=t+s/2,Z=e+s/2;null==Z&&(Z=0),null==j&&(j=0);var J=q._02*j+q._12*Z+q._22,$=(q._00*j+q._10*Z+q._20)/J,tt=(q._01*j+q._11*Z+q._21)/J;null==tt&&(tt=0),null==$&&($=0),B=$,k=tt;var et=this.transformations[this.transformationIndex],it=t+s/2,nt=e+n-s/2;null==nt&&(nt=0),null==it&&(it=0);var st=et._02*it+et._12*nt+et._22,rt=(et._00*it+et._10*nt+et._20)/st,at=(et._01*it+et._11*nt+et._21)/st;null==at&&(at=0),null==rt&&(rt=0),M=rt,R=at,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,A,v,w,B,k,M,R);var ot=this.transformations[this.transformationIndex],lt=t-s/2,ut=e+n+s/2;null==ut&&(ut=0),null==lt&&(lt=0);var ht=ot._02*lt+ot._12*ut+ot._22,ct=(ot._00*lt+ot._10*ut+ot._20)/ht,At=(ot._01*lt+ot._11*ut+ot._21)/ht;null==At&&(At=0),null==ct&&(ct=0),c=ct,A=At;var dt=this.transformations[this.transformationIndex],_t=t-s/2,ft=e+n-s/2;null==ft&&(ft=0),null==_t&&(_t=0);var gt=dt._02*_t+dt._12*ft+dt._22,pt=(dt._00*_t+dt._10*ft+dt._20)/gt,mt=(dt._01*_t+dt._11*ft+dt._21)/gt;null==mt&&(mt=0),null==pt&&(pt=0),v=pt,w=mt;var vt=this.transformations[this.transformationIndex],wt=t+i+s/2,bt=e+n-s/2;null==bt&&(bt=0),null==wt&&(wt=0);var yt=vt._02*wt+vt._12*bt+vt._22,xt=(vt._00*wt+vt._10*bt+vt._20)/yt,Tt=(vt._01*wt+vt._11*bt+vt._21)/yt;null==Tt&&(Tt=0),null==xt&&(xt=0),B=xt,k=Tt;var St=this.transformations[this.transformationIndex],Et=t+i+s/2,Bt=e+n+s/2;null==Bt&&(Bt=0),null==Et&&(Et=0);var kt=St._02*Et+St._12*Bt+St._22,It=(St._00*Et+St._10*Bt+St._20)/kt,Ct=(St._01*Et+St._11*Bt+St._21)/kt;null==Ct&&(Ct=0),null==It&&(It=0),M=It,R=Ct,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,A,v,w,B,k,M,R);var Lt=this.transformations[this.transformationIndex],Nt=t+i-s/2,Ft=e+n-s/2;null==Ft&&(Ft=0),null==Nt&&(Nt=0);var Pt=Lt._02*Nt+Lt._12*Ft+Lt._22,Mt=(Lt._00*Nt+Lt._10*Ft+Lt._20)/Pt,Rt=(Lt._01*Nt+Lt._11*Ft+Lt._21)/Pt;null==Rt&&(Rt=0),null==Mt&&(Mt=0),c=Mt,A=Rt;var Ot=this.transformations[this.transformationIndex],Vt=t+i-s/2,Dt=e+s/2;null==Dt&&(Dt=0),null==Vt&&(Vt=0);var Ut=Ot._02*Vt+Ot._12*Dt+Ot._22,Ht=(Ot._00*Vt+Ot._10*Dt+Ot._20)/Ut,Wt=(Ot._01*Vt+Ot._11*Dt+Ot._21)/Ut;null==Wt&&(Wt=0),null==Ht&&(Ht=0),v=Ht,w=Wt;var Gt=this.transformations[this.transformationIndex],zt=t+i+s/2,Xt=e+s/2;null==Xt&&(Xt=0),null==zt&&(zt=0);var Yt=Gt._02*zt+Gt._12*Xt+Gt._22,Kt=(Gt._00*zt+Gt._10*Xt+Gt._20)/Yt,Qt=(Gt._01*zt+Gt._11*Xt+Gt._21)/Yt;null==Qt&&(Qt=0),null==Kt&&(Kt=0),B=Kt,k=Qt;var qt=this.transformations[this.transformationIndex],jt=t+i+s/2,Zt=e+n-s/2;null==Zt&&(Zt=0),null==jt&&(jt=0);var Jt=qt._02*jt+qt._12*Zt+qt._22,$t=(qt._00*jt+qt._10*Zt+qt._20)/Jt,te=(qt._01*jt+qt._11*Zt+qt._21)/Jt;null==te&&(te=0),null==$t&&($t=0),M=$t,R=te,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,A,v,w,B,k,M,R)},fillRect:function(t,e,i,n){this.imagePainter.end(),this.textPainter.end();var s=this.transformations[this.transformationIndex],r=t,a=e+n;null==a&&(a=0),null==r&&(r=0);var o=s._02*r+s._12*a+s._22,l=(s._00*r+s._10*a+s._20)/o,u=(s._01*r+s._11*a+s._21)/o;null==u&&(u=0),null==l&&(l=0);var h=l,c=u,A=this.transformations[this.transformationIndex],d=t,_=e;null==_&&(_=0),null==d&&(d=0);var f=A._02*d+A._12*_+A._22,g=(A._00*d+A._10*_+A._20)/f,p=(A._01*d+A._11*_+A._21)/f;null==p&&(p=0),null==g&&(g=0);var m=g,v=p,w=this.transformations[this.transformationIndex],b=t+i,y=e;null==y&&(y=0),null==b&&(b=0);var x=w._02*b+w._12*y+w._22,T=(w._00*b+w._10*y+w._20)/x,S=(w._01*b+w._11*y+w._21)/x;null==S&&(S=0),null==T&&(T=0);var E=T,B=S,k=this.transformations[this.transformationIndex],I=t+i,C=e+n;null==C&&(C=0),null==I&&(I=0);var L=k._02*I+k._12*C+k._22,N=(k._00*I+k._10*C+k._20)/L,F=(k._01*I+k._11*C+k._21)/L;null==F&&(F=0),null==N&&(N=0);var P=N,M=F;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,c,m,v,E,B,P,M)},drawString:function(t,e,i){this.imagePainter.end();var n=this.coloredPainter;0<Ie.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ie.bufferIndex&&n.drawBuffer(!1),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.transformations[this.transformationIndex])},drawCharacters:function(t,e,i,n,s){this.imagePainter.end();var r=this.coloredPainter;0<Ie.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ie.bufferIndex&&r.drawBuffer(!1),this.textPainter.drawCharacters(t,e,i,this.get_opacity(),this.get_color(),n,s,this.transformations[this.transformationIndex])},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return Gt.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,n,s){null==s&&(s=1),this.imagePainter.end(),this.textPainter.end();var r=0,a=0;if(n==e){var o=0,l=-1;null==l&&(l=0),null==o&&(o=0),r=o,a=l}else{var u=1,h=-(i-t)/(n-e);null==h&&(h=0),null==u&&(u=0),r=u,a=h}var c=Math.sqrt(r*r+a*a);if(0!=c){var A=s/c;r*=A,a*=A}var d=t+.5*r,_=e+.5*a;null==_&&(_=0),null==d&&(d=0);var f=d,g=_,p=i+.5*r,m=n+.5*a;null==m&&(m=0),null==p&&(p=0);var v=p,w=m,b=f-r,y=g-a;null==y&&(y=0),null==b&&(b=0);var x=b,T=y,S=v-r,E=w-a;null==E&&(E=0),null==S&&(S=0);var B=S,k=E,I=this.transformations[this.transformationIndex],C=I._02*f+I._12*g+I._22,L=(I._00*f+I._10*g+I._20)/C,N=(I._01*f+I._11*g+I._21)/C;null==N&&(N=0),null==L&&(L=0),f=L,g=N;var F=this.transformations[this.transformationIndex],P=F._02*v+F._12*w+F._22,M=(F._00*v+F._10*w+F._20)/P,R=(F._01*v+F._11*w+F._21)/P;null==R&&(R=0),null==M&&(M=0),v=M,w=R;var O=this.transformations[this.transformationIndex],V=O._02*x+O._12*T+O._22,D=(O._00*x+O._10*T+O._20)/V,U=(O._01*x+O._11*T+O._21)/V;null==U&&(U=0),null==D&&(D=0),x=D,T=U;var H=this.transformations[this.transformationIndex],W=H._02*B+H._12*k+H._22,G=(H._00*B+H._10*k+H._20)/W,z=(H._01*B+H._11*k+H._21)/W;null==z&&(z=0),null==G&&(G=0),B=G,k=z,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),f,g,v,w,x,T),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),x,T,v,w,B,k)},fillTriangle:function(t,e,i,n,s,r){this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],o=t,l=e;null==l&&(l=0),null==o&&(o=0);var u=a._02*o+a._12*l+a._22,h=(a._00*o+a._10*l+a._20)/u,c=(a._01*o+a._11*l+a._21)/u;null==c&&(c=0),null==h&&(h=0);var A=h,d=c,_=this.transformations[this.transformationIndex],f=i,g=n;null==g&&(g=0),null==f&&(f=0);var p=_._02*f+_._12*g+_._22,m=(_._00*f+_._10*g+_._20)/p,v=(_._01*f+_._11*g+_._21)/p;null==v&&(v=0),null==m&&(m=0);var w=m,b=v,y=this.transformations[this.transformationIndex],x=s,T=r;null==T&&(T=0),null==x&&(x=0);var S=y._02*x+y._12*T+y._22,E=(y._00*x+y._10*T+y._20)/S,B=(y._01*x+y._11*T+y._21)/S;null==B&&(B=0),null==E&&(E=0);var k=E,I=B;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),A,d,w,b,k,I)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(t){return t==this.myImageScaleQuality?t:(this.imagePainter.setBilinearFilter(1==t),this.textPainter.setBilinearFilter(1==t),this.myImageScaleQuality=t)},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(t){return this.imagePainter.setBilinearMipmapFilter(1==t),this.myMipmapScaleQuality=t},pipelineCache:null,lastPipeline:null,setPipeline:function(t){if(t!=this.lastPipeline)if(this.lastPipeline=t,this.flush(),null==t)this.imagePainter.set_pipeline(null),this.coloredPainter.set_pipeline(null),this.textPainter.set_pipeline(null);else{var e=this.pipelineCache.h[t.__id__];null==e&&(e=new ge(t),this.pipelineCache.set(t,e)),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e)}},scissorEnabled:null,scissorX:null,scissorY:null,scissorW:null,scissorH:null,scissor:function(t,e,i,n){this.scissorEnabled=!0,this.scissorX=t,this.scissorY=e,this.scissorW=i,this.scissorH=n,this.flush(),this.g.scissor(t,e,i,n)},disableScissor:function(){this.scissorEnabled=!1,this.flush(),this.g.disableScissor()},begin:function(t,e){if(null==t&&(t=!0),null!=Le.current)throw new ne("End before you begin");(Le.current=this).g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;0<Ie.triangleBufferIndex&&t.drawTriBuffer(!1),0<Ie.bufferIndex&&t.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),Le.current!=this)throw new ne("Begin before you end");Le.current=null},drawVideoInternal:function(t,e,i,n,s){},drawVideo:function(t,e,i,n,s){this.setPipeline(Le.videoPipeline),this.drawVideoInternal(t,e,i,n,s),this.setPipeline(null)},__class__:Le});var Ne=function(t,e,i){null==i&&(i=!1),this.indexCount=t,this.buffer=Krom.createIndexBuffer(t)};(x["kha.graphics4.IndexBuffer"]=Ne).__name__=!0,Ne.prototype={buffer:null,_data:null,indexCount:null,delete:function(){Krom.deleteIndexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockIndexBuffer(this.buffer),null==t&&(t=0),null==e&&(e=this.indexCount),this._data.subarray(t,t+e)},unlock:function(t){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},count:function(){return this.indexCount},__class__:Ne};function Fe(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Re.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1}(x["kha.graphics4.PipelineStateBase"]=Fe).__name__=!0,Fe.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,set_colorWriteMask:function(t){var e=this.colorWriteMasksAlpha[0]=t,i=this.colorWriteMasksGreen[0]=e,n=this.colorWriteMasksBlue[0]=i;return this.colorWriteMasksRed[0]=n},get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:Fe,__properties__:{set_colorWriteMaskAlpha:"set_colorWriteMaskAlpha",get_colorWriteMaskAlpha:"get_colorWriteMaskAlpha",set_colorWriteMaskBlue:"set_colorWriteMaskBlue",get_colorWriteMaskBlue:"get_colorWriteMaskBlue",set_colorWriteMaskGreen:"set_colorWriteMaskGreen",get_colorWriteMaskGreen:"get_colorWriteMaskGreen",set_colorWriteMaskRed:"set_colorWriteMaskRed",get_colorWriteMaskRed:"get_colorWriteMaskRed",set_colorWriteMask:"set_colorWriteMask"}};var Pe=function(){Fe.call(this),this.pipeline=Krom.createPipeline()};(x["kha.graphics4.PipelineState"]=Pe).__name__=!0,Pe.convertBlendingFactor=function(t){switch(t){case 0:case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5;case 7:return 6;case 8:return 7;case 9:return 8;case 10:return 9}},Pe.__super__=Fe,Pe.prototype=s(Fe.prototype,{pipeline:null,delete:function(){Krom.deletePipeline(this.pipeline),this.pipeline=null},compile:function(){var t=0<this.inputLayout.length?this.inputLayout[0]:null,e=1<this.inputLayout.length?this.inputLayout[1]:null,i=2<this.inputLayout.length?this.inputLayout[2]:null,n=3<this.inputLayout.length?this.inputLayout[3]:null,s=null!=this.geometryShader?this.geometryShader.shader:null,r=null!=this.tessellationControlShader?this.tessellationControlShader.shader:null,a=null!=this.tessellationEvaluationShader?this.tessellationEvaluationShader.shader:null,o=0,l=this.stencilReferenceValue;1==l._hx_index&&(o=l.value);Krom.compilePipeline(this.pipeline,t,e,i,n,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,s,r,a,{cullMode:this.cullMode,depthWrite:this.depthWrite,depthMode:this.depthMode,stencilMode:this.stencilMode,stencilBothPass:this.stencilBothPass,stencilDepthFail:this.stencilDepthFail,stencilFail:this.stencilFail,stencilReferenceValue:o,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:Pe.convertBlendingFactor(this.blendSource),blendDestination:Pe.convertBlendingFactor(this.blendDestination),alphaBlendSource:Pe.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:Pe.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(t){return Krom.getConstantLocation(this.pipeline,t)},getTextureUnit:function(t){return Krom.getTextureUnit(this.pipeline,t)},__class__:Pe});function Me(t,e){this.shader=Krom.createTessellationControlShader(t[0].bytes.b.bufferValue,e[0])}var Re=f["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:((e=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:i}}).__params__=["value"],e)};(x["kha.graphics4.TessellationControlShader"]=Me).__name__=!0,Me.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Me};function Oe(t,e){this.shader=Krom.createTessellationEvaluationShader(t[0].bytes.b.bufferValue,e[0])}(x["kha.graphics4.TessellationEvaluationShader"]=Oe).__name__=!0,Oe.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Oe};function Ve(){}(x["kha.graphics4.TextureUnit"]=Ve).__name__=!0,Ve.__isInterface__=!0;var De=function(t,e,i,n,s){null==s&&(s=!1),null==n&&(n=0),this.vertexCount=t,this.structure=e,this.buffer=Krom.createVertexBuffer(t,e.elements,i,n)};(x["kha.graphics4.VertexBuffer"]=De).__name__=!0,De.prototype={buffer:null,_data:null,vertexCount:null,structure:null,delete:function(){Krom.deleteVertexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},lockInt16:function(t,e){return new Int16Array(this.lock(t,e).buffer)},unlock:function(t){Krom.unlockVertexBuffer(this.buffer)},stride:function(){return this.structure.byteSize()},count:function(){return this.vertexCount},set:function(t){return Krom.setVertexBuffer(this.buffer),0},__class__:De};function Ue(t,e){this.name=t,this.data=e}(x["kha.graphics4.VertexElement"]=Ue).__name__=!0,Ue.prototype={name:null,data:null,__class__:Ue};var He=function(t,e){null!=t&&(this.shader=Krom.createVertexShader(t[0].bytes.b.bufferValue,e[0]))};(x["kha.graphics4.VertexShader"]=He).__name__=!0,He.fromSource=function(t){var e=new He(null,null);return e.shader=Krom.createVertexShaderFromSource(t),e},He.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:He};var We=function(){this.elements=[],this.instanced=!1};(x["kha.graphics4.VertexStructure"]=We).__name__=!0,We.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new Ue(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,i=this.elements.length;e<i;){var n=e++;t+=this.dataByteSize(this.elements[n].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64;case 5:return 4;case 6:return 8}},get:function(t){return this.elements[t]},__class__:We};var Ge=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Ge.instances[t]=this};(x["kha.input.Gamepad"]=Ge).__name__=!0,Ge.get=function(t){return null==t&&(t=0),t>=Ge.instances.length?null:Ge.instances[t]},Ge.notifyOnConnect=function(t,e){null!=t&&Ge.connectListeners.push(t),null!=e&&Ge.disconnectListeners.push(e)},Ge.removeConnect=function(t,e){null!=t&&me.remove(Ge.connectListeners,t),null!=e&&me.remove(Ge.disconnectListeners,e)},Ge.sendConnectEvent=function(t){Ge.instances[t].connected=!0;for(var e=0,i=Ge.connectListeners;e<i.length;){var n=i[e];++e,n(t)}},Ge.sendDisconnectEvent=function(t){Ge.instances[t].connected=!1;for(var e=0,i=Ge.disconnectListeners;e<i.length;){var n=i[e];++e,n(t)}},Ge.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},remove:function(t,e){null!=t&&me.remove(this.axisListeners,t),null!=e&&me.remove(this.buttonListeners,e)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return Y.getGamepadId(this.index)},sendAxisEvent:function(t,e){for(var i=0,n=this.axisListeners;i<n.length;){var s=n[i];++i,s(t,e)}},sendButtonEvent:function(t,e){for(var i=0,n=this.buttonListeners;i<n.length;){var s=n[i];++i,s(t,e)}},__class__:Ge,__properties__:{get_id:"get_id"}};function ze(){this.__id=ci.nextId++,this._inputBuffer=new xe(new ArrayBuffer(1))}var Xe=f["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:i},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:i},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:i},Custom:((e=function(t){return{_hx_index:3,func:t,__enum__:"kha.input.BlockInterventions",toString:i}}).__params__=["func"],e)};(x["kha.netsync.Controller"]=ze).__name__=!0,ze.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(t){},__class__:ze};var Ye=t.kha.input.Keyboard=function(){ze.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Ye.instance=this};(x["kha.input.Keyboard"]=Ye).__name__=!0,Ye.get=function(t){return null==t&&(t=0),Y.getKeyboard(t)},Ye.disableSystemInterventions=function(t){Ye.keyBehavior=t},Ye.__super__=ze,Ye.prototype=s(ze.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},remove:function(t,e,i){null!=t&&me.remove(this.downListeners,t),null!=e&&me.remove(this.upListeners,e),null!=i&&me.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){for(var e=0,i=this.downListeners;e<i.length;){var n=i[e];++e,n(t)}},sendUpEvent:function(t){for(var e=0,i=this.upListeners;e<i.length;){var n=i[e];++e,n(t)}},sendPressEvent:function(t){for(var e=0,i=this.pressListeners;e<i.length;){var n=i[e];++e,n(t)}},_receive:function(t){},__class__:Ye});var Ke=t.kha.input.Mouse=function(){ze.call(this),Ke.instance=this};(x["kha.input.Mouse"]=Ke).__name__=!0,Ke.get=function(t){return null==t&&(t=0),Y.getMouse(t)},Ke.__super__=ze,Ke.prototype=s(ze.prototype,{notify:function(t,e,i,n,s){this.notifyWindowed(0,t,e,i,n,s)},remove:function(t,e,i,n,s){this.removeWindowed(0,t,e,i,n,s)},notifyWindowed:function(t,e,i,n,s,r){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}if(null!=s){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(s)}if(null!=r){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(r)}},removeWindowed:function(t,e,i,n,s,r){null!=e&&(null!=this.windowDownListeners?t<this.windowDownListeners.length?me.remove(this.windowDownListeners[t],e):L.trace('no downListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?t<this.windowUpListeners.length?me.remove(this.windowUpListeners[t],i):L.trace('no upListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowMoveListeners?t<this.windowMoveListeners.length?me.remove(this.windowMoveListeners[t],n):L.trace('no moveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowWheelListeners?t<this.windowWheelListeners.length?me.remove(this.windowWheelListeners[t],s):L.trace('no wheelListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowLeaveListeners?t<this.windowLeaveListeners.length?me.remove(this.windowLeaveListeners[t],r):L.trace('no leaveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(t,e){},removeFromLockChange:function(t,e){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=this.windowLeaveListeners)for(var e=0,i=this.windowLeaveListeners[t];e<i.length;){var n=i[e];++e,n()}},sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var s=0,r=this.windowDownListeners[t];s<r.length;){var a=r[s];++s,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var s=0,r=this.windowUpListeners[t];s<r.length;){var a=r[s];++s,a(e,i,n)}},sendMoveEvent:function(t,e,i,n,s){if(null!=this.windowMoveListeners)for(var r=0,a=this.windowMoveListeners[t];r<a.length;){var o=a[r];++r,o(e,i,n,s)}},sendWheelEvent:function(t,e){if(null!=this.windowWheelListeners)for(var i=0,n=this.windowWheelListeners[t];i<n.length;){var s=n[i];++i,s(e)}},_receive:function(t){},__class__:Ke});var Qe=function(){Ke.call(this)};(x["kha.input.MouseImpl"]=Qe).__name__=!0,Qe.__super__=Ke,Qe.prototype=s(Ke.prototype,{lock:function(){Y.lockMouse()},unlock:function(){Y.unlockMouse()},canLock:function(){return Y.canLockMouse()},isLocked:function(){return Y.isMouseLocked()},notifyOnLockChange:function(t,e){Y.notifyOfMouseLockChange(t,e)},removeFromLockChange:function(t,e){Y.removeFromMouseLockChange(t,e)},hideSystemCursor:function(){Y.hideSystemCursor()},showSystemCursor:function(){Y.showSystemCursor()},_receive:function(t){},__class__:Qe});var qe=function(){qe.instance=this};(x["kha.input.Pen"]=qe).__name__=!0,qe.get=function(t){return null==t&&(t=0),Y.getPen(t)},qe.prototype={notify:function(t,e,i){this.notifyWindowed(0,t,e,i)},remove:function(t,e,i){this.removeWindowed(0,t,e,i)},notifyWindowed:function(t,e,i,n){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}},removeWindowed:function(t,e,i,n){null!=e&&null!=this.windowDownListeners&&t<this.windowDownListeners.length&&me.remove(this.windowDownListeners[t],e),null!=i&&null!=this.windowUpListeners&&t<this.windowUpListeners.length&&me.remove(this.windowUpListeners[t],i),null!=n&&null!=this.windowMoveListeners&&t<this.windowMoveListeners.length&&me.remove(this.windowMoveListeners[t],n)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var s=0,r=this.windowDownListeners[t];s<r.length;){var a=r[s];++s,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var s=0,r=this.windowUpListeners[t];s<r.length;){var a=r[s];++s,a(e,i,n)}},sendMoveEvent:function(t,e,i,n){if(null!=this.windowMoveListeners)for(var s=0,r=this.windowMoveListeners[t];s<r.length;){var a=r[s];++s,a(e,i,n)}},__class__:qe};var je=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],je.instance=this};(x["kha.input.Surface"]=je).__name__=!0,je.get=function(t){return null==t&&(t=0),0!=t?null:je.instance},je.prototype={notify:function(t,e,i){null!=t&&this.touchStartListeners.push(t),null!=e&&this.touchEndListeners.push(e),null!=i&&this.moveListeners.push(i)},remove:function(t,e,i){null!=t&&me.remove(this.touchStartListeners,t),null!=e&&me.remove(this.touchEndListeners,e),null!=i&&me.remove(this.moveListeners,i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,i){for(var n=0,s=this.touchStartListeners;n<s.length;){var r=s[n];++n,r(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var n=0,s=this.touchEndListeners;n<s.length;){var r=s[n];++n,r(t,e,i)}},sendMoveEvent:function(t,e,i){for(var n=0,s=this.moveListeners;n<s.length;){var r=s[n];++n,r(t,e,i)}},__class__:je};var Ze=function(t){this.bytes=t};(x["kha.internal.BytesBlob"]=Ze).__name__=!0,Ze.__interfaces__=[P],Ze.fromBytes=function(t){return new Ze(t)},Ze.alloc=function(t){return new Ze(new xe(new ArrayBuffer(t)))},Ze.readF32=function(t){var e=0==(-2147483648&t)?1:-1,i=t>>23&255,n=8388607&t;switch(i){case 0:return 0;case 255:return 0!=n?NaN:0<e?1/0:-1/0;default:return(8388608+n)/8388608*e*Math.pow(2,i-127)}},Ze.bit=function(t,e){if(1==(t>>>e&1)){return!0}return!1},Ze.toText=function(t,e){for(var i="",n=0,s=e;n<s;){var r=n++;i+=String.fromCodePoint(t[r])}return i},Ze.prototype={bytes:null,sub:function(t,e){return new Ze(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=e},readU8:function(t){var e=this.bytes.b[t];return++t,e},readS8:function(t){var e=this.bytes.b[t];return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*e+i},readU16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*i+e},readU32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],s=this.bytes.b[t+3];return t+=4,e+256*i+256*n*256+256*s*256*256},readU32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],s=this.bytes.b[t+3];return t+=4,s+256*n+256*i*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];t+=2;var n=0==(128&e)?1:-1;return e&=127,-1==n?256*e-32767+i:256*e+i},readS16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=0==(128&i)?1:-1;return i&=127,t+=2,-1==n?256*i-32767+e:256*i+e},readS32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],s=this.bytes.b[t+3],r=0==(128&s)?1:-1;return s&=127,t+=4,-1==r?-2147483647+e+256*i+256*n*256+256*s*256*256:e+256*i+256*n*256+256*s*256*256},readS32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],s=this.bytes.b[t+3],r=0==(128&e)?1:-1;return e&=127,t+=4,-1==r?-2147483647+s+256*n+256*i*256+256*e*256*256:s+256*n+256*i*256+256*e*256*256},readF32LE:function(t){return Ze.readF32(this.readS32LE(t))},readF32BE:function(t){return Ze.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8String:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:Ze,__properties__:{get_length:"get_length"}};var Je=function(t){this.renderTarget=t};(x["kha.krom.Graphics"]=Je).__name__=!0,Je.__interfaces__=[fe],Je.prototype={renderTarget:null,begin:function(t){Krom.begin(this.renderTarget,t)},beginFace:function(t){Krom.beginFace(this.renderTarget,t)},beginEye:function(t){},end:function(){Krom.end()},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(t,e,i){var n=0;null!=t&&(n|=1),null!=e&&(n|=2),null!=i&&(n|=4),Krom.clear(n,null==t?0:t,e,i)},viewport:function(t,e,i,n){Krom.viewport(t,e,i,n)},setVertexBuffer:function(t){t.set(0)},setVertexBuffers:function(t){Krom.setVertexBuffers(t)},setIndexBuffer:function(t){t.set()},setCubeMap:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setCubeMapDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTexture:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setTextureDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTextureArray:function(t,e){},setVideoTexture:function(t,e){},setImageTexture:function(t,e){null!=e&&Krom.setImageTexture(t,e.texture_)},setTextureParameters:function(t,e,i,n,s,r){Krom.setTextureParameters(t,e,i,n,s,r)},setTexture3DParameters:function(t,e,i,n,s,r,a){Krom.setTexture3DParameters(t,e,i,n,s,r,a)},setTextureCompareMode:function(t,e){Krom.setTextureCompareMode(t,e)},setCubeMapCompareMode:function(t,e){Krom.setCubeMapCompareMode(t,e)},setPipeline:function(t){t.set()},setStencilReferenceValue:function(t){},setBool:function(t,e){Krom.setBool(t,e)},setInt:function(t,e){Krom.setInt(t,e)},setInt2:function(t,e,i){},setInt3:function(t,e,i,n){},setInt4:function(t,e,i,n,s){},setInts:function(t,e){},setFloat:function(t,e){Krom.setFloat(t,e)},setFloat2:function(t,e,i){Krom.setFloat2(t,e,i)},setFloat3:function(t,e,i,n){Krom.setFloat3(t,e,i,n)},setFloat4:function(t,e,i,n,s){Krom.setFloat4(t,e,i,n,s)},setFloats:function(t,e){Krom.setFloats(t,e.buffer)},setVector2:function(t,e){Krom.setFloat2(t,e.x,e.y)},setVector3:function(t,e){Krom.setFloat3(t,e.x,e.y,e.z)},setVector4:function(t,e){Krom.setFloat4(t,e.x,e.y,e.z,e.w)},setMatrix:function(t,e){Je.mat[0]=e._00,Je.mat[1]=e._01,Je.mat[2]=e._02,Je.mat[3]=e._03,Je.mat[4]=e._10,Je.mat[5]=e._11,Je.mat[6]=e._12,Je.mat[7]=e._13,Je.mat[8]=e._20,Je.mat[9]=e._21,Je.mat[10]=e._22,Je.mat[11]=e._23,Je.mat[12]=e._30,Je.mat[13]=e._31,Je.mat[14]=e._32,Je.mat[15]=e._33,Krom.setMatrix(t,Je.mat.buffer)},setMatrix3:function(t,e){Je.mat[0]=e._00,Je.mat[1]=e._01,Je.mat[2]=e._02,Je.mat[3]=e._10,Je.mat[4]=e._11,Je.mat[5]=e._12,Je.mat[6]=e._20,Je.mat[7]=e._21,Je.mat[8]=e._22,Krom.setMatrix3(t,Je.mat.buffer)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0),Krom.drawIndexedVertices(t,e)},drawIndexedVerticesInstanced:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),Krom.drawIndexedVerticesInstanced(t,e,i)},instancedRenderingAvailable:function(){return!0},scissor:function(t,e,i,n){Krom.scissor(t,e,i,n)},disableScissor:function(){Krom.disableScissor()},__class__:Je};var $e=function(t){z.call(this),this.sampleRate=44100;var e=t.length/4|0,i=new Float32Array(e);this.uncompressedData=i;for(var n=0,s=e;n<s;){var r=n++;this.uncompressedData[r]=t.getFloat(4*r)}this.compressedData=null};(x["kha.krom.Sound"]=$e).__name__=!0,$e.__super__=z,$e.prototype=s(z.prototype,{uncompress:function(t){t()},unload:function(){z.prototype.unload.call(this)},__class__:$e});var ti=function(t,e,i,n,s,r,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=s,this._21=r,this._02=a,this._12=o,this._22=l};(x["kha.math.FastMatrix3"]=ti).__name__=!0,ti.fromMatrix3=function(t){return new ti(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},ti.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:ti};var ei=function(t,e,i,n,s,r,a,o,l,u,h,c,A,d,_,f){this._00=t,this._10=e,this._20=i,this._30=n,this._01=s,this._11=r,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=c,this._03=A,this._13=d,this._23=_,this._33=f};(x["kha.math.FastMatrix4"]=ei).__name__=!0,ei.fromMatrix4=function(t){return new ei(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ei.orthogonalProjection=function(t,e,i,n,s,r){return new ei(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},ei.perspectiveProjection=function(t,e,i,n){var s=1/Math.tan(t/2);return new ei(s/e,0,0,0,0,s,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ei.lookAt=function(t,e,i){var n=e.x-t.x,s=e.y-t.y,r=e.z-t.z;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,o=s,l=r;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,c=l,A=Math.sqrt(u*u+h*h+c*c);if(0!=A){var d=1/A;u*=d,h*=d,c*=d}var _=h*i.z-c*i.y,f=c*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==f&&(f=0),null==_&&(_=0);var p=_,m=f,v=g;null==v&&(v=0),null==m&&(m=0),null==p&&(p=0);var w=p,b=m,y=v,x=Math.sqrt(w*w+b*b+y*y);if(0!=x){var T=1/x;w*=T,b*=T,y*=T}var S=b*c-y*h,E=y*u-w*c,B=w*h-b*u;null==B&&(B=0),null==E&&(E=0),null==S&&(S=0);return new ei(w,b,y,-(w*t.x+b*t.y+y*t.z),S,E,B,-(S*t.x+E*t.y+B*t.z),-u,-h,-c,u*t.x+h*t.y+c*t.z,0,0,0,1)},ei.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ei};function ii(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e}(x["kha.math.FastVector2"]=ii).__name__=!0,ii.fromVector2=function(t){return new ii(t.x,t.y)},ii.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:ii,__properties__:{set_length:"set_length",get_length:"get_length"}};function ni(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(x["kha.math.FastVector3"]=ni).__name__=!0,ni.fromVector3=function(t){return new ni(t.x,t.y,t.z)},ni.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:ni,__properties__:{set_length:"set_length",get_length:"get_length"}};function si(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(x["kha.math.FastVector4"]=si).__name__=!0,si.fromVector4=function(t){return new si(t.x,t.y,t.z,t.w)},si.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:si,__properties__:{set_length:"set_length",get_length:"get_length"}};function ri(t,e,i,n,s,r,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=s,this._21=r,this._02=a,this._12=o,this._22=l}(x["kha.math.Matrix3"]=ri).__name__=!0,ri.fromFastMatrix3=function(t){return new ri(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},ri.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:ri};function ai(t,e,i,n,s,r,a,o,l,u,h,c,A,d,_,f){this._00=t,this._10=e,this._20=i,this._30=n,this._01=s,this._11=r,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=c,this._03=A,this._13=d,this._23=_,this._33=f}(x["kha.math.Matrix4"]=ai).__name__=!0,ai.fromFastMatrix4=function(t){return new ai(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ai.orthogonalProjection=function(t,e,i,n,s,r){return new ai(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},ai.perspectiveProjection=function(t,e,i,n){var s=1/Math.tan(t/2);return new ai(s/e,0,0,0,0,s,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ai.lookAt=function(t,e,i){var n=e.x-t.x,s=e.y-t.y,r=e.z-t.z;null==r&&(r=0),null==s&&(s=0),null==n&&(n=0);var a=n,o=s,l=r;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,c=l,A=Math.sqrt(u*u+h*h+c*c);if(0!=A){var d=1/A;u*=d,h*=d,c*=d}var _=h*i.z-c*i.y,f=c*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==f&&(f=0),null==_&&(_=0);var p=_,m=f,v=g;null==v&&(v=0),null==m&&(m=0),null==p&&(p=0);var w=p,b=m,y=v,x=Math.sqrt(w*w+b*b+y*y);if(0!=x){var T=1/x;w*=T,b*=T,y*=T}var S=b*c-y*h,E=y*u-w*c,B=w*h-b*u;null==B&&(B=0),null==E&&(E=0),null==S&&(S=0);return new ai(w,b,y,-(w*t.x+b*t.y+y*t.z),S,E,B,-(S*t.x+E*t.y+B*t.z),-u,-h,-c,u*t.x+h*t.y+c*t.z,0,0,0,1)},ai.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ai};var oi=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(x["kha.math.Vector2"]=oi).__name__=!0,oi.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:oi,__properties__:{set_length:"set_length",get_length:"get_length"}};function li(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(x["kha.math.Vector3"]=li).__name__=!0,li.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},__class__:li,__properties__:{set_length:"set_length",get_length:"get_length"}};function ui(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(x["kha.math.Vector4"]=ui).__name__=!0,ui.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},__class__:ui,__properties__:{set_length:"set_length",get_length:"get_length"}};function hi(){}(x["kha.netsync.Client"]=hi).__name__=!0,hi.__isInterface__=!0,hi.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:hi,__properties__:{get_id:"get_id"}};var ci=function(){};(x["kha.netsync.ControllerBuilder"]=ci).__name__=!0;function Ai(){}(x["kha.netsync.Entity"]=Ai).__name__=!0,Ai.__isInterface__=!0,Ai.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:Ai};function di(t){this.myId=t}(x["kha.netsync.LocalClient"]=di).__name__=!0,di.__interfaces__=[hi],di.prototype={myId:null,send:function(t,e){},receive:function(t){},onClose:function(t){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:di,__properties__:{get_id:"get_id",get_controllers:"get_controllers"}};function _i(t,e){this.time=t,this.data=e}(x["kha.netsync.State"]=_i).__name__=!0,_i.prototype={time:null,data:null,__class__:_i};var fi=function(t,e,i){this.ping=1,this.currentPlayers=0,this.controllers=new $,this.entities=new $,(fi.instance=this).maxPlayers=t,this.address=e,this.port=i};(x["kha.netsync.Session"]=fi).__name__=!0,fi.the=function(){return fi.instance},fi.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(t){var e=this.entities,i=t._id();e.h[i]=t},addController:function(t){L.trace("Adding controller id "+t._id(),{fileName:"kha/netsync/Session.hx",lineNumber:88,className:"kha.netsync.Session",methodName:"addController"}),t._inputBufferIndex=0;var e=this.controllers,i=t._id();e.h[i]=t},sendControllerUpdate:function(t,e){if(this.controllers.h.hasOwnProperty(t)){if(this.controllers.h[t]._inputBuffer.length<this.controllers.h[t]._inputBufferIndex+4+e.length){var i=new xe(new ArrayBuffer(this.controllers.h[t]._inputBufferIndex+4+e.length));i.blit(0,this.controllers.h[t]._inputBuffer,0,this.controllers.h[t]._inputBufferIndex),this.controllers.h[t]._inputBuffer=i}this.controllers.h[t]._inputBuffer.setInt32(this.controllers.h[t]._inputBufferIndex,e.length),this.controllers.h[t]._inputBuffer.blit(this.controllers.h[t]._inputBufferIndex+4,e,0,e.length),this.controllers.h[t]._inputBufferIndex+=4+e.length}},sendPing:function(){var t=new xe(new ArrayBuffer(5));t.b[0]=4,t.setFloat(1,W.realTime()),this.sendToServer(t)},sendPlayerUpdate:function(){},receive:function(t,e){switch(t.b[0]){case 0:var i=t.b[1];this.localClient=new di(i),W.resetTime(),this.startCallback();break;case 1:for(var n=t.getDouble(1),s=9,r=this.entities.iterator();r.hasNext();){var a=r.next();a._receive(s,t),s+=a._size()}W.warp(n);break;case 3:switch(t.b[1]){case 0:break;case 1:this.executeRPC(t)}break;case 4:var o=t.getFloat(1);this.ping=W.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=t.getInt32(1)}},executeRPC:function(t){var e=[],i=t.getInt32(2),n=6,s=t.getUInt16(n);n+=2;for(var r="",a=0,o=s;a<o;){a++;var l=t.b[n];r+=String.fromCodePoint(l),++n}var u=t.getUInt16(n);n+=2;for(var h="",c=0,A=u;c<A;){c++;var d=t.b[n];h+=String.fromCodePoint(d),++n}for(;n<t.length;){var _=t.b[n];switch(++n,_){case 66:var f=1==t.b[n];++n,L.trace("Bool: "+(null==f?"null":""+f),{fileName:"kha/netsync/Session.hx",lineNumber:295,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(f);break;case 70:var g=t.getDouble(n);n+=8,L.trace("Float: "+g,{fileName:"kha/netsync/Session.hx",lineNumber:300,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(g);break;case 73:var p=t.getInt32(n);n+=4,L.trace("Int: "+p,{fileName:"kha/netsync/Session.hx",lineNumber:305,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(p);break;case 83:var m=t.getUInt16(n);n+=2;for(var v="",w=0,b=m;w<b;){w++;var y=t.b[n];v+=String.fromCodePoint(y),++n}L.trace("String: "+v,{fileName:"kha/netsync/Session.hx",lineNumber:315,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(v);break;default:L.trace("Unknown argument type.",{fileName:"kha/netsync/Session.hx",lineNumber:318,className:"kha.netsync.Session",methodName:"executeRPC"})}}-1==i?we.field(x[r],h+"_remotely").apply(null,e):we.field(gi.objects[i],h+"_remotely").apply(gi.objects[i],e)},waitForStart:function(t,e,i,n,s){var r=this;this.startCallback=t,this.refusedCallback=e,this.resetCallback=s,this.network=new kha.netsync.Network(this.address,this.port,i,function(){n(),r.reset()}),this.network.listen(function(t){r.receive(t)}),this.updateTaskId=W.addFrameTask(Si(this,this.update),0),this.ping=1,this.pingTaskId=W.addTimeTask(Si(this,this.sendPing),0,1)},reset:function(){W.removeFrameTask(this.updateTaskId),W.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new $,this.entities=new $,this.resetCallback()},update:function(){for(var t=this.controllers.iterator();t.hasNext();){var e=t.next();if(0<e._inputBufferIndex){var i=new xe(new ArrayBuffer(22+e._inputBufferIndex));i.b[0]=2,i.setInt32(1,e._id()),i.setDouble(5,W.time()),i.setInt32(13,Ee.windowWidth(0)),i.setInt32(17,Ee.windowHeight(0)),i.b[21]=0,i.blit(22,e._inputBuffer,0,e._inputBufferIndex),this.sendToServer(i),e._inputBufferIndex=0}}},sendToServer:function(t){this.network.send(t,!1)},__class__:fi,__properties__:{get_me:"get_me"}};var gi=function(){};(x["kha.netsync.SyncBuilder"]=gi).__name__=!0;function pi(t,e,i,n){this._0=t,this._1=e,this._2=i,this._3=n}(x["kha.simd.Float32x4"]=pi).__name__=!0,pi.create=function(){return new pi(0,0,0,0)},pi.loadAllFast=function(t){return new pi(t,t,t,t)},pi.load=function(t,e,i,n){return new pi(t,e,i,n)},pi.loadFast=function(t,e,i,n){return new pi(t,e,i,n)},pi.get=function(t,e){var i=0;switch(e){case 0:i=t._0;break;case 1:i=t._1;break;case 2:i=t._2;break;case 3:i=t._3}return i},pi.getFast=function(t,e){switch(e){case 0:return t._0;case 1:return t._1;case 2:return t._2;case 3:return t._3}return 0},pi.abs=function(t){return new pi(Math.abs(t._0),Math.abs(t._1),Math.abs(t._2),Math.abs(t._3))},pi.add=function(t,e){return new pi(t._0+e._0,t._1+e._1,t._2+e._2,t._3+e._3)},pi.div=function(t,e){return new pi(t._0/e._0,t._1/e._1,t._2/e._2,t._3/e._3)},pi.mul=function(t,e){return new pi(t._0*e._0,t._1*e._1,t._2*e._2,t._3*e._3)},pi.neg=function(t){return new pi(-t._0,-t._1,-t._2,-t._3)},pi.reciprocalApproximation=function(t){return new pi(0,0,0,0)},pi.reciprocalSqrtApproximation=function(t){return new pi(0,0,0,0)},pi.sub=function(t,e){return new pi(t._0-e._0,t._1-e._1,t._2-e._2,t._3-e._3)},pi.sqrt=function(t){return new pi(Math.sqrt(t._0),Math.sqrt(t._1),Math.sqrt(t._2),Math.sqrt(t._3))},pi.prototype={_0:null,_1:null,_2:null,_3:null,__class__:pi};var mi=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(x["zui.Handle"]=mi).__name__=!0,mi.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){null==this.children&&(this.children=new $);var i=this.children.h[t];return null==i&&(i=new mi(e),this.children.h[t]=i),i},unnest:function(t){null!=this.children&&this.children.remove(t)},__class__:mi};var vi=function(){};(x["zui.Canvas"]=vi).__name__=!0,vi.draw=function(t,e,i){vi.screenW=Ee.windowWidth(),vi.screenH=Ee.windowHeight(),vi.events=[],vi._ui=t,i.end(),t.begin(i),i.begin(!1),t.g=i;for(var n=0,s=e.elements;n<s.length;){var r=s[n];++n,null==r.parent&&vi.drawElement(t,e,r)}return i.end(),t.end(),i.begin(!1),vi.events},vi.drawElement=function(t,e,i,n,s){if(null==s&&(s=0),null==n&&(n=0),null!=i&&0!=i.visible){var r=e.width*vi._ui.ops.scaleFactor|0,a=e.height*vi._ui.ops.scaleFactor|0;switch(i.anchor){case 1:n-=(r-vi.screenW)/2;break;case 2:n-=r-vi.screenW;break;case 3:s-=(a-vi.screenH)/2;break;case 4:n-=(r-vi.screenW)/2,s-=(a-vi.screenH)/2;break;case 5:n-=r-vi.screenW,s-=(a-vi.screenH)/2;break;case 6:s-=a-vi.screenH;break;case 7:n-=(r-vi.screenW)/2,s-=a-vi.screenH;break;case 8:n-=r-vi.screenW,s-=a-vi.screenH}t._x=e.x+(i.x*vi._ui.ops.scaleFactor|0)+(n*vi._ui.ops.scaleFactor|0),t._y=e.y+(i.y*vi._ui.ops.scaleFactor|0)+(s*vi._ui.ops.scaleFactor|0),t._w=i.width*vi._ui.ops.scaleFactor|0;var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+(i.width*vi._ui.ops.scaleFactor|0)/2,t._y+(i.height*vi._ui.ops.scaleFactor|0)/2),i.type){case 0:var l=t.ops.font,u=t.fontSize;null!=i.asset&&ye.endsWith(i.asset,".ttf")&&(t.ops.font=vi.getAsset(e,i.asset)),t.fontSize=i.height*vi._ui.ops.scaleFactor|0;var h=i.color_text,c=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=h?h:c,t.text(i.text,i.alignment),t.ops.font=l,t.fontSize=u;break;case 1:var A=vi.getAsset(e,i.asset),d=null!=i.asset&&ye.endsWith(i.asset,".ttf");if(null!=A&&!d){t.imageScrollAlign=!1;var _=null!=i.color?i.color:-1;if(3==t.image(A,_,i.height*vi._ui.ops.scaleFactor|0)){var f=i.event;null!=f&&""!=f&&vi.events.push(f)}t.imageScrollAlign=!0}break;case 2:var g=t.t.ELEMENT_H,p=t.t.BUTTON_H;t.t.ELEMENT_H=i.height*vi._ui.ops.scaleFactor|0,t.t.BUTTON_H=i.height*vi._ui.ops.scaleFactor|0;var m=i.color,v=vi.getTheme(e.theme).BUTTON_COL;t.t.BUTTON_COL=null!=m?m:v;var w=i.color_text,b=vi.getTheme(e.theme).BUTTON_TEXT_COL;t.t.BUTTON_TEXT_COL=null!=w?w:b;var y=i.color_hover,x=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.BUTTON_HOVER_COL=null!=y?y:x;var T=i.color_press,S=vi.getTheme(e.theme).BUTTON_PRESSED_COL;if(t.t.BUTTON_PRESSED_COL=null!=T?T:S,t.button(i.text,i.alignment)){var E=i.event;null!=E&&""!=E&&vi.events.push(E)}t.t.ELEMENT_H=g,t.t.BUTTON_H=p;break;case 3:break;case 6:var B=i.color_text,k=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=B?B:k;var I=i.color,C=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=I?I:C;var L=i.color_hover,N=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=L?L:N,t.check(vi.h.nest(i.id),i.text);break;case 7:var F=i.color_text,P=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=F?F:P;var M=i.color,R=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=M?M:R;var O=i.color_hover,V=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=O?O:V,wi.inlineRadio(t,vi.h.nest(i.id),i.text.split(";"));break;case 8:var D=i.color_text,U=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=D?D:U;var H=i.color_text,W=vi.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=H?H:W;var G=i.color,z=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=G?G:z;var X=i.color,Y=vi.getTheme(e.theme).BUTTON_COL;t.t.SEPARATOR_COL=null!=X?X:Y;var K=i.color_hover,Q=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=K?K:Q,t.combo(vi.h.nest(i.id),i.text.split(";"));break;case 9:var q=i.color_text,j=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=q?q:j;var Z=i.color_text,J=vi.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=Z?Z:J;var $=i.color,tt=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=$?$:tt;var et=i.color_hover,it=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=et?et:it,t.slider(vi.h.nest(i.id),i.text,0,1,!0,100,!0,i.alignment);break;case 10:var nt=i.color_text,st=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=nt?nt:st;var rt=i.color_text,at=vi.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=rt?rt:at;var ot=i.color,lt=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=ot?ot:lt;var ut=i.color_hover,ht=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=ut?ut:ht,t.textInput(vi.h.nest(i.id),i.text,i.alignment);break;case 11:var ct=i.color_text,At=vi.getTheme(e.theme).TEXT_COL;t.t.TEXT_COL=null!=ct?ct:At;var dt=i.color_text,_t=vi.getTheme(e.theme).TEXT_COL;t.t.LABEL_COL=null!=dt?dt:_t;var ft=i.color,gt=vi.getTheme(e.theme).BUTTON_COL;t.t.ACCENT_COL=null!=ft?ft:gt;var pt=i.color_hover,mt=vi.getTheme(e.theme).BUTTON_HOVER_COL;t.t.ACCENT_HOVER_COL=null!=pt?pt:mt,wi.keyInput(t,vi.h.nest(i.id),i.text);break;case 12:var vt=t.g.get_color(),wt=t.g,bt=i.color,yt=vi.getTheme(e.theme).BUTTON_COL;wt.set_color(null!=bt?bt:yt),t.g.fillRect(t._x,t._y,t._w,i.height*vi._ui.ops.scaleFactor|0),t.g.set_color(vt);break;case 13:var xt=t.g.get_color(),Tt=t.g,St=i.color,Et=vi.getTheme(e.theme).BUTTON_COL;Tt.set_color(null!=St?St:Et),t.g.drawRect(t._x,t._y,t._w,i.height*vi._ui.ops.scaleFactor|0,i.strength),t.g.set_color(xt);break;case 14:var Bt=t.g.get_color(),kt=t.g,It=i.color,Ct=vi.getTheme(e.theme).BUTTON_COL;kt.set_color(null!=It?It:Ct),Be.fillCircle(t.g,t._x+(i.width*vi._ui.ops.scaleFactor|0)/2,t._y+(i.height*vi._ui.ops.scaleFactor|0)/2,t._w/2),t.g.set_color(Bt);break;case 15:var Lt=t.g.get_color(),Nt=t.g,Ft=i.color,Pt=vi.getTheme(e.theme).BUTTON_COL;Nt.set_color(null!=Ft?Ft:Pt),Be.drawCircle(t.g,t._x+(i.width*vi._ui.ops.scaleFactor|0)/2,t._y+(i.height*vi._ui.ops.scaleFactor|0)/2,t._w/2,i.strength),t.g.set_color(Lt);break;case 16:var Mt=t.g.get_color(),Rt=t.g,Ot=i.color,Vt=vi.getTheme(e.theme).BUTTON_COL;Rt.set_color(null!=Ot?Ot:Vt),t.g.fillTriangle(t._x+t._w/2,t._y,t._x,t._y+(i.height*vi._ui.ops.scaleFactor|0),t._x+t._w,t._y+(i.height*vi._ui.ops.scaleFactor|0)),t.g.set_color(Mt);break;case 17:var Dt=t.g.get_color(),Ut=t.g,Ht=i.color,Wt=vi.getTheme(e.theme).BUTTON_COL;Ut.set_color(null!=Ht?Ht:Wt),t.g.drawLine(t._x+t._w/2,t._y,t._x,t._y+(i.height*vi._ui.ops.scaleFactor|0),i.strength),t.g.drawLine(t._x,t._y+(i.height*vi._ui.ops.scaleFactor|0),t._x+t._w,t._y+(i.height*vi._ui.ops.scaleFactor|0),i.strength),t.g.drawLine(t._x+t._w,t._y+(i.height*vi._ui.ops.scaleFactor|0),t._x+t._w/2,t._y,i.strength),t.g.set_color(Dt);break;case 18:var Gt=t.g.get_color(),zt=i.progress_at,Xt=i.progress_total,Yt=t.g,Kt=i.color_progress,Qt=vi.getTheme(e.theme).TEXT_COL;Yt.set_color(null!=Kt?Kt:Qt),t.g.fillRect(t._x,t._y,t._w/Xt*Math.min(zt,Xt),i.height*vi._ui.ops.scaleFactor|0);var qt=t.g,jt=i.color,Zt=vi.getTheme(e.theme).BUTTON_COL;qt.set_color(null!=jt?jt:Zt),t.g.drawRect(t._x,t._y,t._w,i.height*vi._ui.ops.scaleFactor|0,i.strength),t.g.set_color(Gt);break;case 19:var Jt=t.g.get_color(),$t=i.progress_at,te=i.progress_total,ee=t.g,ie=i.color_progress,ne=vi.getTheme(e.theme).TEXT_COL;ee.set_color(null!=ie?ie:ne),Be.drawArc(t.g,t._x+(i.width*vi._ui.ops.scaleFactor|0)/2,t._y+(i.height*vi._ui.ops.scaleFactor|0)/2,t._w/2,-Math.PI/2,2*Math.PI/te*$t-Math.PI/2,i.strength);var se=t.g,re=i.color,ae=vi.getTheme(e.theme).BUTTON_COL;se.set_color(null!=re?re:ae),Be.fillCircle(t.g,t._x+(i.width*vi._ui.ops.scaleFactor|0)/2,t._y+(i.height*vi._ui.ops.scaleFactor|0)/2,t._w/2-10),t.g.set_color(Jt)}if(null!=i.children)for(var oe=0,le=i.children;oe<le.length;){var ue=le[oe];++oe,vi.drawElement(t,e,vi.elemById(e,ue),i.x+n,i.y+s)}o&&t.g.popTransformation()}},vi.getText=function(t,e){return e.text},vi.getAsset=function(t,e){for(var i=0,n=t.assets;i<n.length;){var s=n[i];if(++i,s.name==e)return vi.assetMap.h[s.id]}return null},vi.getElementId=function(t){if(-1==vi.elemId)for(var e=0,i=t.elements;e<i.length;){var n=i[e];++e,vi.elemId<n.id&&(vi.elemId=n.id)}return++vi.elemId},vi.getAssetId=function(t){if(-1==vi.assetId)for(var e=0,i=t.assets;e<i.length;){var n=i[e];++e,vi.assetId<n.id&&(vi.assetId=n.id)}return++vi.assetId},vi.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var s=n[i];if(++i,s.id==e)return s}return null},vi.scaled=function(t){return t*vi._ui.ops.scaleFactor|0},vi.getColor=function(t,e){return null!=t?t:e},vi.getTheme=function(t){for(var e=0,i=vi.themes;e<i.length;){var n=i[e];if(++e,n.NAME==t)return n}return null};var wi=function(){};(x["zui.Ext"]=wi).__name__=!0,wi.floatInput=function(t,e,i,n){null==n&&(n=0),null==i&&(i=""),e.text=null==e.value?"null":""+e.value;var s=t.textInput(e,i,n);return e.value=parseFloat(s),e.value},wi.keyInput=function(t,e,i,n){if(null==n&&(n=0),null==i&&(i=""),!t.isVisible(t.t.ELEMENT_H*t.ops.scaleFactor))return t.endElement(),0|e.value;var s=t.getHover();s&&null!=Ti.onTextHover&&Ti.onTextHover(),t.g.set_color(s?t.t.ACCENT_HOVER_COL:t.t.ACCENT_COL);var r=t.g,a=t.t.FILL_ACCENT_BG,o=t._x+t.buttonOffsetY,l=t._y+t.buttonOffsetY,u=t._w-2*t.buttonOffsetY,h=t.t.BUTTON_H*t.ops.scaleFactor,c=0;0==c&&(c=1),t.enabled||t.fadeColor(),a?r.fillRect(o,l-1,u,1+h):r.drawRect(o,l,u,h,c);var A=t.getReleased()||t.tabPressed;if(t.textSelectedHandle!=e&&A&&t.startTextEdit(e),t.textSelectedHandle==e?wi.listenToKey(t,e):e.changed=!1,""!=i){t.g.set_color(t.t.LABEL_COL);var d=2==n?0:2,_=0==d?7:0;t.drawString(t.g,i,_,0,d)}return e.text=wi.keycodeToString(0|e.value),t.g.set_color(t.t.TEXT_COL),t.textSelectedHandle!=e?t.drawString(t.g,e.text,null,0,n):t.drawString(t.g,t.textSelectedCurrentText,null,0,n),t.endElement(),0|e.value},wi.listenToKey=function(t,e){t.isKeyDown?(e.value=t.key,e.changed=t.changed=!0,t.textSelectedHandle=null,t.isTyping=!1,null!=Ye.get()&&Ye.get().hide()):t.textSelectedCurrentText="Press a key..."},wi.list=function(t,e,i,n){var s=0;null==n&&(n={});for(var r=null!=n.addCb?n.addCb:function(t){i.push(t)},a=null!=n.removeCb?n.removeCb:function(t){i.splice(t,1)},o=null!=n.getNameCb?n.getNameCb:function(t){return i[t]},l=null!=n.setNameCb?n.setNameCb:function(t,e){i[t]=e},u=null!=n.getLabelCb?n.getLabelCb:function(t){return""},h=n.itemDrawCb,c=null!=n.showRadio&&n.showRadio,A=null==n.editable||n.editable,d=null==n.showAdd||n.showAdd,_=null!=n.addLabel?n.addLabel:"Add",f=0;f<i.length;){c?(t.row([.12,.68,.2]),t.radio(e.nest(0),f,"")&&(s=f)):t.row([.8,.2]);var g=e.nest(f);g.text=o(f),A?l(f,t.textInput(g,u(f))):t.text(o(f)),t.button("X")?a(f):++f,null!=h&&h(g.nest(f),f-1)}return d&&t.button(_)&&r("untitled"),s},wi.panelList=function(t,e,i,n,s,r,a,o,l,u,h){null==h&&(h="Add"),null==u&&(u=!0),null==l&&(l=!0),null==n&&(n=function(t){i.push(t)}),null==s&&(s=function(t){i.splice(t,1)}),null==r&&(r=function(t){return i[t]}),null==a&&(a=function(t,e){i[t]=e});for(var c=0;c<i.length;){t.row([.12,.68,.2]);var A=t.panel(e.nest(c),""),d=e.nest(c);l?a(c,t.textInput(d,r(c))):t.text(r(c)),t.button("X")?s(c):++c,null!=o&&A&&o(d.nest(c),c-1)}u&&t.button(h)&&n("untitled")},wi.colorField=function(t,e,i){null==i&&(i=!1),t.g.set_color(e.color);var n=t.g,s=t._x+2,r=t._y,a=t._w-4,o=t.t.BUTTON_H*t.ops.scaleFactor,l=0;0==l&&(l=1),t.enabled||t.fadeColor(),n.fillRect(s,r-1,a,1+o),t.g.set_color(t.getHover()?t.t.ACCENT_HOVER_COL:t.t.ACCENT_COL);var u=t.g,h=t._x+2,c=t._y,A=t._w-4,d=t.t.BUTTON_H*t.ops.scaleFactor,_=1;return null==_&&(_=0),0==_&&(_=1),t.enabled||t.fadeColor(),u.drawRect(h,c,A,d,_),t.getStarted()&&yi.showCustom(new Ti(t.ops),function(t){wi.colorWheel(t,e,i)},0|t.inputX,0|t.inputY,200,500),t.endElement(),e.color},wi.colorPicker=function(t,e,i){null==i&&(i=!1);var n=t.slider(e.nest(0,{value:.00392156862745098*((16711680&e.color)>>>16)}),"R",0,1,!0),s=t.slider(e.nest(1,{value:.00392156862745098*((65280&e.color)>>>8)}),"G",0,1,!0),r=t.slider(e.nest(2,{value:.00392156862745098*(255&e.color)}),"B",0,1,!0),a=.00392156862745098*(e.color>>>24);i&&(a=t.slider(e.nest(3,{value:a}),"A",0,1,!0));var o=C.fromFloats(n,s,r,a);return t.text("",2,o),o},wi.initPath=function(t,e){t.text="Windows"==e?"C:\\Users":"/"},wi.fileBrowser=function(t,e,i){null==i&&(i=!1);var n="/",s="ls ",r=Ee.get_systemId();"Windows"==r&&(s="dir /b ",i&&(s+="/ad "),n="\\",e.text=ye.replace(e.text,"\\\\","\\"),e.text=ye.replace(e.text,"\r","")),""==e.text&&wi.initPath(e,r);var a=Krom.getFilesLocation()+n+wi.dataPath+"dir.txt";e.text!=wi.lastPath&&Krom.sysCommand(s+'"'+e.text+'" > "'+a+'"'),wi.lastPath=e.text;var o=xe.ofData(Krom.loadBlob(a)).toString().split("\n"),l=e.text.indexOf("/"),u=e.text.indexOf("\\"),h=-1<l&&e.text.length-1>l||-1<u&&e.text.length-1>u;e.changed=!1,h&&t.button("..",0)&&(e.changed=t.changed=!0,e.text=e.text.substring(0,e.text.lastIndexOf(n)),2==e.text.length&&":"==e.text.charAt(1)&&(e.text+=n));for(var c=0;c<o.length;){var A=o[c];++c,""!=A&&"."!=A.charAt(0)&&t.button(A,0)&&(e.changed=t.changed=!0,e.text.charAt(e.text.length-1)!=n&&(e.text+=n),e.text+=A)}return e.text},wi.inlineRadio=function(t,e,i,n){if(null==n&&(n=1),!t.isVisible(t.t.ELEMENT_H*t.ops.scaleFactor))return t.endElement(),e.position;t.getReleased()?(++e.position>=i.length&&(e.position=0),e.changed=t.changed=!0):e.changed=!1;var s=t.getHover();return wi.drawInlineRadio(t,i[e.position],s,n),t.endElement(),e.position},wi.drawInlineRadio=function(t,e,i,n){null==n&&(n=1),i?(t.g.set_color(t.t.ACCENT_HOVER_COL),t.g.fillRect(t._x+t.buttonOffsetY,t._y+t.buttonOffsetY,t._w-2*t.buttonOffsetY,t.t.BUTTON_H*t.ops.scaleFactor)):(t.g.set_color(t.t.ACCENT_COL),t.enabled||t.fadeColor(),t.g.drawRect(t._x+t.buttonOffsetY,t._y+t.buttonOffsetY,t._w-2*t.buttonOffsetY,t.t.BUTTON_H*t.ops.scaleFactor)),t.g.set_color(t.t.TEXT_COL),t.drawString(t.g,e,t.t.TEXT_OFFSET,0,n)},wi.colorWheel=function(t,e,i,n,s,r){null==r&&(r=!0),null==s&&(s=!1),null==i&&(i=!1),null==n&&(n=t._w),wi.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),wi.ar);var a=wi.ar[0],o=wi.ar[1],l=wi.ar[2],u=.00392156862745098*(e.color>>>24),h=t._x,c=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(n-=t.t.SCROLL_W*t.ops.scaleFactor|0,h+=(t.t.SCROLL_W*t.ops.scaleFactor|0)/2),t.image(t.ops.color_wheel,C.fromFloats(l,l,l));var A=h+n/2,d=c+(t._y-c)/2,_=.7*n,f=_/2,g=A,p=d+o*f,m=a*(2*Math.PI),v=Math.cos(m)*(g-A)-Math.sin(m)*(p-d)+A,w=Math.sin(m)*(g-A)+Math.cos(m)*(p-d)+d;g=v,p=w,t.g.set_color(-16777216),t.g.fillRect(g-3*t.ops.scaleFactor,p-3*t.ops.scaleFactor,6*t.ops.scaleFactor,6*t.ops.scaleFactor),t.g.set_color(-1),t.g.fillRect(g-2*t.ops.scaleFactor,p-2*t.ops.scaleFactor,4*t.ops.scaleFactor,4*t.ops.scaleFactor),s&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var b=e.nest(0);if(b.value=Math.round(100*l)/100,l=t.slider(b,"Value",0,1,!0),b.changed?e.changed=t.changed=!0:e.changed=!1,i){var y=e.nest(1,{value:Math.round(100*u)/100});u=t.slider(y,"Alpha",0,1,!0),y.changed&&(e.changed=t.changed=!0)}var x=A+t._windowX,T=d+t._windowY;if(t.inputStarted&&t.getInputInRect(x-f,T-f,_,_)&&(wi.wheelSelectedHande=e),t.inputReleased&&(wi.wheelSelectedHande=null),t.inputDown&&wi.wheelSelectedHande==e){var S=x-t.inputX,E=T-t.inputY;o=Math.min(Math.sqrt(S*S+E*E),f)/f;var B=Math.atan2(t.inputX-x,t.inputY-T);B<0&&(B=Math.PI+(Math.PI-Math.abs(B))),a=(B=2*Math.PI-B)/(2*Math.PI),e.changed=t.changed=!0}return wi.hsvToRgb(a,o,l,wi.ar),e.color=C.fromFloats(wi.ar[0],wi.ar[1],wi.ar[2],u),r&&t.text("",2,e.color),e.color},wi.keycodeToString=function(t){switch(t){case-1:return"None";case 0:return"Unknown";case 1:return"Back";case 3:return"Cancel";case 6:return"Help";case 8:return"Backspace";case 9:return"Tab";case 12:return"Clear";case 13:return"Return";case 16:return"Shift";case 17:return"Ctrl";case 18:return"Alt";case 19:return"Pause";case 20:return"CapsLock";case 21:return"Kana";case 22:return"Eisu";case 23:return"Junja";case 24:return"Final";case 25:return"Hanja";case 27:return"Esc";case 28:return"Convert";case 29:return"NonConvert";case 30:return"Accept";case 31:return"ModeChange";case 32:return"Space";case 33:return"PageUp";case 34:return"PageDown";case 35:return"End";case 36:return"Home";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 41:return"Select";case 42:return"Print";case 43:return"Execute";case 44:return"PrintScreen";case 45:return"Insert";case 46:return"Delete";case 58:return"Colon";case 59:return"Semicolon";case 60:return"LessThan";case 61:return"Equals";case 62:return"GreaterThan";case 63:return"QuestionMark";case 64:return"At";case 91:return"Win";case 93:return"ContextMenu";case 95:return"Sleep";case 96:return"Numpad0";case 97:return"Numpad1";case 98:return"Numpad2";case 99:return"Numpad3";case 100:return"Numpad4";case 101:return"Numpad5";case 102:return"Numpad6";case 103:return"Numpad7";case 104:return"Numpad8";case 105:return"Numpad9";case 106:return"Multiply";case 107:return"Add";case 108:return"Separator";case 109:return"Subtract";case 110:return"Decimal";case 111:return"Divide";case 112:return"F1";case 113:return"F2";case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 124:return"F13";case 125:return"F14";case 126:return"F15";case 127:return"F16";case 128:return"F17";case 129:return"F18";case 130:return"F19";case 131:return"F20";case 132:return"F21";case 133:return"F22";case 134:return"F23";case 135:return"F24";case 144:return"NumLock";case 145:return"ScrollLock";case 146:return"WinOemFjJisho";case 147:return"WinOemFjMasshou";case 148:return"WinOemFjTouroku";case 149:return"WinOemFjLoya";case 150:return"WinOemFjRoya";case 160:return"Circumflex";case 161:return"Exclamation";case 162:return"DoubleQuote";case 163:return"Hash";case 164:return"Dollar";case 165:return"Percent";case 166:return"Ampersand";case 167:return"Underscore";case 168:return"OpenParen";case 169:return"CloseParen";case 170:return"Asterisk";case 171:return"Plus";case 172:return"Pipe";case 173:return"HyphenMinus";case 174:return"OpenCurlyBracket";case 175:return"CloseCurlyBracket";case 176:return"Tilde";case 181:return"VolumeMute";case 182:return"VolumeDown";case 183:return"VolumeUp";case 188:return"Comma";case 190:return"Period";case 191:return"Slash";case 192:return"BackQuote";case 219:return"OpenBracket";case 220:return"BackSlash";case 221:return"CloseBracket";case 222:return"Quote";case 224:return"Meta";case 225:return"AltGr";case 227:return"WinIcoHelp";case 228:return"WinIco00";case 230:return"WinIcoClear";case 233:return"WinOemReset";case 234:return"WinOemJump";case 235:return"WinOemPA1";case 236:return"WinOemPA2";case 237:return"WinOemPA3";case 238:return"WinOemWSCTRL";case 239:return"WinOemCUSEL";case 240:return"WinOemATTN";case 241:return"WinOemFinish";case 242:return"WinOemCopy";case 243:return"WinOemAuto";case 244:return"WinOemENLW";case 245:return"WinOemBackTab";case 246:return"ATTN";case 247:return"CRSEL";case 248:return"EXSEL";case 249:return"EREOF";case 250:return"Play";case 251:return"Zoom";case 253:return"PA1";case 254:return"WinOemClear"}return String.fromCodePoint(t)},wi.dist=function(t,e,i,n){var s=t-i,r=e-n;return Math.sqrt(s*s+r*r)},wi.fract=function(t){return t-(0|t)},wi.mix=function(t,e,i){return t*(1-i)+e*i},wi.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},wi.step=function(t,e){return e<t?0:1},wi.hsvToRgb=function(t,e,i,n){var s=t+1,r=Math.abs(6*(s-(0|s))-3),a=t+.6666666666666666,o=Math.abs(6*(a-(0|a))-3),l=t+.3333333333333333,u=Math.abs(6*(l-(0|l))-3);n[0]=i*(1-e+Math.min(Math.max(r-1,0),1)*e),n[1]=i*(1-e+Math.min(Math.max(o-1,0),1)*e),n[2]=i*(1-e+Math.min(Math.max(u-1,0),1)*e)},wi.rgbToHsv=function(t,e,i,n){var s=e<i?0:1,r=i*(1-s)+e*s,a=e<i?0:1,o=e*(1-a)+i*a,l=e<i?0:1,u=e<i?0:1,h=t<r?0:1,c=r*(1-h)+t*h,A=t<r?0:1,d=o*(1-A)+o*A,_=t<r?0:1,f=(.6666666666666666*(1-u)+-.3333333333333333*u)*(1-_)+(-1*(1-l)+0*l)*_,g=t<r?0:1,p=t*(1-g)+r*g,m=c-Math.min(p,d);n[0]=Math.abs(f+(p-d)/(6*m+1e-10)),n[1]=m/(1e-10+c),n[2]=c};function bi(){}(x["zui.Id"]=bi).__name__=!0;var yi=function(){};(x["zui.Popup"]=yi).__name__=!0,yi.render=function(t){if(null==yi.boxCommands){if(yi.ui.begin(t),yi.ui.window(yi.hwnd,yi.modalX,yi.modalY,yi.modalW,yi.modalH)){yi.drawTitle(t);for(var e=0,i=yi.boxText.split("\n");e<i.length;){var n=i[e];++e,yi.ui.text(n)}yi.ui._y=yi.ui._h-yi.ui.t.BUTTON_H-10,yi.ui.row([.3333333333333333,.3333333333333333,.3333333333333333]),yi.ui.endElement(),yi.ui.button("OK")&&(yi.show=!1)}yi.ui.end()}else yi.ui.begin(t),yi.ui.window(yi.hwnd,yi.modalX,yi.modalY,yi.modalW,yi.modalH)&&(yi.drawTitle(t),yi.ui._y+=10,yi.boxCommands(yi.ui)),yi.ui.end()},yi.drawTitle=function(t){if(""!=yi.boxTitle){t.set_color(yi.ui.t.SEPARATOR_COL);var e=yi.ui,i=yi.ui._x,n=yi.ui._y,s=yi.ui._w,r=yi.ui.t.BUTTON_H,a=0;0==a&&(a=1),e.enabled||e.fadeColor(),t.fillRect(i,n-1,s,r+1),t.set_color(yi.ui.t.TEXT_COL),yi.ui.text(yi.boxTitle)}},yi.update=function(){var t=null!=yi.ui.comboSelectedHandle;yi.ui.inputStarted&&!t&&(yi.ui.inputX<yi.modalX||yi.ui.inputX>yi.modalX+yi.modalW||yi.ui.inputY<yi.modalY||yi.ui.inputY>yi.modalY+yi.modalH)&&(yi.show=!1)},yi.showMessage=function(t,e,i){yi.ui=t,yi.init(),yi.boxTitle=e,yi.boxText=i,yi.boxCommands=null},yi.showCustom=function(t,e,i,n,s,r){null==r&&(r=160),null==s&&(s=400),null==n&&(n=-1),null==i&&(i=-1),yi.ui=t,yi.init(i,n,s,r),yi.boxTitle="",yi.boxText="",yi.boxCommands=e},yi.init=function(t,e,i,n){null==n&&(n=160),null==i&&(i=400),null==e&&(e=-1),null==t&&(t=-1);var s=Ee.windowWidth(),r=Ee.windowHeight();yi.modalX=t,yi.modalY=e,yi.modalW=i*yi.ui.ops.scaleFactor|0,yi.modalH=n*yi.ui.ops.scaleFactor|0,-1==t&&(yi.modalX=s/2-yi.modalW/2|0),-1==e&&(yi.modalY=r/2-yi.modalH/2|0),yi.modalX=0|Math.max(0,Math.min(yi.modalX,s-yi.modalW)),yi.modalY=0|Math.max(0,Math.min(yi.modalY,r-yi.modalH)),yi.hwnd.dragX=0,yi.hwnd.dragY=0,yi.show=!0};var xi=function(){};(x["zui.Themes"]=xi).__name__=!0;var Ti=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipWait=!1,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImgMaxWidth=null,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.dragHandle=null,this.scrollHandle=null,this.windowEnded=!0,this._windowY=0,this._windowX=0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isReturnDown=!1,this.isEscapeDown=!1,this.isDeleteDown=!1,this.isBackspaceDown=!1,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.isKeyPressed=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.alwaysRedraw=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.enabled=!0,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=xi.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),null==Ti.copyReceiver&&(Ti.copyReceiver=this,Ee.notifyOnCutCopyPaste(Si(this,this.onCut),Si(this,this.onCopy),Si(this,this.onPaste)),Ee.notifyOnFrames(function(t){(Ti.isCopy||Ti.isPaste)&&1<++Ti.copyFrame&&(Ti.isCopy=Ti.isCut=Ti.isPaste=!1,Ti.copyFrame=0)}));var e=Le.createTextVertexStructure();this.rtTextPipeline=Le.createTextPipeline(e),this.rtTextPipeline.alphaBlendSource=1,this.rtTextPipeline.compile()};function Si(t,e){return null==e?null:(null==e.__id__&&(e.__id__=n.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}(x["zui.Zui"]=Ti).__name__=!0,Ti.prototype={isScrolling:null,isTyping:null,enabled:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,imageInvertY:null,scrollEnabled:null,alwaysRedraw:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputStartedX:null,inputStartedY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyPressed:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,isBackspaceDown:null,isDeleteDown:null,isEscapeDown:null,isReturnDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,t:null,ops:null,globalG:null,rtTextPipeline:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollHandle:null,dragHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipImgMaxWidth:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipWait:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.fontSize=this.t.FONT_SIZE*this.ops.scaleFactor|0;var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-e)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.ARROW_SIZE*this.ops.scaleFactor)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.ops.scaleFactor)/this.ops.scaleFactor,this.buttonOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.BUTTON_H*this.ops.scaleFactor)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.CHECK_SIZE*this.ops.scaleFactor)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.ops.scaleFactor-this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.ops.scaleFactor-this.t.CHECK_SIZE*this.ops.scaleFactor)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.ops.scaleFactor-this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=M.createRenderTarget(this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0,null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.ops.scaleFactor),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.ops.scaleFactor),t.end(),this.elementsBaked=!0},remove:function(){this.ops.autoNotifyInput&&this.unregisterInput()},registerInput:function(){Ke.get().notifyWindowed(this.ops.khaWindowId,Si(this,this.onMouseDown),Si(this,this.onMouseUp),Si(this,this.onMouseMove),Si(this,this.onMouseWheel)),Ye.get().notify(Si(this,this.onKeyDown),Si(this,this.onKeyUp),Si(this,this.onKeyPress)),this.inputRegistered=!0},unregisterInput:function(){Ke.get().removeWindowed(this.ops.khaWindowId,Si(this,this.onMouseDown),Si(this,this.onMouseUp),Si(this,this.onMouseMove),Si(this,this.onMouseWheel)),Ye.get().remove(Si(this,this.onKeyDown),Si(this,this.onKeyUp),Si(this,this.onKeyPress)),this.endInput(),this.inputX=this.inputY=0,this.inputRegistered=!1},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),this.drawCombo(),this.drawTooltip(),this.tabPressedHandle=null,t&&this.endInput()},beginRegion:function(t,e,i,n){this.elementsBaked||(t.end(),this.bakeElements(),t.begin(!1)),this.changed=!1,this.globalG=t,this.g=t,this.currentWindow=null,this.tooltipText="",this.tooltipImg=null,this._windowX=0,this._windowY=0,this._windowW=n,this._x=e,this._y=i,this._w=n},endRegion:function(t){null==t&&(t=!0),this.drawTooltip(),this.tabPressedHandle=null,t&&this.endInput()},endInput:function(){this.isKeyPressed=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,Ti.textToPaste="",Ti.keyRepeat&&this.isKeyDown&&.05<W.time()-Ti.keyRepeatTime&&(8!=this.key&&46!=this.key&&37!=this.key&&39!=this.key&&38!=this.key&&40!=this.key||(Ti.keyRepeatTime=W.time(),this.isKeyPressed=!0))},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyPressed},windowDirty:function(t,e,i,n,s){var r=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(r,a,n,s)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,n,s,r){return null==r&&(r=!1),null!=t.texture&&n==t.texture.get_width()&&s==t.texture.get_height()||this.resize(t,n,s,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=n,this._windowH=s,this.windowHeader=0,this.windowDirty(t,e,i,n,s)&&(t.redraws=2),null!=Ti.onBorderHover&&(this.getInputInRect(this._windowX-4,this._windowY,8,this._windowH)?Ti.onBorderHover(t,0):this.getInputInRect(this._windowX+this._windowW-4,this._windowY,8,this._windowH)?Ti.onBorderHover(t,1):this.getInputInRect(this._windowX,this._windowY-4,this._windowW,8)?Ti.onBorderHover(t,2):this.getInputInRect(this._windowX,this._windowY+this._windowH-4,this._windowW,8)&&Ti.onBorderHover(t,3)),!(t.redraws<=0)&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(n=this.t.ELEMENT_W*this.ops.scaleFactor|0),this._w=t.scrollEnabled?n-(this.t.SCROLL_W*this.ops.scaleFactor|0):n,this._h=s,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=r)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?this.dragHandle=t:this.inputReleased&&(this.dragHandle=null),t==this.dragHandle&&(t.redraws=2,t.dragX+=0|this.inputDX,t.dragY+=0|this.inputDY),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var i=this._y-e.scrollOffset;if(i<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var n=i-this._windowH,s=-e.scrollOffset/n,r=this._windowH*Math.abs(this._windowH/i);r=Math.max(r,this.t.ELEMENT_H*this.ops.scaleFactor);var a=this._windowH-r,o=n/a,l=a*s,u=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),l+this._windowY,this.t.SCROLL_W*this.ops.scaleFactor|0,r);this.inputStarted&&u&&(this.scrollHandle=e,this.isScrolling=!0),e==this.scrollHandle?this.scroll(this.inputDY*o,i):0!=this.inputWheelDelta&&null==this.comboSelectedHandle&&this.getInputInRect(this._windowX,this._windowY,this._windowW,this._windowH)&&this.scroll(this.inputWheelDelta*(this.t.ELEMENT_H*this.ops.scaleFactor),i),0<e.scrollOffset?e.scrollOffset=0:i+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-i),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),this._windowY,this.t.SCROLL_W*this.ops.scaleFactor|0,this._windowH),this.g.set_color(this.t.ACCENT_COL);var h=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0),this._windowY,this.t.SCROLL_W*this.ops.scaleFactor|0,this._windowH)||e==this.scrollHandle?this.t.SCROLL_W*this.ops.scaleFactor|0:(this.t.SCROLL_W*this.ops.scaleFactor|0)/3;this.g.fillRect(this._windowW-h-this.scrollAlign,l,h,r)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,(Ti.alwaysRedrawWindow||-4<e.redraws)&&(t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawImage(e.texture,this._windowX,this._windowY),t&&this.globalG.end(),e.redraws<=0&&e.redraws--)}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,tab:function(t,e){null==this.tabNames&&(this.tabNames=[],this.tabHandle=t,this.windowHeader+=this.buttonOffsetY+this.t.BUTTON_H*this.ops.scaleFactor,this.restoreX=this.inputX,this.restoreY=this.inputY,this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeader)&&(this.inputX=this.inputY=-1)),this.tabNames.push(e);var i=t.position==this.tabNames.length-1;return i&&(this.endElement(),this._y+=2),i},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this.t.BUTTON_H*this.ops.scaleFactor*1.1|0,i=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.tabHandle.changed=!1,this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+e+2),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+e+2,this._windowW-2*this.buttonOffsetY,1),this._y+=2;for(var n=0,s=this.tabNames.length;n<s;){var r=n++;this._x=t,this._w=this.ops.font.width(this.fontSize,this.tabNames[r])+2*this.buttonOffsetY+18*this.ops.scaleFactor|0;var a=this.getReleased(),o=this.getPushed(),l=this.getHover();if(a){var u=this.tabHandle.nest(this.tabHandle.position);u.scrollOffset=this.currentWindow.scrollOffset,u=this.tabHandle.nest(r),this.tabScroll=u.scrollOffset,this.tabHandle.position=r,this.currentWindow.redraws=3,this.tabHandle.changed=!0}var h=this.tabHandle.position==r;this.g.set_color(h?this.t.WINDOW_BG_COL:o||l?this.t.BUTTON_HOVER_COL:this.t.SEPARATOR_COL),t+=this._w+1;var c=this.g,A=this._x+this.buttonOffsetY,d=this._y+this.buttonOffsetY,_=this._w,f=0;0==f&&(f=1),this.enabled||this.fadeColor(),c.fillRect(A,d-1,_,1+e),this.g.set_color(h?this.t.BUTTON_TEXT_COL:this.t.LABEL_COL),this.drawString(this.g,this.tabNames[r],this.t.TEXT_OFFSET,0,0),h&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+e,this._w-1,1))}this._x=0,this._y=i,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(this.t.SCROLL_W*this.ops.scaleFactor|0):this._windowW)}},panel:function(t,e,i){return null==i&&(i=!1),this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor)&&(this.getReleased()&&(t.selected=!t.selected,t.changed=this.changed=!0),i?this.drawTree(t.selected):this.drawArrow(t.selected),this.g.set_color(this.t.LABEL_COL),this.g.set_opacity(1),this.drawString(this.g,e,this.titleOffsetX,0)),this.endElement(),t.selected},image:function(t,e,i,n,s,r,a){null==a&&(a=0),null==r&&(r=0),null==s&&(s=0),null==n&&(n=0),null==e&&(e=-1);var o=(0<r?r:t.get_width())*this.ops.scaleFactor,l=(0<a?a:t.get_height())*this.ops.scaleFactor,u=Math.min(o,this._w),h=this._x;if(this.imageScrollAlign&&(u=Math.min(o,this._w-2*this.buttonOffsetY),h+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var c=-1==this.curRatio?1:this.ratios[this.curRatio];u-=(this.t.SCROLL_W*this.ops.scaleFactor|0)*c,h+=(this.t.SCROLL_W*this.ops.scaleFactor|0)*c/2}var A=null==i?u/o:i/l;if(null==i?i=l*A:u=o*A,!this.isVisible(i))return this.endElement(i),0;var d=this.getStarted(i),_=this.getPushed(i),f=this.getReleased(i);this.getHover(i);this.g.set_color(e),this.enabled||this.fadeColor();var g=i;return 0<r?this.imageInvertY?this.g.drawScaledSubImage(t,n,s,r,a,h,this._y+g,u,-g):this.g.drawScaledSubImage(t,n,s,r,a,h,this._y,u,g):this.imageInvertY?this.g.drawScaledImage(t,h,this._y+g,u,-g):this.g.drawScaledImage(t,h,this._y,u,g),this.endElement(i),d?1:f?3:_?2:0},text:function(t,e,i){if(null==i&&(i=0),null==e&&(e=0),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),0;var n=this.getStarted(),s=this.getPushed(),r=this.getReleased();this.getHover();return 0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.ops.scaleFactor)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),this.endElement(),n?1:r?3:s?2:0},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed&&(this.tabPressed=!1,this.isKeyPressed=!1),this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Ye.get()&&Ye.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyPressed&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=me.substr(e,0,this.cursorX-1)+me.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=me.substr(e,0,this.highlightAnchor)+me.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=me.substr(e,0,this.cursorX)+me.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=me.substr(e,0,this.cursorX)+me.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=me.substr(e,0,this.highlightAnchor)+me.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=me.substr(e,0,this.cursorX)+me.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&38!=this.key&&40!=this.key&&null!=this.char&&""!=this.char&&32<=me.cca(this.char,0)&&(e=me.substr(e,0,this.highlightAnchor)+this.char+me.substr(e,this.cursorX,null),this.cursorX=this.cursorX+1>e.length?e.length:this.cursorX+1),this.isShiftDown&&(37==this.key||39==this.key||16==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=Ti.textToPaste&&(e=me.substr(e,0,this.highlightAnchor)+Ti.textToPaste+me.substr(e,this.cursorX,null),this.cursorX+=Ti.textToPaste.length,this.highlightAnchor=this.cursorX,Ti.textToPaste=""),this.highlightAnchor==this.cursorX?Ti.textToCopy=e:this.highlightAnchor<this.cursorX?Ti.textToCopy=e.substring(this.highlightAnchor,this.cursorX):Ti.textToCopy=e.substring(this.cursorX,this.highlightAnchor),Ti.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=me.substr(e,0,this.highlightAnchor)+me.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=me.substr(e,0,this.cursorX)+me.substr(e,this.highlightAnchor,e.length));var i=this.t.TEXT_OFFSET,n=this.t.ELEMENT_H*this.ops.scaleFactor,s=n-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var r=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(r=this.highlightAnchor,a=this.cursorX);var o=me.substr(e,r,a-r),l=this.ops.font.width(this.fontSize,o),u=this.ops.font.width(this.fontSize,me.substr(e,0,r)),h=0==t?this._x+u+i:this._x+this._w-l-i;2==t&&(h-=this.ops.font.width(this.fontSize,me.substr(e,a,e.length))),this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(h,this._y+this.cursorY*n+1.5*this.buttonOffsetY,l*this.ops.scaleFactor,s)}var c=W.time();if(this.isKeyDown||c%1<.5){var A=0==t?me.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),d=this.ops.font.width(this.fontSize,A),_=0==t?this._x+d+i:this._x+this._w-d-i;this.g.set_color(this.t.TEXT_COL),this.g.fillRect(_,this._y+this.cursorY*n+1.5*this.buttonOffsetY,this.ops.scaleFactor,s)}this.textSelectedCurrentText=e},textInput:function(t,e,i){if(null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.text;var n=this.getHover();n&&null!=Ti.onTextHover&&Ti.onTextHover(),this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var s=this.g,r=this.t.FILL_ACCENT_BG,a=this._x+this.buttonOffsetY,o=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,u=this.t.BUTTON_H*this.ops.scaleFactor,h=0;0==h&&(h=1),this.enabled||this.fadeColor(),r?s.fillRect(a,o-1,l,1+u):s.drawRect(a,o,l,u,h);var c=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&c&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var A=2==i?0:2,d=0==A?7:0;this.drawString(this.g,e,d,0,A)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelectedCurrentText,null,0,i),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Ye.get()&&Ye.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e,i){if(null==i&&(i=""),null==e&&(e=1),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),!1;var n=this.getReleased(),s=this.getPushed(),r=this.getHover();n&&(this.changed=!0),this.g.set_color(s?this.t.BUTTON_PRESSED_COL:r?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var a=this.g,o=this.t.FILL_BUTTON_BG,l=this._x+this.buttonOffsetY,u=this._y+this.buttonOffsetY,h=this._w-2*this.buttonOffsetY,c=this.t.BUTTON_H*this.ops.scaleFactor,A=0;return 0==A&&(A=1),this.enabled||this.fadeColor(),o?a.fillRect(l,u-1,h,1+c):a.drawRect(l,u,h,c,A),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),""!=i&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,this.t.TEXT_OFFSET,0,2==e?0:2)),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawRadio(t.position==e,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},combo:function(t,e,i,n,s){if(null==s&&(s=0),null==n&&(n=!1),null==i&&(i=""),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.position;if(this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=s,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=this._x+this._windowX|0,this.comboSelectedY=this._y+this._windowY+this.t.ELEMENT_H*this.ops.scaleFactor|0,this.comboSelectedW=0|this._w),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()){this.g.set_color(this.t.ACCENT_HOVER_COL);var r=this.g,a=this.t.FILL_ACCENT_BG,o=this._x+this.buttonOffsetY,l=this._y+this.buttonOffsetY,u=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.ops.scaleFactor,c=0;0==c&&(c=1),this.enabled||this.fadeColor(),a?r.fillRect(o,l-1,u,1+h):r.drawRect(o,l,u,h,c)}else{this.g.set_color(this.t.ACCENT_COL);var A=this.g,d=this.t.FILL_ACCENT_BG,_=this._x+this.buttonOffsetY,f=this._y+this.buttonOffsetY,g=this._w-2*this.buttonOffsetY,p=this.t.BUTTON_H*this.ops.scaleFactor,m=0;0==m&&(m=1),this.enabled||this.fadeColor(),d?A.fillRect(_,f-1,g,1+p):A.drawRect(_,f,g,p,m)}var v=this._x+this._w-this.arrowOffsetX-8,w=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(v,w,v+this.t.ARROW_SIZE*this.ops.scaleFactor,w,v+this.t.ARROW_SIZE*this.ops.scaleFactor/2,w+this.t.ARROW_SIZE*this.ops.scaleFactor/2),n&&""!=i&&(0==s&&(this._x-=15),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,null,0,0==s?2:0),0==s&&(this._x+=15)),2==s&&(this._x-=15),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e[t.position],null,0,s),2==s&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,n,s,r,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==r&&(r=100),null==s&&(s=!1),null==n&&(n=1),null==i&&(i=0),!this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor))return this.endElement(),t.value;if(this.getStarted()&&(this.scrollHandle=t,this.isScrolling=!0),t.changed=!1,t==this.scrollHandle){var u=n-i,h=this._x+this._windowX+this.buttonOffsetY,c=u/(this._w-2*this.buttonOffsetY),A=i+(this.inputX-h)*c;t.value=Math.round(A*r)/r,t.value<i?t.value=i:t.value>n&&(t.value=n),t.changed=this.changed=!0}var d=this.getHover();this.drawSlider(t.value,i,n,s,d),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t),t.changed=this.changed=!0);var _=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(_),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=parseFloat(t.text),t.changed=this.changed=!0),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,_):this.drawString(this.g,this.textSelectedCurrentText,null,0,_)),this.endElement(),t.value},separator:function(t,e){null==e&&(e=!0),null==t&&(t=4),this.isVisible(this.t.ELEMENT_H*this.ops.scaleFactor)&&e&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(this._x,this._y,this._w,t*this.ops.scaleFactor)),this._y+=t*this.ops.scaleFactor},tooltip:function(t){this.tooltipText=t,this.tooltipY=this._y+this._windowY},tooltipImage:function(t,e){this.tooltipImg=t,this.tooltipImgMaxWidth=e,this.tooltipInvertY=this.imageInvertY,this.tooltipY=this._y+this._windowY},drawArrow:function(t){var e=this._x+this.arrowOffsetX,i=this._y+this.arrowOffsetY;this.g.set_color(this.t.TEXT_COL),t?this.g.fillTriangle(e,i,e+this.t.ARROW_SIZE*this.ops.scaleFactor,i,e+this.t.ARROW_SIZE*this.ops.scaleFactor/2,i+this.t.ARROW_SIZE*this.ops.scaleFactor):this.g.fillTriangle(e,i,e,i+this.t.ARROW_SIZE*this.ops.scaleFactor,e+this.t.ARROW_SIZE*this.ops.scaleFactor,i+this.t.ARROW_SIZE*this.ops.scaleFactor/2)},drawTree:function(t){var e=7*this.ops.scaleFactor,i=this._x+this.arrowOffsetX+1,n=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.TEXT_COL),t?this.g.fillRect(i,n+e/2-1,e,e/8):(this.g.fillRect(i,n+e/2-1,e,e/8),this.g.fillRect(i+e/2-1,n,e/8,e))},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,n=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var s=this.g,r=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.ops.scaleFactor,o=this.t.CHECK_SIZE*this.ops.scaleFactor,l=0;if(0==l&&(l=1),this.enabled||this.fadeColor(),r?s.fillRect(i,n-1,a,1+o):s.drawRect(i,n,a,o,l),t){this.g.set_color(-1),this.enabled||this.fadeColor();var u=this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor|0;this.g.drawScaledImage(this.checkSelectImage,i+this.checkSelectOffsetX,n+this.checkSelectOffsetY,u,u)}},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,n=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var s=this.g,r=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.ops.scaleFactor,o=this.t.CHECK_SIZE*this.ops.scaleFactor,l=0;0==l&&(l=1),this.enabled||this.fadeColor(),r?s.fillRect(i,n-1,a,1+o):s.drawRect(i,n,a,o,l),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.enabled||this.fadeColor(),this.g.fillRect(i+this.radioSelectOffsetX,n+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor,this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor))},drawSlider:function(t,e,i,n,s){var r=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(s?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=this.g,u=this.t.FILL_ACCENT_BG,h=this.t.BUTTON_H*this.ops.scaleFactor,c=0;0==c&&(c=1),this.enabled||this.fadeColor(),u?l.fillRect(r,a-1,o,1+h):l.drawRect(r,a,o,h,c),this.g.set_color(s?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var A=(t-e)/(i-e),d=8*this.ops.scaleFactor,_=n?r:r+(o-d)*A,f=n?o*A:d;f=Math.max(Math.min(f,o),0);var g=this.g,p=this.t.BUTTON_H*this.ops.scaleFactor,m=0;0==m&&(m=1),this.enabled||this.fadeColor(),g.fillRect(_,a-1,f,1+p)},drawCombo:function(){if(null!=this.comboSelectedHandle){var t=this.g;this.globalG.set_color(this.t.SEPARATOR_COL);var e=this.t.ELEMENT_H*this.ops.scaleFactor+this.t.ELEMENT_OFFSET*this.ops.scaleFactor|0,i=(this.comboSelectedTexts.length+1)*e;this.globalG.begin(!1);var n=this.comboSelectedY-i-(this.t.ELEMENT_H*this.ops.scaleFactor|0),s=Ee.windowHeight()-(this.comboSelectedY+i),r=s<0&&s<n,a=r?this.comboSelectedY-i-(this.t.ELEMENT_H*this.ops.scaleFactor|0):this.comboSelectedY;this.globalG.fillRect(this.comboSelectedX,a,this.comboSelectedW,i),this.beginRegion(this.globalG,this.comboSelectedX,a,this.comboSelectedW),r&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2),this._y+=e,this.fill(0,0,this._w/this.ops.scaleFactor,this.ops.scaleFactor,this.t.ACCENT_SELECT_COL)),this.inputEnabled=!0;for(var o=this.t.BUTTON_COL,l=0,u=this.comboSelectedTexts.length;l<u;){var h=l++,c=r?this.comboSelectedTexts.length-1-h:h;if(this.t.BUTTON_COL=c==this.comboSelectedHandle.position?this.t.WINDOW_BG_COL:this.t.SEPARATOR_COL,this.button(this.comboSelectedTexts[c],this.comboSelectedAlign)){this.comboToSubmit=c,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.t.BUTTON_COL=o,r||(this.fill(0,0,this._w/this.ops.scaleFactor,this.ops.scaleFactor,this.t.ACCENT_SELECT_COL),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2)),!this.inputReleased&&!this.isEscapeDown||Ti.comboFirst?Ti.comboFirst=!1:(this.comboSelectedHandle=null,Ti.comboFirst=!0),this.inputEnabled=null==this.comboSelectedHandle,this.endRegion(!1),this.globalG.end(),this.g=t}},drawTooltip:function(){""!=this.tooltipText||null!=this.tooltipImg?(this.inputChanged()&&(this.tooltipShown=!1,this.tooltipWait=0==this.inputDX&&0==this.inputDY),this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=W.time()),!this.tooltipWait&&1<W.time()-this.tooltipTime&&(""!=this.tooltipText?this.drawTooltipText():this.drawTooltipImage())):this.tooltipShown=!1},drawTooltipText:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var n=t[i];++i;var s=this.ops.font.width(this.fontSize,n);e<s&&(e=s)}this.tooltipX=Math.min(this.tooltipX,Ee.windowWidth()-e-20),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.t.ELEMENT_H*this.ops.scaleFactor*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var r=0,a=t.length;r<a;){var o=r++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}this.globalG.end()},drawTooltipImage:function(){var t=this.tooltipImg.get_width();null!=this.tooltipImgMaxWidth&&t>this.tooltipImgMaxWidth&&(t=this.tooltipImgMaxWidth);var e=this.tooltipImg.get_height()*(t/this.tooltipImg.get_width());this.tooltipX=Math.min(this.tooltipX,Ee.windowWidth()-t-20),this.tooltipY=Math.min(this.tooltipY,Ee.windowHeight()-e-20),this.globalG.set_color(-16777216),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,t,e),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+e,t,-e):this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY,t,e),this.globalG.end()},drawString:function(t,e,i,n,s){null==s&&(s=0),null==n&&(n=0);var r=this._w/(this.fontSize/2|0)|0;e.length>r&&(e=e.substring(0,r)+".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.ops.scaleFactor,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==s?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==s&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.t.TEXT_OFFSET),this.enabled||this.fadeColor(),t.set_pipeline(this.rtTextPipeline),t.drawString(e,this._x+i,this._y+this.fontOffsetY+n),t.set_pipeline(null)},endElement:function(t){null==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor+this.t.ELEMENT_OFFSET*this.ops.scaleFactor),null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=this.wBeforeSplit*this.ratios[this.curRatio]|0):this._x+=this._w+this.t.ELEMENT_OFFSET*this.ops.scaleFactor:this._y+=t},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=this._w*t[this.curRatio]|0},indent:function(){this._x+=this.t.TAB_W*this.ops.scaleFactor|0,this._w-=this.t.TAB_W*this.ops.scaleFactor|0},unindent:function(){this._x-=this.t.TAB_W*this.ops.scaleFactor|0,this._w+=this.t.TAB_W*this.ops.scaleFactor|0},fadeColor:function(){this.g.set_color(C.fromFloats(.00392156862745098*((16711680&this.g.get_color())>>>16),.00392156862745098*((65280&this.g.get_color())>>>8),.00392156862745098*(255&this.g.get_color()),.25))},fill:function(t,e,i,n,s){this.g.set_color(s),this.enabled||this.fadeColor(),this.g.fillRect(this._x+t*this.ops.scaleFactor,this._y+e*this.ops.scaleFactor-1,i*this.ops.scaleFactor,n*this.ops.scaleFactor),this.g.set_color(-1)},rect:function(t,e,i,n,s,r){null==r&&(r=1),this.g.set_color(s),this.enabled||this.fadeColor(),this.g.drawRect(this._x+t*this.ops.scaleFactor,this._y+e*this.ops.scaleFactor,i*this.ops.scaleFactor,n*this.ops.scaleFactor,r),this.g.set_color(-1)},drawRect:function(t,e,i,n,s,r,a){null==a&&(a=0),0==a&&(a=1),this.enabled||this.fadeColor(),e?t.fillRect(i,n-1,s,r+1):t.drawRect(i,n,s,r,a)},isVisible:function(t){if(null==this.currentWindow)return!0;var e=null!=this.tabNames?this.t.ELEMENT_H*this.ops.scaleFactor+this.t.ELEMENT_OFFSET*this.ops.scaleFactor:0;return this._y+t>e&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.enabled&&this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.enabled&&this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.enabled&&this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor),!!(this.enabled&&this.inputEnabled&&this.inputStartedX>=this._windowX+this._x&&this.inputStartedX<this._windowX+this._x+this._w&&this.inputStartedY>=this._windowY+this._y)&&this.inputStartedY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.ops.scaleFactor),this.isHovered=this.enabled&&this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,n,s){return null==s&&(s=1),!!(this.enabled&&this.inputEnabled&&this.inputX>=t*s&&this.inputX<(t+i)*s&&this.inputY>=e*s)&&this.inputY<(e+n)*s},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0,this.setInputPosition(e,i),this.inputStartedX=e,this.inputStartedY=i},onMouseUp:function(t,e,i){0==t?this.isScrolling?(this.isScrolling=!1,this.scrollHandle=null,e==this.inputStartedX&&i==this.inputStartedY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(e,i),this.deselectText()},onMouseMove:function(t,e,i,n){this.setInputPosition(t,e)},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyPressed=!0,this.isKeyDown=!0,Ti.keyRepeatTime=W.time()+.4,t){case 8:this.isBackspaceDown=!0;break;case 13:this.isReturnDown=!0;break;case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 27:this.isEscapeDown=!0;break;case 32:this.char=" ";break;case 46:this.isDeleteDown=!0}},onKeyUp:function(t){switch(this.isKeyDown=!1,t){case 8:this.isBackspaceDown=!1;break;case 13:this.isReturnDown=!1;break;case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1;break;case 27:this.isEscapeDown=!1;break;case 46:this.isDeleteDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyPressed=!0},onCut:function(){return Ti.isCut=!0,this.onCopy()},onCopy:function(){return Ti.isCopy=!0,Ti.textToCopy},onPaste:function(t){Ti.isPaste=!0,Ti.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.ops.scaleFactor},ELEMENT_H:function(){return this.t.ELEMENT_H*this.ops.scaleFactor},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.ops.scaleFactor},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.ops.scaleFactor},BUTTON_H:function(){return this.t.BUTTON_H*this.ops.scaleFactor},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.ops.scaleFactor},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.ops.scaleFactor},SCROLL_W:function(){return this.t.SCROLL_W*this.ops.scaleFactor|0},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},TAB_W:function(){return this.t.TAB_W*this.ops.scaleFactor|0},SCALE:function(){return this.ops.scaleFactor},FLASH_SPEED:function(){return.5},TOOLTIP_DELAY:function(){return 1},resize:function(t,e,i,n){null==n&&(n=0),t.redraws=2,null!=t.texture&&t.texture.unload(),e<1&&(e=1),i<1&&(i=1),t.texture=M.createRenderTarget(e,i,0,0,1,n),t.texture.get_g2().set_imageScaleQuality(1)},__class__:Ti},n.$haxeUID|=0,x.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=x.String=String,String.__name__=!0,x.Array=Array,Array.__name__=!0,Date.prototype.__class__=x.Date=Date,Date.__name__="Date";var Ei={},Bi={},ki=Number,Ii=Boolean,Ci={},Li={};et.count=0;var Ni={};Object.defineProperty(ne.prototype,"message",{get:function(){return String(this.val)}}),g.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=p.sliceImpl),pe.windowW=pe.defaultWindowW=240,pe.coffX=70,pe.coffY=50,pe.modalW=625,pe.modalH=545,pe.modalHeaderH=66,pe.modalRectW=625,pe.modalRectH=545,pe.path="/",ve.cwd="",J.DEFAULT_RESOLVER=new a,J.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",_.helper=new DataView(new ArrayBuffer(8)),Se.images=new S,Se.sounds=new E,Se.blobs=new B,Se.fonts=new k,Se.videos=new I,C.Black=-16777216,C.White=-1,C.Red=-65536,C.Blue=-16776961,C.Green=-16711936,C.Magenta=-65281,C.Yellow=-256,C.Cyan=-16711681,C.Purple=-8388480,C.Pink=-16181,C.Orange=-23296,C.Transparent=0,C.invMaxChannelValue=.00392156862745098,w.displays=[],y.Default=new y(!1,!1,!1),W.timeWarpSaveTime=10,W.DIF_COUNT=3,W.maxframetime=.5,W.startTime=0,G.painter_colored_fragData0="s580:AAAARFhCQwKRAhCE2jyY1lWcLP2kpYQBAAAAsAEAAAUAAAA0AAAAjAAAAMAAAAD0AAAANAEAAFJERUZQAAAAAAAAAAAAAAAAAAAAHAAAAAAE::8AAQAAHAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOLAAAAAEAAAAIAAAAIAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFI4AAAAQAAAAA4AAABiEAAD8hAQAAAAAABlAAAD8iAQAAAAAAA2AAAF8iAQAAAAAABGHhAAAAAAAD4AAAFTVEFUdAAAAAIAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_colored_vertData0="s1314:AnZlcnRleENvbG9yAAB2ZXJ0ZXhQb3NpdGlvbgABASRHbG9iYWxzAAABcHJvamVjdGlvbk1hdHJpeAAAAAAAQAAAAAQERFhCQ5A:MgyGPthJiwcRz4ddIcQBAAAAlAMAAAUAAAA0AAAADAEAAFgBAACwAQAAGAMAAFJERUbQAAAAAQAAAEgAAAABAAAAHAAAAAAE:v8AAQAAnAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAJEdsb2JhbHMAq6urPAAAAAEAAABgAAAAQAAAAAAAAAAAAAAAeAAAAAAAAABAAAAAAgAAAIwAAAAAAAAAcHJvamVjdGlvbk1hdHJpeACrq6sDAAMABAAEAAAAAAAAAAAATWljcm9zb2Z0IChSKSBITFNMIFNoYWRlciBDb21waWxlciA2LjMuOTYwMC4xNjM4NACrq0lTR05EAAAAAgAAAAgAAAA4AAAAAAAAAAAAAAADAAAAAAAAAA8PAAA4AAAAAQAAAAAAAAADAAAAAQAAAAcHAABURVhDT09SRACrq6tPU0dOUAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPAAAAQQAAAAAAAAABAAAAAwAAAAEAAAAPAAAAVEVYQ09PUkQAU1ZfUG9zaXRpb24Aq6urU0hEUmABAABAAAEAWAAAAFkAAARGjiAAAAAAAAQAAABfAAAD8hAQAAAAAABfAAADchAQAAEAAABlAAAD8iAQAAAAAABnAAAE8iAQAAEAAAABAAAAaAAAAgIAAAA2AAAF8iAQAAAAAABGHhAAAAAAADYAAAVyABAAAAAAAEYSEAABAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAQAAABoAEAABAAAAOAAAB0IgEAABAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAQAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAABAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAALAAAAAgAAAAAAAAAEAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_image_fragData0="s931:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkMLuHx52DaqoPgbxVgoLcgLAQAAAKQCAAAFAAAANAAAANwAAAAoAQAAXAEAACgCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFLEAAAAQAAAADEAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAH8gAQAAAAAABGDhAAAAAAAEYeEAAAAAAAOAAAB3IgEAAAAAAARgIQAAAAAAD2HxAAAAAAADYAAAWCIBAAAAAAADoAEAAAAAAAPgAAAVNUQVR0AAAABQAAAAEAAAAAAAAAAwAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_image_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_text_fragData0="s894:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkN4eKkSkOMyc:NS8ppPD1BYAQAAAIgCAAAFAAAANAAAANwAAAAoAQAAXAEAAAwCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFKoAAAAQAAAACoAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAHgiAQAAAAAAAKABAAAAAAADoQEAAAAAAANgAABXIgEAAAAAAARhIQAAAAAAA%AAABU1RBVHQAAAAEAAAAAQAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_text_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_video_fragData0="s931:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkMLuHx52DaqoPgbxVgoLcgLAQAAAKQCAAAFAAAANAAAANwAAAAoAQAAXAEAACgCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFLEAAAAQAAAADEAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAH8gAQAAAAAABGDhAAAAAAAEYeEAAAAAAAOAAAB3IgEAAAAAAARgIQAAAAAAD2HxAAAAAAADYAAAWCIBAAAAAAADoAEAAAAAAAPgAAAVNUQVR0AAAABQAAAAEAAAAAAAAAAwAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",G.painter_video_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",Ee.renderListeners=[],Ee.foregroundListeners=[],Ee.resumeListeners=[],Ee.pauseListeners=[],Ee.backgroundListeners=[],Ee.shutdownListeners=[],Ee.dropFilesListeners=[],Y.maxGamepads=4,Y.mouseLockListeners=[],Q.windows=[],q.None=0,q.FeatureResizable=1,q.FeatureMinimizable=2,q.FeatureMaximizable=4,q.FeatureBorderless=8,q.FeatureOnTop=16,lt.disableGcInteractions=!1,lt.intBox=new ot(0),ut.channelCount=32,ut.lastAllocationCount=0,gt.POLY=79764919,wt.INVALID_BITS=-1,xt.EOP=-1,xt.M__PI=3.141592653589793,xt.DIVTAB_NUMER=32,xt.DIVTAB_DENOM=64,xt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Tt.NO_CODE=255,Tt.delay=0,It.PACKET_ID=1,It.PACKET_COMMENT=3,It.PACKET_SETUP=5,Rt.CONTINUED_PACKET=1,Rt.FIRST_PAGE=2,Rt.LAST_PAGE=4,Dt.MAX_CHANNELS=16,Dt.PUSHDATA_CRC_COUNT=4,Dt.FAST_HUFFMAN_LENGTH=10,Dt.FAST_HUFFMAN_TABLE_SIZE=1024,Dt.FAST_HUFFMAN_TABLE_MASK=1023,Gt.fontGlyphs=function(){for(var t=[],e=32;e<256;){var i=e++;t.push(i)}return t}(),he.STBTT_vmove=1,he.STBTT_vline=2,he.STBTT_vcurve=3,he.STBTT_MACSTYLE_DONTCARE=0,he.STBTT_MACSTYLE_BOLD=1,he.STBTT_MACSTYLE_ITALIC=2,he.STBTT_MACSTYLE_UNDERSCORE=4,he.STBTT_MACSTYLE_NONE=8,he.STBTT_PLATFORM_ID_UNICODE=0,he.STBTT_PLATFORM_ID_MAC=1,he.STBTT_PLATFORM_ID_ISO=2,he.STBTT_PLATFORM_ID_MICROSOFT=3,he.STBTT_UNICODE_EID_UNICODE_1_0=0,he.STBTT_UNICODE_EID_UNICODE_1_1=1,he.STBTT_UNICODE_EID_ISO_10646=2,he.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,he.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,he.STBTT_MS_EID_SYMBOL=0,he.STBTT_MS_EID_UNICODE_BMP=1,he.STBTT_MS_EID_SHIFTJIS=2,he.STBTT_MS_EID_UNICODE_FULL=10,he.STBTT_MAC_EID_ROMAN=0,he.STBTT_MAC_EID_ARABIC=4,he.STBTT_MAC_EID_JAPANESE=1,he.STBTT_MAC_EID_HEBREW=5,he.STBTT_MAC_EID_CHINESE_TRAD=2,he.STBTT_MAC_EID_GREEK=6,he.STBTT_MAC_EID_KOREAN=3,he.STBTT_MAC_EID_RUSSIAN=7,he.STBTT_MS_LANG_ENGLISH=1033,he.STBTT_MS_LANG_ITALIAN=1040,he.STBTT_MS_LANG_CHINESE=2052,he.STBTT_MS_LANG_JAPANESE=1041,he.STBTT_MS_LANG_DUTCH=1043,he.STBTT_MS_LANG_KOREAN=1042,he.STBTT_MS_LANG_FRENCH=1036,he.STBTT_MS_LANG_RUSSIAN=1049,he.STBTT_MS_LANG_GERMAN=1031,he.STBTT_MS_LANG_SPANISH=1033,he.STBTT_MS_LANG_HEBREW=1037,he.STBTT_MS_LANG_SWEDISH=1053,he.STBTT_MAC_LANG_ENGLISH=0,he.STBTT_MAC_LANG_JAPANESE=11,he.STBTT_MAC_LANG_ARABIC=12,he.STBTT_MAC_LANG_KOREAN=23,he.STBTT_MAC_LANG_DUTCH=4,he.STBTT_MAC_LANG_RUSSIAN=32,he.STBTT_MAC_LANG_FRENCH=1,he.STBTT_MAC_LANG_SPANISH=6,he.STBTT_MAC_LANG_GERMAN=2,he.STBTT_MAC_LANG_SWEDISH=5,he.STBTT_MAC_LANG_HEBREW=10,he.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,he.STBTT_MAC_LANG_ITALIAN=3,he.STBTT_MAC_LANG_CHINESE_TRAD=19,he.STBTT_MAX_OVERSAMPLE=8,he.STBTT_RASTERIZER_VERSION=2,ke.bufferSize=1500,ke.vertexSize=9,Ie.bufferSize=1e3,Ie.triangleBufferSize=1e3,Ce.bufferSize=1e3,Ge.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Ge.instances=[],Ge.connectListeners=[],Ge.disconnectListeners=[],Ye.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Ye.keyBehavior=Xe.Default,Ke.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},Ze.bufferSize=2e3,Je.mat=new Float32Array(16),ti.width=3,ti.height=3,ei.width=4,ei.height=4,ri.width=3,ri.height=3,ai.width=4,ai.height=4,ci.nextId=0,fi.START=0,fi.ENTITY_UPDATES=1,fi.CONTROLLER_UPDATES=2,fi.REMOTE_CALL=3,fi.PING=4,fi.SESSION_ERROR=5,fi.PLAYER_UPDATES=6,fi.RPC_SERVER=0,fi.RPC_ALL=1,gi.nextId=0,gi.objects=[],mi.global=new mi,vi.assetMap=new $,vi.themes=[],vi.events=[],vi.screenW=-1,vi.screenH=-1,vi.locale="en",vi.h=new mi,vi.elemId=-1,vi.assetId=-1,wi.dataPath="",wi.lastPath="",wi.kx=1,wi.ky=.6666666666666666,wi.kz=.3333333333333333,wi.kw=3,wi.ar=[0,0,0],wi.Kx=0,wi.Ky=-.3333333333333333,wi.Kz=.6666666666666666,wi.Kw=-1,wi.e=1e-10,bi.i=0,yi.show=!1,yi.hwnd=new mi,yi.boxTitle="",yi.boxText="",yi.modalX=0,yi.modalY=0,yi.modalW=400,yi.modalH=160,xi.dark={NAME:"Default Dark",FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:24,ELEMENT_OFFSET:4,ARROW_SIZE:5,BUTTON_H:22,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:6,TEXT_OFFSET:8,TAB_W:12,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-13421773,WINDOW_TINT_COL:-1,ACCENT_COL:-12303292,ACCENT_HOVER_COL:-11974327,ACCENT_SELECT_COL:-10461088,BUTTON_COL:-12171706,BUTTON_TEXT_COL:-1513499,BUTTON_HOVER_COL:-11974327,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-1513499,LABEL_COL:-3618616,SEPARATOR_COL:-14211289,HIGHLIGHT_COL:-14656100,CONTEXT_COL:-14540254},xi.light={NAME:"Default Light",FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:48,ELEMENT_OFFSET:8,ARROW_SIZE:10,BUTTON_H:44,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:12,TEXT_OFFSET:16,TAB_W:24,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,SEPARATOR_COL:-6710887,HIGHLIGHT_COL:-14656100,CONTEXT_COL:-5592406},Ti.alwaysRedrawWindow=!0,Ti.keyRepeat=!0,Ti.keyRepeatTime=0,Ti.textToPaste="",Ti.textToCopy="",Ti.isCut=!1,Ti.isCopy=!1,Ti.isPaste=!1,Ti.copyFrame=0,Ti.comboFirst=!0,ve.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);