!function(t,n){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};function i(){return p.__string_rec(this,"")}var e,y={},f=f||{};function r(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}function yt(t){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.hwin=bi.global.nest(0,null),this.selectedElem=null,this.selectedFrame=0,this.gridSize=20,this.gridSnapPos=!0,this.gridSnapBounds=!1,this.filesDone=null,this.foldersOnly=!1,this.showFiles=!1,this.zoom=1,this.resizeCanvas=!1,this.dragAsset=null,this.assetNames=[""],this.sizeY=!1,this.sizeX=!1,this.size=!1,this.grabY=!1,this.grabX=!1,this.grab=!1,this.dragBottom=!1,this.dragRight=!1,this.dragTop=!1,this.dragLeft=!1,this.drag=!1,this.dropPath="",0<(this.canvas=t).assets.length){var e=t.assets;t.assets=[];for(var i=0;i<e.length;){var n=e[i];++i,this.importAsset(n.file)}}Ct.loadEverything(Bi(this,this.loaded))}(y.Elements=yt).__name__=!0,yt.get_uiw=function(){return yt.windowW*Et.prefs.scaleFactor|0},yt.toRelative=function(t,e){t=g.normalize(t),e=g.normalize(e);for(var i=[],n=t.split("/"),r=e.split("/"),s=0;n[s]==r[s];)++s;for(var a=0,o=r.length-s;a<o;){a++;i.push("..")}for(var l=s,u=n.length;l<u;){var h=l++;i.push(n[h])}return i.join("/")},yt.toAbsolute=function(t,e){return g.normalize(e+"/"+t)},yt.toDegrees=function(t){return 57.29578*t},yt.toRadians=function(t){return.0174532924*t},yt.prototype={ui:null,cui:null,canvas:null,toolbarw:null,get_toolbarw:function(){return 100*this.ui.SCALE|0},dropPath:null,drag:null,dragLeft:null,dragTop:null,dragRight:null,dragBottom:null,grab:null,grabX:null,grabY:null,size:null,sizeX:null,sizeY:null,assetNames:null,dragAsset:null,resizeCanvas:null,zoom:null,showFiles:null,foldersOnly:null,filesDone:null,uimodal:null,gridSnapBounds:null,gridSnapPos:null,gridSize:null,selectedFrame:null,selectedElem:null,hwin:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var e=this,t=K.copy(Ei.dark);t.FILL_WINDOW_BG=!0,this.ui=new Ti({scaleFactor:Et.prefs.scaleFactor,font:Ct.fonts.font_default,theme:t,color_wheel:Ct.images.color_wheel}),this.cui=new Ti({scaleFactor:1,font:Ct.fonts.font_default,autoNotifyInput:!0,theme:Ei.light}),this.uimodal=new Ti({font:Ct.fonts.font_default,scaleFactor:Et.prefs.scaleFactor}),It.notifyOnDropFiles(function(t){e.dropPath=Bt.rtrim(t),e.dropPath=yt.toRelative(e.dropPath,Et.cwd)}),It.notifyOnFrames(Bi(this,this.onFrames)),D.addTimeTask(Bi(this,this.update),0,.016666666666666666)},importAsset:function(s){var a=this,t=Bt.endsWith(s,".jpg")||Bt.endsWith(s,".png")||Bt.endsWith(s,".k")||Bt.endsWith(s,".hdr"),e=Bt.endsWith(s,".ttf"),i=yt.toAbsolute(s,Et.cwd);i="Windows"==It.get_systemId()?Bt.replace(i,"/","\\"):i,t?Ct.loadImageFromPath(i,!1,function(t){var e=s.split("/"),i=e[e.length-1],n=Si.getAssetId(a.canvas),r={name:i,file:s,id:n};a.canvas.assets.push(r),Si.assetMap.h[r.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:131,className:"Elements",methodName:"importAsset"}):e&&Ct.loadFontFromPath(i,function(t){var e=s.split("/"),i=e[e.length-1],n=Si.getAssetId(a.canvas),r={name:i,file:s,id:n};a.canvas.assets.push(r),Si.assetMap.h[r.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:143,className:"Elements",methodName:"importAsset"})},unique:function(t){return t},makeElem:function(t){var e="",i=this.cui.t.ELEMENT_H;switch(t){case 0:e=this.unique("Text");break;case 1:e=this.unique("Image"),i=100;break;case 2:e=this.unique("Button");break;case 3:e=this.unique("Empty"),i=100;break;case 6:e=this.unique("Check");break;case 7:e=this.unique("Radio");break;case 8:e=this.unique("Combo");break;case 9:e=this.unique("Slider");break;case 10:e=this.unique("Input");break;case 11:e=this.unique("Filled_Rectangle"),i=100;break;case 12:e=this.unique("Rectangle"),i=100;break;case 13:e=this.unique("Filled_Circle");break;case 14:e=this.unique("Circle");break;case 15:e=this.unique("Filled_Triangle");break;case 16:e=this.unique("Triangle");break;case 17:e=this.unique("Progress_bar");break;case 18:e=this.unique("CProgress_bar")}var n={id:Si.getElementId(this.canvas),type:t,name:e,event:"",x:0,y:0,width:150,height:i,rotation:0,text:"My "+e,asset:"",color:-12040120,color_text:-1513499,color_hover:-12895429,color_press:-15000805,anchor:0,parent:null,children:[],visible:!0};return this.canvas.elements.push(n),n},unparent:function(t){var e=this.elemById(t.parent);null!=e&&(t.x+=this.absx(e),t.y+=this.absy(e),t.parent=null,xt.remove(e.children,t.id))},setParent:function(t,e){this.elemById(t.parent)!=e&&(this.unparent(t),null!=e&&(null==e.children&&(t.children=[]),e.children.push(t.id),t.parent=e.id,t.x-=this.absx(e),t.y-=this.absy(e)))},duplicateElem:function(t,e){if(null==t)return null;null==e&&(e=t.parent);var i={id:Si.getElementId(this.canvas),type:t.type,name:t.name,event:t.event,x:t.x+10,y:t.y+10,width:t.width,height:t.height,rotation:t.rotation,text:t.text,asset:t.asset,color:t.color,color_text:t.color_text,color_hover:t.color_hover,color_press:t.color_press,progress_at:t.progress_at,progress_total:t.progress_total,anchor:t.anchor,parent:e,children:[],visible:t.visible};this.canvas.elements.push(i),null!=e&&(this.elemById(e).children.push(i.id),t.parent!=e&&(i.x=t.x,i.y=t.y));for(var n=0,r=t.children;n<r.length;){var s=r[n];++n,this.duplicateElem(this.elemById(s),i.id)}return i},getEnumTexts:function(){return 0<this.assetNames.length?this.assetNames:[""]},getAssetIndex:function(t){for(var e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(t==this.canvas.assets[n].name)return 1+n}return 0},resize:function(){null!=yt.grid&&(yt.grid.unload(),yt.grid=null),null!=yt.timeline&&(yt.timeline.unload(),yt.timeline=null)},drawGrid:function(){var t=2*this.gridSize,e=It.windowWidth()+2*t,i=It.windowHeight()+2*t;(yt.grid=C.createRenderTarget(e,i)).get_g2().begin(!0,-14408668);for(var n=0,r=1+(i/t|0);n<r;){var s=n++;yt.grid.get_g2().set_color(-14145496),yt.grid.get_g2().drawLine(0,s*t,e,s*t),yt.grid.get_g2().set_color(-13487566),yt.grid.get_g2().drawLine(0,s*t+this.gridSize,e,s*t+this.gridSize)}for(var a=0,o=1+(e/t|0);a<o;){var l=a++;yt.grid.get_g2().set_color(-14145496),yt.grid.get_g2().drawLine(l*t,0,l*t,i),yt.grid.get_g2().set_color(-13487566),yt.grid.get_g2().drawLine(l*t+this.gridSize,0,l*t+this.gridSize,i)}yt.grid.get_g2().end()},drawTimeline:function(t,e){var i=this.ui.SCALE,n=t+e,r=(yt.timeline=C.createRenderTarget(It.windowWidth()-yt.get_uiw()-this.get_toolbarw(),n)).get_g2();r.begin(!0,-14540254),r.set_font(Ct.fonts.font_default),r.set_fontSize(16*i|0);for(var s=yt.timeline.get_width()/(11*i)|0,a=0,o=1+(s/5|0);a<o;){var l=a++,u=5*l,h=Ct.fonts.font_default.width(r.get_fontSize(),u+"");r.drawString(u+"",55*l*i+5*i-h/2,t/2-r.get_fontSize()/2)}for(var A=0,c=s;A<c;){var d=A++;r.set_color(d%5==0?-12303292:-13421773),r.fillRect(11*d*i,n-e,10*i,e)}r.end()},onFrames:function(t){var o=this,e=t[0];""!=this.dropPath&&(this.importAsset(this.dropPath),this.dropPath="");var i=this.ui.SCALE,n=30*i|0,r=40*i|0;null==yt.grid&&this.drawGrid(),null!=yt.timeline&&yt.timeline.get_height()==n+r||this.drawTimeline(n,r);var s=e.get_g2();if(s.begin(),s.set_color(-1),s.drawImage(yt.grid,yt.coffX%40-40,yt.coffY%40-40),this.canvas.x=yt.coffX,this.canvas.y=yt.coffY,s.drawRect(this.canvas.x,this.canvas.y,this.canvas.width*this.cui.SCALE|0,this.canvas.height*this.cui.SCALE|0,1),s.drawRect(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6,1),Si.screenW=this.canvas.width,Si.screenH=this.canvas.height,Si.draw(this.cui,this.canvas,s),null!=this.selectedElem){s.set_color(-1);var a=this.absx(this.selectedElem)*this.cui.SCALE|0,l=this.absy(this.selectedElem)*this.cui.SCALE|0,u=this.selectedElem.width*this.cui.SCALE|0,h=this.selectedElem.height*this.cui.SCALE|0;s.pushRotation(this.selectedElem.rotation,this.canvas.x+a+u/2,this.canvas.y+l+h/2),s.drawRect(this.canvas.x+a,this.canvas.y+l,u,h),s.set_color(-16777216),s.drawRect(this.canvas.x+a+1,this.canvas.y+l+1,u,h),s.set_color(-1);for(var A=0;A<3;)for(var c=A++/2,d=0;d<3;){var _=d++/2;if(.5!=c||.5!=_){var f=this.canvas.x+a+u*c-4,g=this.canvas.y+l+h*_-4;s.drawRect(f,g,8,8);var p=this.rotatePoint(this.ui.inputX,this.ui.inputY,this.canvas.x+a+u/2,this.canvas.y+l+h/2,-this.selectedElem.rotation);p.x>f&&p.x<8+f&&p.y>g&&p.y<8+g&&(s.set_color(-14656100),s.fillRect(f,g,8,8),s.set_color(-1))}}s.popTransformation()}s.set_color(-1);var v=It.windowHeight()-yt.timeline.get_height();s.drawImage(yt.timeline,this.get_toolbarw(),v),s.set_color(-14656100),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i,v+n,10*i,r),s.set_font(Ct.fonts.font_default),s.set_fontSize(16*i|0);var m=4*i,w=4*i,b=30*i,S=n-2*m,y=Ct.fonts.font_default.width(s.get_fontSize(),""+this.selectedFrame);if(b+w<y&&(b=y+w),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i+5*i-b/2,v+m,b,S),s.set_color(-1),s.drawString(""+this.selectedFrame,this.get_toolbarw()+11*this.selectedFrame*i+5*i-y/2,v+n/2-s.get_fontSize()/2),s.end(),this.ui.begin(s),this.ui.window(bi.global.nest(1,null),0,0,this.get_toolbarw(),It.windowHeight())&&(this.ui._y=50,this.ui.button("Empty")&&(this.selectedElem=this.makeElem(3)),this.ui.panel(bi.global.nest(2,null),"Shapes")&&(this.ui.indent(),this.ui.button("Rect")&&(this.selectedElem=this.makeElem(12)),this.ui.button("Fill Rect")&&(this.selectedElem=this.makeElem(11)),this.ui.button("Circle")&&(this.selectedElem=this.makeElem(14)),this.ui.button("Fill Circle")&&(this.selectedElem=this.makeElem(13)),this.ui.button("Triangle")&&(this.selectedElem=this.makeElem(16)),this.ui.button("Fill Triangle")&&(this.selectedElem=this.makeElem(15)),this.ui.unindent()),this.ui.panel(bi.global.nest(3,null),"Texts")&&(this.ui.indent(),this.ui.button("Text")&&(this.selectedElem=this.makeElem(0)),this.ui.button("Input")&&(this.selectedElem=this.makeElem(10)),this.ui.unindent()),this.ui.panel(bi.global.nest(4,null),"ProgressBars")&&(this.ui.indent(),this.ui.button("RectPB")&&(this.selectedElem=this.makeElem(17)),this.ui.button("CircularPB")&&(this.selectedElem=this.makeElem(18)),this.ui.unindent()),this.ui.button("Image")&&(this.selectedElem=this.makeElem(1)),this.ui.button("Button")&&(this.selectedElem=this.makeElem(2)),this.ui.button("Check")&&(this.selectedElem=this.makeElem(6)),this.ui.button("Radio")&&(this.selectedElem=this.makeElem(7)),this.ui.button("Combo")&&(this.selectedElem=this.makeElem(8)),this.ui.button("Slider")&&(this.selectedElem=this.makeElem(9))),this.ui.window(bi.global.nest(5,null),this.get_toolbarw(),0,It.windowWidth()-yt.get_uiw()-this.get_toolbarw(),(this.ui.t.ELEMENT_H+2)*this.ui.SCALE|0)&&this.ui.tab(bi.global.nest(6,null),this.canvas.name),this.ui.window(this.hwin,It.windowWidth()-yt.get_uiw(),0,yt.get_uiw(),It.windowHeight())){var x=bi.global.nest(7,null);if(this.ui.tab(x,"Project")){if(this.ui.button("Save")){this.canvas.x=0,this.canvas.y=0,Krom.fileSaveBytes(Et.prefs.path,kt.ofString(JSON.stringify(this.canvas)).b.bufferValue);var E=xt.substr(Et.prefs.path,0,Et.prefs.path.length-5);E+=".files";for(var T="",B=0,k=this.canvas.assets;B<k.length;){var C=k[B];++B,T+=C.file+"\n"}Krom.fileSaveBytes(E,kt.ofString(T).b.bufferValue),this.canvas.x=yt.coffX,this.canvas.y=yt.coffY}if(this.ui.panel(bi.global.nest(8,{selected:!1}),"Canvas")){this.ui.button("New")&&(this.canvas.elements=[],this.selectedElem=null);var I=this.ui,L=bi.global.nest(9,{text:this.canvas.name});this.canvas.name=I.textInput(L,"Name",2),this.ui.row([.5,.5]);var N=bi.global.nest(10,{text:this.canvas.width+""}),P=bi.global.nest(11,{text:this.canvas.height+""});N.text=this.canvas.width+"",P.text=this.canvas.height+"";var R=this.ui.textInput(N,"Width",2),M=this.ui.textInput(P,"Height",2);this.canvas.width=Tt.parseInt(R),this.canvas.height=Tt.parseInt(M)}if(this.ui.panel(bi.global.nest(12,{selected:!0}),"Outliner")){var V=null;V=function(t,e){var i=!1;o.selectedElem==e&&(o.ui.g.set_color(-14656100),o.ui.g.fillRect(0,o.ui._y,o.ui._windowW,o.ui.t.ELEMENT_H*o.ui.SCALE),o.ui.g.set_color(-1));var n=o.ui.getStarted();if(n&&!o.ui.inputDownR&&(o.selectedElem=e),n&&o.ui.inputDownR&&(e==o.selectedElem?o.unparent(e):o.setParent(o.selectedElem,e)),null!=e.children&&0<e.children.length?(o.ui.row([.07692307692307693,.9230769230769231]),i=o.ui.panel(t.nest(e.id,{selected:!0}),"",0,!0),o.ui.text(e.name)):(o.ui._x+=18,o.ui.text(e.name),o.ui._x-=18),i)for(var r=e.children.length;0<r;){--r;var s=e.children[e.children.length-1-r];o.ui.indent();var a=o.elemById(s);V(t,a),o.ui.unindent()}};for(var D=0,O=this.canvas.elements.length;D<O;){var F=D++,U=this.canvas.elements[this.canvas.elements.length-1-F];if(null==U.parent){var H=bi.global.nest(13,null);V(H,U)}}this.ui.row([.25,.25,.25,.25]);this.canvas.elements;this.ui.button("Up")&&null!=this.selectedElem&&this.moveElem(1),this.ui.button("Down")&&null!=this.selectedElem&&this.moveElem(-1),this.ui.button("Remove")&&null!=this.selectedElem&&this.removeSelectedElem(),this.ui.button("Duplicate")&&null!=this.selectedElem&&(this.selectedElem=this.duplicateElem(this.selectedElem))}if(null!=this.selectedElem){var W=this.selectedElem,G=W.id;if(this.ui.panel(bi.global.nest(14,{selected:!0}),"Properties")){var z=null==W.visible||W.visible;W.visible=this.ui.check(bi.global.nest(15,null).nest(G,{selected:z}),"Visible"),W.name=this.ui.textInput(bi.global.nest(16,null).nest(G,{text:W.name}),"Name",2),W.text=this.ui.textInput(bi.global.nest(17,null).nest(G,{text:W.text}),"Text",2),this.ui.row([.25,.25,.25,.25]);var Y=W.x+"",X=bi.global.nest(18,null).nest(G,{text:Y}),K=W.y+"",Q=bi.global.nest(19,null).nest(G,{text:K});X.text=W.x+"",Q.text=W.y+"";var q=this.ui.textInput(X,"X",2),j=this.ui.textInput(Q,"Y",2);W.x=parseFloat(q),W.y=parseFloat(j);var Z=W.width+"",J=bi.global.nest(20,null).nest(G,{text:Z}),$=W.height+"",tt=bi.global.nest(21,null).nest(G,{text:$});J.text=W.width+"",tt.text=W.height+"";var et=this.ui.textInput(J,"W",2),it=this.ui.textInput(tt,"H",2);if(W.width=0|parseFloat(et),W.height=0|parseFloat(it),12==W.type||14==W.type||16==W.type||17==W.type||18==W.type){var nt=bi.global.nest(22,null).nest(G,{text:"1"}),rt=this.ui.textInput(nt,"Line Strength",2);W.strength=0|parseFloat(rt)}if(17==W.type||18==W.type){var st=bi.global.nest(23,null).nest(G,{text:"1"}),at=this.ui.textInput(st,"Progress",2),ot=bi.global.nest(24,null).nest(G,{text:"1"}),lt=this.ui.textInput(ot,"Total Progress",2);W.progress_total=0|parseFloat(lt),W.progress_at=0|parseFloat(at)}var ut=null==W.rotation?0:W.rotation,ht=bi.global.nest(25,null).nest(G,{value:57.29578*ut});W.rotation=.0174532924*this.ui.slider(ht,"Rotation",0,360,!0);var At=this.ui.combo(bi.global.nest(26,null).nest(G,{position:this.getAssetIndex(W.asset)}),this.getEnumTexts(),"Asset",!0,2);W.asset=this.getEnumTexts()[At]}this.ui.panel(bi.global.nest(27,{selected:!1}),"Color")&&(0==W.type?(this.ui.text("Text:"),W.color_text=yi.colorWheel(this.ui,bi.global.nest(28,null).nest(G,{color:W.color_text}),!0,null,!0)):2==W.type?(this.ui.text("Text:"),W.color_text=yi.colorWheel(this.ui,bi.global.nest(29,null).nest(G,{color:W.color_text}),!0,null,!0),this.ui.text("Background:"),W.color=yi.colorWheel(this.ui,bi.global.nest(30,null).nest(G,{color:W.color}),!0,null,!0),this.ui.text("On Hover:"),W.color_hover=yi.colorWheel(this.ui,bi.global.nest(31,null).nest(G,{color:W.color_hover}),!0,null,!0),this.ui.text("On Pressed:"),W.color_press=yi.colorWheel(this.ui,bi.global.nest(32,null).nest(G,{color:W.color_press}),!0,null,!0)):11==W.type||13==W.type||12==W.type||14==W.type||16==W.type||15==W.type||17==W.type||18==W.type?(this.ui.text("Color:"),W.color=yi.colorWheel(this.ui,bi.global.nest(33,null).nest(G,{color:W.color}),!0,null,!0)):3==W.type?this.ui.text("No color for element type empty"):(this.ui.text("Text:"),W.color_text=yi.colorWheel(this.ui,bi.global.nest(34,null).nest(G,{color:W.color_text}),!0,null,!0),this.ui.text("Background:"),W.color=yi.colorWheel(this.ui,bi.global.nest(35,null).nest(G,{color:W.color}),!0,null,!0),this.ui.text("On Hover:"),W.color_hover=yi.colorWheel(this.ui,bi.global.nest(36,null).nest(G,{color:W.color_hover}),!0,null,!0)));this.ui.panel(bi.global.nest(37,{selected:!1}),"Align");if(this.ui.panel(bi.global.nest(38,{selected:!1}),"Anchor")){var ct=bi.global.nest(39,null).nest(G,{position:W.anchor});this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(ct,0,"Top-Left"),this.ui.radio(ct,1,"Top"),this.ui.radio(ct,2,"Top-Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(ct,3,"Left"),this.ui.radio(ct,4,"Center"),this.ui.radio(ct,5,"Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(ct,6,"Bot-Left"),this.ui.radio(ct,7,"Bottom"),this.ui.radio(ct,8,"Bot-Right"),W.anchor=ct.position}this.ui.panel(bi.global.nest(40,{selected:!1}),"Script")&&(W.event=this.ui.textInput(bi.global.nest(41,null).nest(G,{text:W.event}),"Event",2));this.ui.panel(bi.global.nest(42,{selected:!1}),"Timeline")}}if(this.ui.tab(x,"Assets"))if(this.ui.button("Import Asset")&&(this.showFiles=!0,this.foldersOnly=!1,this.filesDone=function(t){t=Bt.rtrim(t),t=yt.toRelative(t,Et.cwd),o.importAsset(t)}),0<this.canvas.assets.length){this.ui.text("(Drag and drop assets to canvas)",1);for(var dt=this.canvas.assets.length-1;0<=dt;){var _t=this.canvas.assets[dt];Bt.endsWith(_t.name,".ttf")||1!=this.ui.image(this.getImage(_t))||(this.dragAsset=_t),this.ui.row([.875,.125]),_t.name=this.ui.textInput(bi.global.nest(43,null).nest(_t.id,{text:_t.name}),"",2),this.assetNames[dt+1]=_t.name,this.ui.button("X")&&(this.getImage(_t).unload(),this.canvas.assets.splice(dt,1),this.assetNames.splice(dt+1,1)),--dt}}else this.ui.text("(Drag and drop images and fonts here)",1);if(this.ui.tab(x,"Preferences")){var ft=bi.global.nest(44,{position:0});this.ui.combo(ft,["Left Click","Right Click"],"Select Elements With",!0),ft.changed&&(Et.prefs.selectMouseButton=["Left","Right"][ft.position]);var gt=bi.global.nest(45,{value:1});this.ui.slider(gt,"UI Scale",.5,4,!0);var pt=bi.global.nest(46,{value:20});this.ui.slider(pt,"Grid Size",1,128,!0,1),this.gridSnapPos=this.ui.check(bi.global.nest(47,{selected:!0}),"Grid Snap Position"),this.gridSnapBounds=this.ui.check(bi.global.nest(48,{selected:!1}),"Grid Snap Bounds"),this.ui.changed&&!this.ui.inputDown&&(this.gridSize=0|pt.value,this.ui.setScale(gt.value),yt.windowW=yt.defaultWindowW*gt.value|0);var vt=this.ui,mt=bi.global.nest(49,{selected:!0});Et.prefs.window_vsync=vt.check(mt,"VSync"),this.ui.panel(bi.global.nest(50,{selected:!0}),"Console")&&(this.ui.text("Mouse X: "+this.ui.inputX),this.ui.text("Mouse Y: "+this.ui.inputY))}}if(this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),s.begin(!1),null!=this.dragAsset){var wt=Math.min(128,this.getImage(this.dragAsset).get_width()),bt=wt/this.getImage(this.dragAsset).get_width(),St=this.getImage(this.dragAsset).get_height()*bt;s.drawScaledImage(this.getImage(this.dragAsset),this.ui.inputX,this.ui.inputY,wt,St)}s.end(),0<this.lastW&&(this.lastW!=It.windowWidth()||this.lastH!=It.windowHeight())?this.resize():0<this.lastCanvasW&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=It.windowWidth(),this.lastH=It.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,this.showFiles&&this.renderFiles(s)},elemById:function(t){for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];if(++e,n.id==t)return n}return null},moveElem:function(t){for(var e=this.canvas.elements,i=e.indexOf(this.selectedElem),n=this.selectedElem.parent;!((i+=t)<0||i>=e.length);)if(e[i].parent==n){xt.remove(e,this.selectedElem),e.splice(i,0,this.selectedElem);break}},getImage:function(t){return Si.assetMap.h[t.id]},removeElem:function(t){if(null!=t.children)for(var e=0,i=t.children;e<i.length;){var n=i[e];++e,this.removeElem(this.elemById(n))}xt.remove(this.canvas.elements,t),null!=t.parent&&(xt.remove(this.elemById(t.parent).children,t.id),t.parent=null)},removeSelectedElem:function(){this.removeElem(this.selectedElem),this.selectedElem=null},acceptDrag:function(t){var e=this.makeElem(1);e.asset=this.assetNames[t+1],e.x=this.ui.inputX-this.canvas.x,e.y=this.ui.inputY-this.canvas.y,e.width=this.getImage(this.canvas.assets[t]).get_width(),e.height=this.getImage(this.canvas.assets[t]).get_height(),this.selectedElem=e},hitbox:function(t,e,i,n,r){var s=this.rotatePoint(this.ui.inputX,this.ui.inputY,t+i/2,e+n/2,-r);return s.x>t&&s.x<t+i&&s.y>e&&s.y<e+n},update:function(){if(this.ui.inputReleased&&null!=this.dragAsset){if(this.ui.inputX<It.windowWidth()-yt.get_uiw()){for(var t=0,e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(this.canvas.assets[n]==this.dragAsset){t=n;break}}this.acceptDrag(t)}this.dragAsset=null}if(null==this.dragAsset){if(this.updateCanvas(),null!=yt.timeline){var r=It.windowHeight()-yt.timeline.get_height();this.ui.inputDown&&this.ui.inputY>r&&this.ui.inputX<It.windowWidth()-yt.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=(this.ui.inputX-this.get_toolbarw())/11/this.ui.SCALE|0)}if(null!=this.selectedElem){var s=this.selectedElem,a=this.absx(s)*this.cui.SCALE|0,o=this.absy(s)*this.cui.SCALE|0,l=s.width*this.cui.SCALE|0,u=s.height*this.cui.SCALE|0;if(this.ui.inputStarted&&this.ui.inputDown&&this.hitbox(this.canvas.x+a-4,this.canvas.y+o-4,8+l,8+u,this.selectedElem.rotation)){var h=this.rotatePoint(this.ui.inputX,this.ui.inputY,this.canvas.x+a+l/2,this.canvas.y+o+u/2,-s.rotation);this.drag=!0,this.dragLeft=this.dragRight=this.dragTop=this.dragBottom=!1,h.x>this.canvas.x+a+l-4?this.dragRight=!0:h.x<this.canvas.x+a+4&&(this.dragLeft=!0),h.y>this.canvas.y+o+u-4?this.dragBottom=!0:h.y<this.canvas.y+o+4&&(this.dragTop=!0)}this.ui.inputReleased&&(this.grab||this.drag)&&(this.drag=!1,this.grab=!1,this.gridSnapBounds&&(s.width=Math.round(s.width/this.gridSize)*this.gridSize,s.height=Math.round(s.height/this.gridSize)*this.gridSize),this.gridSnapPos&&(s.x=Math.round(s.x/this.gridSize)*this.gridSize,s.y=Math.round(s.y/this.gridSize)*this.gridSize)),this.drag&&(this.hwin.redraws=2,this.dragRight?s.width+=0|this.ui.inputDX:this.dragLeft&&(s.x+=0|this.ui.inputDX,s.width-=0|this.ui.inputDX),this.dragBottom?s.height+=0|this.ui.inputDY:this.dragTop&&(s.y+=0|this.ui.inputDY,s.height-=0|this.ui.inputDY),1!=s.type&&(s.width<1&&(s.width=1),s.height<1&&(s.height=1)),this.dragLeft||this.dragRight||this.dragBottom||this.dragTop||(s.x+=this.ui.inputDX,s.y+=this.ui.inputDY)),this.grab&&(this.hwin.redraws=2,this.size=!1,this.grabX||this.grabY?this.grabX?s.x+=0|this.ui.inputDX:this.grabY&&(s.y+=0|this.ui.inputDY):(s.x+=0|this.ui.inputDX,s.y+=0|this.ui.inputDY)),this.size&&(this.hwin.redraws=2,this.grab=!1,this.sizeX||this.sizeY?this.sizeX?s.width+=0|this.ui.inputDX:this.sizeY&&(s.height+=0|this.ui.inputDY):(s.height+=0|this.ui.inputDY,s.width+=0|this.ui.inputDX)),this.ui.inputStarted&&(this.grab||this.size)&&(this.grab=!1,this.size=!1),this.ui.isKeyDown&&!this.ui.isTyping&&(37==this.ui.key&&(this.gridSnapPos?s.x-=this.gridSize:s.x--),39==this.ui.key&&(this.gridSnapPos?s.x+=this.gridSize:s.x++),38==this.ui.key&&(this.gridSnapPos?s.y-=this.gridSize:s.y--),40==this.ui.key&&(this.gridSnapPos?s.y+=this.gridSize:s.y++),71==this.ui.key&&(this.grab=!0,this.grabX=!1,this.grabY=!1),this.grab&&88==this.ui.key&&(this.grabX=!0,this.grabY=!1),this.grab&&89==this.ui.key&&(this.grabY=!0,this.grabX=!1),83==this.ui.key&&(this.size=!0,this.sizeX=!1,this.sizeY=!1),this.size&&88==this.ui.key&&(this.sizeX=!0,this.sizeY=!1),this.size&&89==this.ui.key&&(this.sizeY=!0,this.sizeX=!1),8!=this.ui.key&&46!=this.ui.key||this.removeSelectedElem(),68==this.ui.key&&(this.selectedElem=this.duplicateElem(s)),this.hwin.redraws=2)}this.updateFiles()}},updateCanvas:function(){if(!(this.showFiles||this.ui.inputX>It.windowWidth()-yt.get_uiw())){var t=Et.prefs.selectMouseButton;if(("Left"==t||null==t)&&this.ui.inputStarted&&this.ui.inputDown||"Right"==t&&this.ui.inputStartedR&&this.ui.inputDownR){this.canvas.elements.length;for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];++e;var r=this.absx(n)*this.cui.SCALE|0,s=this.absy(n)*this.cui.SCALE|0,a=n.width*this.cui.SCALE|0,o=n.height*this.cui.SCALE|0;if(this.hitbox(this.canvas.x+r,this.canvas.y+s,a,o,n.rotation)&&this.selectedElem!=n){this.selectedElem=n;break}}}this.ui.inputDownR&&(yt.coffX+=0|this.ui.inputDX,yt.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta&&(this.zoom+=-this.ui.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.SCALE=this.cui.ops.scaleFactor*this.zoom),this.ui.inputStarted&&this.hitbox(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,this.canvas.width<1&&(this.canvas.width=1),this.canvas.height<1&&(this.canvas.height=1))}},updateFiles:function(){if(this.showFiles&&this.ui.inputReleased){var t=It.windowWidth(),e=It.windowHeight(),i=t/2-yt.modalRectW/2,n=t/2+yt.modalRectW/2,r=e/2-yt.modalRectH/2,s=e/2+yt.modalRectH/2;(this.ui.inputX<i||this.ui.inputX>n||this.ui.inputY<r+yt.modalHeaderH||this.ui.inputY>s)&&(this.showFiles=!1)}},renderFiles:function(t){var e=It.windowWidth(),i=It.windowHeight(),n=e/2-yt.modalW/2,r=i/2-yt.modalH/2;t.begin(!1),t.set_color(-14671840),t.fillRect(n,r,yt.modalW,yt.modalH),t.end();var s=e/2-yt.modalRectW/2|0,a=e/2+yt.modalRectW/2|0,o=i/2-yt.modalRectH/2|0,l=i/2+yt.modalRectH/2|0;if(o+=yt.modalHeaderH,this.uimodal.begin(t),this.uimodal.window(bi.global.nest(51,null),s,o,yt.modalRectW,yt.modalRectH-100)){var u=bi.global.nest(52,null);u.text=this.uimodal.textInput(u),yt.path=yi.fileBrowser(this.uimodal,u,this.foldersOnly)}this.uimodal.end(!1),t.begin(!1),this.uimodal.beginLayout(t,a-100,l-30,100),this.uimodal.button("OK")&&(this.showFiles=!1,this.filesDone(yt.path)),this.uimodal.endLayout(!1),this.uimodal.beginLayout(t,a-200,l-30,100),this.uimodal.button("Cancel")&&(this.showFiles=!1),this.uimodal.endLayout(),t.end()},absx:function(t){return null==t?0:t.x+this.absx(this.elemById(t.parent))},absy:function(t){return null==t?0:t.y+this.absy(this.elemById(t.parent))},rotatePoint:function(t,e,i,n,r){e-=n;var s=(t-=i)*Math.cos(r)-e*Math.sin(r),a=t*Math.sin(r)+e*Math.cos(r);return new hi(i+s,n+a)},scaled:function(t){return t*this.cui.SCALE|0},__class__:yt};var xt=function(){};(y.HxOverrides=xt).__name__=!0,xt.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var r=t.split(" "),s=r[0].split("-"),a=r[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new ne("Invalid date format : "+t)}},xt.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},xt.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},xt.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},xt.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};function l(){}(y.Lambda=l).__name__=!0,l.array=function(t){for(var e=[],i=function(t){return t instanceof Array?xt.iter(t):t.iterator()}(t);i.hasNext();){var n=i.next();e.push(n)}return e};var Et=function(){};(y.Main=Et).__name__=!0,Et.main=function(){var t=1600,e=900;t>b.get_primary().get_width()&&(t=b.get_primary().get_width()),e>b.get_primary().get_height()-30&&(e=b.get_primary().get_height()-30),It.start(new H("Armory2D",t,e,null,new T(null,null,null,null,null,2)),Et.initialized)},Et.initialized=function(t){Et.prefs={path:"",scaleFactor:1};var e=Krom.getArgCount();if(4<e&&(Et.prefs.path=Krom.getArg(3)),5<e){var i=parseFloat(Krom.getArg(4));Et.prefs.scaleFactor=i}var n=Et.prefs.path.split("/");n.pop(),Et.cwd=n.join("/");var r="Windows"==It.get_systemId()?Bt.replace(Et.prefs.path,"/","\\"):Et.prefs.path;Ct.loadBlobFromPath(r,function(t){var e=JSON.parse(t.toString());Et.inst=new yt(e)},null,{fileName:"Main.hx",lineNumber:36,className:"Main",methodName:"initialized"})},Math.__name__=!0;var K=function(){};(y.Reflect=K).__name__=!0,K.field=function(t,e){try{return t[e]}catch(t){t instanceof ne&&t.val;return null}},K.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},K.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},K.copy=function(t){if(null==t)return null;for(var e={},i=0,n=K.fields(t);i<n.length;){var r=n[i];++i,e[r]=K.field(t,r)}return e};var Tt=function(){};(y.Std=Tt).__name__=!0,Tt.string=function(t){return p.__string_rec(t,"")},Tt.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e};var Bt=function(){};(y.StringTools=Bt).__name__=!0,Bt.endsWith=function(t,e){var i=e.length,n=t.length;return i<=n&&t.indexOf(e,n-i)==n-i},Bt.isSpace=function(t,e){var i=xt.cca(t,e);return 8<i&&i<14||32==i},Bt.rtrim=function(t){for(var e=t.length,i=0;i<e&&Bt.isSpace(t,e-i-1);)++i;return 0<i?xt.substr(t,0,e-i):t},Bt.replace=function(t,e,i){return t.split(e).join(i)};function Q(){}(y.Type=Q).__name__=!0,Q.createEnum=function(t,e,i){var n=K.field(t,e);if(null==n)throw new ne("No such constructor "+e);if(K.isFunction(n)){if(null==i)throw new ne("Constructor "+e+" need parameters");return n.apply(t,i)}if(null!=i&&0!=i.length)throw new ne("Constructor "+e+" does not need parameters");return n},Q.getInstanceFields=function(t){var e=[];for(var i in t.prototype)e.push(i);return xt.remove(e,"__class__"),xt.remove(e,"__properties__"),e};var Mt={};(y["_UInt.UInt_Impl_"]=Mt).__name__=!0,Mt.gt=function(t,e){var i=t<0;return i!=e<0?i:e<t},Mt.gte=function(t,e){var i=t<0;return i!=e<0?i:e<=t},Mt.toFloat=function(t){return t<0?4294967296+t:t+0};function s(){}(y["haxe.IMap"]=s).__name__=!0,s.__isInterface__=!0;function L(){}(y["haxe.Log"]=L).__name__=!0,L.formatOutput=function(t,e){var i=Tt.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e.customParams)for(var r=0,s=e.customParams;r<s.length;){var a=s[r];++r,i+=", "+Tt.string(a)}return n+": "+i},L.trace=function(t,e){var i=L.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};function a(){}(y["haxe._Unserializer.DefaultResolver"]=a).__name__=!0,a.prototype={resolveClass:function(t){return y[t]},resolveEnum:function(t){return f[t]},__class__:a};var J=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=J.DEFAULT_RESOLVER;null==e&&(e=new a,J.DEFAULT_RESOLVER=e),this.resolver=e};(y["haxe.Unserializer"]=J).__name__=!0,J.initCodes=function(){for(var t=[],e=0,i=J.BASE64.length;e<i;){var n=e++;t[J.BASE64.charCodeAt(n)]=n}return t},J.run=function(t){return new J(t).unserialize()},J.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||57<n)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return parseFloat(xt.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new ne("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new ne("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new ne("Invalid enum format");var i=this.readDigits();if(0==i)return Q.createEnum(t,e);for(var n=[];0<i--;)n.push(this.unserialize());return Q.createEnum(t,e,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new ne("Class not found "+t);return e;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new ne("Enum not found "+i);return n;case 67:var r=this.unserialize(),s=this.resolver.resolveClass(r);if(null==s)throw new ne("Class not found "+r);var a=Object.create(s.prototype);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new ne("Invalid custom data");return a;case 77:var o=new et;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new ne("Invalid string reference");return this.scache[u];case 97:this.buf;var h=[];for(this.cache.push(h);;){var A=this.buf.charCodeAt(this.pos);if(104==A){this.pos++;break}if(117==A){this.pos++;var c=this.readDigits();h[h.length+c-1]=null}else h.push(this.unserialize())}return h;case 98:var d=new it;this.cache.push(d);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var _=this.unserialize(),f=this.unserialize();null!=Ri[_]?d.setReserved(_,f):d.h[_]=f}return this.pos++,d;case 99:var g=this.unserialize(),p=this.resolver.resolveClass(g);if(null==p)throw new ne("Class not found "+g);var v=Object.create(p.prototype);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var m=this.unserialize(),w=this.resolver.resolveEnum(m);if(null==w)throw new ne("Enum not found "+m);this.pos++;var b=this.readDigits(),S=w.__constructs__.slice()[b];if(null==S)throw new ne("Unknown enum index "+m+"@"+b);var y=this.unserializeEnum(w,S);return this.cache.push(y),y;case 107:return NaN;case 108:var x=new tt;this.cache.push(x);for(this.buf;104!=this.buf.charCodeAt(this.pos);)x.add(this.unserialize());return this.pos++,x;case 109:return-1/0;case 110:return null;case 111:var E={};return this.cache.push(E),this.unserializeObject(E),E;case 112:return 1/0;case 113:var T=new $;this.cache.push(T);this.buf;for(var B=this.buf.charCodeAt(this.pos++);58==B;){var k=this.readDigits(),C=this.unserialize();T.h[k]=C,B=this.buf.charCodeAt(this.pos++)}if(104!=B)throw new ne("Invalid IntMap format");return T;case 114:var I=this.readDigits();if(I<0||I>=this.cache.length)throw new ne("Invalid reference");return this.cache[I];case 115:var L=this.readDigits(),N=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<L)throw new ne("Invalid bytes length");var P=J.CODES;null==P&&(P=J.initCodes(),J.CODES=P);for(var R=this.pos,M=3&L,V=R+(L-M),D=new kt(new ArrayBuffer(3*(L>>2)+(2<=M?M-1:0))),O=0;R<V;){var F=P[N.charCodeAt(R++)],U=P[N.charCodeAt(R++)];D.b[O++]=F<<2|U>>4;var H=P[N.charCodeAt(R++)];D.b[O++]=U<<4|H>>2;var W=P[N.charCodeAt(R++)];D.b[O++]=H<<6|W}if(2<=M){var G=P[N.charCodeAt(R++)],z=P[N.charCodeAt(R++)];if(D.b[O++]=G<<2|z>>4,3==M){var Y=P[N.charCodeAt(R++)];D.b[O++]=z<<4|Y>>2}}return this.pos+=L,this.cache.push(D),D;case 116:return!0;case 118:var X;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(X=xt.strDate(xt.substr(this.buf,this.pos,19)),this.pos+=19):X=new Date(this.readFloat()),this.cache.push(X),X;case 119:var K=this.unserialize(),Q=this.resolver.resolveEnum(K);if(null==Q)throw new ne("Enum not found "+K);var q=this.unserializeEnum(Q,this.unserialize());return this.cache.push(q),q;case 120:throw ne.wrap(this.unserialize());case 121:var j=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<j)throw new ne("Invalid string length");var Z=xt.substr(this.buf,this.pos,j);return this.pos+=j,Z=decodeURIComponent(Z.split("+").join(" ")),this.scache.push(Z),Z;case 122:return 0}throw this.pos--,new ne("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:J};var $=function(){this.h={}};(y["haxe.ds.IntMap"]=$).__name__=!0,$.__interfaces__=[s],$.prototype={h:null,keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return xt.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:$};var tt=function(){this.length=0};(y["haxe.ds.List"]=tt).__name__=!0,tt.prototype={h:null,q:null,length:null,add:function(t){var e=new o(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:tt};var o=function(t,e){this.item=t,this.next=e};(y["haxe.ds._List.ListNode"]=o).__name__=!0,o.prototype={item:null,next:null,__class__:o};var et=function(){this.h={__keys__:{}}};(y["haxe.ds.ObjectMap"]=et).__name__=!0,et.__interfaces__=[s],et.prototype={h:null,set:function(t,e){var i=t.__id__||(t.__id__=n.$haxeUID++);this.h[i]=e,this.h.__keys__[i]=t},__class__:et};var it=function(){this.h={}};(y["haxe.ds.StringMap"]=it).__name__=!0,it.__interfaces__=[s],it.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:it};var kt=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(y["haxe.io.Bytes"]=kt).__name__=!0,kt.ofString=function(t,e){if(e==c.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,r=t.length;n<r;){var s=n++,a=t.charCodeAt(s);i[s<<1]=255&a,i[s<<1|1]=a>>8}return new kt(i.buffer)}for(var o=[],l=0;l<t.length;){var u=t.charCodeAt(l++);55296<=u&&u<=56319&&(u=u-55232<<10|1023&t.charCodeAt(l++)),u<=127?o.push(u):(u<=2047?o.push(192|u>>6):(u<=65535?o.push(224|u>>12):(o.push(240|u>>18),o.push(128|u>>12&63)),o.push(128|u>>6&63)),o.push(128|63&u))}return new kt(new Uint8Array(o).buffer)},kt.ofData=function(t){var e=t.hxBytes;return null!=e?e:new kt(t)},kt.prototype={length:null,b:null,data:null,blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new ne(d.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new ne(d.OutsideBounds);return new kt(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getDouble:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(t,!0)},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setDouble:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(t,e,!0)},setFloat:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(t,e,!0)},getUInt16:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(t,!0)},getInt32:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new ne(d.OutsideBounds);null==i&&(i=c.UTF8);var n="",r=this.b,s=t,a=t+e;switch(i._hx_index){case 0:for(;s<a;){var o=r[s++];if(o<128){if(0==o)break;n+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&r[s++];n+=String.fromCodePoint(l)}else if(o<240){var u=(31&o)<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(u)}else{var h=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(h)}}break;case 1:for(;s<a;){var A=r[s++]|r[s++]<<8;n+=String.fromCodePoint(A)}}return n},toString:function(){return this.getString(0,this.length)},__class__:kt};function u(){this.pos=0,this.size=0}(y["haxe.io.BytesBuffer"]=u).__name__=!0,u.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var n=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(n,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),r=new Uint8Array(n);0<this.size&&r.set(this.u8),this.size=i,this.buffer=n,this.u8=r,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new kt(new ArrayBuffer(0));var t=new kt(this.buffer);return t.length=this.pos,t},__class__:u};function h(){}(y["haxe.io.Input"]=h).__name__=!0,h.prototype={bigEndian:null,readByte:function(){throw new ne("Not implemented")},readBytes:function(t,e,i){var n=i,r=t.b;if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);try{for(;0<n;)r[e]=this.readByte(),++e,--n}catch(t){var s=t instanceof ne?t.val:t;if(!(s instanceof v))throw t}return i-n},readFullBytes:function(t,e,i){for(;0<i;){var n=this.readBytes(t,e,i);if(0==n)throw new ne(d.Blocked);e+=n,i-=n}},read:function(t){for(var e=new kt(new ArrayBuffer(t)),i=0;0<t;){var n=this.readBytes(e,i,t);if(0==n)throw new ne(d.Blocked);i+=n,t-=n}return e},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=new kt(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:h};function ht(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i}(y["haxe.io.BytesInput"]=ht).__name__=!0,ht.__super__=h,ht.prototype=r(h.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new ne(new v);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);if(0==this.len&&0<i)throw new ne(new v);this.len<i&&(i=this.len);for(var n=this.b,r=t.b,s=0,a=i;s<a;){var o=s++;r[e+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:ht});function A(){}(y["haxe.io.Output"]=A).__name__=!0,A.prototype={bigEndian:null,writeByte:function(t){throw new ne("Not implemented")},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new ne(d.OutsideBounds);for(var n=t.b,r=i;0<r;)this.writeByte(n[e]),++e,--r;return i},write:function(t){for(var e=t.length,i=0;0<e;){var n=this.writeBytes(t,i,e);if(0==n)throw new ne(d.Blocked);i+=n,e-=n}},writeFloat:function(t){this.writeInt32(_.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:A};function At(){this.b=new u}(y["haxe.io.BytesOutput"]=At).__name__=!0,At.__super__=A,At.prototype=r(A.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:At});var c=f["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},v=function(){};(y["haxe.io.Eof"]=v).__name__=!0,v.prototype={toString:function(){return"Eof"},__class__:v};var d=f["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:(e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}},e.__params__=["e"],e)},_=function(){};(y["haxe.io.FPHelper"]=_).__name__=!0,_.floatToI32=function(t){return _.helper.setFloat32(0,t,!0),_.helper.getInt32(0,!0)};var g=function(){};(y["haxe.io.Path"]=g).__name__=!0,g.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,n=t.split("/");i<n.length;){var r=n[i];++i,".."==r&&0<e.length&&".."!=e[e.length-1]?e.pop():""==r?(0<e.length||47==xt.cca(t,0))&&e.push(r):"."!=r&&e.push(r)}for(var s="",a=!1,o=!1,l=0,u=e.join("/");l<u.length;){var h=u,A=l++,c=h.charCodeAt(A);55296<=c&&c<=56319&&(c=c-55232<<10|1023&h.charCodeAt(1+A));65536<=c&&++l;var d=c;switch(d){case 47:if(a){var _=d;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(_)}else o=!0;break;case 58:s+=":",a=!0;break;default:var f=d;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(f)}}return s};var ne=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,ne)};(y["js._Boot.HaxeError"]=ne).__name__=!0,ne.wrap=function(t){return t instanceof Error?t:new ne(t)},ne.__super__=Error,ne.prototype=r(Error.prototype,{val:null,__class__:ne});var p=function(){};(y["js.Boot"]=p).__name__=!0,p.getClass=function(t){if(null==t)return null;if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=p.__nativeClassName(t);return null!=i?p.__resolveNativeClass(i):null},p.__string_rec=function(r,s){if(null==r)return"null";if(5<=s.length)return"<...>";var t=typeof r;switch("function"==t&&(r.__name__||r.__ename__)&&(t="object"),t){case"function":return"<function>";case"object":if(r.__enum__){var e=f[r.__enum__],i=e.__constructs__[r._hx_index],a=e[i];return a.__params__?(s+="\t",i+"("+function(){for(var t=[],e=0,i=a.__params__;e<i.length;){var n=i[e];e+=1,t.push(p.__string_rec(r[n],s))}return t}().join(",")+")"):i}if(r instanceof Array){var n="[";s+="\t";for(var o=0,l=r.length;o<l;){var u=o++;n+=(0<u?",":"")+p.__string_rec(r[u],s)}return n+="]"}var h;try{h=r.toString}catch(t){t instanceof ne&&t.val;return"???"}if(null!=h&&h!=Object.toString&&"function"==typeof h){var A=r.toString();if("[object Object]"!=A)return A}var c="{\n";s+="\t";var d=null!=r.hasOwnProperty,_=null;for(_ in r)d&&!r.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=c.length&&(c+=", \n"),c+=s+_+" : "+p.__string_rec(r[_],s));return c+="\n"+(s=s.substring(1))+"}";case"string":return r;default:return String(r)}},p.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;if(Object.prototype.hasOwnProperty.call(t,"__interfaces__"))for(var i=t.__interfaces__,n=0,r=i.length;n<r;){var s=i[n++];if(s==e||p.__interfLoop(s,e))return!0}return p.__interfLoop(t.__super__,e)},p.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case Li:return"boolean"==typeof t;case Ci:return null!=t;case Ii:return"number"==typeof t;case ki:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(p.__downcastCheck(t,e))return!0}else if("object"==typeof e&&p.__isNativeObj(e)&&t instanceof e)return!0;return e==Ni&&null!=t.__name__||(e==Pi&&null!=t.__ename__||null!=t.__enum__&&f[t.__enum__]==e)}},p.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&p.__interfLoop(p.getClass(t),e)},p.__cast=function(t,e){if(null==t||p.__instanceof(t,e))return t;throw new ne("Cannot cast "+Tt.string(t)+" to "+Tt.string(e))},p.__nativeClassName=function(t){var e=p.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},p.__isNativeObj=function(t){return null!=p.__nativeClassName(t)},p.__resolveNativeClass=function(t){return n[t]};function m(){}(y["js.lib._ArrayBuffer.ArrayBufferCompat"]=m).__name__=!0,m.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),n=new Uint8Array(i.byteLength);return n.set(i),n.buffer};function q(){this.names=["color_wheel"],this.color_wheelDescription={name:"color_wheel",original_height:270,original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null}(y["kha._Assets.ImageList"]=q).__name__=!0,q.prototype={get:function(t){return K.field(this,t)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(e,t){Ct.loadImage("color_wheel",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},names:null,__class__:q};function j(){this.names=[]}(y["kha._Assets.SoundList"]=j).__name__=!0,j.prototype={get:function(t){return K.field(this,t)},names:null,__class__:j};function Z(){this.names=[]}(y["kha._Assets.BlobList"]=Z).__name__=!0,Z.prototype={get:function(t){return K.field(this,t)},names:null,__class__:Z};function nt(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null}(y["kha._Assets.FontList"]=nt).__name__=!0,nt.prototype={get:function(t){return K.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){Ct.loadFont("font_default",function(t){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:nt};function rt(){this.names=[]}(y["kha._Assets.VideoList"]=rt).__name__=!0,rt.prototype={get:function(t){return K.field(this,t)},names:null,__class__:rt};var Ct=function(){};(y["kha.Assets"]=Ct).__name__=!0,Ct.loadEverything=function(t,e,i,n){for(var r=0,s=0,a=Q.getInstanceFields(Z);s<a.length;){var o=a[s];++s,Bt.endsWith(o,"Load")&&(r+=1)}for(var l=0,u=Q.getInstanceFields(q);l<u.length;){var h=u[l];++l,Bt.endsWith(h,"Load")&&(r+=1)}for(var A=0,c=Q.getInstanceFields(j);A<c.length;){var d=c[A];++A,Bt.endsWith(d,"Load")&&(r+=1)}for(var _=0,f=Q.getInstanceFields(nt);_<f.length;){var g=f[_];++_,Bt.endsWith(g,"Load")&&(r+=1)}for(var p=0,v=Q.getInstanceFields(rt);p<v.length;){var m=v[p];++p,Bt.endsWith(m,"Load")&&(r+=1)}if(0!=r){for(var w=r,b=function(){w-=1,Ct.progress=1-w/r,0==w&&t()},S=0,y=Q.getInstanceFields(Z);S<y.length;){var x=y[S];if(++S,Bt.endsWith(x,"Load")){var E=xt.substr(x,0,x.length-4),T=K.field(Ct.blobs,E+"Description");null==e||e(T)?K.field(Ct.blobs,x)(b,function(t){Ct.reporter(n,{fileName:"kha/Assets.hx",lineNumber:142,className:"kha.Assets",methodName:"loadEverything"})(t),b()}):b()}}for(var B=0,k=Q.getInstanceFields(q);B<k.length;){var C=k[B];if(++B,Bt.endsWith(C,"Load")){var I=xt.substr(C,0,C.length-4),L=K.field(Ct.images,I+"Description");null==e||e(L)?K.field(Ct.images,C)(b,function(t){Ct.reporter(n,{fileName:"kha/Assets.hx",lineNumber:158,className:"kha.Assets",methodName:"loadEverything"})(t),b()}):b()}}for(var N=0,P=Q.getInstanceFields(j);N<P.length;){var R=[P[N]];if(++N,Bt.endsWith(R[0],"Load")){var M=xt.substr(R[0],0,R[0].length-4),V=[K.field(Ct.sounds,M+"Description")];null==e||e(V[0])?K.field(Ct.sounds,R[0])(function(t,e){return function(){null==i||i(t[0])?K.field(Ct.sounds,e[0].substring(0,e[0].length-4)).uncompress(b):b()}}(V,R),function(t){Ct.reporter(n,{fileName:"kha/Assets.hx",lineNumber:181,className:"kha.Assets",methodName:"loadEverything"})(t),b()}):b()}}for(var D=0,O=Q.getInstanceFields(nt);D<O.length;){var F=O[D];if(++D,Bt.endsWith(F,"Load")){var U=xt.substr(F,0,F.length-4),H=K.field(Ct.fonts,U+"Description");null==e||e(H)?K.field(Ct.fonts,F)(b,function(t){Ct.reporter(n,{fileName:"kha/Assets.hx",lineNumber:196,className:"kha.Assets",methodName:"loadEverything"})(t),b()}):b()}}for(var W=0,G=Q.getInstanceFields(rt);W<G.length;){var z=G[W];if(++W,Bt.endsWith(z,"Load")){var Y=xt.substr(z,0,z.length-4),X=K.field(Ct.videos,Y+"Description");null==e||e(X)?K.field(Ct.videos,z)(b,function(t){Ct.reporter(n,{fileName:"kha/Assets.hx",lineNumber:211,className:"kha.Assets",methodName:"loadEverything"})(t),b()}):b()}}}else t()},Ct.loadImage=function(e,i,t,n){var r=K.field(Ct.images,e+"Description");R.loadImageFromDescription(r,function(t){Ct.images[e]=t,i(t)},Ct.reporter(t,n))},Ct.loadImageFromPath=function(t,e,i,n,r){var s={files:[t],readable:e};R.loadImageFromDescription(s,i,Ct.reporter(n,r))},Ct.get_imageFormats=function(){return R.getImageFormats()},Ct.loadBlob=function(e,i,t,n){var r=K.field(Ct.blobs,e+"Description");R.loadBlobFromDescription(r,function(t){Ct.blobs[e]=t,i(t)},Ct.reporter(t,n))},Ct.loadBlobFromPath=function(t,e,i,n){var r={files:[t]};R.loadBlobFromDescription(r,e,Ct.reporter(i,n))},Ct.loadSound=function(e,i,t,n){var r=K.field(Ct.sounds,e+"Description");R.loadSoundFromDescription(r,function(t){Ct.sounds[e]=t,i(t)},Ct.reporter(t,n))},Ct.loadSoundFromPath=function(t,e,i,n){var r={files:[t]};R.loadSoundFromDescription(r,e,Ct.reporter(i,n))},Ct.get_soundFormats=function(){return R.getSoundFormats()},Ct.loadFont=function(e,i,t,n){var r=K.field(Ct.fonts,e+"Description");R.loadFontFromDescription(r,function(t){Ct.fonts[e]=t,i(t)},Ct.reporter(t,n))},Ct.loadFontFromPath=function(t,e,i,n){var r={files:[t]};R.loadFontFromDescription(r,e,Ct.reporter(i,n))},Ct.get_fontFormats=function(){return["ttf"]},Ct.loadVideo=function(e,i,t,n){var r=K.field(Ct.videos,e+"Description");R.loadVideoFromDescription(r,function(t){Ct.videos[e]=t,i(t)},Ct.reporter(t,n))},Ct.loadVideoFromPath=function(t,e,i,n){var r={files:[t]};R.loadVideoFromDescription(r,e,Ct.reporter(i,n))},Ct.get_videoFormats=function(){return R.getVideoFormats()},Ct.reporter=function(t,e){if(null!=t)return t;var i=L.trace,n=e;return function(t){i(t,n)}};function w(){}(y["kha.Canvas"]=w).__name__=!0,w.__isInterface__=!0,w.prototype={get_width:null,get_height:null,get_g1:null,get_g2:null,get_g4:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:w};var B=t.kha._Color.Color_Impl_={};(y["kha._Color.Color_Impl_"]=B).__name__=!0,B.fromValue=function(t){return B._new(t)},B.fromBytes=function(t,e,i,n){return null==n&&(n=255),B._new(n<<24|t<<16|e<<8|i)},B.fromFloats=function(t,e,i,n){return null==n&&(n=1),B._new((255*n|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*i|0)},B.fromString=function(t){if(7!=t.length&&9!=t.length||35!=t.charCodeAt(0))throw new ne("Invalid Color string: '"+t+"'");var e=Tt.parseInt("0x"+xt.substr(t,1,null));return 7==t.length&&(e+=-16777216),B._new(e)},B._new=function(t){return t},B.get_value=function(t){return t},B.set_value=function(t,e){return e},B.get_Rb=function(t){return(16711680&t)>>>16},B.get_Gb=function(t){return(65280&t)>>>8},B.get_Bb=function(t){return 255&t},B.get_Ab=function(t){return t>>>24},B.set_Rb=function(t,e){return t=t>>>24<<24|e<<16|(65280&t)>>>8<<8|255&t,e},B.set_Gb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|e<<8|255&t,e},B.set_Bb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|e,e},B.set_Ab=function(t,e){return t=e<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|255&t,e},B.get_R=function(t){return.00392156862745098*((16711680&t)>>>16)},B.get_G=function(t){return.00392156862745098*((65280&t)>>>8)},B.get_B=function(t){return.00392156862745098*(255&t)},B.get_A=function(t){return.00392156862745098*(t>>>24)},B.set_R=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(255*e|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e},B.set_G=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(255*e|0)<<8|.00392156862745098*(255&t)*255|0,e},B.set_B=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|255*e|0,e},B.set_A=function(t,e){return t=(255*e|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e};var b=function(t,e){this.num=t,this.isPrimary=e};(y["kha.Display"]=b).__name__=!0,b.init=function(){for(var t=0,e=Krom.displayCount();t<e;){var i=t++;b.displays.push(new b(i,Krom.displayIsPrimary(i)))}},b.get_primary=function(){b.init();for(var t=0,e=b.displays;t<e.length;){var i=e[t];if(++t,i.isPrimary)return i}return null},b.get_all=function(){return b.init(),b.displays},b.prototype={num:null,isPrimary:null,get_available:function(){return!0},get_name:function(){return"Display"},get_x:function(){return Krom.displayX(this.num)},get_y:function(){return Krom.displayY(this.num)},get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},get_pixelsPerInch:function(){return Krom.screenDpi()},get_modes:function(){return[]},__class__:b};function S(t,e,i,n){this.width=t,this.height=e,this.frequency=i,this.bitsPerPixel=n}(y["kha.DisplayMode"]=S).__name__=!0,S.prototype={width:null,height:null,frequency:null,bitsPerPixel:null,__class__:S};function x(t,e,i){this.bold=t,this.italic=e,this.underlined=i}(y["kha.FontStyle"]=x).__name__=!0,x.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:x};function E(t,e,i,n){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=n}(y["kha.Framebuffer"]=E).__name__=!0,E.__interfaces__=[w],E.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(t,e,i){this.graphics1=t,this.graphics2=e,this.graphics4=i},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return It.windowWidth(this.window)},height:null,get_height:function(){return It.windowHeight(this.window)},__class__:E};var T=function(t,e,i,n,r,s){null==s&&(s=1),null==r&&(r=8),null==n&&(n=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=n,this.stencilBufferBits=r,this.samplesPerPixel=s};(y["kha.FramebufferOptions"]=T).__name__=!0,T.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:T};function k(){}(y["kha.Resource"]=k).__name__=!0,k.__isInterface__=!0,k.prototype={unload:null,__class__:k};var C=function(t){this.pixels=null,this.texture_=t};(y["kha.Image"]=C).__name__=!0,C.__interfaces__=[k,w],C.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 1:return 5;case 2:return 3;case 3:return 4;case 4:return 1;case 5:return 2;case 6:return 6;default:return 0}},C.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},C.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},C.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;case 6:return 7;default:return 1}},C._fromTexture=function(t){return new C(t)},C.fromBytes=function(t,e,i,n,r){null==n&&(n=0);var s=new C(null);return s.format=n,s.texture_=Krom.createTextureFromBytes(t.b.bufferValue,e,i,C.getTextureFormat(n),!0),s},C.fromBytes3D=function(t,e,i,n,r,s){null==r&&(r=0);var a=new C(null);return a.format=r,a.texture_=Krom.createTextureFromBytes3D(t.b.bufferValue,e,i,n,C.getTextureFormat(r),!0),a},C.fromEncodedBytes=function(t,e,i,n,r){null==r&&(r=!1);var s=new C(null);s.texture_=Krom.createTextureFromEncodedBytes(t.b.bufferValue,e,r),i(s)},C.create=function(t,e,i,n){null==i&&(i=0);var r=new C(null);return r.format=i,r.texture_=Krom.createTexture(t,e,C.getTextureFormat(i)),r},C.create3D=function(t,e,i,n,r){null==n&&(n=0);var s=new C(null);return s.format=n,s.texture_=Krom.createTexture3D(t,e,i,C.getTextureFormat(n)),s},C.createRenderTarget=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=1),null==n&&(n=0),null==i&&(i=0);var a=new C(null);return a.format=i,a.renderTarget_=Krom.createRenderTarget(t,e,C.getDepthBufferBits(n),C.getRenderTargetFormat(i),C.getStencilBufferBits(n),s),a},C.get_maxSize=function(){return 4096},C.get_nonPow2Supported=function(){return!0},C.renderTargetsInvertedY=function(){return Krom.renderTargetsInvertedY()},C.formatByteSize=function(t){switch(t){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},C.prototype={texture_:null,renderTarget_:null,format:null,readable:null,graphics1:null,graphics2:null,graphics4:null,isOpaque:function(t,e){return!1},at:function(t,e){return-16777216},unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(t){return null==t&&(t=0),kt.ofData(Krom.lockTexture(this.texture_,t))},unlock:function(){Krom.unlockTexture(this.texture_)},pixels:null,getPixels:function(){return null!=this.renderTarget_?(null==this.pixels&&(this.pixels=new kt(new ArrayBuffer(C.formatByteSize(this.format)*this.get_width()*this.get_height()))),Krom.getRenderTargetPixels(this.renderTarget_,this.pixels.b.bufferValue),this.pixels):kt.ofData(Krom.getTexturePixels(this.texture_))},generateMipmaps:function(t){null==this.texture_?Krom.generateRenderTargetMipmaps(this.renderTarget_,t):Krom.generateTextureMipmaps(this.texture_,t)},setMipmaps:function(t){Krom.setMipmaps(this.texture_,t)},setDepthStencilFrom:function(t){Krom.setDepthStencilFrom(this.renderTarget_,t.renderTarget_)},clear:function(t,e,i,n,r,s,a){Krom.clearTexture(this.texture_,t,e,i,n,r,s,a)},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},depth:null,get_depth:function(){return null!=this.texture_?this.texture_.depth:1},realWidth:null,get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},realHeight:null,get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},g1:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new ie(this)),this.graphics1},g2:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new Re(this)),this.graphics2},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new ei(this)),this.graphics4},__class__:C};function I(){}(y["kha.AlignedQuad"]=I).__name__=!0,I.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:I};function N(t,e,i,n,r,s,a,o){this.mySize=t,this.width=r,this.height=s,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var u=a[l];++l,u.yoff+=this.baseline}this.texture=C.fromBytes(o.toBytes(),r,s,1)}(y["kha.KravurImage"]=N).__name__=!0,N.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,n){if(e>=this.chars.length)return null;var r=1/this.width,s=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*r,t.t0=a.y0*s,t.s1=a.x1*r,t.t1=a.y1*s,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=N.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,n=N.charBlocks.length/2|0;i<n;){var r=i++,s=N.charBlocks[2*r-1],a=N.charBlocks[2*r];a-1<t&&(e+=a-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,n=t.length;i<n;){var r=i++;e+=this.getCharWidth(xt.cca(t,r))}return e},charactersWidth:function(t,e,i){for(var n=0,r=e,s=e+i;r<s;){var a=r++;n+=this.getCharWidth(t[a])}return n},getBaselinePosition:function(){return this.baseline},__class__:N};function P(t){this.images=new $,this.blob=t}(y["kha.Kravur"]=P).__name__=!0,P.__interfaces__=[k],P.fromBytes=function(t){return new P(ti.fromBytes(t))},P.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=ee.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(N.charBlocks=[e[0]])[0]+1,n=1,r=e.length;n<r;){var s=n++;e[s]!=i?(N.charBlocks.push(e[s-1]),N.charBlocks.push(e[s]),i=e[s]+1):++i}N.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(this.images.h.hasOwnProperty(a))return this.images.h[a];for(var o=64,l=32,u=new Array(e.length),h=0,A=u.length;h<A;){u[h++]=new de}for(var c=null,d=-1;d<=0;)l<o?l*=2:o*=2,c=ti.alloc(o*l),d=xe.stbtt_BakeFontBitmap(this.blob,0,t,c,o,l,e,u);var _=new ve;xe.stbtt_InitFont(_,this.blob,0);var f=xe.stbtt_GetFontVMetrics(_),g=xe.stbtt_ScaleForPixelHeight(_,t),p=Math.round(f.ascent*g),v=Math.round(f.descent*g),m=Math.round(f.lineGap*g),w=new N(0|t,p,v,m,o,l,u,c);return this.images.h[a]=w},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},widthOfCharacters:function(t,e,i,n){return this._get(t).charactersWidth(e,i,n)},baseline:function(t){return this._get(t).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:P};var R=function(){};(y["kha.LoaderImpl"]=R).__name__=!0,R.getImageFormats=function(){return["png","jpg"]},R.loadImageFromDescription=function(t,e,i){var n=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;e(C._fromTexture(Krom.loadImage(t.files[0],n)))},R.getSoundFormats=function(){return["wav","ogg"]},R.loadSoundFromDescription=function(t,e,i){e(new ii(kt.ofData(Krom.loadSound(t.files[0]))))},R.getVideoFormats=function(){return["webm"]},R.loadVideoFromDescription=function(t,e,i){},R.loadBlobFromDescription=function(t,e,i){e(new ti(kt.ofData(Krom.loadBlob(t.files[0]))))},R.loadFontFromDescription=function(t,e,i){R.loadBlobFromDescription(t,function(t){e(new P(t))},i)};function M(){}(y["kha.TimeTask"]=M).__name__=!0,M.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:M};function V(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1}(y["kha.FrameTask"]=V).__name__=!0,V.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:V};var D=function(){};(y["kha.Scheduler"]=D).__name__=!0,D.init=function(){D.deltas=[];for(var t=0,e=D.DIF_COUNT;t<e;){var i=t++;D.deltas[i]=0}D.stopped=!0,D.frame_tasks_sorted=!0,D.current=D.lastTime=D.realTime(),D.currentFrameTaskId=0,D.currentTimeTaskId=0,D.currentGroupId=0,D.timeTasks=[],D.pausedTimeTasks=[],D.outdatedTimeTasks=[],D.timeTasksScratchpad=[],D.frameTasks=[],D.toDeleteFrame=[]},D.start=function(t){null==t&&(t=!1),D.vsync=z.get(0).get_vSynced();var e=b.get_primary().get_frequency();57<=e&&e<=63&&(e=60),D.onedifhz=1/e,D.stopped=!1,D.resetTime(),D.lastTime=D.realTime()-D.startTime;for(var i=0,n=D.DIF_COUNT;i<n;){var r=i++;D.deltas[r]=0}if(t){for(var s=0,a=D.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,u=D.frameTasks;l<u.length;){var h=u[l];++l,h.paused=!1}}},D.stop=function(){D.stopped=!0},D.isStopped=function(){return D.stopped},D.warpTimeTasksBack=function(t,e){for(var i=0;i<e.length;){var n=e[i];if(++i,n.start>=t)n.next=n.start;else if(0<n.period){var r=t-n.start,s=Math.ceil(r/n.period);n.next=n.start+s*n.period}}},D.warp=function(t){if(t<D.lastTime){D.current=t,D.lastTime=t,D.warpTimeTasksBack(t,D.outdatedTimeTasks),D.warpTimeTasksBack(t,D.timeTasks);for(var e=0,i=D.outdatedTimeTasks;e<i.length;){var n=i[e];++e,n.next>=t&&D.timeTasksScratchpad.push(n)}for(var r=0,s=D.timeTasksScratchpad;r<s.length;){var a=s[r];++r,xt.remove(D.outdatedTimeTasks,a)}for(var o=0,l=D.timeTasksScratchpad;o<l.length;){var u=l[o];++o,D.insertSorted(D.timeTasks,u)}for(;0<D.timeTasksScratchpad.length;)xt.remove(D.timeTasksScratchpad,D.timeTasksScratchpad[0])}else t>D.lastTime&&(D.startTime-=t-D.lastTime,D.current=t,D.lastTime=t,D.executeTimeTasks(t))},D.executeFrame=function(){var t=D.realTime()-D.startTime-D.lastTime,e=D.current;if(0<=t){if(null==vi.the())if(t>D.maxframetime)D.startTime+=t-D.maxframetime,e+=t=D.maxframetime;else if(D.vsync){for(var i=D.onedifhz;i<t-D.onedifhz;)i+=D.onedifhz;t=i;for(var n=0,r=D.DIF_COUNT-2;n<r;){var s=n++;t+=D.deltas[s],D.deltas[s]=D.deltas[1+s]}t+=D.deltas[D.DIF_COUNT-2],t/=D.DIF_COUNT,D.deltas[D.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=D.DIF_COUNT-1;a<o;){var l=a++;D.deltas[l]=D.deltas[1+l]}D.deltas[D.DIF_COUNT-1]=t;for(var u=0,h=0,A=D.DIF_COUNT;h<A;){var c=h++;u+=D.deltas[c]}e+=u/=D.DIF_COUNT}else e+=t;D.lastTime=e,D.stopped||(D.current=e);for(var d=0,_=D.pausedTimeTasks;d<_.length;){var f=_[d];++d,f.next+=t}if(D.stopped)for(var g=0,p=D.timeTasks;g<p.length;){var v=p[g];++g,v.next+=t}D.executeTimeTasks(e);for(var m=0,w=D.outdatedTimeTasks;m<w.length;){var b=w[m];++m,b.next<e-10&&D.timeTasksScratchpad.push(b)}for(var S=0,y=D.timeTasksScratchpad;S<y.length;){var x=y[S];++S,xt.remove(D.outdatedTimeTasks,x)}for(;0<D.timeTasksScratchpad.length;)xt.remove(D.timeTasksScratchpad,D.timeTasksScratchpad[0])}D.sortFrameTasks();for(var E=0,T=D.frameTasks;E<T.length;){var B=T[E];++E,D.stopped||B.paused||!B.active||B.task()||(B.active=!1)}for(var k=0,C=D.frameTasks;k<C.length;){var I=C[k];++k,I.active||D.toDeleteFrame.push(I)}for(;0<D.toDeleteFrame.length;)xt.remove(D.frameTasks,D.toDeleteFrame.pop())},D.executeTimeTasks=function(t){for(;0<D.timeTasks.length&&(D.activeTimeTask=D.timeTasks[0],D.activeTimeTask.next<=t);)D.activeTimeTask.next+=D.activeTimeTask.period,xt.remove(D.timeTasks,D.activeTimeTask),D.activeTimeTask.active&&D.activeTimeTask.task()?0<D.activeTimeTask.period&&(0==D.activeTimeTask.duration||D.activeTimeTask.duration>=D.activeTimeTask.start+D.activeTimeTask.next)?D.insertSorted(D.timeTasks,D.activeTimeTask):D.archiveTimeTask(D.activeTimeTask,t):(D.activeTimeTask.active=!1,D.archiveTimeTask(D.activeTimeTask,t));D.activeTimeTask=null},D.archiveTimeTask=function(t,e){},D.time=function(){return D.current},D.realTime=function(){return It.get_time()},D.resetTime=function(){var t=It.get_time(),e=t-D.startTime;D.startTime=t;for(var i=0,n=D.timeTasks;i<n.length;){var r=n[i];++i,r.start-=e,r.next-=e}for(var s=0,a=D.DIF_COUNT;s<a;){var o=s++;D.deltas[o]=0}D.current=0,D.lastTime=0},D.addBreakableFrameTask=function(t,e){return D.frameTasks.push(new V(t,e,++D.currentFrameTaskId)),D.frame_tasks_sorted=!1,D.currentFrameTaskId},D.addFrameTask=function(t,e){return D.addBreakableFrameTask(function(){return t(),!0},e)},D.pauseFrameTask=function(t,e){for(var i=0,n=D.frameTasks;i<n.length;){var r=n[i];if(++i,r.id==t){r.paused=e;break}}},D.removeFrameTask=function(t){for(var e=0,i=D.frameTasks;e<i.length;){var n=i[e];if(++e,n.id==t){n.active=!1;break}}},D.generateGroupId=function(){return++D.currentGroupId},D.addBreakableTimeTaskToGroup=function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=new M;return s.active=!0,s.task=e,s.id=++D.currentTimeTaskId,s.groupId=t,s.start=D.current+i,(s.period=0)!=n&&(s.period=n),(s.duration=0)!=r&&(s.duration=s.start+r),s.next=s.start,D.insertSorted(D.timeTasks,s),s.id},D.addTimeTaskToGroup=function(t,e,i,n,r){return null==r&&(r=0),null==n&&(n=0),D.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,n,r)},D.addBreakableTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),D.addBreakableTimeTaskToGroup(0,t,e,i,n)},D.addTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),D.addTimeTaskToGroup(0,t,e,i,n)},D.getTimeTask=function(t){if(null!=D.activeTimeTask&&D.activeTimeTask.id==t)return D.activeTimeTask;for(var e=0,i=D.timeTasks;e<i.length;){var n=i[e];if(++e,n.id==t)return n}for(var r=0,s=D.pausedTimeTasks;r<s.length;){var a=s[r];if(++r,a.id==t)return a}return null},D.pauseTimeTask=function(t,e){var i=D.getTimeTask(t);null!=i&&D.pauseRunningTimeTask(i,e),null!=D.activeTimeTask&&D.activeTimeTask.id==t&&(D.activeTimeTask.paused=e)},D.pauseRunningTimeTask=function(t,e){(t.paused=e)?(xt.remove(D.timeTasks,t),D.pausedTimeTasks.push(t)):(D.insertSorted(D.timeTasks,t),xt.remove(D.pausedTimeTasks,t))},D.pauseTimeTasks=function(t,e){for(var i=0,n=D.timeTasks;i<n.length;){var r=n[i];++i,r.groupId==t&&D.pauseRunningTimeTask(r,e)}null!=D.activeTimeTask&&D.activeTimeTask.groupId==t&&(D.activeTimeTask.paused=e)},D.removeTimeTask=function(t){var e=D.getTimeTask(t);null!=e&&(e.active=!1,xt.remove(D.timeTasks,e))},D.removeTimeTasks=function(t){for(var e=0,i=D.timeTasks;e<i.length;){var n=i[e];++e,n.groupId==t&&(n.active=!1,D.timeTasksScratchpad.push(n))}for(var r=0,s=D.timeTasksScratchpad;r<s.length;){var a=s[r];++r,xt.remove(D.timeTasks,a)}for(;0<D.timeTasksScratchpad.length;)xt.remove(D.timeTasksScratchpad,D.timeTasksScratchpad[0]);null!=D.activeTimeTask&&D.activeTimeTask.groupId==t&&(D.activeTimeTask.active=!1)},D.numTasksInSchedule=function(){return D.timeTasks.length+D.frameTasks.length},D.insertSorted=function(t,e){for(var i=0,n=t.length;i<n;){var r=i++;if(t[r].next>e.next)return void t.splice(r,0,e)}t.push(e)},D.sortFrameTasks=function(){D.frame_tasks_sorted||(D.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),D.frame_tasks_sorted=!0)};function O(){}var F=f["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:i},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:i},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:i},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:i}};(y["kha.Shaders"]=O).__name__=!0,O.init=function(){var t=[],e=K.field(O,"painter_colored_fragData0"),i=J.run(e);t.push(ti.fromBytes(i)),O.painter_colored_frag=new Be(t,["painter-colored.frag.d3d11"]);var n=[],r=K.field(O,"painter_colored_vertData0"),s=J.run(r);n.push(ti.fromBytes(s)),O.painter_colored_vert=new ze(n,["painter-colored.vert.d3d11"]);var a=[],o=K.field(O,"painter_image_fragData0"),l=J.run(o);a.push(ti.fromBytes(l)),O.painter_image_frag=new Be(a,["painter-image.frag.d3d11"]);var u=[],h=K.field(O,"painter_image_vertData0"),A=J.run(h);u.push(ti.fromBytes(A)),O.painter_image_vert=new ze(u,["painter-image.vert.d3d11"]);var c=[],d=K.field(O,"painter_text_fragData0"),_=J.run(d);c.push(ti.fromBytes(_)),O.painter_text_frag=new Be(c,["painter-text.frag.d3d11"]);var f=[],g=K.field(O,"painter_text_vertData0"),p=J.run(g);f.push(ti.fromBytes(p)),O.painter_text_vert=new ze(f,["painter-text.vert.d3d11"]);var v=[],m=K.field(O,"painter_video_fragData0"),w=J.run(m);v.push(ti.fromBytes(w)),O.painter_video_frag=new Be(v,["painter-video.frag.d3d11"]);var b=[],S=K.field(O,"painter_video_vertData0"),y=J.run(S);b.push(ti.fromBytes(y)),O.painter_video_vert=new ze(b,["painter-video.vert.d3d11"])};function U(){this.sampleRate=0,this.channels=0,this.length=0}(y["kha.Sound"]=U).__name__=!0,U.__interfaces__=[k],U.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(t){if(null==this.uncompressedData){var e=new At,i=bt.readAll(this.compressedData,e,!0),n=e.getBytes(),r=n.length/4|0;if(1==i.channel){this.length=r/ct.samplesPerSecond;var s=new Float32Array(2*r);this.uncompressedData=s;for(var a=0,o=r;a<o;){var l=a++;this.uncompressedData[2*l]=n.getFloat(4*l),this.uncompressedData[2*l+1]=n.getFloat(4*l)}}else{this.length=r/2/ct.samplesPerSecond;var u=new Float32Array(r);this.uncompressedData=u;for(var h=0,A=r;h<A;){var c=h++;this.uncompressedData[c]=n.getFloat(4*c)}}this.channels=i.channel,this.sampleRate=i.sampleRate,this.compressedData=null,t()}else t()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:U};var H=function(t,e,i,n,r){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==n?new X(null,null,null,null,null,null,null,null,null):n,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<i?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==r?new T(null,null,null,null,null,null):r};(y["kha.SystemOptions"]=H).__name__=!0,H.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:H};var It=function(){};(y["kha.System"]=It).__name__=!0,It.init=function(t,e){var i=0;t.resizable&&(i|=1),t.maximizable&&(i|=4),t.minimizable&&(i|=2);var n=new H(t.title,t.width,t.height,new X(null,null,null,null,null,null,null,i,t.windowMode),new T(null,t.vSync,null,null,null,t.samplesPerPixel));It.start(n,function(t){e()})},It.start=function(t,e){It.theTitle=t.title,W.init(t,e)},It.get_title=function(){return It.theTitle},It.notifyOnRender=function(e,i){null==i&&(i=0),It.renderListeners.push(function(t){i<t.length&&e(t[i])})},It.notifyOnFrames=function(t){It.renderListeners.push(t)},It.removeFramesListener=function(t){xt.remove(It.renderListeners,t)},It.notifyOnApplicationState=function(t,e,i,n,r){null!=t&&It.foregroundListeners.push(t),null!=e&&It.resumeListeners.push(e),null!=i&&It.pauseListeners.push(i),null!=n&&It.backgroundListeners.push(n),null!=r&&It.shutdownListeners.push(r)},It.notifyOnDropFiles=function(t){It.dropFilesListeners.push(t)},It.removeDropListerer=function(t){xt.remove(It.dropFilesListeners,t)},It.notifyOnCutCopyPaste=function(t,e,i){It.cutListener=t,It.copyListener=e,It.pasteListener=i},It.notifyOnLoginLogout=function(t,e){It.loginListener=t,It.logoutListener=e},It.login=function(){W.login()},It.render=function(t){for(var e=0,i=It.renderListeners;e<i.length;){var n=i[e];++e,n(t)}},It.foreground=function(){for(var t=0,e=It.foregroundListeners;t<e.length;){var i=e[t];++t,i()}},It.resume=function(){for(var t=0,e=It.resumeListeners;t<e.length;){var i=e[t];++t,i()}},It.pause=function(){for(var t=0,e=It.pauseListeners;t<e.length;){var i=e[t];++t,i()}},It.background=function(){for(var t=0,e=It.backgroundListeners;t<e.length;){var i=e[t];++t,i()}},It.shutdown=function(){for(var t=0,e=It.shutdownListeners;t<e.length;){var i=e[t];++t,i()}},It.dropFiles=function(t){for(var e=0,i=It.dropFilesListeners;e<i.length;){var n=i[e];++e,n(t)}},It.get_time=function(){return W.getTime()},It.windowWidth=function(t){return null==t&&(t=0),z.get(t).get_width()},It.windowHeight=function(t){return null==t&&(t=0),z.get_all()[t].get_height()},It.get_screenRotation=function(){return F.RotationNone},It.get_systemId=function(){return W.getSystemId()},It.vibrate=function(t){W.vibrate(t)},It.get_language=function(){return W.getLanguage()},It.stop=function(){return W.requestShutdown()},It.loadUrl=function(t){W.loadUrl(t)},It.canSwitchFullscreen=function(){return!0},It.isFullscreen=function(){return 1==z.get(0).get_mode()||2==z.get(0).get_mode()},It.requestFullscreen=function(){z.get(0).set_mode(1)},It.exitFullscreen=function(){z.get(0).set_mode(0)},It.notifyOnFullscreenChange=function(t,e){},It.removeFullscreenListener=function(t,e){},It.changeResolution=function(t,e){},It.requestShutdown=function(){It.stop()},It.get_vsync=function(){return z.get(0).get_vSynced()},It.get_refreshRate=function(){return b.get_primary().get_frequency()},It.screenDpi=function(){return b.get_primary().get_pixelsPerInch()},It.safeZone=function(){return W.safeZone()},It.automaticSafeZone=function(){return W.automaticSafeZone()},It.setSafeZone=function(t){W.setSafeZone(t)},It.unlockAchievement=function(t){W.unlockAchievement(t)};var W=function(){};(y["kha.SystemImpl"]=W).__name__=!0,W.renderCallback=function(){D.executeFrame(),It.render([W.framebuffer])},W.dropFilesCallback=function(t){It.dropFiles(t)},W.copyCallback=function(){return null!=It.copyListener?It.copyListener():null},W.cutCallback=function(){return null!=It.cutListener?It.cutListener():null},W.pasteCallback=function(t){null!=It.pasteListener&&It.pasteListener(t)},W.foregroundCallback=function(){It.foreground()},W.resumeCallback=function(){It.resume()},W.pauseCallback=function(){It.pause()},W.backgroundCallback=function(){It.background()},W.shutdownCallback=function(){It.shutdown()},W.keyboardDownCallback=function(t){W.keyboard.sendDownEvent(t)},W.keyboardUpCallback=function(t){W.keyboard.sendUpEvent(t)},W.keyboardPressCallback=function(t){W.keyboard.sendPressEvent(String.fromCodePoint(t))},W.mouseDownCallback=function(t,e,i){W.mouse.sendDownEvent(0,t,e,i)},W.mouseUpCallback=function(t,e,i){W.mouse.sendUpEvent(0,t,e,i)},W.mouseMoveCallback=function(t,e,i,n){W.mouse.sendMoveEvent(0,t,e,i,n)},W.mouseWheelCallback=function(t){W.mouse.sendWheelEvent(0,t)},W.penDownCallback=function(t,e,i){W.pen.sendDownEvent(0,t,e,i)},W.penUpCallback=function(t,e,i){W.pen.sendUpEvent(0,t,e,i)},W.penMoveCallback=function(t,e,i){W.pen.sendMoveEvent(0,t,e,i)},W.gamepadAxisCallback=function(t,e,i){W.gamepads[t].sendAxisEvent(e,i)},W.gamepadButtonCallback=function(t,e,i){W.gamepads[t].sendButtonEvent(e,i)},W.audioCallback=function(t){ct._callCallback(t);var e=ct.buffer;Krom.writeAudioBuffer(e.data.buffer,t)},W.init=function(t,e){Krom.init(t.title,t.width,t.height,t.framebuffer.samplesPerPixel,t.framebuffer.verticalSync,t.window.mode,t.window.windowFeatures,3),W.start=Krom.getTime(),L.trace=function(t,e){var i=null!=e?e.className+":"+e.lineNumber+": "+Tt.string(t):Tt.string(t);Krom.log(xt.substr(i,0,511))},new z(0),D.init(),O.init();var i=new ei;W.framebuffer=new E(0,null,null,i),W.framebuffer.init(new ie(W.framebuffer),new Re(W.framebuffer),i),Krom.setCallback(W.renderCallback),Krom.setDropFilesCallback(W.dropFilesCallback),Krom.setCutCopyPasteCallback(W.cutCallback,W.copyCallback,W.pasteCallback),Krom.setApplicationStateCallback(W.foregroundCallback,W.resumeCallback,W.pauseCallback,W.backgroundCallback,W.shutdownCallback),W.keyboard=new qe,W.mouse=new Ze,W.pen=new Je,W.gamepads=[];for(var n=0,r=W.maxGamepads;n<r;){var s=n++;W.gamepads[s]=new Xe(s)}Krom.setKeyboardDownCallback(W.keyboardDownCallback),Krom.setKeyboardUpCallback(W.keyboardUpCallback),Krom.setKeyboardPressCallback(W.keyboardPressCallback),Krom.setMouseDownCallback(W.mouseDownCallback),Krom.setMouseUpCallback(W.mouseUpCallback),Krom.setMouseMoveCallback(W.mouseMoveCallback),Krom.setMouseWheelCallback(W.mouseWheelCallback),Krom.setPenDownCallback(W.penDownCallback),Krom.setPenUpCallback(W.penUpCallback),Krom.setPenMoveCallback(W.penMoveCallback),Krom.setGamepadAxisCallback(W.gamepadAxisCallback),Krom.setGamepadButtonCallback(W.gamepadButtonCallback),ct._init(),dt._init(),Krom.setAudioCallback(W.audioCallback),D.start(),e(z.get(0))},W.initEx=function(t,e,i,n){},W.translateWindowMode=function(t){if(null==t)return 0;switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},W.getScreenRotation=function(){return F.RotationNone},W.getTime=function(){return Krom.getTime()-W.start},W.getVsync=function(){return!0},W.getRefreshRate=function(){return 60},W.getSystemId=function(){return Krom.systemId()},W.vibrate=function(t){},W.getLanguage=function(){return"en"},W.requestShutdown=function(){return Krom.requestShutdown(),!0},W.getMouse=function(t){return W.mouse},W.getPen=function(t){return W.pen},W.getKeyboard=function(t){return W.keyboard},W.lockMouse=function(){if(!W.isMouseLocked()){Krom.lockMouse();for(var t=0,e=W.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},W.unlockMouse=function(){if(W.isMouseLocked()){Krom.unlockMouse();for(var t=0,e=W.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},W.canLockMouse=function(){return Krom.canLockMouse()},W.isMouseLocked=function(){return Krom.isMouseLocked()},W.notifyOfMouseLockChange=function(t,e){W.canLockMouse()&&null!=t&&W.mouseLockListeners.push(t)},W.removeFromMouseLockChange=function(t,e){W.canLockMouse()&&null!=t&&xt.remove(W.mouseLockListeners,t)},W.hideSystemCursor=function(){Krom.showMouse(!1)},W.showSystemCursor=function(){Krom.showMouse(!0)},W.unload=function(){},W.canSwitchFullscreen=function(){return!1},W.isFullscreen=function(){return!1},W.requestFullscreen=function(){},W.exitFullscreen=function(){},W.notifyOfFullscreenChange=function(t,e){},W.removeFromFullscreenChange=function(t,e){},W.changeResolution=function(t,e){},W.setKeepScreenOn=function(t){},W.loadUrl=function(t){},W.getGamepadId=function(t){return"unkown"},W.safeZone=function(){return 1},W.login=function(){},W.automaticSafeZone=function(){return!0},W.setSafeZone=function(t){},W.unlockAchievement=function(t){};function G(){}(y["kha.Video"]=G).__name__=!0,G.__interfaces__=[k],G.prototype={width:function(){return 100},height:function(){return 100},play:function(t){null==t&&(t=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(t){return 0},getVolume:function(){return 1},setVolume:function(t){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:G};var z=function(t){this.num=t,z.windows.push(this)};(y["kha.Window"]=z).__name__=!0,z.create=function(t,e){return null},z.destroy=function(t){},z.get=function(t){return z.windows[t]},z.get_all=function(){return z.windows},z.prototype={num:null,windowTitle:null,resize:function(t,e){},move:function(t,e){},changeWindowFeatures:function(t){},changeFramebuffer:function(t){},get_x:function(){return 0},set_x:function(t){return 0},get_y:function(){return 0},set_y:function(t){return 0},get_width:function(){return Krom.windowWidth(this.num)},set_width:function(t){return 800},get_height:function(){return Krom.windowHeight(this.num)},set_height:function(t){return 600},get_mode:function(){return 0},set_mode:function(t){return 0},get_visible:function(){return!0},set_visible:function(t){return!0},get_title:function(){return this.windowTitle},set_title:function(t){return Krom.setWindowTitle(this.num,t),this.windowTitle=t,this.windowTitle},notifyOnResize:function(t){},get_vSynced:function(){return!0},__class__:z};var Y={};(y["kha._WindowOptions.WindowFeatures_Impl_"]=Y).__name__=!0,Y._new=function(t){return t};var X=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==s&&(s=-1),null==r&&(r=600),null==n&&(n=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=n,this.height=r,this.display=s,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(y["kha.WindowOptions"]=X).__name__=!0,X.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:X};var st={};(y["kha.arrays._Float32Array.Float32Array_Impl_"]=st).__name__=!0,st._new=function(t){return new Float32Array(t)},st.get_buffer=function(t){return t.buffer},st.get_length=function(t){return t.length},st.set=function(t,e,i){return t[e]=i},st.get=function(t,e){return t[e]},st.data=function(t){return t},st.subarray=function(t,e,i){return t.subarray(e,i)};var at={};(y["kha.arrays._Int16Array.Int16Array_Impl_"]=at).__name__=!0,at._new=function(t){return new Int16Array(t)},at.get_length=function(t){return t.length},at.set=function(t,e,i){return t[e]=i},at.get=function(t,e){return t[e]},at.data=function(t){return t},at.arrayRead=function(t,e){return t[e]},at.arrayWrite=function(t,e,i){return t[e]=i},at.subarray=function(t,e,i){return t.subarray(e,i)};var ot={};(y["kha.arrays._Uint32Array.Uint32Array_Impl_"]=ot).__name__=!0,ot._new=function(t){return new Uint32Array(t)},ot.get_length=function(t){return t.length},ot.set=function(t,e,i){return t[e]=i},ot.get=function(t,e){return t[e]},ot.data=function(t){return t},ot.arrayRead=function(t,e){return t[e]},ot.arrayWrite=function(t,e,i){return t[e]=i},ot.subarray=function(t,e,i){return t.subarray(e,i)};function lt(){}(y["kha.audio1.AudioChannel"]=lt).__name__=!0,lt.__isInterface__=!0,lt.prototype={play:null,pause:null,stop:null,length:null,get_length:null,get_position:null,set_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:lt};function ut(t){this.value=t}(y["kha.internal.IntBox"]=ut).__name__=!0,ut.prototype={value:null,__class__:ut};var ct=function(){};(y["kha.audio2.Audio"]=ct).__name__=!0,ct._init=function(){ct.buffer=new ft(8192,2,44100)},ct._callCallback=function(t){if(null!=ct.buffer)if(null!=ct.audioCallback)ct.intBox.value=t,ct.audioCallback(ct.intBox,ct.buffer);else for(var e=0,i=t;e<i;){e++;ct.buffer.data[ct.buffer.writeLocation]=0,ct.buffer.writeLocation+=1,ct.buffer.writeLocation>=ct.buffer.size&&(ct.buffer.writeLocation=0)}},ct._readSample=function(){if(null==ct.buffer)return 0;var t=ct.buffer.data[ct.buffer.readLocation];return ct.buffer.readLocation+=1,ct.buffer.readLocation>=ct.buffer.size&&(ct.buffer.readLocation=0),t},ct.play=function(t,e){return null==e&&(e=!1),null},ct.stream=function(t,e){return null==e&&(e=!1),null};var dt=function(){};(y["kha.audio2.Audio1"]=dt).__name__=!0,dt._init=function(){var t=new Array(32);dt.soundChannels=t;var e=new Array(32);dt.streamChannels=e;var i=new Array(32);dt.internalSoundChannels=i;var n=new Array(32);dt.internalStreamChannels=n;var r=new Float32Array(512);dt.sampleCache1=r;var s=new Float32Array(512);dt.sampleCache2=s,dt.lastAllocationCount=0,ct.audioCallback=dt.mix},dt.max=function(t,e){return e<t?t:e},dt.min=function(t,e){return t<e?t:e},dt.mix=function(t,e){var i=t.value;if(dt.sampleCache1.length<i){if(ct.disableGcInteractions){L.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:45,className:"kha.audio2.Audio1",methodName:"mix"});for(var n=0,r=i;n<r;){n++;e.data[e.writeLocation]=0,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}return dt.lastAllocationCount=0,void(ct.disableGcInteractions=!1)}var s=new Float32Array(2*i);dt.sampleCache1=s;var a=new Float32Array(2*i);dt.sampleCache2=a,dt.lastAllocationCount=0}else 100<dt.lastAllocationCount?ct.disableGcInteractions=!0:dt.lastAllocationCount+=1;for(var o=0,l=i;o<l;){var u=o++;dt.sampleCache2[u]=0}for(var h=0;h<32;){var A=h++;dt.internalSoundChannels[A]=dt.soundChannels[A]}for(var c=0;c<32;){var d=c++;dt.internalStreamChannels[d]=dt.streamChannels[d]}for(var _=0,f=dt.internalSoundChannels;_<f.length;){var g=f[_];if(++_,null!=g&&!g.get_finished()){g.nextSamples(dt.sampleCache1,i,e.samplesPerSecond);for(var p=0,v=i;p<v;){var m=p++;dt.sampleCache2[m]+=dt.sampleCache1[m]*g.get_volume()}}}for(var w=0,b=dt.internalStreamChannels;w<b.length;){var S=b[w];if(++w,null!=S&&!S.get_finished()){S.nextSamples(dt.sampleCache1,i,e.samplesPerSecond);for(var y=0,x=i;y<x;){var E=y++;dt.sampleCache2[E]+=dt.sampleCache1[E]*S.get_volume()}}}for(var T=0,B=i;T<B;){var k=T++,C=dt.sampleCache2[k],I=C<1?C:1;e.data[e.writeLocation]=-1<I?I:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},dt.play=function(t,e){null==e&&(e=!1);var i=null;(i=ct.samplesPerSecond!=t.sampleRate?new gt(e,t.sampleRate):new _t(e)).data=t.uncompressedData;for(var n=!1,r=0;r<32;){var s=r++;if(null==dt.soundChannels[s]||dt.soundChannels[s].get_finished()){dt.soundChannels[s]=i,n=!0;break}}return n?i:null},dt._playAgain=function(t){for(var e=0;e<32;){var i=e++;dt.soundChannels[i]==t&&(dt.soundChannels[i]=null)}for(var n=0;n<32;){var r=n++;if(null==dt.soundChannels[r]||dt.soundChannels[r].get_finished()||dt.soundChannels[r]==t){dt.soundChannels[r]=t;break}}},dt.stream=function(t,e){null==e&&(e=!1);var i=ct.stream(t,e);if(null!=i)return i;for(var n=new pt(t.compressedData,e),r=!1,s=0;s<32;){var a=s++;if(null==dt.streamChannels[a]||dt.streamChannels[a].get_finished()){dt.streamChannels[a]=n,r=!0;break}}return r?n:null};var _t=function(t){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=t};(y["kha.audio2.AudioChannel"]=_t).__name__=!0,_t.__interfaces__=[lt],_t.max=function(t,e){return e<t?t:e},_t.min=function(t,e){return t<e?t:e},_t.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=this.data.length-this.myPosition,l=e-s,u=o<l?o:l;a<u;){a++;t[s++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},play:function(){this.paused=!1,this.stopped=!1,dt._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},length:null,get_length:function(){return this.data.length/ct.samplesPerSecond/2},get_position:function(){return this.myPosition/ct.samplesPerSecond/2},set_position:function(t){this.myPosition=Math.round(t*ct.samplesPerSecond*2);var e=this.myPosition,i=this.data.length,n=e<i?e:i;return this.myPosition=0<n?n:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.stopped},__class__:_t};var ft=function(t,e,i){this.size=t;var n=new Float32Array(t);this.data=n,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(y["kha.audio2.Buffer"]=ft).__name__=!0,ft.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:ft};var gt=function(t,e){_t.call(this,t),this.sampleRate=e};(y["kha.audio2.ResamplingAudioChannel"]=gt).__name__=!0,gt.max=function(t,e){return e<t?t:e},gt.min=function(t,e){return t<e?t:e},gt.__super__=_t,gt.prototype=r(_t.prototype,{sampleRate:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=Math.ceil(this.data.length*(i/this.sampleRate)),l=(o%2==0?o:o+1)-this.myPosition,u=e-s,h=l<u?l:u;a<h;){a++;var A,c=s++,d=this.myPosition++,_=d%2==0,f=this.sampleRate/i;if(_){var g=f*(d=d/2|0),p=Math.floor(g),v=Math.floor(1+g);p*=2,v*=2;var m=this.data.length-1;m%2==0?m=m:--m;var w=p<0||m<p?0:this.data[p],b=v<0||m<v?0:this.data[v],S=g-Math.floor(g);A=(1-S)*w+S*b}else{var y=f*(d=d/2|0),x=Math.floor(y),E=Math.floor(1+y);x=2*x+1,E=2*E+1;var T=this.data.length-1;T%2!=0?T=T:--T;var B=x<1||T<x?0:this.data[x],k=E<1||T<E?0:this.data[E],C=y-Math.floor(y);A=(1-C)*B+C*k}t[c]=A}var I=Math.ceil(this.data.length*(i/this.sampleRate));if(this.myPosition>=(I%2==0?I:I+1)&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},sample:function(t,e){var i=t%2==0,n=this.sampleRate/e;if(i){var r=n*(t=t/2|0),s=Math.floor(r),a=Math.floor(1+r);s*=2,a*=2;var o=this.data.length-1;o%2==0?o=o:--o;var l=s<0||o<s?0:this.data[s],u=a<0||o<a?0:this.data[a],h=r-Math.floor(r);return(1-h)*l+h*u}var A=n*(t=t/2|0),c=Math.floor(A),d=Math.floor(1+A);c=2*c+1,d=2*d+1;var _=this.data.length-1;_%2!=0?_=_:--_;var f=c<1||_<c?0:this.data[c],g=d<1||_<d?0:this.data[d],p=A-Math.floor(A);return(1-p)*f+p*g},lerp:function(t,e,i){return(1-i)*t+i*e},sampleLength:function(t){var e=Math.ceil(this.data.length*(t/this.sampleRate));return e%2==0?e:e+1},play:function(){this.paused=!1,this.stopped=!1,dt._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},get_length:function(){return this.data.length/this.sampleRate/2},get_position:function(){return this.myPosition/this.sampleRate/2},set_position:function(t){this.myPosition=Math.round(t*this.sampleRate*2);var e=this.myPosition,i=Math.ceil(this.data.length*(ct.samplesPerSecond/this.sampleRate)),n=i%2==0?i:i+1,r=e<n?e:n;return this.myPosition=0<r?r:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.stopped},__class__:gt});var pt=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=bt.openFromBytes(t)};(y["kha.audio2.StreamChannel"]=pt).__name__=!0,pt.__interfaces__=[lt],pt.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,i){if(this.paused)for(var n=0,r=e;n<r;){t[n++]=0}else{var s=2*this.reader.read(t,e/2|0,2,i,!0);if(s<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=s,o=e;a<o;){t[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},set_position:function(t){return t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.atend},__class__:pt};function vt(){}(y["kha.audio2.ogg.tools.Crc32"]=vt).__name__=!0,vt.init=function(){if(null==vt.table){var t=new Array(256);vt.table=t;for(var e=0;e<256;){var i=e++,n=i<<24;n=(n=(n=(n=(n=(n=(n=(n=n<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0))<<1^(Mt.gte(n,1<<31)?79764919:0),vt.table[i]=n}}},vt.update=function(t,e){return t<<8^vt.table[e^t>>>24]};function mt(){}(y["kha.audio2.ogg.tools.MathTools"]=mt).__name__=!0,mt.ilog=function(t){var e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return t<16384?t<16?e[t]:t<512?5+e[t>>5]:10+e[t>>10]:t<16777216?t<524288?15+e[t>>15]:20+e[t>>20]:t<536870912?25+e[t>>25]:t<-2147483648?30+e[t>>30]:0};function wt(){}(y["kha.audio2.ogg.tools.Mdct"]=wt).__name__=!0,wt.inverseTransform=function(t,e,i,n,r,s){for(var a=e>>1,o=e>>2,l=e>>3,u=new Array(a),h=a-2,A=0,c=0,d=a;c!=d;)u[h+1]=t[c]*i[A]-t[c+2]*i[A+1],u[h]=t[c]*i[A+1]+t[c+2]*i[A],h-=2,A+=2,c+=4;for(c=a-3;0<=h;)u[h+1]=-t[c+2]*i[A]- -t[c]*i[A+1],u[h]=-t[c+2]*i[A+1]+-t[c]*i[A],h-=2,A+=2,c-=4;for(var _=t,f=u,g=a-8,p=o,v=0,m=o,w=0;0<=g;){var b=f[p+1]-f[v+1],S=f[p]-f[v];_[m+1]=f[p+1]+f[v+1],_[m]=f[p]+f[v],_[w+1]=b*i[g+4]-S*i[g+5],_[w]=S*i[g+4]+b*i[g+5],b=f[p+3]-f[v+3],S=f[p+2]-f[v+2],_[m+3]=f[p+3]+f[v+3],_[m+2]=f[p+2]+f[v+2],_[w+3]=b*i[g]-S*i[g+1],_[w+2]=S*i[g]+b*i[g+1],g-=8,m+=4,w+=4,p+=4,v+=4}for(var y=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],x=(e<16384?e<16?y[e]:e<512?5+y[e>>5]:10+y[e>>10]:e<16777216?e<524288?15+y[e>>15]:20+y[e>>20]:e<536870912?25+y[e>>25]:e<-2147483648?30+y[e>>30]:0)-1,E=a-1-0*o,T=E,B=E-(e>>3),k=0,C=1+(e>>4>>2);0<--C;){var I=_[T]-_[B],L=_[T+-1]-_[B+-1],N=T,P=_;P[N]=P[N]+_[B];var R=T+-1,M=_;M[R]=M[R]+_[B+-1],_[B]=I*i[k]-L*i[k+1],_[B+-1]=L*i[k]+I*i[k+1],k+=8,I=_[T+-2]-_[B+-2],L=_[T+-3]-_[B+-3];var V=T+-2,D=_;D[V]=D[V]+_[B+-2];var O=T+-3,F=_;F[O]=F[O]+_[B+-3],_[B+-2]=I*i[k]-L*i[k+1],_[B+-3]=L*i[k]+I*i[k+1],k+=8,I=_[T+-4]-_[B+-4],L=_[T+-5]-_[B+-5];var U=T+-4,H=_;H[U]=H[U]+_[B+-4];var W=T+-5,G=_;G[W]=G[W]+_[B+-5],_[B+-4]=I*i[k]-L*i[k+1],_[B+-5]=L*i[k]+I*i[k+1],k+=8,I=_[T+-6]-_[B+-6],L=_[T+-7]-_[B+-7];var z=T+-6,Y=_;Y[z]=Y[z]+_[B+-6];var X=T+-7,K=_;K[X]=K[X]+_[B+-7],_[B+-6]=I*i[k]-L*i[k+1],_[B+-7]=L*i[k]+I*i[k+1],k+=8,T-=8,B-=8}for(var Q=a-1-o,q=Q,j=Q-(e>>3),Z=0,J=1+(e>>4>>2);0<--J;){var $=_[q]-_[j],tt=_[q+-1]-_[j+-1],et=q,it=_;it[et]=it[et]+_[j];var nt=q+-1,rt=_;rt[nt]=rt[nt]+_[j+-1],_[j]=$*i[Z]-tt*i[Z+1],_[j+-1]=tt*i[Z]+$*i[Z+1],Z+=8,$=_[q+-2]-_[j+-2],tt=_[q+-3]-_[j+-3];var st=q+-2,at=_;at[st]=at[st]+_[j+-2];var ot=q+-3,lt=_;lt[ot]=lt[ot]+_[j+-3],_[j+-2]=$*i[Z]-tt*i[Z+1],_[j+-3]=tt*i[Z]+$*i[Z+1],Z+=8,$=_[q+-4]-_[j+-4],tt=_[q+-5]-_[j+-5];var ut=q+-4,ht=_;ht[ut]=ht[ut]+_[j+-4];var At=q+-5,ct=_;ct[At]=ct[At]+_[j+-5],_[j+-4]=$*i[Z]-tt*i[Z+1],_[j+-5]=tt*i[Z]+$*i[Z+1],Z+=8,$=_[q+-6]-_[j+-6],tt=_[q+-7]-_[j+-7];var dt=q+-6,_t=_;_t[dt]=_t[dt]+_[j+-6];var ft=q+-7,gt=_;gt[ft]=gt[ft]+_[j+-7],_[j+-6]=$*i[Z]-tt*i[Z+1],_[j+-7]=tt*i[Z]+$*i[Z+1],Z+=8,q-=8,j-=8}for(var pt=a-1-0*l,vt=0,mt=pt,wt=pt-(e>>4),bt=1+(e>>5>>2);0<--bt;){var St=_[mt]-_[wt],yt=_[mt+-1]-_[wt+-1],xt=mt,Et=_;Et[xt]=Et[xt]+_[wt];var Tt=mt+-1,Bt=_;Bt[Tt]=Bt[Tt]+_[wt+-1],_[wt]=St*i[vt]-yt*i[vt+1],_[wt+-1]=yt*i[vt]+St*i[vt+1],vt+=16,St=_[mt+-2]-_[wt+-2],yt=_[mt+-3]-_[wt+-3];var kt=mt+-2,Ct=_;Ct[kt]=Ct[kt]+_[wt+-2];var It=mt+-3,Lt=_;Lt[It]=Lt[It]+_[wt+-3],_[wt+-2]=St*i[vt]-yt*i[vt+1],_[wt+-3]=yt*i[vt]+St*i[vt+1],vt+=16,St=_[mt+-4]-_[wt+-4],yt=_[mt+-5]-_[wt+-5];var Nt=mt+-4,Pt=_;Pt[Nt]=Pt[Nt]+_[wt+-4];var Rt=mt+-5,Mt=_;Mt[Rt]=Mt[Rt]+_[wt+-5],_[wt+-4]=St*i[vt]-yt*i[vt+1],_[wt+-5]=yt*i[vt]+St*i[vt+1],vt+=16,St=_[mt+-6]-_[wt+-6],yt=_[mt+-7]-_[wt+-7];var Vt=mt+-6,Dt=_;Dt[Vt]=Dt[Vt]+_[wt+-6];var Ot=mt+-7,Ft=_;Ft[Ot]=Ft[Ot]+_[wt+-7],_[wt+-6]=St*i[vt]-yt*i[vt+1],_[wt+-7]=yt*i[vt]+St*i[vt+1],mt-=8,wt-=8,vt+=16}for(var Ut=a-1-l,Ht=0,Wt=Ut,Gt=Ut-(e>>4),zt=1+(e>>5>>2);0<--zt;){var Yt=_[Wt]-_[Gt],Xt=_[Wt+-1]-_[Gt+-1],Kt=Wt,Qt=_;Qt[Kt]=Qt[Kt]+_[Gt];var qt=Wt+-1,jt=_;jt[qt]=jt[qt]+_[Gt+-1],_[Gt]=Yt*i[Ht]-Xt*i[Ht+1],_[Gt+-1]=Xt*i[Ht]+Yt*i[Ht+1],Ht+=16,Yt=_[Wt+-2]-_[Gt+-2],Xt=_[Wt+-3]-_[Gt+-3];var Zt=Wt+-2,Jt=_;Jt[Zt]=Jt[Zt]+_[Gt+-2];var $t=Wt+-3,te=_;te[$t]=te[$t]+_[Gt+-3],_[Gt+-2]=Yt*i[Ht]-Xt*i[Ht+1],_[Gt+-3]=Xt*i[Ht]+Yt*i[Ht+1],Ht+=16,Yt=_[Wt+-4]-_[Gt+-4],Xt=_[Wt+-5]-_[Gt+-5];var ee=Wt+-4,ie=_;ie[ee]=ie[ee]+_[Gt+-4];var ne=Wt+-5,re=_;re[ne]=re[ne]+_[Gt+-5],_[Gt+-4]=Yt*i[Ht]-Xt*i[Ht+1],_[Gt+-5]=Xt*i[Ht]+Yt*i[Ht+1],Ht+=16,Yt=_[Wt+-6]-_[Gt+-6],Xt=_[Wt+-7]-_[Gt+-7];var se=Wt+-6,ae=_;ae[se]=ae[se]+_[Gt+-6];var oe=Wt+-7,le=_;le[oe]=le[oe]+_[Gt+-7],_[Gt+-6]=Yt*i[Ht]-Xt*i[Ht+1],_[Gt+-7]=Xt*i[Ht]+Yt*i[Ht+1],Wt-=8,Gt-=8,Ht+=16}for(var ue=a-1-2*l,he=0,Ae=ue,ce=ue-(e>>4),de=1+(e>>5>>2);0<--de;){var _e=_[Ae]-_[ce],fe=_[Ae+-1]-_[ce+-1],ge=Ae,pe=_;pe[ge]=pe[ge]+_[ce];var ve=Ae+-1,me=_;me[ve]=me[ve]+_[ce+-1],_[ce]=_e*i[he]-fe*i[he+1],_[ce+-1]=fe*i[he]+_e*i[he+1],he+=16,_e=_[Ae+-2]-_[ce+-2],fe=_[Ae+-3]-_[ce+-3];var we=Ae+-2,be=_;be[we]=be[we]+_[ce+-2];var Se=Ae+-3,ye=_;ye[Se]=ye[Se]+_[ce+-3],_[ce+-2]=_e*i[he]-fe*i[he+1],_[ce+-3]=fe*i[he]+_e*i[he+1],he+=16,_e=_[Ae+-4]-_[ce+-4],fe=_[Ae+-5]-_[ce+-5];var xe=Ae+-4,Ee=_;Ee[xe]=Ee[xe]+_[ce+-4];var Te=Ae+-5,Be=_;Be[Te]=Be[Te]+_[ce+-5],_[ce+-4]=_e*i[he]-fe*i[he+1],_[ce+-5]=fe*i[he]+_e*i[he+1],he+=16,_e=_[Ae+-6]-_[ce+-6],fe=_[Ae+-7]-_[ce+-7];var ke=Ae+-6,Ce=_;Ce[ke]=Ce[ke]+_[ce+-6];var Ie=Ae+-7,Le=_;Le[Ie]=Le[Ie]+_[ce+-7],_[ce+-6]=_e*i[he]-fe*i[he+1],_[ce+-7]=fe*i[he]+_e*i[he+1],Ae-=8,ce-=8,he+=16}for(var Ne=a-1-3*l,Pe=0,Re=Ne,Me=Ne-(e>>4),Ve=1+(e>>5>>2);0<--Ve;){var De=_[Re]-_[Me],Oe=_[Re+-1]-_[Me+-1],Fe=Re,Ue=_;Ue[Fe]=Ue[Fe]+_[Me];var He=Re+-1,We=_;We[He]=We[He]+_[Me+-1],_[Me]=De*i[Pe]-Oe*i[Pe+1],_[Me+-1]=Oe*i[Pe]+De*i[Pe+1],Pe+=16,De=_[Re+-2]-_[Me+-2],Oe=_[Re+-3]-_[Me+-3];var Ge=Re+-2,ze=_;ze[Ge]=ze[Ge]+_[Me+-2];var Ye=Re+-3,Xe=_;Xe[Ye]=Xe[Ye]+_[Me+-3],_[Me+-2]=De*i[Pe]-Oe*i[Pe+1],_[Me+-3]=Oe*i[Pe]+De*i[Pe+1],Pe+=16,De=_[Re+-4]-_[Me+-4],Oe=_[Re+-5]-_[Me+-5];var Ke=Re+-4,Qe=_;Qe[Ke]=Qe[Ke]+_[Me+-4];var qe=Re+-5,je=_;je[qe]=je[qe]+_[Me+-5],_[Me+-4]=De*i[Pe]-Oe*i[Pe+1],_[Me+-5]=Oe*i[Pe]+De*i[Pe+1],Pe+=16,De=_[Re+-6]-_[Me+-6],Oe=_[Re+-7]-_[Me+-7];var Ze=Re+-6,Je=_;Je[Ze]=Je[Ze]+_[Me+-6];var $e=Re+-7,ti=_;ti[$e]=ti[$e]+_[Me+-7],_[Me+-6]=De*i[Pe]-Oe*i[Pe+1],_[Me+-7]=Oe*i[Pe]+De*i[Pe+1],Re-=8,Me-=8,Pe+=16}for(var ei=2,ii=x-3>>1;ei<ii;)for(var ni=ei++,ri=e>>2+ni,si=ri>>1,ai=0,oi=1<<1+ni;ai<oi;)for(var li=a-1-ri*ai++,ui=1<<3+ni,hi=0,Ai=li,ci=li-si,di=1+(e>>4+ni>>2);0<--di;){var _i=_[Ai]-_[ci],fi=_[Ai+-1]-_[ci+-1],gi=Ai,pi=_;pi[gi]=pi[gi]+_[ci];var vi=Ai+-1,mi=_;mi[vi]=mi[vi]+_[ci+-1],_[ci]=_i*i[hi]-fi*i[hi+1],_[ci+-1]=fi*i[hi]+_i*i[hi+1],hi+=ui,_i=_[Ai+-2]-_[ci+-2],fi=_[Ai+-3]-_[ci+-3];var wi=Ai+-2,bi=_;bi[wi]=bi[wi]+_[ci+-2];var Si=Ai+-3,yi=_;yi[Si]=yi[Si]+_[ci+-3],_[ci+-2]=_i*i[hi]-fi*i[hi+1],_[ci+-3]=fi*i[hi]+_i*i[hi+1],hi+=ui,_i=_[Ai+-4]-_[ci+-4],fi=_[Ai+-5]-_[ci+-5];var xi=Ai+-4,Ei=_;Ei[xi]=Ei[xi]+_[ci+-4];var Ti=Ai+-5,Bi=_;Bi[Ti]=Bi[Ti]+_[ci+-5],_[ci+-4]=_i*i[hi]-fi*i[hi+1],_[ci+-5]=fi*i[hi]+_i*i[hi+1],hi+=ui,_i=_[Ai+-6]-_[ci+-6],fi=_[Ai+-7]-_[ci+-7];var ki=Ai+-6,Ci=_;Ci[ki]=Ci[ki]+_[ci+-6];var Ii=Ai+-7,Li=_;Li[Ii]=Li[Ii]+_[ci+-7],_[ci+-6]=_i*i[hi]-fi*i[hi+1],_[ci+-7]=fi*i[hi]+_i*i[hi+1],Ai-=8,ci-=8,hi+=ui}for(var Ni=x-3>>1,Pi=x-6;Ni<Pi;)for(var Ri=Ni++,Mi=e>>2+Ri,Vi=1<<3+Ri,Di=Mi>>1,Oi=1<<1+Ri,Fi=0,Ui=a-1,Hi=1+(e>>6+Ri);0<--Hi;){for(var Wi=i[Fi],Gi=i[Fi+1],zi=i[Fi+Vi],Yi=i[Fi+Vi+1],Xi=i[Fi+2*Vi],Ki=i[Fi+2*Vi+1],Qi=i[Fi+3*Vi],qi=i[Fi+3*Vi+1],ji=Ui,Zi=Ui+-Di,Ji=1+Oi;0<--Ji;){var $i=_[ji]-_[Zi],tn=_[ji+-1]-_[Zi+-1];_[ji]=_[ji]+_[Zi],_[ji+-1]=_[ji+-1]+_[Zi+-1],_[Zi]=$i*Wi-tn*Gi,_[Zi+-1]=tn*Wi+$i*Gi,$i=_[ji+-2]-_[Zi+-2],tn=_[ji+-3]-_[Zi+-3],_[ji+-2]=_[ji+-2]+_[Zi+-2],_[ji+-3]=_[ji+-3]+_[Zi+-3],_[Zi+-2]=$i*zi-tn*Yi,_[Zi+-3]=tn*zi+$i*Yi,$i=_[ji+-4]-_[Zi+-4],tn=_[ji+-5]-_[Zi+-5],_[ji+-4]=_[ji+-4]+_[Zi+-4],_[ji+-5]=_[ji+-5]+_[Zi+-5],_[Zi+-4]=$i*Xi-tn*Ki,_[Zi+-5]=tn*Xi+$i*Ki,$i=_[ji+-6]-_[Zi+-6],tn=_[ji+-7]-_[Zi+-7],_[ji+-6]=_[ji+-6]+_[Zi+-6],_[ji+-7]=_[ji+-7]+_[Zi+-7],_[Zi+-6]=$i*Qi-tn*qi,_[Zi+-7]=tn*Qi+$i*qi,ji-=Mi,Zi-=Mi}Fi+=4*Vi,Ui-=8}for(var en=a-1,nn=i[e>>3],rn=en,sn=en-16*(e>>5);sn<rn;){var an=_[rn],on=_[rn+-8];_[rn+-8]=an-on,_[rn]=an+on,an=_[rn+-1],on=_[rn+-9],_[rn+-9]=an-on,_[rn+-1]=an+on;var ln=(an=_[rn+-2])-(on=_[rn+-10]);_[rn+-2]=an+on;var un=(an=_[rn+-3])-(on=_[rn+-11]);_[rn+-3]=an+on,_[rn+-10]=(ln+un)*nn,_[rn+-11]=(un-ln)*nn,an=_[rn+-4],ln=(on=_[rn+-12])-an,_[rn+-4]=an+on,un=(an=_[rn+-5])-(on=_[rn+-13]),_[rn+-5]=an+on,_[rn+-12]=un,_[rn+-13]=ln,an=_[rn+-6],ln=(on=_[rn+-14])-an,_[rn+-6]=an+on,un=(an=_[rn+-7])-(on=_[rn+-15]),_[rn+-7]=an+on,_[rn+-14]=(ln+un)*nn,_[rn+-15]=(ln-un)*nn;var hn=_[rn],An=_[rn+-4],cn=hn-An,dn=hn+An,_n=(hn=_[rn+-2])+(An=_[rn+-6]),fn=hn-An;_[rn]=dn+_n,_[rn+-2]=dn-_n;var gn=_[rn+-3]-_[rn+-7];_[rn+-4]=cn+gn,_[rn+-6]=cn-gn;var pn=(hn=_[rn+-1])-(An=_[rn+-5]),vn=hn+An,mn=_[rn+-3]+_[rn+-7];_[rn+-1]=vn+mn,_[rn+-3]=vn-mn,_[rn+-5]=pn-fn,_[rn+-7]=pn+fn;var wn=rn-8,bn=_[wn],Sn=_[wn-4],yn=bn-Sn,xn=bn+Sn,En=(bn=_[wn-2])+(Sn=_[wn-6]),Tn=bn-Sn;_[wn]=xn+En,_[wn-2]=xn-En;var Bn=_[wn-3]-_[wn-7];_[wn-4]=yn+Bn,_[wn-6]=yn-Bn;var kn=(bn=_[wn-1])-(Sn=_[wn-5]),Cn=bn+Sn,In=_[wn-3]+_[wn-7];_[wn-1]=Cn+In,_[wn-3]=Cn-In,_[wn-5]=kn-Tn,_[wn-7]=kn+Tn,rn-=16}for(var Ln=0,Nn=o-4,Pn=a-4;0<=Nn;){var Rn=s[Ln];f[Pn+3]=_[Rn],f[Pn+2]=_[Rn+1],f[Nn+3]=_[Rn+2],f[Nn+2]=_[Rn+3],Rn=s[Ln+1],f[Pn+1]=_[Rn],f[Pn]=_[Rn+1],f[Nn+1]=_[Rn+2],f[Nn]=_[Rn+3],Nn-=4,Pn-=4,Ln+=2}for(var Mn=0,Vn=0,Dn=a-4;Vn<Dn;){var On=f[Vn]-f[Dn+2],Fn=f[Vn+1]+f[Dn+3],Un=r[Mn+1]*On+r[Mn]*Fn,Hn=r[Mn+1]*Fn-r[Mn]*On,Wn=f[Vn]+f[Dn+2],Gn=f[Vn+1]-f[Dn+3];f[Vn]=Wn+Un,f[Vn+1]=Gn+Hn,f[Dn+2]=Wn-Un,f[Dn+3]=Hn-Gn,On=f[Vn+2]-f[Dn],Fn=f[Vn+3]+f[Dn+1],Un=r[Mn+3]*On+r[Mn+2]*Fn,Hn=r[Mn+3]*Fn-r[Mn+2]*On,Wn=f[Vn+2]+f[Dn],Gn=f[Vn+3]-f[Dn+1],f[Vn+2]=Wn+Un,f[Vn+3]=Gn+Hn,f[Dn]=Wn-Un,f[Dn+1]=Hn-Gn,Mn+=4,Vn+=4,Dn-=4}for(var zn=a-8,Yn=a-8,Xn=0,Kn=a-4,Qn=a,qn=e-4;0<=Yn;){var jn=u[Yn+6]*n[zn+7]-u[Yn+7]*n[zn+6],Zn=-u[Yn+6]*n[zn+6]-u[Yn+7]*n[zn+7];t[Xn]=jn,t[Kn+3]=-jn,t[Qn]=Zn,t[qn+3]=Zn;var Jn=u[Yn+4]*n[zn+5]-u[Yn+5]*n[zn+4],$n=-u[Yn+4]*n[zn+4]-u[Yn+5]*n[zn+5];t[Xn+1]=Jn,t[Kn+2]=-Jn,t[Qn+1]=$n,t[qn+2]=$n,jn=u[Yn+2]*n[zn+3]-u[Yn+3]*n[zn+2],Zn=-u[Yn+2]*n[zn+2]-u[Yn+3]*n[zn+3],t[Xn+2]=jn,t[Kn+1]=-jn,t[Qn+2]=Zn,t[qn+1]=Zn,Jn=u[Yn]*n[zn+1]-u[Yn+1]*n[zn],$n=-u[Yn]*n[zn]-u[Yn+1]*n[zn+1],t[Xn+3]=Jn,t[Kn]=-Jn,t[Qn+3]=$n,t[qn]=$n,zn-=8,Yn-=8,Xn+=4,Qn+=4,Kn-=4,qn-=4}},wt.step3Iter0Loop=function(t,e,i,n,r){for(var s=i,a=i+n,o=0,l=1+(t>>2);0<--l;){var u=e[s]-e[a],h=e[s+-1]-e[a+-1],A=s,c=e;c[A]=c[A]+e[a];var d=s+-1,_=e;_[d]=_[d]+e[a+-1],e[a]=u*r[o]-h*r[o+1],e[a+-1]=h*r[o]+u*r[o+1],o+=8,u=e[s+-2]-e[a+-2],h=e[s+-3]-e[a+-3];var f=s+-2,g=e;g[f]=g[f]+e[a+-2];var p=s+-3,v=e;v[p]=v[p]+e[a+-3],e[a+-2]=u*r[o]-h*r[o+1],e[a+-3]=h*r[o]+u*r[o+1],o+=8,u=e[s+-4]-e[a+-4],h=e[s+-5]-e[a+-5];var m=s+-4,w=e;w[m]=w[m]+e[a+-4];var b=s+-5,S=e;S[b]=S[b]+e[a+-5],e[a+-4]=u*r[o]-h*r[o+1],e[a+-5]=h*r[o]+u*r[o+1],o+=8,u=e[s+-6]-e[a+-6],h=e[s+-7]-e[a+-7];var y=s+-6,x=e;x[y]=x[y]+e[a+-6];var E=s+-7,T=e;T[E]=T[E]+e[a+-7],e[a+-6]=u*r[o]-h*r[o+1],e[a+-7]=h*r[o]+u*r[o+1],o+=8,s-=8,a-=8}},wt.step3InnerRLoop=function(t,e,i,n,r,s){for(var a=0,o=i,l=i+n,u=1+(t>>2);0<--u;){var h=e[o]-e[l],A=e[o+-1]-e[l+-1],c=o,d=e;d[c]=d[c]+e[l];var _=o+-1,f=e;f[_]=f[_]+e[l+-1],e[l]=h*r[a]-A*r[a+1],e[l+-1]=A*r[a]+h*r[a+1],a+=s,h=e[o+-2]-e[l+-2],A=e[o+-3]-e[l+-3];var g=o+-2,p=e;p[g]=p[g]+e[l+-2];var v=o+-3,m=e;m[v]=m[v]+e[l+-3],e[l+-2]=h*r[a]-A*r[a+1],e[l+-3]=A*r[a]+h*r[a+1],a+=s,h=e[o+-4]-e[l+-4],A=e[o+-5]-e[l+-5];var w=o+-4,b=e;b[w]=b[w]+e[l+-4];var S=o+-5,y=e;y[S]=y[S]+e[l+-5],e[l+-4]=h*r[a]-A*r[a+1],e[l+-5]=A*r[a]+h*r[a+1],a+=s,h=e[o+-6]-e[l+-6],A=e[o+-7]-e[l+-7];var x=o+-6,E=e;E[x]=E[x]+e[l+-6];var T=o+-7,B=e;B[T]=B[T]+e[l+-7],e[l+-6]=h*r[a]-A*r[a+1],e[l+-7]=A*r[a]+h*r[a+1],o-=8,l-=8,a+=s}},wt.step3InnerSLoop=function(t,e,i,n,r,s,a,o){for(var l=r[s],u=r[s+1],h=r[s+a],A=r[s+a+1],c=r[s+2*a],d=r[s+2*a+1],_=r[s+3*a],f=r[s+3*a+1],g=i,p=i+n,v=t+1;0<--v;){var m=e[g]-e[p],w=e[g+-1]-e[p+-1];e[g]=e[g]+e[p],e[g+-1]=e[g+-1]+e[p+-1],e[p]=m*l-w*u,e[p+-1]=w*l+m*u,m=e[g+-2]-e[p+-2],w=e[g+-3]-e[p+-3],e[g+-2]=e[g+-2]+e[p+-2],e[g+-3]=e[g+-3]+e[p+-3],e[p+-2]=m*h-w*A,e[p+-3]=w*h+m*A,m=e[g+-4]-e[p+-4],w=e[g+-5]-e[p+-5],e[g+-4]=e[g+-4]+e[p+-4],e[g+-5]=e[g+-5]+e[p+-5],e[p+-4]=m*c-w*d,e[p+-5]=w*c+m*d,m=e[g+-6]-e[p+-6],w=e[g+-7]-e[p+-7],e[g+-6]=e[g+-6]+e[p+-6],e[g+-7]=e[g+-7]+e[p+-7],e[p+-6]=m*_-w*f,e[p+-7]=w*_+m*f,g-=o,p-=o}},wt.iter54=function(t,e){var i=t[e],n=t[e+-4],r=i-n,s=i+n,a=(i=t[e+-2])+(n=t[e+-6]),o=i-n;t[e]=s+a,t[e+-2]=s-a;var l=t[e+-3]-t[e+-7];t[e+-4]=r+l,t[e+-6]=r-l;var u=(i=t[e+-1])-(n=t[e+-5]),h=i+n,A=t[e+-3]+t[e+-7];t[e+-1]=h+A,t[e+-3]=h-A,t[e+-5]=u-o,t[e+-7]=u+o},wt.step3InnerSLoopLd654=function(t,e,i,n,r){for(var s=n[r>>3],a=i,o=i-16*t;o<a;){var l=e[a],u=e[a+-8];e[a+-8]=l-u,e[a]=l+u,l=e[a+-1],u=e[a+-9],e[a+-9]=l-u,e[a+-1]=l+u;var h=(l=e[a+-2])-(u=e[a+-10]);e[a+-2]=l+u;var A=(l=e[a+-3])-(u=e[a+-11]);e[a+-3]=l+u,e[a+-10]=(h+A)*s,e[a+-11]=(A-h)*s,l=e[a+-4],h=(u=e[a+-12])-l,e[a+-4]=l+u,A=(l=e[a+-5])-(u=e[a+-13]),e[a+-5]=l+u,e[a+-12]=A,e[a+-13]=h,l=e[a+-6],h=(u=e[a+-14])-l,e[a+-6]=l+u,A=(l=e[a+-7])-(u=e[a+-15]),e[a+-7]=l+u,e[a+-14]=(h+A)*s,e[a+-15]=(h-A)*s;var c=e[a],d=e[a+-4],_=c-d,f=c+d,g=(c=e[a+-2])+(d=e[a+-6]),p=c-d;e[a]=f+g,e[a+-2]=f-g;var v=e[a+-3]-e[a+-7];e[a+-4]=_+v,e[a+-6]=_-v;var m=(c=e[a+-1])-(d=e[a+-5]),w=c+d,b=e[a+-3]+e[a+-7];e[a+-1]=w+b,e[a+-3]=w-b,e[a+-5]=m-p,e[a+-7]=m+p;var S=a-8,y=e[S],x=e[S-4],E=y-x,T=y+x,B=(y=e[S-2])+(x=e[S-6]),k=y-x;e[S]=T+B,e[S-2]=T-B;var C=e[S-3]-e[S-7];e[S-4]=E+C,e[S-6]=E-C;var I=(y=e[S-1])-(x=e[S-5]),L=y+x,N=e[S-3]+e[S-7];e[S-1]=L+N,e[S-3]=L-N,e[S-5]=I-k,e[S-7]=I+k,a-=16}};var bt=function(t,e,i){this.seekFunc=e,this.inputLength=i,this.decoder=Nt.start(t),this.decoder.setupSampleNumber(e,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(y["kha.audio2.ogg.vorbis.Reader"]=bt).__name__=!0,bt.openFromBytes=function(t){var e=new ht(t),i=e;return new bt(e,function(t){bt.seekBytes(i,t)},t.length)},bt.seekBytes=function(t,e){t.set_position(e)},bt.readAll=function(t,e,i){null==i&&(i=!1);var n=new ht(t),r=Nt.start(n),s=n;r.setupSampleNumber(function(t){bt.seekBytes(s,t)},t.length);for(var a=r.header,o=new Float32Array(4096*a.channel);;){for(var l=r.read(o,4096,a.channel,a.sampleRate,i),u=0,h=l*a.channel;u<h;){var A=u++;e.writeFloat(o[A])}if(0==l)break;l}return r.header},bt.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var t=this.decoder.totalSample,e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},set_currentMillisecond:function(t){return this.set_currentSample(Math.floor(Mt.toFloat(this.get_header().sampleRate)*(t/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,i,n,r){return null==r&&(r=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==n&&(n=this.get_header().sampleRate),this.decoder.read(t,e,i,n,r)},clone:function(){var t=Object.create(bt.prototype);return t.seekFunc=this.seekFunc,t.inputLength=this.inputLength,t.decoder=this.decoder.clone(this.seekFunc),t.loopStart=this.loopStart,t.loopLength=this.loopLength,t},sampleToMillisecond:function(t){var e=this.get_header().sampleRate;return Mt.toFloat(t)/Mt.toFloat(e)*1e3},millisecondToSample:function(t){return Math.floor(Mt.toFloat(this.get_header().sampleRate)*(t/1e3))},__class__:bt};function St(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Yt,vt.init()}(y["kha.audio2.ogg.vorbis.VorbisDecodeState"]=St).__name__=!0,St.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var n=new Array(i),r=0,s=i;r<s;){n[r++]=this.input.readByte()}if(this.segments=n,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=t),--a;if(this.firstDecode){for(var o=0,l=new Kt,u=0,h=i;u<h;){var A=u++;o+=this.segments[A]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(St.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof ne?t.val:t;if(e instanceof Qt)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new ne(new Qt(qt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new ne(new Qt(qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,i=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var n=t instanceof ne?t.val:t;if(!(n instanceof v))throw t;i=!0,e=0}if(i)return!1;if(!!(!!(79!=e||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ne(new Qt(qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(24<t)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var i=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var t;return t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,t},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){var t,e,i,n,r,s,a=new kt(new ArrayBuffer(6));if(t=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[0]=t,e=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[1]=e,i=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[2]=i,n=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[3]=n,r=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[4]=r,s=0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1,this.validBits=0,a.b[5]=s,"vorbis"!=a.toString())throw new ne(new Qt(qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){if(this.inputPosition+=1,!!(!!(79!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))throw new ne(new Qt(qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(t){this.validBits<10&&this.prepHuffman();var e,i=t.fastHuffman[1023&this.acc];if(0<=i){var n=t.codewordLengths[i];this.acc=this.acc>>>n,this.validBits-=n,e=this.validBits<0?(this.validBits=0,-1):i}else e=this.decodeScalarRaw(t);return t.sparse&&(e=t.sortedValues[e]),e},decodeRaw:function(t){this.validBits<10&&this.prepHuffman();var e=t.fastHuffman[1023&this.acc];if(0<=e){var i=t.codewordLengths[e];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):e}return this.decodeScalarRaw(t)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(t,e,i){var n=i.left.start,r=!1,s=e>>1;if(this.firstDecode)this.currentLoc=-s,this.discardSamplesDeferred=e-i.right.end,r=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,n=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(r&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(e-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:n,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(s-i.left.start),r=!0}return r&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:n,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}return e},readBytes:function(t){return this.inputPosition+=t,this.input.read(t)},readString:function(t){return this.inputPosition+=t,this.input.readString(t)},getSampleNumber:function(t,e){var i=this.inputPosition,n=Mt.gte(e,65536)&&Mt.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=n);var r=0,s=!1,a=this.findPage(t,e);switch(a._hx_index){case 0:var o=a.last;r=a.end,s=o;break;case 1:throw new ne(new Qt(qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!s;){t(this.inputPosition=r);var u=this.findPage(t,e);switch(u._hx_index){case 0:var h=u.last;r=u.end,s=h;break;case 1:break t}n=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var A=new Array(6),c=0;c<6;){A[c++]=this.input.readByte()}this.inputPosition+=4;var d=this.input.readInt32();this.inputPosition+=4;var _=this.input.readInt32();if(-1==d&&-1==_||0<_)throw new ne(new Qt(qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Kt,this.pLast.pageStart=l,this.pLast.pageEnd=r,this.pLast.lastDecodedSample=d,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=n,t(this.inputPosition=i),d},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(t,e){t(this.inputPosition=e)},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i=this.inputPosition;if(e<i-25)return Lt.NotFound;if(this.inputPosition+=1,!!(103!=this.input.readByte()||(this.inputPosition+=1,103!=this.input.readByte()))||(this.inputPosition+=1,83!=this.input.readByte()))continue;var n=new Array(27);if(n[0]=79,n[1]=103,n[2]=103,n[3]=83,this.inputPosition+=1,n[4]=this.input.readByte(),this.inputPosition+=1,n[5]=this.input.readByte(),this.inputPosition+=1,n[6]=this.input.readByte(),this.inputPosition+=1,n[7]=this.input.readByte(),this.inputPosition+=1,n[8]=this.input.readByte(),this.inputPosition+=1,n[9]=this.input.readByte(),this.inputPosition+=1,n[10]=this.input.readByte(),this.inputPosition+=1,n[11]=this.input.readByte(),this.inputPosition+=1,n[12]=this.input.readByte(),this.inputPosition+=1,n[13]=this.input.readByte(),this.inputPosition+=1,n[14]=this.input.readByte(),this.inputPosition+=1,n[15]=this.input.readByte(),this.inputPosition+=1,n[16]=this.input.readByte(),this.inputPosition+=1,n[17]=this.input.readByte(),this.inputPosition+=1,n[18]=this.input.readByte(),this.inputPosition+=1,n[19]=this.input.readByte(),this.inputPosition+=1,n[20]=this.input.readByte(),this.inputPosition+=1,n[21]=this.input.readByte(),this.inputPosition+=1,n[22]=this.input.readByte(),this.inputPosition+=1,n[23]=this.input.readByte(),this.inputPosition+=1,n[24]=this.input.readByte(),this.inputPosition+=1,n[25]=this.input.readByte(),this.inputPosition+=1,n[26]=this.input.readByte(),0!=n[4]){t(this.inputPosition=i);continue}var r=n[22]+(n[23]<<8)+(n[24]<<16)+(n[25]<<24);n[22]=0,n[23]=0,n[24]=0;for(var s=n[25]=0,a=0;a<27;){var o=a++;s=s<<8^vt.table[n[o]^s>>>24]}var l=0;try{for(var u=0,h=n[26];u<h;){u++;this.inputPosition+=1;var A=this.input.readByte();s=s<<8^vt.table[A^s>>>24],l+=A}for(var c=0,d=l;c<d;){c++;this.inputPosition+=1;var _=this.input.readByte();s=s<<8^vt.table[_^s>>>24]}}catch(t){var f=t instanceof ne?t.val:t;if(f instanceof v){return Lt.NotFound}throw t}if(s==r){var g=this.inputPosition;return t(this.inputPosition=i-1),Lt.Found(g,0!=(4&n[5]))}}}}catch(t){var p=t instanceof ne?t.val:t;if(p instanceof v){return Lt.NotFound}throw t}},analyzePage:function(t,e){var i=new Kt,n=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var r=new Array(27),s=0;s<27;){r[s++]=this.input.readByte()}var a=r,o=a[26];this.inputPosition+=o;for(var l=new Array(o),u=0,h=o;u<h;){l[u++]=this.input.readByte()}for(var A=l,c=0,d=0,_=a[26];d<_;){c+=A[d++]}if(i.pageEnd=i.pageStart+27+a[26]+c,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,t(this.inputPosition=i.pageStart),i;for(var f=0,g=0==(1&a[5]),p=e.modes.length,v=0,m=a[26];v<m;){var w=v++;if(g){if(0==A[w])return t(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var b=this.input.readByte();if(0!=(1&b))return t(this.inputPosition=i.pageStart),null;b>>=1;var S=p-1,y=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(p<=(b&=(1<<(S<16384?S<16?y[S]:S<512?5+y[S>>5]:10+y[S>>10]:S<16777216?S<524288?15+y[S>>15]:20+y[S>>20]:S<536870912?25+y[S>>25]:S<-2147483648?30+y[S>>30]:0))-1))return t(this.inputPosition=i.pageStart),null;n[f++]=e.modes[b].blockflag;var x=A[w]-1;this.inputPosition+=x;for(var E=new Array(x),T=0,B=x;T<B;){E[T++]=this.input.readByte()}}else{var k=A[w];this.inputPosition+=k;for(var C=new Array(k),I=0,L=k;I<L;){C[I++]=this.input.readByte()}}g=A[w]<255}var N=0;1<f&&(N+=n[f-1]?e.blocksize1:e.blocksize0);for(var P=f-2;1<=P;)n[--P]?n[P+1]?N+=e.blocksize1>>1:N+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):N+=e.blocksize0>>1,--P;return i.firstDecodedSample=i.lastDecodedSample-N,t(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,i=t.codewords,n=t.sortedCodewords;if(8<t.entries?null!=n:null!=i){for(var r=this.acc,s=(r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16,a=0,o=t.sortedEntries;1<o;){var l=a+(o>>1);Mt.gte(s,n[l])?(a=l,o-=o>>1):o>>=1}t.sparse||(a=t.sortedValues[a]);var u=e[a];return this.validBits>=u?(this.acc=this.acc>>>u,this.validBits-=u,a):(this.validBits=0,-1)}for(var h=0,A=t.entries;h<A;){var c=h++,d=e[c];if(255!=d&&i[c]==(this.acc&(1<<d)-1))return this.validBits>=d?(this.acc=this.acc>>>d,this.validBits-=d,c):(this.validBits=0,-1)}return this.error=new Qt(qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:St};var Lt=f["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(e=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}},e.__params__=["end","last"],e),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:i}},Nt=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(t.channel);this.channelBuffers=i;var n=new Array(t.channel);this.previousWindow=n;var r=new Array(t.channel);this.finalY=r;for(var s=0,a=t.channel;s<a;){var o=s++,l=this.channelBuffers,u=new Array(t.blocksize1);l[o]=u;var h=this.previousWindow,A=new Array(t.blocksize1/2|0);h[o]=A,this.finalY[o]=[]}var c=new Array(2);this.a=c;var d=new Array(2);this.b=d;var _=new Array(2);this.c=_;var f=new Array(2);this.window=f;var g=new Array(2);this.bitReverseData=g,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};(y["kha.audio2.ogg.vorbis.VorbisDecoder"]=Nt).__name__=!0,Nt.start=function(t){var e=new St(t),i=Ut.read(e),n=new Nt(i,e);return e.startFirstDecode(),n.pumpFirstFrame(),n},Nt.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,i,n,r){var s=this.header.sampleRate;if(0!=(Mt.toFloat(n)%Mt.toFloat(s)|0)){var a=this.header.sampleRate;throw new ne("Unsupported sampleRate : can't convert "+Tt.string(null==a?null:Mt.toFloat(a))+" to "+n)}if(i%this.header.channel!=0)throw new ne("Unsupported channels : can't convert "+this.header.channel+" to "+i);var o=this.header.sampleRate,l=Mt.toFloat(n)/Mt.toFloat(o)|0,u=i/this.header.channel|0,h=0,A=Math.floor(e/l);null!=this.totalSample&&A>this.totalSample-this.currentSample&&(A=this.totalSample-this.currentSample);for(var c=0;h<A;){var d=this.channelBufferEnd-this.channelBufferStart;A-h<=d&&(d=A-h);for(var _=this.channelBufferStart,f=this.channelBufferStart+d;_<f;)for(var g=_++,p=0,v=l;p<v;){p++;for(var m=0,w=this.header.channel;m<w;)for(var b=m++,S=0,y=u;S<y;){S++;var x=this.channelBuffers[b][g];1<x?x=1:x<-1&&(x=-1),r&&(t[c]=x,++c)}}if(h+=d,this.channelBufferStart+=d,h==A||0==this.getFrameFloat())break}for(var E=h,T=A;E<T;){E++;for(var B=0,k=l;B<k;){B++;for(var C=0,I=this.header.channel;C<I;){C++;for(var L=0,N=u;L<N;){L++;r&&(t[c]=0,++c)}}}}return this.currentSample+=A,A*l},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var i=this.channelBufferEnd-this.channelBufferStart;if(t-e<=i&&(i=t-e),e+=i,this.channelBufferStart+=i,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new ne(new Qt(qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var n=this.decodeState.pFirst,r=this.decodeState.pLast;if(i>=r.lastDecodedSample&&(i=r.lastDecodedSample-1),i<n.lastDecodedSample)this.seekFrameFromPage(t,n.pageStart,0,i);else{for(var s=0;n.pageEnd<r.pageStart;){var a=n.pageEnd,o=r.afterPreviousPageStart,l=n.lastDecodedSample,u=r.lastDecodedSample;if(null==l||null==u)throw new ne(new Qt(qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));Mt.gt(o,a+4e3)&&(o-=4e3);var h=a+Math.floor(Mt.toFloat(o-a)/Mt.toFloat(u-l)*(i-l));if(4<=s){var A=a+(o-a>>>1);h=8<=s?A:Mt.gt(A,h)?h+(A-h>>>1):A+(h-A>>>1)}++s,t(this.decodeState.inputPosition=h);var c=this.decodeState.findPage(t,e);switch(c._hx_index){case 0:c.last,c.end;break;case 1:throw new ne(new Qt(qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var d=this.decodeState.analyzePage(t,this.header);if(null==d)throw new ne(new Qt(qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));d.afterPreviousPageStart=h,d.pageStart!=r.pageStart?i<d.lastDecodedSample?r=d:n=d:r=d}if(!(n.lastDecodedSample<=i&&i<r.lastDecodedSample))throw new ne(new Qt(qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,r.pageStart,n.lastDecodedSample,i)}}},seekFrameFromPage:function(t,e,i,n){var r=0,s=i;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,u=null;;){l=u,u=this.decodeState.clone(t);var h=this.decodeInitial();if(null==h){u=l;break}o=h.left.start,a=h.left.end;var A=0==r?a:o;if(n<s+h.right.start-A)break;for(var c=this.decodeState;0!=c.bytesInSeg||!c.lastSeg&&0!=c.next();)c.bytesInSeg--,c.inputPosition+=1,c.input.readByte();s+=h.right.start-A,++r}this.decodeState=u,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=s,this.skipSamples(n-s)},clone:function(t){var e=Object.create(Nt.prototype);e.currentSample=this.currentSample,e.totalSample=this.totalSample,e.previousLength=this.previousLength,e.channelBufferStart=this.channelBufferStart,e.channelBufferEnd=this.channelBufferEnd,e.a=this.a,e.b=this.b,e.c=this.c,e.window=this.window,e.bitReverseData=this.bitReverseData,e.header=this.header,e.decodeState=this.decodeState.clone(t);var i=new Array(this.header.channel);e.channelBuffers=i;var n=new Array(this.header.channel);e.previousWindow=n;var r=new Array(this.header.channel);e.finalY=r;for(var s=0,a=this.header.channel;s<a;){var o=s++;e.channelBuffers[o]=Pt.copyVector(this.channelBuffers[o]),e.previousWindow[o]=Pt.copyVector(this.previousWindow[o]),e.finalY[o]=l.array(this.finalY[o])}return e},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,i=t.right,n=t.left;if(0!=this.previousLength)for(var r=this.previousLength,s=this.getWindow(r),a=0,o=this.header.channel;a<o;)for(var l=a++,u=this.channelBuffers[l],h=this.previousWindow[l],A=0,c=r;A<c;){var d=A++;u[n+d]=u[n+d]*s[d]+h[d]*s[r-1-d]}var _=this.previousLength;this.previousLength=e-i;for(var f=0,g=this.header.channel;f<g;)for(var p=f++,v=this.previousWindow[p],m=this.channelBuffers[p],w=0,b=e-i;w<b;){var S=w++;v[S]=m[i+S]}return 0==_?0:(e<i&&(i=e),i-n)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var i=e>>1,n=e>>2,r=e>>3,s=this.a,a=new Array(i);s[t]=a;var o=this.b,l=new Array(i);o[t]=l;var u=this.c,h=new Array(n);u[t]=h;var A=this.window,c=new Array(i);A[t]=c;var d=this.bitReverseData,_=new Array(r);d[t]=_,Pt.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),Pt.computeWindow(e,this.window[t]),Pt.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,i){for(var n=i?1:0,r=this.a[n],s=this.b[n],a=this.c[n],o=this.bitReverseData[n],l=e>>1,u=e>>2,h=e>>3,A=new Array(l),c=l-2,d=0,_=0,f=l;_!=f;)A[c+1]=t[_]*r[d]-t[_+2]*r[d+1],A[c]=t[_]*r[d+1]+t[_+2]*r[d],c-=2,d+=2,_+=4;for(_=l-3;0<=c;)A[c+1]=-t[_+2]*r[d]- -t[_]*r[d+1],A[c]=-t[_+2]*r[d+1]+-t[_]*r[d],c-=2,d+=2,_-=4;for(var g=t,p=A,v=l-8,m=u,w=0,b=u,S=0;0<=v;){var y=p[m+1]-p[w+1],x=p[m]-p[w];g[b+1]=p[m+1]+p[w+1],g[b]=p[m]+p[w],g[S+1]=y*r[v+4]-x*r[v+5],g[S]=x*r[v+4]+y*r[v+5],y=p[m+3]-p[w+3],x=p[m+2]-p[w+2],g[b+3]=p[m+3]+p[w+3],g[b+2]=p[m+2]+p[w+2],g[S+3]=y*r[v]-x*r[v+1],g[S+2]=x*r[v]+y*r[v+1],v-=8,b+=4,S+=4,m+=4,w+=4}for(var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],T=(e<16384?e<16?E[e]:e<512?5+E[e>>5]:10+E[e>>10]:e<16777216?e<524288?15+E[e>>15]:20+E[e>>20]:e<536870912?25+E[e>>25]:e<-2147483648?30+E[e>>30]:0)-1,B=l-1-0*u,k=B,C=B-(e>>3),I=0,L=1+(e>>4>>2);0<--L;){var N=g[k]-g[C],P=g[k+-1]-g[C+-1],R=k,M=g;M[R]=M[R]+g[C];var V=k+-1,D=g;D[V]=D[V]+g[C+-1],g[C]=N*r[I]-P*r[I+1],g[C+-1]=P*r[I]+N*r[I+1],I+=8,N=g[k+-2]-g[C+-2],P=g[k+-3]-g[C+-3];var O=k+-2,F=g;F[O]=F[O]+g[C+-2];var U=k+-3,H=g;H[U]=H[U]+g[C+-3],g[C+-2]=N*r[I]-P*r[I+1],g[C+-3]=P*r[I]+N*r[I+1],I+=8,N=g[k+-4]-g[C+-4],P=g[k+-5]-g[C+-5];var W=k+-4,G=g;G[W]=G[W]+g[C+-4];var z=k+-5,Y=g;Y[z]=Y[z]+g[C+-5],g[C+-4]=N*r[I]-P*r[I+1],g[C+-5]=P*r[I]+N*r[I+1],I+=8,N=g[k+-6]-g[C+-6],P=g[k+-7]-g[C+-7];var X=k+-6,K=g;K[X]=K[X]+g[C+-6];var Q=k+-7,q=g;q[Q]=q[Q]+g[C+-7],g[C+-6]=N*r[I]-P*r[I+1],g[C+-7]=P*r[I]+N*r[I+1],I+=8,k-=8,C-=8}for(var j=l-1-u,Z=j,J=j-(e>>3),$=0,tt=1+(e>>4>>2);0<--tt;){var et=g[Z]-g[J],it=g[Z+-1]-g[J+-1],nt=Z,rt=g;rt[nt]=rt[nt]+g[J];var st=Z+-1,at=g;at[st]=at[st]+g[J+-1],g[J]=et*r[$]-it*r[$+1],g[J+-1]=it*r[$]+et*r[$+1],$+=8,et=g[Z+-2]-g[J+-2],it=g[Z+-3]-g[J+-3];var ot=Z+-2,lt=g;lt[ot]=lt[ot]+g[J+-2];var ut=Z+-3,ht=g;ht[ut]=ht[ut]+g[J+-3],g[J+-2]=et*r[$]-it*r[$+1],g[J+-3]=it*r[$]+et*r[$+1],$+=8,et=g[Z+-4]-g[J+-4],it=g[Z+-5]-g[J+-5];var At=Z+-4,ct=g;ct[At]=ct[At]+g[J+-4];var dt=Z+-5,_t=g;_t[dt]=_t[dt]+g[J+-5],g[J+-4]=et*r[$]-it*r[$+1],g[J+-5]=it*r[$]+et*r[$+1],$+=8,et=g[Z+-6]-g[J+-6],it=g[Z+-7]-g[J+-7];var ft=Z+-6,gt=g;gt[ft]=gt[ft]+g[J+-6];var pt=Z+-7,vt=g;vt[pt]=vt[pt]+g[J+-7],g[J+-6]=et*r[$]-it*r[$+1],g[J+-7]=it*r[$]+et*r[$+1],$+=8,Z-=8,J-=8}for(var mt=l-1-0*h,wt=0,bt=mt,St=mt-(e>>4),yt=1+(e>>5>>2);0<--yt;){var xt=g[bt]-g[St],Et=g[bt+-1]-g[St+-1],Tt=bt,Bt=g;Bt[Tt]=Bt[Tt]+g[St];var kt=bt+-1,Ct=g;Ct[kt]=Ct[kt]+g[St+-1],g[St]=xt*r[wt]-Et*r[wt+1],g[St+-1]=Et*r[wt]+xt*r[wt+1],wt+=16,xt=g[bt+-2]-g[St+-2],Et=g[bt+-3]-g[St+-3];var It=bt+-2,Lt=g;Lt[It]=Lt[It]+g[St+-2];var Nt=bt+-3,Pt=g;Pt[Nt]=Pt[Nt]+g[St+-3],g[St+-2]=xt*r[wt]-Et*r[wt+1],g[St+-3]=Et*r[wt]+xt*r[wt+1],wt+=16,xt=g[bt+-4]-g[St+-4],Et=g[bt+-5]-g[St+-5];var Rt=bt+-4,Mt=g;Mt[Rt]=Mt[Rt]+g[St+-4];var Vt=bt+-5,Dt=g;Dt[Vt]=Dt[Vt]+g[St+-5],g[St+-4]=xt*r[wt]-Et*r[wt+1],g[St+-5]=Et*r[wt]+xt*r[wt+1],wt+=16,xt=g[bt+-6]-g[St+-6],Et=g[bt+-7]-g[St+-7];var Ot=bt+-6,Ft=g;Ft[Ot]=Ft[Ot]+g[St+-6];var Ut=bt+-7,Ht=g;Ht[Ut]=Ht[Ut]+g[St+-7],g[St+-6]=xt*r[wt]-Et*r[wt+1],g[St+-7]=Et*r[wt]+xt*r[wt+1],bt-=8,St-=8,wt+=16}for(var Wt=l-1-h,Gt=0,zt=Wt,Yt=Wt-(e>>4),Xt=1+(e>>5>>2);0<--Xt;){var Kt=g[zt]-g[Yt],Qt=g[zt+-1]-g[Yt+-1],qt=zt,jt=g;jt[qt]=jt[qt]+g[Yt];var Zt=zt+-1,Jt=g;Jt[Zt]=Jt[Zt]+g[Yt+-1],g[Yt]=Kt*r[Gt]-Qt*r[Gt+1],g[Yt+-1]=Qt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-2]-g[Yt+-2],Qt=g[zt+-3]-g[Yt+-3];var $t=zt+-2,te=g;te[$t]=te[$t]+g[Yt+-2];var ee=zt+-3,ie=g;ie[ee]=ie[ee]+g[Yt+-3],g[Yt+-2]=Kt*r[Gt]-Qt*r[Gt+1],g[Yt+-3]=Qt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-4]-g[Yt+-4],Qt=g[zt+-5]-g[Yt+-5];var ne=zt+-4,re=g;re[ne]=re[ne]+g[Yt+-4];var se=zt+-5,ae=g;ae[se]=ae[se]+g[Yt+-5],g[Yt+-4]=Kt*r[Gt]-Qt*r[Gt+1],g[Yt+-5]=Qt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-6]-g[Yt+-6],Qt=g[zt+-7]-g[Yt+-7];var oe=zt+-6,le=g;le[oe]=le[oe]+g[Yt+-6];var ue=zt+-7,he=g;he[ue]=he[ue]+g[Yt+-7],g[Yt+-6]=Kt*r[Gt]-Qt*r[Gt+1],g[Yt+-7]=Qt*r[Gt]+Kt*r[Gt+1],zt-=8,Yt-=8,Gt+=16}for(var Ae=l-1-2*h,ce=0,de=Ae,_e=Ae-(e>>4),fe=1+(e>>5>>2);0<--fe;){var ge=g[de]-g[_e],pe=g[de+-1]-g[_e+-1],ve=de,me=g;me[ve]=me[ve]+g[_e];var we=de+-1,be=g;be[we]=be[we]+g[_e+-1],g[_e]=ge*r[ce]-pe*r[ce+1],g[_e+-1]=pe*r[ce]+ge*r[ce+1],ce+=16,ge=g[de+-2]-g[_e+-2],pe=g[de+-3]-g[_e+-3];var Se=de+-2,ye=g;ye[Se]=ye[Se]+g[_e+-2];var xe=de+-3,Ee=g;Ee[xe]=Ee[xe]+g[_e+-3],g[_e+-2]=ge*r[ce]-pe*r[ce+1],g[_e+-3]=pe*r[ce]+ge*r[ce+1],ce+=16,ge=g[de+-4]-g[_e+-4],pe=g[de+-5]-g[_e+-5];var Te=de+-4,Be=g;Be[Te]=Be[Te]+g[_e+-4];var ke=de+-5,Ce=g;Ce[ke]=Ce[ke]+g[_e+-5],g[_e+-4]=ge*r[ce]-pe*r[ce+1],g[_e+-5]=pe*r[ce]+ge*r[ce+1],ce+=16,ge=g[de+-6]-g[_e+-6],pe=g[de+-7]-g[_e+-7];var Ie=de+-6,Le=g;Le[Ie]=Le[Ie]+g[_e+-6];var Ne=de+-7,Pe=g;Pe[Ne]=Pe[Ne]+g[_e+-7],g[_e+-6]=ge*r[ce]-pe*r[ce+1],g[_e+-7]=pe*r[ce]+ge*r[ce+1],de-=8,_e-=8,ce+=16}for(var Re=l-1-3*h,Me=0,Ve=Re,De=Re-(e>>4),Oe=1+(e>>5>>2);0<--Oe;){var Fe=g[Ve]-g[De],Ue=g[Ve+-1]-g[De+-1],He=Ve,We=g;We[He]=We[He]+g[De];var Ge=Ve+-1,ze=g;ze[Ge]=ze[Ge]+g[De+-1],g[De]=Fe*r[Me]-Ue*r[Me+1],g[De+-1]=Ue*r[Me]+Fe*r[Me+1],Me+=16,Fe=g[Ve+-2]-g[De+-2],Ue=g[Ve+-3]-g[De+-3];var Ye=Ve+-2,Xe=g;Xe[Ye]=Xe[Ye]+g[De+-2];var Ke=Ve+-3,Qe=g;Qe[Ke]=Qe[Ke]+g[De+-3],g[De+-2]=Fe*r[Me]-Ue*r[Me+1],g[De+-3]=Ue*r[Me]+Fe*r[Me+1],Me+=16,Fe=g[Ve+-4]-g[De+-4],Ue=g[Ve+-5]-g[De+-5];var qe=Ve+-4,je=g;je[qe]=je[qe]+g[De+-4];var Ze=Ve+-5,Je=g;Je[Ze]=Je[Ze]+g[De+-5],g[De+-4]=Fe*r[Me]-Ue*r[Me+1],g[De+-5]=Ue*r[Me]+Fe*r[Me+1],Me+=16,Fe=g[Ve+-6]-g[De+-6],Ue=g[Ve+-7]-g[De+-7];var $e=Ve+-6,ti=g;ti[$e]=ti[$e]+g[De+-6];var ei=Ve+-7,ii=g;ii[ei]=ii[ei]+g[De+-7],g[De+-6]=Fe*r[Me]-Ue*r[Me+1],g[De+-7]=Ue*r[Me]+Fe*r[Me+1],Ve-=8,De-=8,Me+=16}for(var ni=2,ri=T-3>>1;ni<ri;)for(var si=ni++,ai=e>>2+si,oi=ai>>1,li=0,ui=1<<1+si;li<ui;)for(var hi=l-1-ai*li++,Ai=1<<3+si,ci=0,di=hi,_i=hi-oi,fi=1+(e>>4+si>>2);0<--fi;){var gi=g[di]-g[_i],pi=g[di+-1]-g[_i+-1],vi=di,mi=g;mi[vi]=mi[vi]+g[_i];var wi=di+-1,bi=g;bi[wi]=bi[wi]+g[_i+-1],g[_i]=gi*r[ci]-pi*r[ci+1],g[_i+-1]=pi*r[ci]+gi*r[ci+1],ci+=Ai,gi=g[di+-2]-g[_i+-2],pi=g[di+-3]-g[_i+-3];var Si=di+-2,yi=g;yi[Si]=yi[Si]+g[_i+-2];var xi=di+-3,Ei=g;Ei[xi]=Ei[xi]+g[_i+-3],g[_i+-2]=gi*r[ci]-pi*r[ci+1],g[_i+-3]=pi*r[ci]+gi*r[ci+1],ci+=Ai,gi=g[di+-4]-g[_i+-4],pi=g[di+-5]-g[_i+-5];var Ti=di+-4,Bi=g;Bi[Ti]=Bi[Ti]+g[_i+-4];var ki=di+-5,Ci=g;Ci[ki]=Ci[ki]+g[_i+-5],g[_i+-4]=gi*r[ci]-pi*r[ci+1],g[_i+-5]=pi*r[ci]+gi*r[ci+1],ci+=Ai,gi=g[di+-6]-g[_i+-6],pi=g[di+-7]-g[_i+-7];var Ii=di+-6,Li=g;Li[Ii]=Li[Ii]+g[_i+-6];var Ni=di+-7,Pi=g;Pi[Ni]=Pi[Ni]+g[_i+-7],g[_i+-6]=gi*r[ci]-pi*r[ci+1],g[_i+-7]=pi*r[ci]+gi*r[ci+1],di-=8,_i-=8,ci+=Ai}for(var Ri=T-3>>1,Mi=T-6;Ri<Mi;)for(var Vi=Ri++,Di=e>>2+Vi,Oi=1<<3+Vi,Fi=Di>>1,Ui=1<<1+Vi,Hi=0,Wi=l-1,Gi=1+(e>>6+Vi);0<--Gi;){for(var zi=r[Hi],Yi=r[Hi+1],Xi=r[Hi+Oi],Ki=r[Hi+Oi+1],Qi=r[Hi+2*Oi],qi=r[Hi+2*Oi+1],ji=r[Hi+3*Oi],Zi=r[Hi+3*Oi+1],Ji=Wi,$i=Wi+-Fi,tn=1+Ui;0<--tn;){var en=g[Ji]-g[$i],nn=g[Ji+-1]-g[$i+-1];g[Ji]=g[Ji]+g[$i],g[Ji+-1]=g[Ji+-1]+g[$i+-1],g[$i]=en*zi-nn*Yi,g[$i+-1]=nn*zi+en*Yi,en=g[Ji+-2]-g[$i+-2],nn=g[Ji+-3]-g[$i+-3],g[Ji+-2]=g[Ji+-2]+g[$i+-2],g[Ji+-3]=g[Ji+-3]+g[$i+-3],g[$i+-2]=en*Xi-nn*Ki,g[$i+-3]=nn*Xi+en*Ki,en=g[Ji+-4]-g[$i+-4],nn=g[Ji+-5]-g[$i+-5],g[Ji+-4]=g[Ji+-4]+g[$i+-4],g[Ji+-5]=g[Ji+-5]+g[$i+-5],g[$i+-4]=en*Qi-nn*qi,g[$i+-5]=nn*Qi+en*qi,en=g[Ji+-6]-g[$i+-6],nn=g[Ji+-7]-g[$i+-7],g[Ji+-6]=g[Ji+-6]+g[$i+-6],g[Ji+-7]=g[Ji+-7]+g[$i+-7],g[$i+-6]=en*ji-nn*Zi,g[$i+-7]=nn*ji+en*Zi,Ji-=Di,$i-=Di}Hi+=4*Oi,Wi-=8}for(var rn=l-1,sn=r[e>>3],an=rn,on=rn-16*(e>>5);on<an;){var ln=g[an],un=g[an+-8];g[an+-8]=ln-un,g[an]=ln+un,ln=g[an+-1],un=g[an+-9],g[an+-9]=ln-un,g[an+-1]=ln+un;var hn=(ln=g[an+-2])-(un=g[an+-10]);g[an+-2]=ln+un;var An=(ln=g[an+-3])-(un=g[an+-11]);g[an+-3]=ln+un,g[an+-10]=(hn+An)*sn,g[an+-11]=(An-hn)*sn,ln=g[an+-4],hn=(un=g[an+-12])-ln,g[an+-4]=ln+un,An=(ln=g[an+-5])-(un=g[an+-13]),g[an+-5]=ln+un,g[an+-12]=An,g[an+-13]=hn,ln=g[an+-6],hn=(un=g[an+-14])-ln,g[an+-6]=ln+un,An=(ln=g[an+-7])-(un=g[an+-15]),g[an+-7]=ln+un,g[an+-14]=(hn+An)*sn,g[an+-15]=(hn-An)*sn;var cn=g[an],dn=g[an+-4],_n=cn-dn,fn=cn+dn,gn=(cn=g[an+-2])+(dn=g[an+-6]),pn=cn-dn;g[an]=fn+gn,g[an+-2]=fn-gn;var vn=g[an+-3]-g[an+-7];g[an+-4]=_n+vn,g[an+-6]=_n-vn;var mn=(cn=g[an+-1])-(dn=g[an+-5]),wn=cn+dn,bn=g[an+-3]+g[an+-7];g[an+-1]=wn+bn,g[an+-3]=wn-bn,g[an+-5]=mn-pn,g[an+-7]=mn+pn;var Sn=an-8,yn=g[Sn],xn=g[Sn-4],En=yn-xn,Tn=yn+xn,Bn=(yn=g[Sn-2])+(xn=g[Sn-6]),kn=yn-xn;g[Sn]=Tn+Bn,g[Sn-2]=Tn-Bn;var Cn=g[Sn-3]-g[Sn-7];g[Sn-4]=En+Cn,g[Sn-6]=En-Cn;var In=(yn=g[Sn-1])-(xn=g[Sn-5]),Ln=yn+xn,Nn=g[Sn-3]+g[Sn-7];g[Sn-1]=Ln+Nn,g[Sn-3]=Ln-Nn,g[Sn-5]=In-kn,g[Sn-7]=In+kn,an-=16}for(var Pn=0,Rn=u-4,Mn=l-4;0<=Rn;){var Vn=o[Pn];p[Mn+3]=g[Vn],p[Mn+2]=g[Vn+1],p[Rn+3]=g[Vn+2],p[Rn+2]=g[Vn+3],Vn=o[Pn+1],p[Mn+1]=g[Vn],p[Mn]=g[Vn+1],p[Rn+1]=g[Vn+2],p[Rn]=g[Vn+3],Rn-=4,Mn-=4,Pn+=2}for(var Dn=0,On=0,Fn=l-4;On<Fn;){var Un=p[On]-p[Fn+2],Hn=p[On+1]+p[Fn+3],Wn=a[Dn+1]*Un+a[Dn]*Hn,Gn=a[Dn+1]*Hn-a[Dn]*Un,zn=p[On]+p[Fn+2],Yn=p[On+1]-p[Fn+3];p[On]=zn+Wn,p[On+1]=Yn+Gn,p[Fn+2]=zn-Wn,p[Fn+3]=Gn-Yn,Un=p[On+2]-p[Fn],Hn=p[On+3]+p[Fn+1],Wn=a[Dn+3]*Un+a[Dn+2]*Hn,Gn=a[Dn+3]*Hn-a[Dn+2]*Un,zn=p[On+2]+p[Fn],Yn=p[On+3]-p[Fn+1],p[On+2]=zn+Wn,p[On+3]=Yn+Gn,p[Fn]=zn-Wn,p[Fn+1]=Gn-Yn,Dn+=4,On+=4,Fn-=4}for(var Xn=l-8,Kn=l-8,Qn=0,qn=l-4,jn=l,Zn=e-4;0<=Kn;){var Jn=A[Kn+6]*s[Xn+7]-A[Kn+7]*s[Xn+6],$n=-A[Kn+6]*s[Xn+6]-A[Kn+7]*s[Xn+7];t[Qn]=Jn,t[qn+3]=-Jn,t[jn]=$n,t[Zn+3]=$n;var tr=A[Kn+4]*s[Xn+5]-A[Kn+5]*s[Xn+4],er=-A[Kn+4]*s[Xn+4]-A[Kn+5]*s[Xn+5];t[Qn+1]=tr,t[qn+2]=-tr,t[jn+1]=er,t[Zn+2]=er,Jn=A[Kn+2]*s[Xn+3]-A[Kn+3]*s[Xn+2],$n=-A[Kn+2]*s[Xn+2]-A[Kn+3]*s[Xn+3],t[Qn+2]=Jn,t[qn+1]=-Jn,t[jn+2]=$n,t[Zn+1]=$n,tr=A[Kn]*s[Xn+1]-A[Kn+1]*s[Xn],er=-A[Kn]*s[Xn]-A[Kn+1]*s[Xn+1],t[Qn+3]=tr,t[qn]=-tr,t[jn+3]=er,t[Zn]=er,Xn-=8,Kn-=8,Qn+=4,jn+=4,qn-=4,Zn-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(t=0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,e.input.readByte()):-1,e.validBits=0,-1==t)break}}var i=this.header.modes.length-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],r=this.decodeState.readBits(i<16384?i<16?n[i]:i<512?5+n[i>>5]:10+n[i>>10]:i<16777216?i<524288?15+n[i>>15]:20+n[i>>20]:i<536870912?25+n[i>>25]:i<-2147483648?30+n[i>>30]:0);if(-1==r||r>=this.header.modes.length)throw new ne(new Qt(qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var s,a,o,l=this.header.modes[r];l.blockflag?(s=this.header.blocksize1,a=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(a=o=0,s=this.header.blocksize0);var u=s>>1;return{mode:r,left:l.blockflag&&0==a?{start:s-this.header.blocksize0>>2,end:s+this.header.blocksize0>>2}:{start:0,end:u},right:l.blockflag&&0==o?{start:3*s-this.header.blocksize0>>2,end:3*s+this.header.blocksize0>>2}:{start:u,end:s}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],i=new Array(256),n=new Array(256),r=e.blockflag?this.header.blocksize1:this.header.blocksize0,s=this.header.mapping[e.mapping],a=r>>1,o=[256,128,86,64],l=this.header.codebooks,u=0,h=this.header.channel;u<h;){var A=u++,c=s.chan[A].mux;i[A]=!1;var d=this.header.floorConfig[s.submapFloor[c]];if(0==d.type)throw new ne(new Qt(qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var _=d.floor1;if(0!=this.decodeState.readBits(1)){var f=[],g=new Array(256),p=o[_.floor1Multiplier-1],v=2,m=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(f=this.finalY[A])[0]=this.decodeState.readBits((p<16384?p<16?m[p]:p<512?5+m[p>>5]:10+m[p>>10]:p<16777216?p<524288?15+m[p>>15]:20+m[p>>20]:p<536870912?25+m[p>>25]:p<-2147483648?30+m[p>>30]:0)-1);var w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];f[1]=this.decodeState.readBits((p<16384?p<16?w[p]:p<512?5+w[p>>5]:10+w[p>>10]:p<16777216?p<524288?15+w[p>>15]:20+w[p>>20]:p<536870912?25+w[p>>25]:p<-2147483648?30+w[p>>30]:0)-1);for(var b=0,S=_.partitions;b<S;){var y=b++,x=_.partitionClassList[y],E=_.classDimensions[x],T=_.classSubclasses[x],B=(1<<T)-1,k=0;if(0!=T){var C=l[_.classMasterbooks[x]],I=this.decodeState;I.validBits<10&&I.prepHuffman();var L,N=C.fastHuffman[1023&I.acc];if(0<=N){var P=C.codewordLengths[N];I.acc=I.acc>>>P,I.validBits-=P,L=I.validBits<0?(I.validBits=0,-1):N}else L=I.decodeScalarRaw(C);C.sparse&&(L=C.sortedValues[L]),k=L}for(var R=_.subclassBooks[x],M=0,V=E;M<V;){M++;var D=R[k&B];k>>=T;var O,F=v++;if(0<=D){var U=this.decodeState,H=l[D];U.validBits<10&&U.prepHuffman();var W,G=H.fastHuffman[1023&U.acc];if(0<=G){var z=H.codewordLengths[G];U.acc=U.acc>>>z,U.validBits-=z,W=U.validBits<0?(U.validBits=0,-1):G}else W=U.decodeScalarRaw(H);H.sparse&&(W=H.sortedValues[W]),O=W}else O=0;f[F]=O}}if(-1==this.decodeState.validBits){i[A]=!0;continue}g[0]=g[1]=!0;for(var Y=_.neighbors,X=_.xlist,K=2,Q=_.values;K<Q;){var q=K++,j=Y[q][0],Z=Y[q][1],J=X[j],$=f[j],tt=f[Z]-$,et=X[Z]-J,it=Math.abs(tt)*(X[q]-J)/et|0,nt=tt<0?$-it:$+it,rt=f[q],st=p-nt,at=st<nt?2*st:2*nt;0!=rt?(g[j]=g[Z]=!0,g[q]=!0,f[q]=at<=rt?nt<st?rt-nt+nt:nt-rt+st-1:0!=(1&rt)?nt-(rt+1>>1):nt+(rt>>1)):(g[q]=!1,f[q]=nt)}for(var ot=0,lt=_.values;ot<lt;){var ut=ot++;g[ut]||(f[ut]=-1)}}else i[A]=!0}for(var ht=0,At=this.header.channel;ht<At;){var ct=ht++;n[ct]=i[ct]}for(var dt=0,_t=s.couplingSteps;dt<_t;){var ft=dt++;i[s.chan[ft].magnitude]&&i[s.chan[ft].angle]||(i[s.chan[ft].magnitude]=i[s.chan[ft].angle]=!1)}for(var gt=0,pt=s.submaps;gt<pt;){for(var vt=gt++,mt=new Array(this.header.channel),wt=new Array(256),bt=0,St=0,yt=this.header.channel;St<yt;){var xt=St++;s.chan[xt].mux==vt&&(i[xt]?(wt[bt]=!0,mt[bt]=null):(wt[bt]=!1,mt[bt]=this.channelBuffers[xt]),++bt)}var Et=s.submapResidue[vt];this.header.residueConfig[Et].decode(this.decodeState,this.header,mt,bt,a,wt,this.channelBuffers)}for(var Tt=s.couplingSteps,Bt=r>>1;0<=--Tt;)for(var kt=this.channelBuffers[s.chan[Tt].magnitude],Ct=this.channelBuffers[s.chan[Tt].angle],It=0,Lt=Bt;It<Lt;){var Nt,Pt,Rt=It++;0<kt[Rt]?0<Ct[Rt]?(Pt=kt[Rt],Nt=kt[Rt]-Ct[Rt]):(Nt=kt[Rt],Pt=kt[Rt]+Ct[Rt]):0<Ct[Rt]?(Pt=kt[Rt],Nt=kt[Rt]+Ct[Rt]):(Nt=kt[Rt],Pt=kt[Rt]-Ct[Rt]),kt[Rt]=Pt,Ct[Rt]=Nt}for(var Mt=0,Vt=this.header.channel;Mt<Vt;){var Dt=Mt++;if(n[Dt])for(var Ot=0,Ft=Bt;Ot<Ft;){var Ut=Ot++;this.channelBuffers[Dt][Ut]=0}else s.doFloor(this.header.floorConfig,Dt,r,this.channelBuffers[Dt],this.finalY[Dt],null)}for(var Ht=0,Wt=this.header.channel;Ht<Wt;){var Gt=Ht++;this.inverseMdct(this.channelBuffers[Gt],r,e.blockflag)}for(var zt=this.decodeState;0!=zt.bytesInSeg||!zt.lastSeg&&0!=zt.next();)zt.bytesInSeg--,zt.inputPosition+=1,zt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,r,t)},__class__:Nt};var Pt=function(){};(y["kha.audio2.ogg.vorbis.VorbisTools"]=Pt).__name__=!0,Pt.assert=function(t,e){},Pt.neighbors=function(t,e){for(var i=-1,n=65536,r=0,s=0,a=0,o=e;a<o;){var l=a++;t[l]>i&&t[l]<t[e]&&(i=t[r=l]),t[l]<n&&t[l]>t[e]&&(n=t[s=l])}return{low:r,high:s}},Pt.floatUnpack=function(t){var e=Mt.toFloat(2097151&t),i=(2145386496&t)>>>21;return(0!=(-2147483648&t)?-e:e)*Math.pow(2,i-788)},Pt.bitReverse=function(t){return(t=(-16711936&(t=(-252645136&(t=(-858993460&(t=(-1431655766&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8)>>>16|t<<16},Pt.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},Pt.uintAsc=function(t,e){return Mt.gt(e,t)?-1:t==e?0:1},Pt.lookup1Values=function(t,e){var i=0|Math.exp(Math.log(t)/e);return(0|Math.pow(i+1,e))<=t&&++i,i},Pt.computeWindow=function(t,e){for(var i=t>>1,n=0,r=i;n<r;){var s=n++;e[s]=Math.sin(1.5707963267948966*Pt.square(Math.sin((.5+s)/i*.5*3.141592653589793)))}},Pt.square=function(t){return t*t},Pt.computeBitReverse=function(t,e){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=(t<16384?t<16?i[t]:t<512?5+i[t>>5]:10+i[t>>10]:t<16777216?t<524288?15+i[t>>15]:20+i[t>>20]:t<536870912?25+i[t>>25]:t<-2147483648?30+i[t>>30]:0)-1,r=0,s=t>>3;r<s;){var a=r++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[a]=(o>>>16|o<<16)>>>32-n+3<<2}},Pt.computeTwiddleFactors=function(t,e,i,n){for(var r=t>>3,s=0,a=0,o=t>>2;a<o;){var l=a++;e[s]=Math.cos(4*l*3.141592653589793/t),e[s+1]=-Math.sin(4*l*3.141592653589793/t),i[s]=.5*Math.cos(3.141592653589793*(s+1)/t/2),i[s+1]=.5*Math.sin(3.141592653589793*(s+1)/t/2),s+=2}for(var u=0,h=0,A=r;h<A;){h++;n[u]=Math.cos(2*(u+1)*3.141592653589793/t),n[u+1]=-Math.sin(2*(u+1)*3.141592653589793/t),u+=2}},Pt.drawLine=function(t,e,i,n,r,s){if(null==Pt.integerDivideTable){var a=new Array(32);Pt.integerDivideTable=a;for(var o=0;o<32;){var l=o++,u=Pt.integerDivideTable,h=new Array(64);u[l]=h;for(var A=1;A<64;){var c=A++;Pt.integerDivideTable[l][c]=l/c|0}}}var d,_,f=r-i,g=n-e,p=f<0?-f:f,v=e,m=i,w=0;_=g<64&&p<32?f<0?(d=-Pt.integerDivideTable[p][g])-1:(d=Pt.integerDivideTable[p][g])+1:(d=f/g|0,f<0?d-1:d+1),p-=(d<0?-d:d)*g,s<n&&(n=s);var b=v,S=t;S[b]=S[b]*Pt.INVERSE_DB_TABLE[m];for(var y=v+1,x=n;y<x;){g<=(w+=p)?(w-=g,m+=_):m+=d;var E=y++,T=t;T[E]=T[E]*Pt.INVERSE_DB_TABLE[m]}},Pt.predictPoint=function(t,e,i,n,r){var s=r-n,a=i-e,o=Math.abs(s)*(t-e)/a|0;return s<0?n-o:n+o},Pt.emptyFloatVector=function(t){return new Array(t)},Pt.copyVector=function(t){for(var e=new Array(t.length),i=0,n=t.length;i<n;){var r=i++;e[r]=t[r]}return e};function Rt(){}(y["kha.audio2.ogg.vorbis.data.Codebook"]=Rt).__name__=!0,Rt.read=function(t){var e=new Rt;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+i;var n=t.readBits(8),r=t.readBits(8);e.entries=(t.readBits(8)<<16)+(r<<8)+n;var s=t.readBits(1);e.sparse=0==s&&0!=t.readBits(1);var a=new Array(e.entries);e.sparse||(e.codewordLengths=a);var o,l=0;if(0!=s)for(var u=0,h=t.readBits(5)+1;u<e.entries;){var A=e.entries-u,c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],d=t.readBits(A<16384?A<16?c[A]:A<512?5+c[A>>5]:10+c[A>>10]:A<16777216?A<524288?15+c[A>>15]:20+c[A>>20]:A<536870912?25+c[A>>25]:A<-2147483648?30+c[A>>30]:0);if(u+d>e.entries)throw new ne(new Qt(qt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var _=0,f=d;_<f;){a[u+_++]=h}u+=d,++h}else for(var g=0,p=e.entries;g<p;){var v=g++;0!=(e.sparse?t.readBits(1):1)?(a[v]=t.readBits(5)+1,++l):a[v]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=a,e.sparse=!1),e.sparse)o=l;else{for(var m=0,w=0,b=e.entries;w<b;){var S=a[w++];10<S&&255!=S&&++m}o=m}e.sortedEntries=o;var y=null;if(e.sparse){if(0!=e.sortedEntries){var x=new Array(e.sortedEntries);e.codewordLengths=x;var E=new Array(e.entries);e.codewords=E,y=new Array(e.entries)}e.entries,e.sortedEntries}else{var T=new Array(e.entries);e.codewords=T}if(!e.computeCodewords(a,e.entries,y))throw new ne(new Qt(qt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var B=new Array(e.sortedEntries);e.sortedValues=B,e.computeSortedHuffman(a,y)}if(e.sparse&&(y=null,a=e.codewords=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),2<e.lookupType)throw new ne(new Qt(qt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<e.lookupType){var k=t.readBits(32),C=Mt.toFloat(2097151&k),I=(2145386496&k)>>>21,L=0!=(-2147483648&k)?-C:C;e.minimumValue=L*Math.pow(2,I-788);var N=t.readBits(32),P=Mt.toFloat(2097151&N),R=(2145386496&N)>>>21,M=0!=(-2147483648&N)?-P:P;e.deltaValue=M*Math.pow(2,R-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=Pt.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var V=new Array(e.lookupValues),D=0,O=e.lookupValues;D<O;){var F=D++,U=t.readBits(e.valueBits);if(-1==U)throw new ne(new Qt(qt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));V[F]=U}var H=new Array(e.lookupValues);e.multiplicands=H;for(var W=0,G=e.lookupValues;W<G;){var z=W++;e.multiplicands[z]=V[z]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var Y=1,X=e.lookupValues;Y<X;){var K=Y++;e.multiplicands[K]=e.multiplicands[K-1]}e.sequenceP=!1}}return e},Rt.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(t,e,i,n,r){this.sparse?(this.codewords[i]=t,this.codewordLengths[i]=n,r[i]=e):this.codewords[e]=t},includeInSort:function(t){return!!this.sparse||255!=t&&10<t},computeCodewords:function(t,e,i){var n=new Array(32);n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,n[16]=0,n[17]=0,n[18]=0,n[19]=0,n[20]=0,n[21]=0,n[22]=0,n[23]=0,n[24]=0,n[25]=0,n[26]=0,n[27]=0,n[28]=0,n[29]=0,n[30]=0;for(var r=n[31]=0;r<e&&!(t[r]<255);)++r;if(r==e)return!0;var s=0,a=s++;this.sparse?(this.codewords[a]=0,this.codewordLengths[a]=t[r],i[a]=r):this.codewords[r]=0;for(var o=0;++o<=t[r];)n[o]=1<<32-o;for(o=r;++o<e;){var l=t[o];if(255!=l){for(;0<l&&0==n[l];)--l;if(0==l)return!1;var u=n[l];n[l]=0;var h=u,A=(h=(-16711936&(h=(-252645136&(h=(-858993460&(h=(-1431655766&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8)>>>16|h<<16,c=s++;if(this.sparse?(this.codewords[c]=A,this.codewordLengths[c]=t[o],i[c]=o):this.codewords[o]=A,l!=t[o])for(var d=t[o];l<d;)n[d]=u+(1<<32-d),--d}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var i=0,n=this.sortedEntries;i<n;){var r=i++,s=this.codewords[r];s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,this.sortedCodewords[r]=s>>>16|s<<16}else for(var a=0,o=0,l=this.entries;o<l;){var u=o++,h=t[u];if(this.sparse||255!=h&&10<h){var A=this.codewords[u];A=(-16711936&(A=(-252645136&(A=(-858993460&(A=(-1431655766&A)>>>1|(1431655765&A)<<1))>>>2|(858993459&A)<<2))>>>4|(252645135&A)<<4))>>>8|(16711935&A)<<8,this.sortedCodewords[a++]=A>>>16|A<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Pt.uintAsc);for(var c=0,d=this.sparse?this.sortedEntries:this.entries;c<d;){var _=c++,f=this.sparse?t[e[_]]:t[_];if(this.sparse||255!=f&&10<f){for(var g=this.codewords[_],p=(g=(-16711936&(g=(-252645136&(g=(-858993460&(g=(-1431655766&g)>>>1|(1431655765&g)<<1))>>>2|(858993459&g)<<2))>>>4|(252645135&g)<<4))>>>8|(16711935&g)<<8)>>>16|g<<16,v=0,m=this.sortedEntries;1<m;){var w=v+(m>>1);Mt.gte(p,this.sortedCodewords[w])?(v=w,m-=m>>1):m>>=1}this.sparse?(this.sortedValues[v]=e[_],this.codewordLengths[v]=f):this.sortedValues[v]=_}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var i=e++;this.fastHuffman[i]=-1}for(var n=0,r=this.sparse?this.sortedEntries:this.entries;n<r;){var s=n++;if(this.codewordLengths[s]<=10){var a;if(this.sparse){var o=this.sortedCodewords[s];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[s];for(;a<1024;)this.fastHuffman[a]=s,a+=1<<this.codewordLengths[s]}}},codebookDecode:function(t,e,i,n){t.validBits<10&&t.prepHuffman();var r,s=this.fastHuffman[1023&t.acc];if(0<=s){var a=this.codewordLengths[s];t.acc=t.acc>>>a,t.validBits-=a,r=t.validBits<0?(t.validBits=0,-1):s}else r=t.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var o=r,l=this.lookupValues,u=this.sequenceP,h=this.multiplicands,A=this.minimumValue;if(o<0)return!1;if(n>this.dimensions&&(n=this.dimensions),1==this.lookupType){for(var c=1,d=0,_=0,f=n;_<f;){var g=_++,p=h[Mt.toFloat(o/c|0)%Mt.toFloat(l)|0]+d,v=i+g,m=e;m[v]=m[v]+p,u&&(d=p+A),c*=l}return!0}if(o*=this.dimensions,u)for(var w=0,b=0,S=n;b<S;){var y=b++,x=h[o+y]+w,E=i+y,T=e;T[E]=T[E]+x,w=x+A}else for(var B=0,k=n;B<k;){var C=B++,I=i+C,L=e;L[I]=L[I]+(h[o+C]+0)}return!0},codebookDecodeStep:function(t,e,i,n,r){t.validBits<10&&t.prepHuffman();var s,a=this.fastHuffman[1023&t.acc];if(0<=a){var o=this.codewordLengths[a];t.acc=t.acc>>>o,t.validBits-=o,s=t.validBits<0?(t.validBits=0,-1):a}else s=t.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,u=0;if(l<0)return!1;n>this.dimensions&&(n=this.dimensions);var h=this.lookupValues,A=this.sequenceP,c=this.multiplicands;if(1==this.lookupType){for(var d=1,_=0,f=n;_<f;){var g=_++,p=c[Mt.toFloat(l/d|0)%Mt.toFloat(h)|0]+u,v=i+g*r,m=e;m[v]=m[v]+p,A&&(u=p),d*=h}return!0}l*=this.dimensions;for(var w=0,b=n;w<b;){var S=w++,y=c[l+S]+u,x=i+S*r,E=e;E[x]=E[x]+y,A&&(u=y)}return!0},decodeStart:function(t){t.validBits<10&&t.prepHuffman();var e,i=this.fastHuffman[1023&t.acc];if(0<=i){var n=this.codewordLengths[i];t.acc=t.acc>>>n,t.validBits-=n,e=t.validBits<0?(t.validBits=0,-1):i}else e=t.decodeScalarRaw(this);return this.sparse&&(e=this.sortedValues[e]),e},decodeDeinterleaveRepeat:function(t,e,i,n,r,s,a){var o=this.dimensions;if(0==this.lookupType)throw new ne(new Qt(qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,u=this.sequenceP,h=this.lookupValues;0<a;){var A=0;t.validBits<10&&t.prepHuffman();var c,d=this.fastHuffman[1023&t.acc];if(0<=d){var _=this.codewordLengths[d];t.acc=t.acc>>>_,t.validBits-=_,c=t.validBits<0?(t.validBits=0,-1):d}else c=t.decodeScalarRaw(this);this.sparse&&(c=this.sortedValues[c]);var f=c;if(f<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new ne(new Qt(qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(s*i<n+r*i+o&&(o=s*i-(r*i-n)),1==this.lookupType){var g=1;if(u)for(var p=0,v=o;p<v;){p++;var m=l[Mt.toFloat(f/g|0)%Mt.toFloat(h)|0]+A,w=r,b=e[n];b[w]=b[w]+m,++n==i&&(n=0,++r),A=m,g*=h}else for(var S=0,y=o;S<y;){S++;var x=l[Mt.toFloat(f/g|0)%Mt.toFloat(h)|0]+A,E=r,T=e[n];T[E]=T[E]+x,++n==i&&(n=0,++r),g*=h}}else if(f*=this.dimensions,u)for(var B=0,k=o;B<k;){var C=l[f+B++]+A,I=r,L=e[n];L[I]=L[I]+C,++n==i&&(n=0,++r),A=C}else for(var N=0,P=o;N<P;){var R=l[f+N++]+A,M=r,V=e[n];V[M]=V[M]+R,++n==i&&(n=0,++r)}a-=o}return{cInter:n,pInter:r}},residueDecode:function(t,e,i,n,r){if(0==r)for(var s=n/this.dimensions|0,a=0,o=s;a<o;){var l=a++;if(!this.codebookDecodeStep(t,e,i+l,n-i-l,s))return!1}else for(var u=0;u<n;){if(!this.codebookDecode(t,e,i,n-u))return!1;u+=this.dimensions,i+=this.dimensions}return!0},__class__:Rt};function Vt(){this.data=new it}(y["kha.audio2.ogg.vorbis.data.Comment"]=Vt).__name__=!0,Vt.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return Tt.parseInt(this.getString("loopstart"))},get_loopLength:function(){return Tt.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(t,e){t=t.toLowerCase();var i=this.data;if(null!=Ri[t]?i.existsReserved(t):i.h.hasOwnProperty(t)){var n=this.data;(null!=Ri[t]?n.getReserved(t):n.h[t]).push(e)}else{var r=[e],s=this.data;null!=Ri[t]?s.setReserved(t,r):s.h[t]=r}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ri[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return(null!=Ri[t]?i.getReserved(t):i.h[t])[0]}return null},getArray:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ri[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return null!=Ri[t]?i.getReserved(t):i.h[t]}return null},__class__:Vt};function Dt(){}(y["kha.audio2.ogg.vorbis.data.Floor"]=Dt).__name__=!0,Dt.read=function(t,e){var i=new Dt;if(i.type=t.readBits(16),1<i.type)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var n=i.floor0=new Ot;n.order=t.readBits(8),n.rate=t.readBits(16),n.barkMapSize=t.readBits(16),n.amplitudeBits=t.readBits(6),n.amplitudeOffset=t.readBits(8),n.numberOfBooks=t.readBits(4)+1;for(var r=0,s=n.numberOfBooks;r<s;){var a=r++;n.bookList[a]=t.readBits(8)}throw new ne(new Qt(qt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new Ft,u=-1;l.partitions=t.readBits(5);var h=new Array(l.partitions);l.partitionClassList=h;for(var A=0,c=l.partitions;A<c;){var d=A++;l.partitionClassList[d]=t.readBits(4),l.partitionClassList[d]>u&&(u=l.partitionClassList[d])}var _=new Array(u+1);l.classDimensions=_;var f=new Array(u+1);l.classMasterbooks=f;var g=new Array(u+1);l.classSubclasses=g;var p=new Array(u+1);l.subclassBooks=p;for(var v=0,m=u+1;v<m;){var w=v++;if(l.classDimensions[w]=t.readBits(3)+1,l.classSubclasses[w]=t.readBits(2),0!=l.classSubclasses[w]&&(l.classMasterbooks[w]=t.readBits(8),l.classMasterbooks[w]>=e.length))throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var b=1<<l.classSubclasses[w],S=l.subclassBooks,y=new Array(b);S[w]=y;for(var x=0,E=b;x<E;){var T=x++;if(l.subclassBooks[w][T]=t.readBits(8)-1,l.subclassBooks[w][T]>=e.length)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var B=new Array(250);l.xlist=B,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var k=0,C=l.partitions;k<C;)for(var I=k++,L=l.partitionClassList[I],N=0,P=l.classDimensions[L];N<P;){N++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var R=0,M=l.values;R<M;){var V=R++;o.push(new Ht),o[V].x=l.xlist[V],o[V].y=V}o.sort(Pt.pointCompare);var D=new Array(l.values);l.sortedOrder=D;for(var O=0,F=l.values;O<F;){var U=O++;l.sortedOrder[U]=o[U].y}var H=new Array(l.values);l.neighbors=H;for(var W=2,G=l.values;W<G;){for(var z=W++,Y=l.xlist,X=-1,K=65536,Q=0,q=0,j=0,Z=z;j<Z;){var J=j++;Y[J]>X&&Y[J]<Y[z]&&(X=Y[Q=J]),Y[J]<K&&Y[J]>Y[z]&&(K=Y[q=J])}var $=Q,tt=q,et=l.neighbors,it=new Array(l.values);et[z]=it,l.neighbors[z][0]=$,l.neighbors[z][1]=tt}return i},Dt.prototype={floor0:null,floor1:null,type:null,__class__:Dt};var Ot=function(){};(y["kha.audio2.ogg.vorbis.data.Floor0"]=Ot).__name__=!0,Ot.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Ot};var Ft=function(){};(y["kha.audio2.ogg.vorbis.data.Floor1"]=Ft).__name__=!0,Ft.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Ft};var Ut=function(){};(y["kha.audio2.ogg.vorbis.data.Header"]=Ut).__name__=!0,Ut.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,n,r,s,a,o,l=new kt(new ArrayBuffer(6));if(i=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[0]=i,n=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[1]=n,r=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[2]=r,s=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[3]=s,a=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[4]=a,o=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new ne(new Qt(qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var u=t.input.readInt32();if(0!=u)throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"vorbis version : "+u,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var h=new Ut;if(t.inputPosition+=1,h.channel=t.input.readByte(),0==h.channel)throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<h.channel)throw new ne(new Qt(qt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,h.sampleRate=t.input.readInt32(),0==h.sampleRate)throw new ne(new Qt(qt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,h.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,h.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,h.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var A=t.input.readByte(),c=15&A,d=A>>4;if(h.blocksize0=1<<c,h.blocksize1=1<<d,c<6||13<c)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(d<6||13<d)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(d<c)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var _=t.input.readByte();if(0==(1&_))throw new ne(new Qt(qt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var f=0,g=new At;0!=(f=t.next());)t.inputPosition+=f,g.write(t.input.read(f)),t.bytesInSeg=0;var p=new ht(g.getBytes());p.readByte(),p.read(6);var v,m=p.readInt32();h.vendor=p.readString(m),h.comment=new Vt;for(var w=0,b=p.readInt32();w<b;){w++;var S=p.readInt32(),y=p.readString(S),x=y.indexOf("=");-1!=x&&h.comment.add(y.substring(0,x),y.substring(x+1))}if(0==(1&p.readByte()))throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),v=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,5!=v)throw new ne(new Qt(qt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var E,T,B,k,C,I,L=new kt(new ArrayBuffer(6));if(E=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[0]=E,T=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[1]=T,B=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[2]=B,k=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[3]=k,C=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[4]=C,I=0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,t.input.readByte()):-1,t.validBits=0,L.b[5]=I,"vorbis"!=L.toString())throw new ne(new Qt(qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var N=t.readBits(8)+1,P=new Array(N);h.codebooks=P;for(var R=0,M=N;R<M;){var V=R++;h.codebooks[V]=Rt.read(t)}for(var D=0,O=_=t.readBits(6)+1;D<O;){D++;if(0!=t.readBits(16))throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var F=t.readBits(6)+1,U=new Array(F);h.floorConfig=U;for(var H=0,W=F;H<W;){var G=H++;h.floorConfig[G]=Dt.read(t,h.codebooks)}var z=t.readBits(6)+1,Y=new Array(z);h.residueConfig=Y;for(var X=0,K=z;X<K;){var Q=X++;h.residueConfig[Q]=jt.read(t,h.codebooks)}var q=t.readBits(6)+1,j=new Array(q);h.mapping=j;for(var Z=0,J=q;Z<J;)for(var $=Z++,tt=Wt.read(t,h.channel),et=0,it=(h.mapping[$]=tt).submaps;et<it;){var nt=et++;if(tt.submapFloor[nt]>=h.floorConfig.length)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(tt.submapResidue[nt]>=h.residueConfig.length)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var rt=t.readBits(6)+1,st=new Array(rt);h.modes=st;for(var at=0,ot=rt;at<ot;){var lt=at++,ut=zt.read(t);if((h.modes[lt]=ut).mapping>=h.mapping.length)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return h},Ut.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Ut};var Ht=function(){};(y["kha.audio2.ogg.vorbis.data.IntPoint"]=Ht).__name__=!0,Ht.prototype={x:null,y:null,__class__:Ht};var Wt=function(){};(y["kha.audio2.ogg.vorbis.data.Mapping"]=Wt).__name__=!0,Wt.read=function(t,e){var i=new Wt,n=t.readBits(16);if(0!=n)throw new ne(new Qt(qt.INVALID_SETUP,"mapping type "+n,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var r=new Array(e);i.chan=r;for(var s=0,a=e;s<a;){var o=s++;i.chan[o]=new Gt}if(0!=t.readBits(1)?i.submaps=t.readBits(4)+1:i.submaps=1,0!=t.readBits(1)){i.couplingSteps=t.readBits(8)+1;for(var l=0,u=i.couplingSteps;l<u;){var h=l++,A=e-1,c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[h].magnitude=t.readBits(A<16384?A<16?c[A]:A<512?5+c[A>>5]:10+c[A>>10]:A<16777216?A<524288?15+c[A>>15]:20+c[A>>20]:A<536870912?25+c[A>>25]:A<-2147483648?30+c[A>>30]:0);var d=e-1,_=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[h].angle=t.readBits(d<16384?d<16?_[d]:d<512?5+_[d>>5]:10+_[d>>10]:d<16777216?d<524288?15+_[d>>15]:20+_[d>>20]:d<536870912?25+_[d>>25]:d<-2147483648?30+_[d>>30]:0),i.chan[h].magnitude>=e)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].angle>=e)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[h].magnitude==i.chan[h].angle)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=t.readBits(2))throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<i.submaps)for(var f=0,g=e;f<g;){var p=f++;if(i.chan[p].mux=t.readBits(4),i.chan[p].mux>=i.submaps)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var v=0,m=e;v<m;){var w=v++;i.chan[w].mux=0}var b=new Array(i.submaps);i.submapFloor=b;var S=new Array(i.submaps);i.submapResidue=S;for(var y=0,x=i.submaps;y<x;){var E=y++;t.readBits(8),i.submapFloor[E]=t.readBits(8),i.submapResidue[E]=t.readBits(8)}return i},Wt.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,i,n,r,s){var a=i>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new ne(new Qt(qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var u=l.floor1,h=0,A=r[0]*u.floor1Multiplier,c=1,d=u.values;c<d;){var _=c++,f=u.sortedOrder[_];if(0<=r[f]){var g=r[f]*u.floor1Multiplier,p=u.xlist[f];Pt.drawLine(n,h,A,p,g,a),h=p,A=g}}if(h<a)for(var v=h,m=a;v<m;){var w=v++,b=n;b[w]=b[w]*Pt.INVERSE_DB_TABLE[A]}},__class__:Wt};var Gt=function(){};(y["kha.audio2.ogg.vorbis.data.MappingChannel"]=Gt).__name__=!0,Gt.prototype={magnitude:null,angle:null,mux:null,__class__:Gt};var zt=function(){};(y["kha.audio2.ogg.vorbis.data.Mode"]=zt).__name__=!0,zt.read=function(t){var e=new zt;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},zt.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:zt};var Yt=function(){};(y["kha.audio2.ogg.vorbis.data.Page"]=Yt).__name__=!0,Yt.prototype={flag:null,clone:function(){var t=new Yt;return t.flag=this.flag,t},start:function(t){if(t.inputPosition+=1,!!(!!(79!=t.input.readByte()||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,103!=t.input.readByte()))||(t.inputPosition+=1,83!=t.input.readByte()))throw new ne(new Qt(qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new ne(new Qt(qt.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4;var n=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(i,n)},__class__:Yt};function Xt(){}(y["kha.audio2.ogg.vorbis.data.PageFlag"]=Xt).__name__=!0;var Kt=function(){};(y["kha.audio2.ogg.vorbis.data.ProbedPage"]=Kt).__name__=!0,Kt.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Kt};var Qt=function(t,e,i){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=i};(y["kha.audio2.ogg.vorbis.data.ReaderError"]=Qt).__name__=!0,Qt.prototype={type:null,message:null,posInfos:null,__class__:Qt};var qt=f["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:i}},jt=function(){};(y["kha.audio2.ogg.vorbis.data.Residue"]=jt).__name__=!0,jt.read=function(t,e){var i=new jt;if(i.type=t.readBits(16),2<i.type)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var n=new Array(64);i.begin=t.readBits(24),i.end=t.readBits(24),i.partSize=t.readBits(24)+1;var r=i.classifications=t.readBits(6)+1;i.classbook=t.readBits(8);for(var s=0,a=i.classifications;s<a;){var o=s++,l=0,u=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),n[o]=8*l+u}var h=new Array(i.classifications);i.residueBooks=h;for(var A=0,c=i.classifications;A<c;){var d=A++,_=i.residueBooks,f=new Array(8);_[d]=f;for(var g=0;g<8;){var p=g++;if(0!=(n[d]&1<<p)){if(i.residueBooks[d][p]=t.readBits(8),i.residueBooks[d][p]>=e.length)throw new ne(new Qt(qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[d][p]=-1}}var v=e[i.classbook].entries,m=e[i.classbook].dimensions,w=new Array(v);i.classdata=w;for(var b=0,S=v;b<S;)for(var y=b++,x=y,E=m,T=i.classdata,B=new Array(m),k=T[y]=B;0<=--E;)k[E]=x%r,x=x/r|0;return i},jt.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,i,n,r,s,a){for(var o=e.codebooks,l=o[this.classbook].dimensions,u=this.end-this.begin,h=this.partSize,A=Mt.toFloat(u)/Mt.toFloat(h)|0,c=new Array(e.channel*A+1),d=0,_=n;d<_;){var f=d++;if(!s[f])for(var g=i[f],p=0,v=g.length;p<v;){g[p++]=0}}if(2!=this.type||1==n)for(var m=0;m<8;)for(var w=m++,b=0;b<A;){if(0==w)for(var S=0,y=n;S<y;){var x=S++;if(!s[x]){var E=o[this.classbook];t.validBits<10&&t.prepHuffman();var T,B=E.fastHuffman[1023&t.acc];if(0<=B){var k=E.codewordLengths[B];t.acc=t.acc>>>k,t.validBits-=k,T=t.validBits<0?(t.validBits=0,-1):B}else T=t.decodeScalarRaw(E);E.sparse&&(T=E.sortedValues[T]);var C=T;if(-1==C)return;for(var I=l;0<=--I;)c[x*A+I+b]=C%this.classifications,C=C/this.classifications|0}}for(var L=0,N=l;L<N;){L++;if(A<=b)break;for(var P=0,R=n;P<R;){var M=P++;if(!s[M]){var V=c[M*A+b],D=this.residueBooks[V][w];if(0<=D){var O=i[M],F=this.begin+b*h,U=h;if(!o[D].residueDecode(t,O,F,U,this.type))return}}}++b}}else{for(var H=0,W=n;H<W;){var G=H++;if(!s[G])break;if(G==n-1)return}for(var z=0;z<8;){var Y=z++,X=0;if(2==n)for(;X<A;){var K=this.begin+X*h,Q=1&K,q=K>>>1;if(0==Y){var j=o[this.classbook];t.validBits<10&&t.prepHuffman();var Z,J=j.fastHuffman[1023&t.acc];if(0<=J){var $=j.codewordLengths[J];t.acc=t.acc>>>$,t.validBits-=$,Z=t.validBits<0?(t.validBits=0,-1):J}else Z=t.decodeScalarRaw(j);j.sparse&&(Z=j.sortedValues[Z]);var tt=Z;if(-1==tt)return;for(var et=l;0<=--et;)c[et+X]=tt%this.classifications,tt=tt/this.classifications|0}for(var it=0,nt=l;it<nt;){it++;if(A<=X)break;var rt=this.begin+X*h,st=c[X],at=this.residueBooks[st][Y];if(0<=at){var ot=o[at].decodeDeinterleaveRepeat(t,i,n,Q,q,r,h);if(null==ot)return;Q=ot.cInter,q=ot.pInter}else Q=1&(rt+=h),q=rt>>>1;++X}}else if(1==n)for(;X<A;){var lt=0,ut=this.begin+X*h;if(0==Y){var ht=o[this.classbook];t.validBits<10&&t.prepHuffman();var At,ct=ht.fastHuffman[1023&t.acc];if(0<=ct){var dt=ht.codewordLengths[ct];t.acc=t.acc>>>dt,t.validBits-=dt,At=t.validBits<0?(t.validBits=0,-1):ct}else At=t.decodeScalarRaw(ht);ht.sparse&&(At=ht.sortedValues[At]);var _t=At;if(-1==_t)return;for(var ft=l;0<=--ft;)c[ft+X]=_t%this.classifications,_t=_t/this.classifications|0}for(var gt=0,pt=l;gt<pt;){gt++;if(A<=X)break;var vt=this.begin+X*h,mt=this.residueBooks[c[X]][Y];if(0<=mt){var wt=o[mt].decodeDeinterleaveRepeat(t,i,n,lt,ut,r,h);if(null==wt)return;lt=wt.cInter,ut=wt.pInter}else lt=0,ut=vt+=h;++X}}else for(;X<A;){var bt=this.begin+X*h,St=Mt.toFloat(bt)%Mt.toFloat(n)|0,yt=Mt.toFloat(bt)/Mt.toFloat(n)|0;if(0==Y){var xt=o[this.classbook];t.validBits<10&&t.prepHuffman();var Et,Tt=xt.fastHuffman[1023&t.acc];if(0<=Tt){var Bt=xt.codewordLengths[Tt];t.acc=t.acc>>>Bt,t.validBits-=Bt,Et=t.validBits<0?(t.validBits=0,-1):Tt}else Et=t.decodeScalarRaw(xt);xt.sparse&&(Et=xt.sortedValues[Et]);var kt=Et;if(-1==kt)return;for(var Ct=l;0<=--Ct;)c[Ct+X]=kt%this.classifications,kt=kt/this.classifications|0}for(var It=0,Lt=l;It<Lt;){It++;if(A<=X)break;var Nt=this.begin+X*h,Pt=this.residueBooks[c[X]][Y];if(0<=Pt){var Rt=o[Pt].decodeDeinterleaveRepeat(t,i,n,St,yt,r,h);if(null==Rt)return;St=Rt.cInter,yt=Rt.pInter}else Nt+=h,St=Mt.toFloat(Nt)%Mt.toFloat(n)|0,yt=Mt.toFloat(Nt)/Mt.toFloat(n)|0;++X}}}}},__class__:jt};function Zt(){}(y["kha.audio2.ogg.vorbis.data.Setting"]=Zt).__name__=!0;function Jt(){}(y["kha.compute.ConstantLocation"]=Jt).__name__=!0,Jt.prototype={__class__:Jt};function $t(){}(y["kha.compute.TextureUnit"]=$t).__name__=!0,$t.prototype={__class__:$t};function te(){}(y["kha.graphics1.Graphics"]=te).__name__=!0,te.__isInterface__=!0,te.prototype={begin:null,end:null,setPixel:null,__class__:te};var ee=function(){this.transformations=[new ni(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};(y["kha.graphics2.Graphics"]=ee).__name__=!0,ee.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},flush:function(){},clear:function(t){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,n,r,s,a){this.drawScaledSubImage(t,n,r,s,a,e,i,s,a)},drawScaledImage:function(t,e,i,n,r){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,n,r)},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){},drawRect:function(t,e,i,n,r){null==r&&(r=1)},fillRect:function(t,e,i,n){},drawString:function(t,e,i){},drawCharacters:function(t,e,i,n,r){},drawLine:function(t,e,i,n,r){null==r&&(r=1)},drawVideo:function(t,e,i,n,r){},fillTriangle:function(t,e,i,n,r,s){},get_imageScaleQuality:function(){return oe.Low},set_imageScaleQuality:function(t){return oe.High},get_mipmapScaleQuality:function(){return oe.Low},set_mipmapScaleQuality:function(t){return oe.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},get_transformation:function(){return this.transformations[this.transformationIndex]},set_transformation:function(t){this.setTransformation(t);var e=this.transformations[this.transformationIndex];return e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,t},pushTransformation:function(t){this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ni(1,0,0,0,1,0,0,0,1));var e=this.transformations[this.transformationIndex];e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(this.transformations[this.transformationIndex])},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},scale:function(t,e){var i=this.transformations[this.transformationIndex],n=t,r=e,s=this.transformations[this.transformationIndex],a=n*s._00+0*s._01+0*s._02,o=n*s._10+0*s._11+0*s._12,l=n*s._20+0*s._21+0*s._22,u=0*s._00+r*s._01+0*s._02,h=0*s._10+r*s._11+0*s._12,A=0*s._20+r*s._21+0*s._22,c=0*s._00+0*s._01+1*s._02,d=0*s._10+0*s._11+1*s._12,_=0*s._20+0*s._21+1*s._22;i._00=a,i._10=o,i._20=l,i._01=u,i._11=h,i._21=A,i._02=c,i._12=d,i._22=_},translation:function(t,e){var i=t,n=e,r=this.transformations[this.transformationIndex];return new ni(1*r._00+0*r._01+i*r._02,1*r._10+0*r._11+i*r._12,1*r._20+0*r._21+i*r._22,0*r._00+1*r._01+n*r._02,0*r._10+1*r._11+n*r._12,0*r._20+1*r._21+n*r._22,0*r._00+0*r._01+1*r._02,0*r._10+0*r._11+1*r._12,0*r._20+0*r._21+1*r._22)},translate:function(t,e){var i=this.transformations[this.transformationIndex],n=t,r=e,s=this.transformations[this.transformationIndex],a=1*s._00+0*s._01+n*s._02,o=1*s._10+0*s._11+n*s._12,l=1*s._20+0*s._21+n*s._22,u=0*s._00+1*s._01+r*s._02,h=0*s._10+1*s._11+r*s._12,A=0*s._20+1*s._21+r*s._22,c=0*s._00+0*s._01+1*s._02,d=0*s._10+0*s._11+1*s._12,_=0*s._20+0*s._21+1*s._22;i._00=a,i._10=o,i._20=l,i._01=u,i._11=h,i._21=A,i._02=c,i._12=d,i._22=_},pushTranslation:function(t,e){var i=t,n=e,r=this.transformations[this.transformationIndex],s=1*r._00+0*r._01+i*r._02,a=1*r._10+0*r._11+i*r._12,o=1*r._20+0*r._21+i*r._22,l=0*r._00+1*r._01+n*r._02,u=0*r._10+1*r._11+n*r._12,h=0*r._20+1*r._21+n*r._22,A=0*r._00+0*r._01+1*r._02,c=0*r._10+0*r._11+1*r._12,d=0*r._20+0*r._21+1*r._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ni(1,0,0,0,1,0,0,0,1));var _=this.transformations[this.transformationIndex];_._00=s,_._10=a,_._20=o,_._01=l,_._11=u,_._21=h,_._02=A,_._12=c,_._22=d,this.setTransformation(this.transformations[this.transformationIndex])},rotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=1*s+0*o+0*n,h=1*a+0*l+0*n,A=0+1*n,c=0*s+1*o+0*r,d=0*a+1*l+0*r,_=0+1*r,f=0*s+0*o+0,g=0*a+0*l+0,p=-e,v=-i,m=1*u+0*h+0*A,w=0*u+1*h+0*A,b=u*p+h*v+1*A,S=1*c+0*d+0*_,y=0*c+1*d+0*_,x=c*p+d*v+1*_,E=1*f+0*g+0,T=0*f+1*g+0,B=f*p+g*v+1,k=this.transformations[this.transformationIndex];return new ni(m*k._00+w*k._01+b*k._02,m*k._10+w*k._11+b*k._12,m*k._20+w*k._21+b*k._22,S*k._00+y*k._01+x*k._02,S*k._10+y*k._11+x*k._12,S*k._20+y*k._21+x*k._22,E*k._00+T*k._01+B*k._02,E*k._10+T*k._11+B*k._12,E*k._20+T*k._21+B*k._22)},rotate:function(t,e,i){var n=this.transformations[this.transformationIndex],r=e,s=i,a=Math.cos(t),o=-Math.sin(t),l=Math.sin(t),u=Math.cos(t),h=1*a+0*l+0*r,A=1*o+0*u+0*r,c=0+1*r,d=0*a+1*l+0*s,_=0*o+1*u+0*s,f=0+1*s,g=0*a+0*l+0,p=0*o+0*u+0,v=-e,m=-i,w=1*h+0*A+0*c,b=0*h+1*A+0*c,S=h*v+A*m+1*c,y=1*d+0*_+0*f,x=0*d+1*_+0*f,E=d*v+_*m+1*f,T=1*g+0*p+0,B=0*g+1*p+0,k=g*v+p*m+1,C=this.transformations[this.transformationIndex],I=w*C._00+b*C._01+S*C._02,L=w*C._10+b*C._11+S*C._12,N=w*C._20+b*C._21+S*C._22,P=y*C._00+x*C._01+E*C._02,R=y*C._10+x*C._11+E*C._12,M=y*C._20+x*C._21+E*C._22,V=T*C._00+B*C._01+k*C._02,D=T*C._10+B*C._11+k*C._12,O=T*C._20+B*C._21+k*C._22;n._00=I,n._10=L,n._20=N,n._01=P,n._11=R,n._21=M,n._02=V,n._12=D,n._22=O},pushRotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),u=1*s+0*o+0*n,h=1*a+0*l+0*n,A=0+1*n,c=0*s+1*o+0*r,d=0*a+1*l+0*r,_=0+1*r,f=0*s+0*o+0,g=0*a+0*l+0,p=-e,v=-i,m=1*u+0*h+0*A,w=0*u+1*h+0*A,b=u*p+h*v+1*A,S=1*c+0*d+0*_,y=0*c+1*d+0*_,x=c*p+d*v+1*_,E=1*f+0*g+0,T=0*f+1*g+0,B=f*p+g*v+1,k=this.transformations[this.transformationIndex],C=m*k._00+w*k._01+b*k._02,I=m*k._10+w*k._11+b*k._12,L=m*k._20+w*k._21+b*k._22,N=S*k._00+y*k._01+x*k._02,P=S*k._10+y*k._11+x*k._12,R=S*k._20+y*k._21+x*k._22,M=E*k._00+T*k._01+B*k._02,V=E*k._10+T*k._11+B*k._12,D=E*k._20+T*k._21+B*k._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ni(1,0,0,0,1,0,0,0,1));var O=this.transformations[this.transformationIndex];O._00=C,O._10=I,O._20=L,O._01=N,O._11=P,O._21=R,O._02=M,O._12=V,O._22=D,this.setTransformation(this.transformations[this.transformationIndex])},pushOpacity:function(t){this.setOpacity(t),this.opacities.push(t)},popOpacity:function(){var t=this.opacities.pop();return this.setOpacity(this.get_opacity()),t},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(t){return this.setOpacity(t),this.opacities[this.opacities.length-1]=t},scissor:function(t,e,i,n){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(t){return this.setPipeline(t),this.pipe=t},transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(t){},setOpacity:function(t){},setPipeline:function(t){},__class__:ee};var ie=function(t){this.canvas=t};(y["kha.graphics2.Graphics1"]=ie).__name__=!0,ie.__interfaces__=[te],ie.prototype={canvas:null,texture:null,pixels:null,begin:function(){null!=this.texture&&this.texture.get_realWidth()==this.canvas.get_width()&&this.texture.get_realHeight()==this.canvas.get_height()||(this.texture=C.create(this.canvas.get_width(),this.canvas.get_height(),0,2)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(t,e,i){this.pixels.setInt32(e*this.texture.get_realWidth()*4+4*t,i)},__class__:ie};function re(){}(y["kha.graphics2.GraphicsExtension"]=re).__name__=!0,re.drawArc=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==o&&(o=!1),null==a&&(a=1),r%=2*Math.PI,s%=2*Math.PI,o?r<s&&(s-=2*Math.PI):s<r&&(s+=2*Math.PI),l<=0&&(l=Math.floor(10*Math.sqrt(n)));for(var u=(s-r)/l,h=Math.cos(u),A=Math.sin(u),c=Math.cos(r)*n,d=Math.sin(r)*n,_=0,f=l;_<f;){_++;var g=c+e,p=d+i,v=c;c=h*c-A*d,d=h*d+A*v,t.drawLine(g,p,c+e,d+i,a)}},re.fillArc=function(t,e,i,n,r,s,a,o){null==o&&(o=0),null==a&&(a=!1),r%=2*Math.PI,s%=2*Math.PI,a?r<s&&(s-=2*Math.PI):s<r&&(s+=2*Math.PI),o<=0&&(o=Math.floor(10*Math.sqrt(n)));for(var l=(s-r)/o,u=Math.cos(l),h=Math.sin(l),A=Math.cos(r)*n,c=Math.sin(r)*n,d=A+e,_=c+i,f=0,g=o;f<g;){f++;var p=A+e,v=c+i,m=A;A=u*A-h*c,c=u*c+h*m,t.fillTriangle(p,v,A+e,c+i,d,_)}},re.drawCircle=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=1),s<=0&&(s=Math.floor(10*Math.sqrt(n)));for(var a=2*Math.PI/s,o=Math.cos(a),l=Math.sin(a),u=n,h=0,A=0,c=s;A<c;){A++;var d=u+e,_=h+i,f=u;u=o*u-l*h,h=o*h+l*f,t.drawLine(d,_,u+e,h+i,r)}},re.fillCircle=function(t,e,i,n,r){null==r&&(r=0),r<=0&&(r=Math.floor(10*Math.sqrt(n)));for(var s=2*Math.PI/r,a=Math.cos(s),o=Math.sin(s),l=n,u=0,h=0,A=r;h<A;){h++;var c=l+e,d=u+i,_=l;l=a*l-o*u,u=a*u+o*_,t.fillTriangle(c,d,l+e,u+i,e,i)}},re.drawPolygon=function(t,e,i,n,r){null==r&&(r=1);for(var s=xt.iter(n),a=s.next(),o=a;s.hasNext();){var l=s.next();t.drawLine(o.x+e,o.y+i,l.x+e,l.y+i,r),o=l}t.drawLine(o.x+e,o.y+i,a.x+e,a.y+i,r)},re.fillPolygon=function(t,e,i,n){var r=xt.iter(n);if(r.hasNext()){var s=r.next();if(r.hasNext())for(var a=r.next();r.hasNext();){var o=r.next();t.fillTriangle(s.x+e,s.y+i,a.x+e,a.y+i,o.x+e,o.y+i),a=o}}},re.drawCubicBezier=function(t,e,i,n,r){null==r&&(r=1),null==n&&(n=20);for(var s,a=re.calculateCubicBezierPoint(0,e,i),o=1,l=n+1;o<l;){var u=o++;s=re.calculateCubicBezierPoint(u/n,e,i),t.drawLine(a[0],a[1],s[0],s[1],r),a=s}},re.drawCubicBezierPath=function(t,e,i,n,r){null==r&&(r=1),null==n&&(n=20);for(var s=0,a=null,o=null;s<e.length-3;){0==s&&(a=re.calculateCubicBezierPoint(0,[e[s],e[s+1],e[s+2],e[s+3]],[i[s],i[s+1],i[s+2],i[s+3]]));for(var l=1,u=n+1;l<u;){var h=l++;o=re.calculateCubicBezierPoint(h/n,[e[s],e[s+1],e[s+2],e[s+3]],[i[s],i[s+1],i[s+2],i[s+3]]),t.drawLine(a[0],a[1],o[0],o[1],r),a=o}s+=3}},re.calculateCubicBezierPoint=function(t,e,i){var n=1-t,r=t*t,s=n*n,a=s*n,o=r*t,l=[a*e[0],a*i[0]];return l[0]+=3*s*t*e[1],l[1]+=3*s*t*i[1],l[0]+=3*n*r*e[2],l[1]+=3*n*r*i[2],l[0]+=o*e[3],l[1]+=o*i[3],l},re.drawAlignedString=function(t,e,i,n,r,s){var a=0;if(r==ae.TextCenter||r==ae.TextRight){var o=t.get_font().width(t.get_fontSize(),e);a=r==ae.TextCenter?.5*-o:-o}var l=0;if(s==le.TextMiddle||s==le.TextBottom){var u=t.get_font().height(t.get_fontSize());l=s==le.TextMiddle?.5*-u:-u}t.drawString(e,i+a,n+l)},re.drawAlignedCharacters=function(t,e,i,n,r,s,a,o){var l=0;if(a==ae.TextCenter||a==ae.TextRight){var u=t.get_font().widthOfCharacters(t.get_fontSize(),e,i,n);l=a==ae.TextCenter?.5*-u:-u}var h=0;if(o==le.TextMiddle||o==le.TextBottom){var A=t.get_font().height(t.get_fontSize());h=o==le.TextMiddle?.5*-A:-A}t.drawCharacters(e,i,n,r+l,s+h)};function se(){}var ae=f["kha.graphics2.HorTextAlignment"]={__ename__:!0,__constructs__:["TextLeft","TextCenter","TextRight"],TextLeft:{_hx_index:0,__enum__:"kha.graphics2.HorTextAlignment",toString:i},TextCenter:{_hx_index:1,__enum__:"kha.graphics2.HorTextAlignment",toString:i},TextRight:{_hx_index:2,__enum__:"kha.graphics2.HorTextAlignment",toString:i}},oe=f["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:i},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:i}},le=f["kha.graphics2.VerTextAlignment"]={__ename__:!0,__constructs__:["TextTop","TextMiddle","TextBottom"],TextTop:{_hx_index:0,__enum__:"kha.graphics2.VerTextAlignment",toString:i},TextMiddle:{_hx_index:1,__enum__:"kha.graphics2.VerTextAlignment",toString:i},TextBottom:{_hx_index:2,__enum__:"kha.graphics2.VerTextAlignment",toString:i}};(y["kha.graphics2.truetype.VectorOfIntPointer"]=se).__name__=!0,se.prototype={value:null,__class__:se};function ue(){}(y["kha.graphics2.truetype.Stbtt_temp_rect"]=ue).__name__=!0,ue.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ue};function he(){}(y["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=he).__name__=!0,he.prototype={advanceWidth:null,leftSideBearing:null,__class__:he};function Ae(){}(y["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Ae).__name__=!0,Ae.prototype={ascent:null,descent:null,lineGap:null,__class__:Ae};function ce(){}(y["kha.graphics2.truetype.Stbtt_temp_region"]=ce).__name__=!0,ce.prototype={width:null,height:null,xoff:null,yoff:null,__class__:ce};var de=function(){};(y["kha.graphics2.truetype.Stbtt_bakedchar"]=de).__name__=!0,de.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:de};function _e(){}(y["kha.graphics2.truetype.Stbtt_aligned_quad"]=_e).__name__=!0,_e.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:_e};function fe(){}(y["kha.graphics2.truetype.Stbtt_packedchar"]=fe).__name__=!0,fe.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:fe};function ge(){}(y["kha.graphics2.truetype.Stbtt_pack_range"]=ge).__name__=!0,ge.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:ge};function pe(){}(y["kha.graphics2.truetype.Stbtt_pack_context"]=pe).__name__=!0,pe.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:pe};var ve=function(){};(y["kha.graphics2.truetype.Stbtt_fontinfo"]=ve).__name__=!0,ve.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:ve};function me(){}(y["kha.graphics2.truetype.Stbtt_vertex"]=me).__name__=!0,me.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:me};function we(){}(y["kha.graphics2.truetype.Stbtt__bitmap"]=we).__name__=!0,we.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:we};function be(){}(y["kha.graphics2.truetype.Stbtt__edge"]=be).__name__=!0,be.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:be};function Se(){}(y["kha.graphics2.truetype.Stbtt__active_edge"]=Se).__name__=!0,Se.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Se};function ye(){}(y["kha.graphics2.truetype.Stbtt__point"]=ye).__name__=!0,ye.prototype={x:null,y:null,__class__:ye};var xe=function(){};(y["kha.graphics2.truetype.StbTruetype"]=xe).__name__=!0,xe.STBTT_assert=function(t){if(!t)throw new ne("Error")},xe.STBTT_POINT_SIZE=function(t){return-t},xe.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},xe.ttCHAR=function(t,e){null==e&&(e=0);var i=t.readU8(e);return 128<=i?i-256:i},xe.ttUSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e);return t.readU8(e+1)|i<<8},xe.ttSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1)|i<<8;return 0!=(32768&n)?n-65536:n},xe.ttULONG=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),r=t.readU8(i+1),s=t.readU8(i+2);return t.readU8(i+3)|s<<8|r<<16|n<<24},xe.ttLONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},xe.ttFixed=function(t,e){null==e&&(e=0);var i=e;null==i&&(i=0);var n=t.readU8(i),r=t.readU8(i+1),s=t.readU8(i+2);return t.readU8(i+3)|s<<8|r<<16|n<<24},xe.stbtt_tag4=function(t,e,i,n,r,s){return t.readU8(e)==i&&t.readU8(e+1)==n&&t.readU8(e+2)==r&&t.readU8(e+3)==s},xe.stbtt_tag=function(t,e,i){var n=xt.cca(i,0),r=xt.cca(i,1),s=xt.cca(i,2),a=xt.cca(i,3);return t.readU8(e)==n&&t.readU8(e+1)==r&&t.readU8(e+2)==s&&t.readU8(e+3)==a},xe.stbtt__isfont=function(t){var e=xt.cca("1",0);if(t.readU8(0)==e&&0==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3))return!0;var i=xt.cca("typ1",0),n=xt.cca("typ1",1),r=xt.cca("typ1",2),s=xt.cca("typ1",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s)return!0;var a=xt.cca("OTTO",0),o=xt.cca("OTTO",1),l=xt.cca("OTTO",2),u=xt.cca("OTTO",3);return t.readU8(0)==a&&t.readU8(1)==o&&t.readU8(2)==l&&t.readU8(3)==u||0==t.readU8(0)&&1==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3)},xe.stbtt__find_table=function(t,e,i){var n=e+4;null==n&&(n=0);for(var r=t.readU8(n),s=e+12,a=0,o=t.readU8(n+1)|r<<8;a<o;){var l=s+16*a++,u=xt.cca(i,0),h=xt.cca(i,1),A=xt.cca(i,2),c=xt.cca(i,3);if(t.readU8(l)==u&&t.readU8(l+1)==h&&t.readU8(l+2)==A&&t.readU8(l+3)==c){var d=l+8;null==d&&(d=0);var _=d;null==_&&(_=0);var f=t.readU8(_),g=t.readU8(_+1),p=t.readU8(_+2);return t.readU8(_+3)|p<<8|g<<16|f<<24}}return 0},xe.stbtt_GetFontOffsetForIndex=function(t,e){if(xe.stbtt__isfont(t))return 0==e?0:-1;var i=xt.cca("ttcf",0),n=xt.cca("ttcf",1),r=xt.cca("ttcf",2),s=xt.cca("ttcf",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s){var a,o=4;null==o&&(o=0);var l=o;null==l&&(l=0);var u=t.readU8(l),h=t.readU8(l+1),A=t.readU8(l+2);if(65536!=(t.readU8(l+3)|A<<8|h<<16|u<<24)){var c=4;null==c&&(c=0);var d=c;null==d&&(d=0);var _=t.readU8(d),f=t.readU8(d+1),g=t.readU8(d+2);a=131072==(t.readU8(d+3)|g<<8|f<<16|_<<24)}else a=!0;if(a){var p=8;null==p&&(p=0);var v=t.readU8(p),m=t.readU8(p+1),w=t.readU8(p+2);if((t.readU8(p+3)|w<<8|m<<16|v<<24)<=e)return-1;var b=12+4*e;null==b&&(b=0);var S=b;null==S&&(S=0);var y=t.readU8(S),x=t.readU8(S+1),E=t.readU8(S+2);return t.readU8(S+3)|E<<8|x<<16|y<<24}}return-1},xe.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var n=xe.stbtt__find_table(e,i,"cmap");if(t.loca=xe.stbtt__find_table(e,i,"loca"),t.head=xe.stbtt__find_table(e,i,"head"),t.glyf=xe.stbtt__find_table(e,i,"glyf"),t.hhea=xe.stbtt__find_table(e,i,"hhea"),t.hmtx=xe.stbtt__find_table(e,i,"hmtx"),t.kern=xe.stbtt__find_table(e,i,"kern"),0==n||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var r=xe.stbtt__find_table(e,i,"maxp");if(0!=r){var s=r+4;null==s&&(s=0);var a=e.readU8(s),o=e.readU8(s+1);t.numGlyphs=o|a<<8}else t.numGlyphs=65535;var l=n+2;null==l&&(l=0);for(var u=e.readU8(l),h=e.readU8(l+1)|u<<8,A=t.index_map=0,c=h;A<c;){var d=n+4+8*A++,_=d;null==_&&(_=0);var f=e.readU8(_);switch(e.readU8(_+1)|f<<8){case 0:var g=d+4;null==g&&(g=0);var p=g;null==p&&(p=0);var v=e.readU8(p),m=e.readU8(p+1),w=e.readU8(p+2),b=e.readU8(p+3);t.index_map=n+(b|w<<8|m<<16|v<<24);break;case 3:var S=d+2;null==S&&(S=0);var y=e.readU8(S);switch(e.readU8(S+1)|y<<8){case 1:case 10:var x=d+4;null==x&&(x=0);var E=x;null==E&&(E=0);var T=e.readU8(E),B=e.readU8(E+1),k=e.readU8(E+2),C=e.readU8(E+3);t.index_map=n+(C|k<<8|B<<16|T<<24)}}}if(0==t.index_map)return!1;var I=t.head+50;null==I&&(I=0);var L=e.readU8(I),N=e.readU8(I+1);return t.indexToLocFormat=N|L<<8,!0},xe.stbtt_FindGlyphIndex=function(t,e){var i=t.data,n=t.index_map,r=n;null==r&&(r=0);var s=i.readU8(r),a=i.readU8(r+1)|s<<8;if(0==a){var o=n+2;null==o&&(o=0);var l=i.readU8(o);if(e<(i.readU8(o+1)|l<<8)-6){var u=n+6+e;return null==u&&(u=0),i.readU8(u)}return 0}if(6==a){var h=n+6;null==h&&(h=0);var A=i.readU8(h),c=i.readU8(h+1)|A<<8,d=n+8;null==d&&(d=0);var _=i.readU8(d),f=i.readU8(d+1);if(c<=e&&e<c+(f|_<<8)){var g=n+10+2*(e-c);null==g&&(g=0);var p=i.readU8(g);return i.readU8(g+1)|p<<8}return 0}if(2==a)throw new ne("Error");if(4==a){var v=n+6;null==v&&(v=0);var m=i.readU8(v),w=(i.readU8(v+1)|m<<8)>>1,b=n+8;null==b&&(b=0);var S=i.readU8(b),y=(i.readU8(b+1)|S<<8)>>1,x=n+10;null==x&&(x=0);var E=i.readU8(x),T=i.readU8(x+1)|E<<8,B=n+12;null==B&&(B=0);var k=i.readU8(B),C=(i.readU8(B+1)|k<<8)>>1,I=n+14,L=I;if(65535<e)return 0;var N=L+2*C;null==N&&(N=0);var P=i.readU8(N);for((i.readU8(N+1)|P<<8)<=e&&(L+=2*C),L-=2;0!=T;){var R=L+2*(y>>=1);null==R&&(R=0);var M=i.readU8(R);(i.readU8(R+1)|M<<8)<e&&(L+=2*y),--T}var V=(L+=2)-I>>1,D=I+2*V;null==D&&(D=0);var O=i.readU8(D);if((i.readU8(D+1)|O<<8)<e)throw new ne("Error");var F=n+14+2*w+2+2*V;null==F&&(F=0);var U=i.readU8(F),H=i.readU8(F+1)|U<<8;if(e<H)return 0;var W=n+14+6*w+2+2*V;null==W&&(W=0);var G=i.readU8(W),z=i.readU8(W+1)|G<<8;if(0==z){var Y=n+14+4*w+2+2*V;null==Y&&(Y=0);var X=i.readU8(Y),K=i.readU8(Y+1)|X<<8;return e+(0!=(32768&K)?K-65536:K)}var Q=z+2*(e-H)+n+14+6*w+2+2*V;null==Q&&(Q=0);var q=i.readU8(Q);return i.readU8(Q+1)|q<<8}if(12!=a&&13!=a)throw new ne("Error");var j=n+12;null==j&&(j=0);var Z=j;null==Z&&(Z=0);for(var J=i.readU8(Z),$=i.readU8(Z+1),tt=i.readU8(Z+2),et=0,it=i.readU8(Z+3)|tt<<8|$<<16|J<<24;et<it;){var nt=et+(it-et>>1),rt=n+16+12*nt;null==rt&&(rt=0);var st=rt;null==st&&(st=0);var at=i.readU8(st),ot=i.readU8(st+1),lt=i.readU8(st+2),ut=i.readU8(st+3)|lt<<8|ot<<16|at<<24,ht=n+16+12*nt+4;null==ht&&(ht=0);var At=ht;null==At&&(At=0);var ct=i.readU8(At),dt=i.readU8(At+1),_t=i.readU8(At+2),ft=i.readU8(At+3);if(e<ut)it=nt;else{if(!((ft|_t<<8|dt<<16|ct<<24)<e)){var gt=n+16+12*nt+8;null==gt&&(gt=0);var pt=gt;null==pt&&(pt=0);var vt=i.readU8(pt),mt=i.readU8(pt+1),wt=i.readU8(pt+2),bt=i.readU8(pt+3)|wt<<8|mt<<16|vt<<24;return 12==a?bt+e-ut:bt}et=nt+1}}return 0},xe.stbtt_GetCodepointShape=function(t,e){return xe.stbtt_GetGlyphShape(t,xe.stbtt_FindGlyphIndex(t,e))},xe.stbtt_setvertex=function(t,e,i,n,r,s){t.type=e,t.x=i,t.y=n,t.cx=r,t.cy=s},xe.stbtt__GetGlyfOffset=function(t,e){var i,n;if(e>=t.numGlyphs)return-1;if(2<=t.indexToLocFormat)return-1;if(0==t.indexToLocFormat){var r=t.glyf,s=t.data,a=t.loca+2*e;null==a&&(a=0);var o=s.readU8(a);i=r+2*(s.readU8(a+1)|o<<8);var l=t.glyf,u=t.data,h=t.loca+2*e+2;null==h&&(h=0);var A=u.readU8(h);n=l+2*(u.readU8(h+1)|A<<8)}else{var c=t.glyf,d=t.data,_=t.loca+4*e;null==_&&(_=0);var f=_;null==f&&(f=0);var g=d.readU8(f),p=d.readU8(f+1),v=d.readU8(f+2);i=c+(d.readU8(f+3)|v<<8|p<<16|g<<24);var m=t.glyf,w=t.data,b=t.loca+4*e+4;null==b&&(b=0);var S=b;null==S&&(S=0);var y=w.readU8(S),x=w.readU8(S+1),E=w.readU8(S+2);n=m+(w.readU8(S+3)|E<<8|x<<16|y<<24)}return i==n?-1:i},xe.stbtt_GetGlyphBox=function(t,e,i){var n=xe.stbtt__GetGlyfOffset(t,e);if(n<0)return!1;var r=t.data,s=n+2;null==s&&(s=0);var a=r.readU8(s),o=r.readU8(s+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=t.data,u=n+4;null==u&&(u=0);var h=l.readU8(u),A=l.readU8(u+1)|h<<8;i.y0=0!=(32768&A)?A-65536:A;var c=t.data,d=n+6;null==d&&(d=0);var _=c.readU8(d),f=c.readU8(d+1)|_<<8;i.x1=0!=(32768&f)?f-65536:f;var g=t.data,p=n+8;null==p&&(p=0);var v=g.readU8(p),m=g.readU8(p+1)|v<<8;return i.y1=0!=(32768&m)?m-65536:m,!0},xe.stbtt_GetCodepointBox=function(t,e,i){return xe.stbtt_GetGlyphBox(t,xe.stbtt_FindGlyphIndex(t,e),i)},xe.stbtt_IsGlyphEmpty=function(t,e){var i=xe.stbtt__GetGlyfOffset(t,e);if(i<0)return!0;var n=t.data,r=i;null==r&&(r=0);var s=n.readU8(r),a=n.readU8(r+1)|s<<8;return 0==(0!=(32768&a)?a-65536:a)},xe.stbtt__close_shape=function(t,e,i,n,r,s,a,o,l,u){return n?(i&&xe.stbtt_setvertex(t[e++],3,l+a>>1,u+o>>1,l,u),xe.stbtt_setvertex(t[e++],3,r,s,a,o)):i?xe.stbtt_setvertex(t[e++],3,r,s,l,u):xe.stbtt_setvertex(t[e++],2,r,s,0,0),e},xe.copyVertices=function(t,e,i,n){for(var r=0,s=n;r<s;){var a=r++;e[i+a]=t[a]}},xe.stbtt_GetGlyphShape=function(t,e){var i=t.data,n=null,r=0,s=xe.stbtt__GetGlyfOffset(t,e);if(s<0)return null;var a=s;null==a&&(a=0);var o=i.readU8(a),l=i.readU8(a+1)|o<<8,u=0!=(32768&l)?l-65536:l;if(0<u){var h,A=0,c=0,d=0,_=!1,f=!1,g=s+10,p=g+2*u;null==p&&(p=0);var v=i.readU8(p),m=g+2*u+2+(i.readU8(p+1)|v<<8),w=g+2*u-2;null==w&&(w=0);var b=i.readU8(w),S=1+(i.readU8(w+1)|b<<8),y=S+2*u;if(null==(n=new Array(y)))return null;for(var x=0,E=n.length;x<E;){n[x++]=new me}var T=d=0;h=y-S;for(var B=0,k=S;B<k;){var C=B++;0==T?0!=(8&(A=i.readU8(m++)))&&(T=i.readU8(m++)):--T,n[h+C].type=A}for(var I=0,L=0,N=S;L<N;){var P=L++;if(0!=(2&(A=n[h+P].type))){var R=i.readU8(m++);I+=0!=(16&A)?R:-R}else if(0==(16&A)){var M=i.readU8(m),V=i.readU8(m+1)|M<<8;I+=0!=(32768&V)?V-65536:V,m+=2}n[h+P].x=I}for(var D=0,O=0,F=S;O<F;){var U=O++;if(0!=(4&(A=n[h+U].type))){var H=i.readU8(m++);D+=0!=(32&A)?H:-H}else if(0==(32&A)){var W=i.readU8(m),G=i.readU8(m+1)|W<<8;D+=0!=(32768&G)?G-65536:G,m+=2}n[h+U].y=D}for(var z=r=0,Y=z,X=Y,K=X,Q=K,q=Q,j=0;j<S;){if(A=n[h+j].type,I=n[h+j].x,D=n[h+j].y,d==j){0!=j&&(r=xe.stbtt__close_shape(n,r,_,f,q,Q,Y,z,K,X)),(f=0==(1&A))?(Y=I,z=D,0==(1&n[h+j+1].type)?(q=I+n[h+j+1].x>>1,Q=D+n[h+j+1].y>>1):(q=n[h+j+1].x,Q=n[h+j+1].y,++j)):(q=I,Q=D),xe.stbtt_setvertex(n[r++],1,q,Q,0,0),_=!1;var Z=g+2*c;null==Z&&(Z=0);var J=i.readU8(Z);d=1+(i.readU8(Z+1)|J<<8),++c}else _=0==(1&A)?(_&&xe.stbtt_setvertex(n[r++],3,K+I>>1,X+D>>1,K,X),K=I,X=D,!0):(_?xe.stbtt_setvertex(n[r++],3,I,D,K,X):xe.stbtt_setvertex(n[r++],2,I,D,0,0),!1);++j}r=xe.stbtt__close_shape(n,r,_,f,q,Q,Y,z,K,X)}else if(-1==u){var $=1,tt=s+10;for(r=0,n=null;0!=$;){var et,it,nt=null,rt=1,st=0,at=0,ot=1,lt=0,ut=0,ht=tt;null==ht&&(ht=0);var At=i.readU8(ht),ct=i.readU8(ht+1)|At<<8,dt=0!=(32768&ct)?ct-65536:ct,_t=tt+=2;null==_t&&(_t=0);var ft=i.readU8(_t),gt=i.readU8(_t+1)|ft<<8,pt=0!=(32768&gt)?gt-65536:gt;if(tt+=2,0==(2&dt))throw new ne("Error");if(0!=(1&dt)){var vt=tt;null==vt&&(vt=0);var mt=i.readU8(vt),wt=i.readU8(vt+1)|mt<<8;lt=0!=(32768&wt)?wt-65536:wt;var bt=tt+=2;null==bt&&(bt=0);var St=i.readU8(bt),yt=i.readU8(bt+1)|St<<8;ut=0!=(32768&yt)?yt-65536:yt,tt+=2}else{var xt=tt;null==xt&&(xt=0);var Et=i.readU8(xt);lt=128<=Et?Et-256:Et;var Tt=++tt;null==Tt&&(Tt=0);var Bt=i.readU8(Tt);ut=128<=Bt?Bt-256:Bt,++tt}if(0!=(8&dt)){var kt=tt;null==kt&&(kt=0);var Ct=i.readU8(kt),It=i.readU8(kt+1)|Ct<<8;rt=ot=(0!=(32768&It)?It-65536:It)/16384,tt+=2,st=at=0}else if(0!=(64&dt)){var Lt=tt;null==Lt&&(Lt=0);var Nt=i.readU8(Lt),Pt=i.readU8(Lt+1)|Nt<<8;rt=(0!=(32768&Pt)?Pt-65536:Pt)/16384,st=at=0;var Rt=tt+=2;null==Rt&&(Rt=0);var Mt=i.readU8(Rt),Vt=i.readU8(Rt+1)|Mt<<8;ot=(0!=(32768&Vt)?Vt-65536:Vt)/16384,tt+=2}else if(0!=(128&dt)){var Dt=tt;null==Dt&&(Dt=0);var Ot=i.readU8(Dt),Ft=i.readU8(Dt+1)|Ot<<8;rt=(0!=(32768&Ft)?Ft-65536:Ft)/16384;var Ut=tt+=2;null==Ut&&(Ut=0);var Ht=i.readU8(Ut),Wt=i.readU8(Ut+1)|Ht<<8;st=(0!=(32768&Wt)?Wt-65536:Wt)/16384;var Gt=tt+=2;null==Gt&&(Gt=0);var zt=i.readU8(Gt),Yt=i.readU8(Gt+1)|zt<<8;at=(0!=(32768&Yt)?Yt-65536:Yt)/16384;var Xt=tt+=2;null==Xt&&(Xt=0);var Kt=i.readU8(Xt),Qt=i.readU8(Xt+1)|Kt<<8;ot=(0!=(32768&Qt)?Qt-65536:Qt)/16384,tt+=2}var qt=Math.sqrt(rt*rt+st*st),jt=Math.sqrt(at*at+ot*ot);if(0<(et=null==(it=xe.stbtt_GetGlyphShape(t,pt))?0:it.length)){for(var Zt=0,Jt=et;Zt<Jt;){var $t=it[Zt++],te=$t.x,ee=$t.y;$t.x=qt*(rt*te+at*ee+lt)|0,$t.y=jt*(st*te+ot*ee+ut)|0,te=$t.cx,ee=$t.cy,$t.cx=qt*(rt*te+at*ee+lt)|0,$t.cy=jt*(st*te+ot*ee+ut)|0}if(null==(nt=new Array(r+et)))return null;0<r&&xe.copyVertices(n,nt,0,r),xe.copyVertices(it,nt,r,et),n=nt,r+=et}$=32&dt}}else if(u<0)throw new ne("Error");if(null==n)return null;if(n.length<r)throw new ne("Error");if(r<n.length){var ie=new Array(r);return xe.copyVertices(n,ie,0,r),ie}return n},xe.stbtt_GetGlyphHMetrics=function(t,e){var i=t.data,n=t.hhea+34;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=new he;if(e<s){var o=t.data,l=t.hmtx+4*e;null==l&&(l=0);var u=o.readU8(l),h=o.readU8(l+1)|u<<8;a.advanceWidth=0!=(32768&h)?h-65536:h;var A=t.data,c=t.hmtx+4*e+2;null==c&&(c=0);var d=A.readU8(c),_=A.readU8(c+1)|d<<8;a.leftSideBearing=0!=(32768&_)?_-65536:_}else{var f=t.data,g=t.hmtx+4*(s-1);null==g&&(g=0);var p=f.readU8(g),v=f.readU8(g+1)|p<<8;a.advanceWidth=0!=(32768&v)?v-65536:v;var m=t.data,w=t.hmtx+4*s+2*(e-s);null==w&&(w=0);var b=m.readU8(w),S=m.readU8(w+1)|b<<8;a.leftSideBearing=0!=(32768&S)?S-65536:S}return a},xe.stbtt_GetGlyphKernAdvance=function(t,e,i){var n,r,s=t.kern,a=t.data;if(0==t.kern)return 0;var o=s+2;null==o&&(o=0);var l=a.readU8(o);if((a.readU8(o+1)|l<<8)<1)return 0;var u=s+8;null==u&&(u=0);var h=a.readU8(u);if(1!=(a.readU8(u+1)|h<<8))return 0;var A=0,c=s+10;null==c&&(c=0);for(var d=a.readU8(c),_=(a.readU8(c+1)|d<<8)-1,f=e<<16|i;A<=_;){var g=s+18+6*(r=A+_>>1);null==g&&(g=0);var p=g;null==p&&(p=0);var v=a.readU8(p),m=a.readU8(p+1),w=a.readU8(p+2);if(f<(n=a.readU8(p+3)|w<<8|m<<16|v<<24))_=r-1;else{if(!(n<f)){var b=s+22+6*r;null==b&&(b=0);var S=a.readU8(b),y=a.readU8(b+1)|S<<8;return 0!=(32768&y)?y-65536:y}A=1+r}}return 0},xe.stbtt_GetCodepointKernAdvance=function(t,e,i){return 0==t.kern?0:xe.stbtt_GetGlyphKernAdvance(t,xe.stbtt_FindGlyphIndex(t,e),xe.stbtt_FindGlyphIndex(t,i))},xe.stbtt_GetCodepointHMetrics=function(t,e){return xe.stbtt_GetGlyphHMetrics(t,xe.stbtt_FindGlyphIndex(t,e))},xe.stbtt_GetFontVMetrics=function(t){var e=new Ae,i=t.data,n=t.hhea+4;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.ascent=0!=(32768&s)?s-65536:s;var a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.descent=0!=(32768&u)?u-65536:u;var h=t.data,A=t.hhea+8;null==A&&(A=0);var c=h.readU8(A),d=h.readU8(A+1)|c<<8;return e.lineGap=0!=(32768&d)?d-65536:d,e},xe.stbtt_GetFontBoundingBox=function(t){var e=new ue,i=t.data,n=t.head+36;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.x0=0!=(32768&s)?s-65536:s;var a=t.data,o=t.head+38;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;e.y0=0!=(32768&u)?u-65536:u;var h=t.data,A=t.head+40;null==A&&(A=0);var c=h.readU8(A),d=h.readU8(A+1)|c<<8;e.x1=0!=(32768&d)?d-65536:d;var _=t.data,f=t.head+42;null==f&&(f=0);var g=_.readU8(f),p=_.readU8(f+1)|g<<8;return e.y1=0!=(32768&p)?p-65536:p,e},xe.stbtt_ScaleForPixelHeight=function(t,e){var i=t.data,n=t.hhea+4;null==n&&(n=0);var r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=t.data,o=t.hhea+6;null==o&&(o=0);var l=a.readU8(o),u=a.readU8(o+1)|l<<8;return e/((0!=(32768&s)?s-65536:s)-(0!=(32768&u)?u-65536:u))},xe.stbtt_ScaleForMappingEmToPixels=function(t,e){var i=t.data,n=t.head+18;null==n&&(n=0);var r=i.readU8(n);return e/(i.readU8(n+1)|r<<8)},xe.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,n,r,s){var a=new ue;if(xe.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,u=a.y0,h=a.y1;a.x0=Math.floor(o*i+r),a.y0=Math.floor(-h*n+s),a.x1=Math.ceil(l*i+r),a.y1=Math.ceil(-u*n+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},xe.stbtt_GetGlyphBitmapBox=function(t,e,i,n){return xe.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,n,0,0)},xe.stbtt_GetCodepointBitmapBoxSubpixel=function(t,e,i,n,r,s){return xe.stbtt_GetGlyphBitmapBoxSubpixel(t,xe.stbtt_FindGlyphIndex(t,e),i,n,r,s)},xe.stbtt_GetCodepointBitmapBox=function(t,e,i,n){return xe.stbtt_GetCodepointBitmapBoxSubpixel(t,e,i,n,0,0)},xe.stbtt__new_active=function(t,e,i,n){var r=new Se,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==r||(r.fdx=s,r.fdy=0!=s?1/s:0,r.fx=t[e].x0+s*(n-t[e].y0),r.fx-=i,r.direction=t[e].invert?1:-1,r.sy=t[e].y0,r.ey=t[e].y1,r.next=null),r},xe.stbtt__handle_clipped_edge=function(t,e,i,n,r,s,a,o){if(s!=o){if(!(s<o))throw new ne("Error");if(!(n.sy<=n.ey))throw new ne("Error");if(!(s>n.ey||o<n.sy)){if(s<n.sy&&(r+=(a-r)*(n.sy-s)/(o-s),s=n.sy),o>n.ey&&(a+=(a-r)*(n.ey-o)/(o-s),o=n.ey),r==i){if(!(a<=i+1))throw new ne("Error")}else if(r==i+1){if(!(i<=a))throw new ne("Error")}else if(r<=i){if(!(a<=i))throw new ne("Error")}else if(i+1<=r){if(!(i+1<=a))throw new ne("Error")}else if(!(i<=a&&a<=i+1))throw new ne("Error");if(r<=i&&a<=i){var l=e+i,u=t;u[l]=u[l]+n.direction*(o-s)}else if(!(i+1<=r&&i+1<=a)){if(!(i<=r&&r<=i+1&&i<=a&&a<=i+1))throw new ne("Error");var h=e+i,A=t;A[h]=A[h]+n.direction*(o-s)*(1-(r-i+(a-i))/2)}}}},xe.stbtt__fill_active_edges_new=function(t,e,i,n,r,s){for(var a=s+1;null!=r;){if(!(r.ey>=s))throw new ne("Error");if(0==r.fdx){var o=r.fx;o<n&&(0<=o?(xe.stbtt__handle_clipped_edge(t,0,0|o,r,o,s,o,a),xe.stbtt__handle_clipped_edge(e,i-1,o+1|0,r,o,s,o,a)):xe.stbtt__handle_clipped_edge(e,i-1,0,r,o,s,o,a))}else{var l,u,h,A,c=r.fx,d=r.fdx,_=c+d,f=r.fdy;if(!(r.sy<=a&&r.ey>=s))throw new ne("Error");if(h=r.sy>s?(l=c+d*(r.sy-s),r.sy):(l=c,s),A=r.ey<a?(u=c+d*(r.ey-s),r.ey):(u=_,a),0<=l&&0<=u&&l<n&&u<n)if((0|l)==(0|u)){var g=0|l,p=A-h;if(!(0<=g&&g<n))throw new ne("Error");var v=g,m=t;m[v]=m[v]+r.direction*(1-(l-g+(u-g))/2)*p;var w=i+g,b=e;b[w]=b[w]+r.direction*p}else{if(u<l){var S=h=a-(h-s);h=A=a-(A-s),A=S,S=u,u=l,l=S,d=-d,f=-f,S=c,c=_,_=S}var y=0|l,x=0|u,E=(1+y-c)*f+s,T=r.direction,B=T*(E-h),k=y,C=t;C[k]=C[k]+B*(1-(l-y+(1+y-y))/2);for(var I=T*f,L=1+y,N=x;L<N;){var P=L++,R=t;R[P]=R[P]+(B+I/2),B+=I}if(E+=f*(x-(1+y)),!(Math.abs(B)<=1.01))throw new ne("Error");var M=x,V=t;V[M]=V[M]+(B+T*(1-(x-x+(u-x))/2)*(A-E));var D=i+x,O=e;O[D]=O[D]+T*(A-h)}else for(var F=0,U=n;F<U;){var H=F++,W=s,G=H,z=1+H,Y=_,X=a,K=(H-c)/d+s,Q=(1+H-c)/d+s;c<G&&z<Y?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,G,K),xe.stbtt__handle_clipped_edge(t,0,H,r,G,K,z,Q),xe.stbtt__handle_clipped_edge(t,0,H,r,z,Q,Y,X)):Y<G&&z<c?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,z,Q),xe.stbtt__handle_clipped_edge(t,0,H,r,z,Q,G,K),xe.stbtt__handle_clipped_edge(t,0,H,r,G,K,Y,X)):c<G&&G<Y?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,G,K),xe.stbtt__handle_clipped_edge(t,0,H,r,G,K,Y,X)):Y<G&&G<c?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,G,K),xe.stbtt__handle_clipped_edge(t,0,H,r,G,K,Y,X)):c<z&&z<Y?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,z,Q),xe.stbtt__handle_clipped_edge(t,0,H,r,z,Q,Y,X)):Y<z&&z<c?(xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,z,Q),xe.stbtt__handle_clipped_edge(t,0,H,r,z,Q,Y,X)):xe.stbtt__handle_clipped_edge(t,0,H,r,c,W,Y,X)}}r=r.next}},xe.stbtt__rasterize_sorted_edges=function(t,e,i,n,r,s){var a,o,l=null,u=0,h=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var A=a;o=t.w;var c=s;for(e[h+i].y0=s+t.h+1;u<t.h;){for(var d=c+0,_=c+1,f=l,g=null,p=0,v=t.w;p<v;){a[p++]=0}for(var m=0,w=t.w+1;m<w;){A[o+m++]=0}for(;null!=f;){var b=f;if(b.ey<=d){if(f=(null==g?l=b.next:g.next=b.next,b.next),0==b.direction)throw new ne("Error");b.direction=0}else f=(g=f).next}for(;e[h].y0<=_;){if(e[h].y0!=e[h].y1){var S=xe.stbtt__new_active(e,h,r,d);if(!(S.ey>=d))throw new ne("Error");S.next=l,l=S}++h}null!=l&&xe.stbtt__fill_active_edges_new(a,A,o+1,t.w,l,d);for(var y=0,x=0,E=t.w;x<E;){var T=x++;y+=A[o+T];var B=a[T]+y,k=0|(B=255*Math.abs(B)+.5);255<k&&(k=255),t.pixels.writeU8(t.pixels_offset+u*t.stride+T,k)}for(g=null,f=l;null!=f;){var C=f;C.fx+=C.fdx,f=(g=f).next}++c,++u}},xe.STBTT__COMPARE=function(t,e){return t.y0<e.y0},xe.stbtt__sort_edges_ins_sort=function(t,e){for(var i,n=1,r=e;n<r;){var s=n++,a=t[s],o=a;for(i=s;0<i;){var l=t[i-1];if(!xe.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}s!=i&&(t[i]=a)}},xe.stbtt__sort_edges_quicksort=function(t,e,i){for(;12<i;){var n,r=i>>1,s=xe.STBTT__COMPARE(t[e],t[e+r]),a=xe.STBTT__COMPARE(t[e+r],t[e+i-1]);if(s!=a){var o=xe.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;n=t[e+o],t[e+o]=t[e+r],t[e+r]=n}n=t[e],t[e]=t[e+r],t[e+r]=n;for(var l=1,u=i-1;;){for(;xe.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;xe.STBTT__COMPARE(t[e],t[e+u]);)--u;if(u<=l)break;n=t[e+l],t[e+l]=t[e+u],t[e+u]=n,++l,--u}u<i-l?(xe.stbtt__sort_edges_quicksort(t,e,u),e+=l,i-=l):(xe.stbtt__sort_edges_quicksort(t,e+l,i-l),i=u)}},xe.stbtt__sort_edges=function(t,e){xe.stbtt__sort_edges_quicksort(t,0,e),xe.stbtt__sort_edges_ins_sort(t,e)},xe.stbtt__rasterize=function(t,e,i,n,r,s,a,o,l,u,h){for(var A,c=h?-s:s,d=0,_=0,f=n;_<f;){d+=i[_++]}var g=new Array(d+1);if(null!=g){for(var p=0,v=g.length;p<v;){g[p++]=new be}for(var m=d=0,w=0,b=n;w<b;){var S=w++,y=e,x=0+m;m+=i[S],A=i[S]-1;for(var E=0,T=i[S];E<T;){var B=E++,k=B,C=A;y[x+A].y!=y[x+B].y?(g[d].invert=!1,(h?y[x+A].y>y[x+B].y:y[x+A].y<y[x+B].y)&&(g[d].invert=!0,k=A,C=B),g[d].x0=y[x+k].x*r+a,g[d].y0=1*(y[x+k].y*c+o),g[d].x1=y[x+C].x*r+a,g[d].y1=1*(y[x+C].y*c+o),++d,A=B):A=B}}xe.stbtt__sort_edges(g,d),xe.stbtt__rasterize_sorted_edges(t,g,d,1,l,u)}},xe.stbtt__add_point=function(t,e,i,n){null!=t&&(t[e].x=i,t[e].y=n)},xe.stbtt__tesselate_curve=function(t,e,i,n,r,s,a,o,l,u){var h=(i+2*r+a)/4,A=(n+2*s+o)/4,c=(i+a)/2-h,d=(n+o)/2-A;return 16<u||(l<c*c+d*d?(xe.stbtt__tesselate_curve(t,e,i,n,(i+r)/2,(n+s)/2,h,A,l,u+1),xe.stbtt__tesselate_curve(t,e,h,A,(r+a)/2,(s+o)/2,a,o,l,u+1)):(xe.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},xe.stbtt_FlattenCurves=function(t,e,i,n,r){for(var s=null,a=0,o=i*i,l=0,u=0,h=0,A=e;h<A;){1==t[h++].type&&++l}if(0==(r.value=l))return null;var c=new Array(l);if(n.value=c,null==n.value)return r.value=0,null;for(var d=0;d<2;){var _=0,f=0;if(1==d++){if(null==(s=new Array(a)))return n.value=null,r.value=0,null;for(var g=0,p=s.length;g<p;){s[g++]=new ye}}l=-1;for(var v=a=0,m=e;v<m;){var w=v++;switch(t[w].type){case 1:0<=l&&(n.value[l]=a-u),++l,u=a,_=t[w].x,f=t[w].y,xe.stbtt__add_point(s,a++,_,f);break;case 2:_=t[w].x,f=t[w].y,xe.stbtt__add_point(s,a++,_,f);break;case 3:var b={value:a};xe.stbtt__tesselate_curve(s,b,_,f,t[w].cx,t[w].cy,t[w].x,t[w].y,o,0),a=b.value,_=t[w].x,f=t[w].y}}n.value[l]=a-u}return s},xe.stbtt_Rasterize=function(t,e,i,n,r,s,a,o,l,u,h){var A,c=s<r?s:r,d=0,_={value:d},f=new se,g=xe.stbtt_FlattenCurves(i,n,e/c,f,_);d=_.value,A=f.value,null!=g&&xe.stbtt__rasterize(t,g,A,d,r,s,a,o,l,u,h)},xe.stbtt_GetGlyphBitmapSubpixel=function(t,e,i,n,r,s,a){var o=new we,l=xe.stbtt_GetGlyphShape(t,s),u=l.length;if(0==e&&(e=i),0==i){if(0==e)return null;i=e}var h=xe.stbtt_GetGlyphBitmapBoxSubpixel(t,s,e,i,n,r),A=h.x0,c=h.y0,d=h.x1,_=h.y1;return o.w=d-A,o.h=_-c,o.pixels=null,a.width=o.w,a.height=o.h,a.xoff=A,a.yoff=c,0!=o.w&&0!=o.h&&(o.pixels=ti.alloc(o.w*o.h),null!=o.pixels&&(o.stride=o.w,xe.stbtt_Rasterize(o,.35,l,u,e,i,n,r,A,c,!0))),o.pixels},xe.stbtt_GetGlyphBitmap=function(t,e,i,n,r){return xe.stbtt_GetGlyphBitmapSubpixel(t,e,i,0,0,n,r)},xe.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,u,h){var A,c,d=xe.stbtt_GetGlyphShape(t,h),_=null==d?0:d.length,f=new we,g=xe.stbtt_GetGlyphBitmapBoxSubpixel(t,h,a,o,l,u);A=g.x0,c=g.y0,f.pixels=e,f.pixels_offset=i,f.w=n,f.h=r,f.stride=s,0!=f.w&&0!=f.h&&xe.stbtt_Rasterize(f,.35,d,_,a,o,l,u,A,c,!0)},xe.stbtt_MakeGlyphBitmap=function(t,e,i,n,r,s,a,o,l){xe.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},xe.stbtt_GetCodepointBitmapSubpixel=function(t,e,i,n,r,s,a){return xe.stbtt_GetGlyphBitmapSubpixel(t,e,i,n,r,xe.stbtt_FindGlyphIndex(t,s),a)},xe.stbtt_MakeCodepointBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,u,h){xe.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,l,u,xe.stbtt_FindGlyphIndex(t,h))},xe.stbtt_GetCodepointBitmap=function(t,e,i,n,r){return xe.stbtt_GetCodepointBitmapSubpixel(t,e,i,0,0,n,r)},xe.stbtt_MakeCodepointBitmap=function(t,e,i,n,r,s,a,o,l){xe.stbtt_MakeCodepointBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},xe.stbtt_BakeFontBitmap=function(t,e,i,n,r,s,a,o){var l=new ve;if(!xe.stbtt_InitFont(l,t,e))return-1;for(var u=1,h=u,A=1,c=xe.stbtt_ScaleForPixelHeight(l,i),d=0,_=0;_<a.length;){var f=a[_];++_;var g=xe.stbtt_FindGlyphIndex(l,f),p=xe.stbtt_GetGlyphHMetrics(l,g),v=p.advanceWidth,m=(p.leftSideBearing,xe.stbtt_GetGlyphBitmapBox(l,g,c,c)),w=m.x0,b=m.y0,S=m.x1-w,y=m.y1-b;if(r<=h+S+1&&(u=A,h=1),s<=u+y+1)return-d;if(r<=h+S)throw new ne("Error");if(s<=u+y)throw new ne("Error");o[d].x0=h,o[d].y0=u,o[d].x1=h+S,o[d].y1=u+y,o[d].xadvance=c*v,o[d].xoff=w,o[d].yoff=b,h=h+S+1,A<u+y+1&&(A=u+y+1),++d}for(var x,E=0,T=r*s;E<T;){var B=E++;n.writeU8(B,0)}for(var k=d=0;k<a.length;){var C=a[k];++k;var I=xe.stbtt_FindGlyphIndex(l,C);x=o[d],xe.stbtt_MakeGlyphBitmap(l,n,x.x0+x.y0*r,x.x1-x.x0,x.y1-x.y0,r,c,c,I),++d}return A},xe.stbtt_GetBakedQuad=function(t,e,i,n,r,s,a,o){var l=o?0:-.5,u=1/e,h=1/i,A=t[n],c=Math.floor(r.value+A.xoff+.5),d=Math.floor(s.value+A.yoff+.5);a.x0=c+l,a.y0=d+l,a.x1=c+A.x1-A.x0+l,a.y1=d+A.y1-A.y0+l,a.s0=A.x0*u,a.t0=A.y0*h,a.s1=A.x1*u,a.t1=A.y1*h,r.value+=A.xadvance};function Ee(){}(y["kha.graphics4.ConstantLocation"]=Ee).__name__=!0,Ee.__isInterface__=!0;function Te(t){this.texture_=t}(y["kha.graphics4.CubeMap"]=Te).__name__=!0,Te.__interfaces__=[k,w],Te.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 3:return 4;case 4:return 1;default:return 0}},Te.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},Te.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},Te.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;default:return 1}},Te.createRenderTarget=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var r=new Te(null);return r.format=e,r.renderTarget_=Krom.createRenderTargetCubeMap(t,Te.getDepthBufferBits(i),Te.getRenderTargetFormat(e),Te.getStencilBufferBits(i),n),r},Te.prototype={texture_:null,renderTarget_:null,format:null,graphics4:null,unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new ei(this)),this.graphics4},__class__:Te};var Be=function(t,e){null!=t&&(this.shader=Krom.createFragmentShader(t[0].bytes.b.bufferValue,e[0]))};(y["kha.graphics4.FragmentShader"]=Be).__name__=!0,Be.fromSource=function(t){var e=new Be(null,null);return e.shader=Krom.createFragmentShaderFromSource(t),e},Be.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Be};function ke(t,e){this.shader=Krom.createGeometryShader(t[0].bytes.b.bufferValue,e[0])}(y["kha.graphics4.GeometryShader"]=ke).__name__=!0,ke.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:ke};function Ce(){}(y["kha.graphics4.Graphics"]=Ce).__name__=!0,Ce.__isInterface__=!0,Ce.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setTextureCompareMode:null,setCubeMapCompareMode:null,setCubeMap:null,setCubeMapDepth:null,setStencilReferenceValue:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:Ce};function Ie(t){this.pipeline=t,this.projectionLocation=t.getConstantLocation("projectionMatrix"),this.textureLocation=t.getTextureUnit("tex")}(y["kha.graphics4.PipelineCache"]=Ie).__name__=!0,Ie.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:Ie};var Le=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Le.bufferIndex=0,Le.initShaders(),this.myPipeline=Le.standardImagePipeline,this.initBuffers()};(y["kha.graphics4.ImageShaderPainter"]=Le).__name__=!0,Le.initShaders=function(){if(null==Le.structure&&(Le.structure=Re.createImageVertexStructure()),null==Le.standardImagePipeline){var t=Re.createImagePipeline(Le.structure);t.compile(),Le.standardImagePipeline=new Ie(t)}},Le.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Le.standardImagePipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Le.rectVertexBuffer){Le.rectVertexBuffer=new We(6e3,Le.structure,1),Le.rectVertices=Le.rectVertexBuffer.lock(),Le.indexBuffer=new Me(9e3,0);for(var t=Le.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Le.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Le.bufferIndex*4;Le.rectVertices[l]=t,Le.rectVertices[1+l]=e,Le.rectVertices[2+l]=-5,Le.rectVertices[9+l]=i,Le.rectVertices[10+l]=n,Le.rectVertices[11+l]=-5,Le.rectVertices[18+l]=r,Le.rectVertices[19+l]=s,Le.rectVertices[20+l]=-5,Le.rectVertices[27+l]=a,Le.rectVertices[28+l]=o,Le.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Le.bufferIndex*4;Le.rectVertices[3+r]=t,Le.rectVertices[4+r]=n,Le.rectVertices[12+r]=t,Le.rectVertices[13+r]=e,Le.rectVertices[21+r]=i,Le.rectVertices[22+r]=e,Le.rectVertices[30+r]=i,Le.rectVertices[31+r]=n},setRectColor:function(t,e,i,n){var r=9*Le.bufferIndex*4;Le.rectVertices[5+r]=t,Le.rectVertices[6+r]=e,Le.rectVertices[7+r]=i,Le.rectVertices[8+r]=n,Le.rectVertices[14+r]=t,Le.rectVertices[15+r]=e,Le.rectVertices[16+r]=i,Le.rectVertices[17+r]=n,Le.rectVertices[23+r]=t,Le.rectVertices[24+r]=e,Le.rectVertices[25+r]=i,Le.rectVertices[26+r]=n,Le.rectVertices[32+r]=t,Le.rectVertices[33+r]=e,Le.rectVertices[34+r]=i,Le.rectVertices[35+r]=n},drawBuffer:function(){Le.rectVertexBuffer.unlock(4*Le.bufferIndex),this.g.setVertexBuffer(Le.rectVertexBuffer),this.g.setIndexBuffer(Le.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Le.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Le.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Le.bufferIndex=0,Le.rectVertices=Le.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setBilinearMipmapFilter:function(t){this.end(),this.bilinearMipmaps=t},drawImage:function(t,e,i,n,r,s,a,o,l,u,h){var A=t;(1500<=Le.bufferIndex+1||null!=Le.lastTexture&&A!=Le.lastTexture)&&this.drawBuffer();var c=.00392156862745098*((16711680&h)>>>16),d=.00392156862745098*((65280&h)>>>8),_=.00392156862745098*(255&h),f=.00392156862745098*(h>>>24)*u,g=9*Le.bufferIndex*4;Le.rectVertices[5+g]=c,Le.rectVertices[6+g]=d,Le.rectVertices[7+g]=_,Le.rectVertices[8+g]=f,Le.rectVertices[14+g]=c,Le.rectVertices[15+g]=d,Le.rectVertices[16+g]=_,Le.rectVertices[17+g]=f,Le.rectVertices[23+g]=c,Le.rectVertices[24+g]=d,Le.rectVertices[25+g]=_,Le.rectVertices[26+g]=f,Le.rectVertices[32+g]=c,Le.rectVertices[33+g]=d,Le.rectVertices[34+g]=_,Le.rectVertices[35+g]=f;var p=A.get_width()/A.get_realWidth(),v=A.get_height()/A.get_realHeight(),m=9*Le.bufferIndex*4;Le.rectVertices[3+m]=0,Le.rectVertices[4+m]=v,Le.rectVertices[12+m]=0,Le.rectVertices[13+m]=0,Le.rectVertices[21+m]=p,Le.rectVertices[22+m]=0,Le.rectVertices[30+m]=p,Le.rectVertices[31+m]=v;var w=9*Le.bufferIndex*4;Le.rectVertices[w]=e,Le.rectVertices[1+w]=i,Le.rectVertices[2+w]=-5,Le.rectVertices[9+w]=n,Le.rectVertices[10+w]=r,Le.rectVertices[11+w]=-5,Le.rectVertices[18+w]=s,Le.rectVertices[19+w]=a,Le.rectVertices[20+w]=-5,Le.rectVertices[27+w]=o,Le.rectVertices[28+w]=l,Le.rectVertices[29+w]=-5,++Le.bufferIndex,Le.lastTexture=A},drawImage2:function(t,e,i,n,r,s,a,o,l,u,h,A,c,d,_){var f=t;(1500<=Le.bufferIndex+1||null!=Le.lastTexture&&f!=Le.lastTexture)&&this.drawBuffer();var g=e/f.get_realWidth(),p=i/f.get_realHeight(),v=(e+n)/f.get_realWidth(),m=(i+r)/f.get_realHeight(),w=9*Le.bufferIndex*4;Le.rectVertices[3+w]=g,Le.rectVertices[4+w]=m,Le.rectVertices[12+w]=g,Le.rectVertices[13+w]=p,Le.rectVertices[21+w]=v,Le.rectVertices[22+w]=p,Le.rectVertices[30+w]=v,Le.rectVertices[31+w]=m;var b=.00392156862745098*((16711680&_)>>>16),S=.00392156862745098*((65280&_)>>>8),y=.00392156862745098*(255&_),x=.00392156862745098*(_>>>24)*d,E=9*Le.bufferIndex*4;Le.rectVertices[5+E]=b,Le.rectVertices[6+E]=S,Le.rectVertices[7+E]=y,Le.rectVertices[8+E]=x,Le.rectVertices[14+E]=b,Le.rectVertices[15+E]=S,Le.rectVertices[16+E]=y,Le.rectVertices[17+E]=x,Le.rectVertices[23+E]=b,Le.rectVertices[24+E]=S,Le.rectVertices[25+E]=y,Le.rectVertices[26+E]=x,Le.rectVertices[32+E]=b,Le.rectVertices[33+E]=S,Le.rectVertices[34+E]=y,Le.rectVertices[35+E]=x;var T=9*Le.bufferIndex*4;Le.rectVertices[T]=s,Le.rectVertices[1+T]=a,Le.rectVertices[2+T]=-5,Le.rectVertices[9+T]=o,Le.rectVertices[10+T]=l,Le.rectVertices[11+T]=-5,Le.rectVertices[18+T]=u,Le.rectVertices[19+T]=h,Le.rectVertices[20+T]=-5,Le.rectVertices[27+T]=A,Le.rectVertices[28+T]=c,Le.rectVertices[29+T]=-5,++Le.bufferIndex,Le.lastTexture=f},drawImageScale:function(t,e,i,n,r,s,a,o,l,u,h){var A=t;(1500<=Le.bufferIndex+1||null!=Le.lastTexture&&A!=Le.lastTexture)&&this.drawBuffer();var c=e/A.get_realWidth(),d=i/A.get_realHeight(),_=(e+n)/A.get_realWidth(),f=(i+r)/A.get_realHeight(),g=9*Le.bufferIndex*4;Le.rectVertices[3+g]=c,Le.rectVertices[4+g]=f,Le.rectVertices[12+g]=c,Le.rectVertices[13+g]=d,Le.rectVertices[21+g]=_,Le.rectVertices[22+g]=d,Le.rectVertices[30+g]=_,Le.rectVertices[31+g]=f;var p=.00392156862745098*((16711680&h)>>>16),v=.00392156862745098*((65280&h)>>>8),m=.00392156862745098*(255&h),w=9*Le.bufferIndex*4;Le.rectVertices[5+w]=p,Le.rectVertices[6+w]=v,Le.rectVertices[7+w]=m,Le.rectVertices[8+w]=u,Le.rectVertices[14+w]=p,Le.rectVertices[15+w]=v,Le.rectVertices[16+w]=m,Le.rectVertices[17+w]=u,Le.rectVertices[23+w]=p,Le.rectVertices[24+w]=v,Le.rectVertices[25+w]=m,Le.rectVertices[26+w]=u,Le.rectVertices[32+w]=p,Le.rectVertices[33+w]=v,Le.rectVertices[34+w]=m,Le.rectVertices[35+w]=u;var b=9*Le.bufferIndex*4;Le.rectVertices[b]=s,Le.rectVertices[1+b]=l,Le.rectVertices[2+b]=-5,Le.rectVertices[9+b]=s,Le.rectVertices[10+b]=a,Le.rectVertices[11+b]=-5,Le.rectVertices[18+b]=o,Le.rectVertices[19+b]=a,Le.rectVertices[20+b]=-5,Le.rectVertices[27+b]=o,Le.rectVertices[28+b]=l,Le.rectVertices[29+b]=-5,++Le.bufferIndex,Le.lastTexture=A},end:function(){0<Le.bufferIndex&&this.drawBuffer(),Le.lastTexture=null},__class__:Le};var Ne=function(t){this.myPipeline=null,this.g=t,Ne.bufferIndex=0,Ne.triangleBufferIndex=0,Ne.initShaders(),this.myPipeline=Ne.standardColorPipeline,this.initBuffers()};(y["kha.graphics4.ColoredShaderPainter"]=Ne).__name__=!0,Ne.initShaders=function(){if(null==Ne.structure&&(Ne.structure=Re.createColoredVertexStructure()),null==Ne.standardColorPipeline){var t=Re.createColoredPipeline(Ne.structure);t.compile(),Ne.standardColorPipeline=new Ie(t)}},Ne.prototype={projectionMatrix:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Ne.standardColorPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ne.rectVertexBuffer){Ne.rectVertexBuffer=new We(4e3,Ne.structure,1),Ne.rectVertices=Ne.rectVertexBuffer.lock(),Ne.indexBuffer=new Me(6e3,0);for(var t=Ne.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ne.indexBuffer.unlock(),Ne.triangleVertexBuffer=new We(3e3,Ne.structure,1),Ne.triangleVertices=Ne.triangleVertexBuffer.lock(),Ne.triangleIndexBuffer=new Me(3e3,0);for(var n=Ne.triangleIndexBuffer.lock(),r=0;r<1e3;){var s=r++;n[3*s]=3*s,n[3*s+1]=3*s+1,n[3*s+2]=3*s+2}Ne.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=7*Ne.bufferIndex*4;Ne.rectVertices[l]=t,Ne.rectVertices[1+l]=e,Ne.rectVertices[2+l]=-5,Ne.rectVertices[7+l]=i,Ne.rectVertices[8+l]=n,Ne.rectVertices[9+l]=-5,Ne.rectVertices[14+l]=r,Ne.rectVertices[15+l]=s,Ne.rectVertices[16+l]=-5,Ne.rectVertices[21+l]=a,Ne.rectVertices[22+l]=o,Ne.rectVertices[23+l]=-5},setRectColors:function(t,e){var i=7*Ne.bufferIndex*4,n=t*(.00392156862745098*(e>>>24)),r=.00392156862745098*((16711680&e)>>>16)*n,s=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Ne.rectVertices[3+i]=r,Ne.rectVertices[4+i]=s,Ne.rectVertices[5+i]=a,Ne.rectVertices[6+i]=n,Ne.rectVertices[10+i]=r,Ne.rectVertices[11+i]=s,Ne.rectVertices[12+i]=a,Ne.rectVertices[13+i]=n,Ne.rectVertices[17+i]=r,Ne.rectVertices[18+i]=s,Ne.rectVertices[19+i]=a,Ne.rectVertices[20+i]=n,Ne.rectVertices[24+i]=r,Ne.rectVertices[25+i]=s,Ne.rectVertices[26+i]=a,Ne.rectVertices[27+i]=n},setTriVertices:function(t,e,i,n,r,s){var a=7*Ne.triangleBufferIndex*3;Ne.triangleVertices[a]=t,Ne.triangleVertices[1+a]=e,Ne.triangleVertices[2+a]=-5,Ne.triangleVertices[7+a]=i,Ne.triangleVertices[8+a]=n,Ne.triangleVertices[9+a]=-5,Ne.triangleVertices[14+a]=r,Ne.triangleVertices[15+a]=s,Ne.triangleVertices[16+a]=-5},setTriColors:function(t,e){var i=7*Ne.triangleBufferIndex*3,n=t*(.00392156862745098*(e>>>24)),r=.00392156862745098*((16711680&e)>>>16)*n,s=.00392156862745098*((65280&e)>>>8)*n,a=.00392156862745098*(255&e)*n;Ne.triangleVertices[3+i]=r,Ne.triangleVertices[4+i]=s,Ne.triangleVertices[5+i]=a,Ne.triangleVertices[6+i]=n,Ne.triangleVertices[10+i]=r,Ne.triangleVertices[11+i]=s,Ne.triangleVertices[12+i]=a,Ne.triangleVertices[13+i]=n,Ne.triangleVertices[17+i]=r,Ne.triangleVertices[18+i]=s,Ne.triangleVertices[19+i]=a,Ne.triangleVertices[20+i]=n},drawBuffer:function(t){t||0<Ne.triangleBufferIndex&&this.drawTriBuffer(!0),Ne.rectVertexBuffer.unlock(4*Ne.bufferIndex),this.g.setVertexBuffer(Ne.rectVertexBuffer),this.g.setIndexBuffer(Ne.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ne.bufferIndex*3),Ne.bufferIndex=0,Ne.rectVertices=Ne.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||0<Ne.bufferIndex&&this.drawBuffer(!0),Ne.triangleVertexBuffer.unlock(3*Ne.triangleBufferIndex),this.g.setVertexBuffer(Ne.triangleVertexBuffer),this.g.setIndexBuffer(Ne.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ne.triangleBufferIndex),Ne.triangleBufferIndex=0,Ne.triangleVertices=Ne.triangleVertexBuffer.lock()},fillRect:function(t,e,i,n,r,s,a,o,l,u){0<Ne.triangleBufferIndex&&this.drawTriBuffer(!0),1e3<=Ne.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,n,r,s,a,o,l,u),++Ne.bufferIndex},fillTriangle:function(t,e,i,n,r,s,a,o){0<Ne.bufferIndex&&this.drawBuffer(!0),1e3<=Ne.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,n,r,s,a,o),++Ne.triangleBufferIndex},endTris:function(t){0<Ne.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<Ne.bufferIndex&&this.drawBuffer(t)},end:function(){0<Ne.triangleBufferIndex&&this.drawTriBuffer(!1),0<Ne.bufferIndex&&this.drawBuffer(!1)},__class__:Ne};var Pe=function(t){this.bakedQuadCache=new I,this.bilinear=!1,this.myPipeline=null,this.g=t,Pe.bufferIndex=0,Pe.initShaders(),this.myPipeline=Pe.standardTextPipeline,this.initBuffers()};(y["kha.graphics4.TextShaderPainter"]=Pe).__name__=!0,Pe.initShaders=function(){if(null==Pe.structure&&(Pe.structure=Re.createTextVertexStructure()),null==Pe.standardTextPipeline){var t=Re.createTextPipeline(Pe.structure);t.compile(),Pe.standardTextPipeline=new Ie(t)}},Pe.findIndex=function(t){ee.fontGlyphs;for(var e=N.charBlocks,i=0,n=0,r=e.length/2|0;n<r;){var s=n++,a=e[2*s],o=e[2*s+1];if(a<=t&&t<=o)return i+t-a;i+=o-a+1}return 0},Pe.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Pe.standardTextPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Pe.rectVertexBuffer){Pe.rectVertexBuffer=new We(4e3,Pe.structure,1),Pe.rectVertices=Pe.rectVertexBuffer.lock(),Pe.indexBuffer=new Me(6e3,0);for(var t=Pe.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Pe.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Pe.bufferIndex*4;Pe.rectVertices[l]=t,Pe.rectVertices[1+l]=e,Pe.rectVertices[2+l]=-5,Pe.rectVertices[9+l]=i,Pe.rectVertices[10+l]=n,Pe.rectVertices[11+l]=-5,Pe.rectVertices[18+l]=r,Pe.rectVertices[19+l]=s,Pe.rectVertices[20+l]=-5,Pe.rectVertices[27+l]=a,Pe.rectVertices[28+l]=o,Pe.rectVertices[29+l]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Pe.bufferIndex*4;Pe.rectVertices[3+r]=t,Pe.rectVertices[4+r]=n,Pe.rectVertices[12+r]=t,Pe.rectVertices[13+r]=e,Pe.rectVertices[21+r]=i,Pe.rectVertices[22+r]=e,Pe.rectVertices[30+r]=i,Pe.rectVertices[31+r]=n},setRectColors:function(t,e){var i=9*Pe.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Pe.rectVertices[5+i]=.00392156862745098*((16711680&e)>>>16),Pe.rectVertices[6+i]=.00392156862745098*((65280&e)>>>8),Pe.rectVertices[7+i]=.00392156862745098*(255&e),Pe.rectVertices[8+i]=n,Pe.rectVertices[14+i]=.00392156862745098*((16711680&e)>>>16),Pe.rectVertices[15+i]=.00392156862745098*((65280&e)>>>8),Pe.rectVertices[16+i]=.00392156862745098*(255&e),Pe.rectVertices[17+i]=n,Pe.rectVertices[23+i]=.00392156862745098*((16711680&e)>>>16),Pe.rectVertices[24+i]=.00392156862745098*((65280&e)>>>8),Pe.rectVertices[25+i]=.00392156862745098*(255&e),Pe.rectVertices[26+i]=n,Pe.rectVertices[32+i]=.00392156862745098*((16711680&e)>>>16),Pe.rectVertices[33+i]=.00392156862745098*((65280&e)>>>8),Pe.rectVertices[34+i]=.00392156862745098*(255&e),Pe.rectVertices[35+i]=n},drawBuffer:function(){Pe.rectVertexBuffer.unlock(4*Pe.bufferIndex),this.g.setVertexBuffer(Pe.rectVertexBuffer),this.g.setIndexBuffer(Pe.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Pe.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Pe.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Pe.bufferIndex=0,Pe.rectVertices=Pe.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=p.__cast(t,P)},bakedQuadCache:null,drawString:function(t,e,i,n,r,s){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Pe.lastTexture&&o!=Pe.lastTexture&&this.drawBuffer(),Pe.lastTexture=o;for(var l=n,u=r,h=0,A=t.length;h<A;){var c=h++,d=t.charCodeAt(c),_=a.getBakedQuad(this.bakedQuadCache,Pe.findIndex(d),l,u);if(null!=_){1e3<=Pe.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(_.s0*o.get_width()/o.get_realWidth(),_.t0*o.get_height()/o.get_realHeight(),_.s1*o.get_width()/o.get_realWidth(),_.t1*o.get_height()/o.get_realHeight());var f=_.x0,g=_.y1;null==g&&(g=0),null==f&&(f=0);var p=f,v=g,m=s._02*p+s._12*v+s._22,w=(s._00*p+s._10*v+s._20)/m,b=(s._01*p+s._11*v+s._21)/m;null==b&&(b=0),null==w&&(w=0);var S=w,y=b,x=_.x0,E=_.y0;null==E&&(E=0),null==x&&(x=0);var T=x,B=E,k=s._02*T+s._12*B+s._22,C=(s._00*T+s._10*B+s._20)/k,I=(s._01*T+s._11*B+s._21)/k;null==I&&(I=0),null==C&&(C=0);var L=C,N=I,P=_.x1,R=_.y0;null==R&&(R=0),null==P&&(P=0);var M=P,V=R,D=s._02*M+s._12*V+s._22,O=(s._00*M+s._10*V+s._20)/D,F=(s._01*M+s._11*V+s._21)/D;null==F&&(F=0),null==O&&(O=0);var U=O,H=F,W=_.x1,G=_.y1;null==G&&(G=0),null==W&&(W=0);var z=W,Y=G,X=s._02*z+s._12*Y+s._22,K=(s._00*z+s._10*Y+s._20)/X,Q=(s._01*z+s._11*Y+s._21)/X;null==Q&&(Q=0),null==K&&(K=0);var q=K,j=Q;this.setRectVertices(S,y,L,N,U,H,q,j),l+=_.xadvance,++Pe.bufferIndex}}},drawCharacters:function(t,e,i,n,r,s,a,o){var l=this.font._get(this.fontSize),u=l.getTexture();null!=Pe.lastTexture&&u!=Pe.lastTexture&&this.drawBuffer(),Pe.lastTexture=u;for(var h=s,A=a,c=e,d=e+i;c<d;){var _=c++,f=l.getBakedQuad(this.bakedQuadCache,Pe.findIndex(t[_]),h,A);if(null!=f){1e3<=Pe.bufferIndex+1&&this.drawBuffer(),this.setRectColors(n,r),this.setRectTexCoords(f.s0*u.get_width()/u.get_realWidth(),f.t0*u.get_height()/u.get_realHeight(),f.s1*u.get_width()/u.get_realWidth(),f.t1*u.get_height()/u.get_realHeight());var g=f.x0,p=f.y1;null==p&&(p=0),null==g&&(g=0);var v=g,m=p,w=o._02*v+o._12*m+o._22,b=(o._00*v+o._10*m+o._20)/w,S=(o._01*v+o._11*m+o._21)/w;null==S&&(S=0),null==b&&(b=0);var y=b,x=S,E=f.x0,T=f.y0;null==T&&(T=0),null==E&&(E=0);var B=E,k=T,C=o._02*B+o._12*k+o._22,I=(o._00*B+o._10*k+o._20)/C,L=(o._01*B+o._11*k+o._21)/C;null==L&&(L=0),null==I&&(I=0);var N=I,P=L,R=f.x1,M=f.y0;null==M&&(M=0),null==R&&(R=0);var V=R,D=M,O=o._02*V+o._12*D+o._22,F=(o._00*V+o._10*D+o._20)/O,U=(o._01*V+o._11*D+o._21)/O;null==U&&(U=0),null==F&&(F=0);var H=F,W=U,G=f.x1,z=f.y1;null==z&&(z=0),null==G&&(G=0);var Y=G,X=z,K=o._02*Y+o._12*X+o._22,Q=(o._00*Y+o._10*X+o._20)/K,q=(o._01*Y+o._11*X+o._21)/K;null==q&&(q=0),null==Q&&(Q=0);var j=Q,Z=q;this.setRectVertices(y,x,N,P,H,W,j,Z),h+=f.xadvance,++Pe.bufferIndex}}},end:function(){0<Pe.bufferIndex&&this.drawBuffer(),Pe.lastTexture=null},__class__:Pe};var Re=function(t){this.scissorH=-1,this.scissorW=-1,this.scissorY=-1,this.scissorX=-1,this.scissorEnabled=!1,this.lastPipeline=null,this.pipelineCache=new et,this.myMipmapScaleQuality=oe.Low,this.myImageScaleQuality=oe.Low,ee.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Le(this.g),this.coloredPainter=new Ne(this.g),this.textPainter=new Pe(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new ri(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Re.videoPipeline&&(Re.videoPipeline=Re.createImagePipeline(Re.createImageVertexStructure()),Re.videoPipeline.fragmentShader=O.painter_video_frag,Re.videoPipeline.vertexShader=O.painter_video_vert,Re.videoPipeline.compile())};(y["kha.graphics4.Graphics2"]=Re).__name__=!0,Re.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},Re.createImageVertexStructure=function(){var t=new Ye;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Re.createImagePipeline=function(t){var e=new De;return e.fragmentShader=O.painter_image_frag,e.vertexShader=O.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Re.createColoredVertexStructure=function(){var t=new Ye;return t.add("vertexPosition",2),t.add("vertexColor",3),t},Re.createColoredPipeline=function(t){var e=new De;return e.fragmentShader=O.painter_colored_frag,e.vertexShader=O.painter_colored_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Re.createTextVertexStructure=function(){var t=new Ye;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Re.createTextPipeline=function(t){var e=new De;return e.fragmentShader=O.painter_text_frag,e.vertexShader=O.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},Re.__super__=ee,Re.prototype=r(ee.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof E){var i=this.projectionMatrix,n=2/t,r=-t/t,s=2/(0-e),a=-e/(0-e);i._00=n,i._10=0,i._20=0,i._30=r,i._01=0,i._11=s,i._21=0,i._31=a,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if(C.get_nonPow2Supported()||(t=Re.upperPowerOfTwo(t),e=Re.upperPowerOfTwo(e)),C.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/t,u=-t/t,h=2/e,A=-e/e;o._00=l,o._10=0,o._20=0,o._30=u,o._01=0,o._11=h,o._21=0,o._31=A,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var c=this.projectionMatrix,d=2/t,_=-t/t,f=2/(0-e),g=-e/(0-e);c._00=d,c._10=0,c._20=0,c._30=_,c._01=0,c._11=f,c._21=0,c._31=g,c._02=0,c._12=0,c._22=-.002000200020002,c._32=-1.0002000200020003,c._03=0,c._13=0,c._23=0,c._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){var n=this.coloredPainter;0<Ne.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ne.bufferIndex&&n.drawBuffer(!1),this.textPainter.end();var r=e+t.get_width(),s=i+t.get_height(),a=this.transformations[this.transformationIndex],o=e,l=s;null==l&&(l=0),null==o&&(o=0);var u=o,h=l,A=a._02*u+a._12*h+a._22,c=(a._00*u+a._10*h+a._20)/A,d=(a._01*u+a._11*h+a._21)/A;null==d&&(d=0),null==c&&(c=0);var _=c,f=d,g=this.transformations[this.transformationIndex],p=e,v=i;null==v&&(v=0),null==p&&(p=0);var m=p,w=v,b=g._02*m+g._12*w+g._22,S=(g._00*m+g._10*w+g._20)/b,y=(g._01*m+g._11*w+g._21)/b;null==y&&(y=0),null==S&&(S=0);var x=S,E=y,T=this.transformations[this.transformationIndex],B=r,k=i;null==k&&(k=0),null==B&&(B=0);var C=B,I=k,L=T._02*C+T._12*I+T._22,N=(T._00*C+T._10*I+T._20)/L,P=(T._01*C+T._11*I+T._21)/L;null==P&&(P=0),null==N&&(N=0);var R=N,M=P,V=this.transformations[this.transformationIndex],D=r,O=s;null==O&&(O=0),null==D&&(D=0);var F=D,U=O,H=V._02*F+V._12*U+V._22,W=(V._00*F+V._10*U+V._20)/H,G=(V._01*F+V._11*U+V._21)/H;null==G&&(G=0),null==W&&(W=0);var z=W,Y=G,X=this.imagePainter,K=this.get_opacity(),Q=this.get_color(),q=t;(1500<=Le.bufferIndex+1||null!=Le.lastTexture&&q!=Le.lastTexture)&&X.drawBuffer();var j=.00392156862745098*((16711680&Q)>>>16),Z=.00392156862745098*((65280&Q)>>>8),J=.00392156862745098*(255&Q),$=.00392156862745098*(Q>>>24)*K,tt=9*Le.bufferIndex*4;Le.rectVertices[5+tt]=j,Le.rectVertices[6+tt]=Z,Le.rectVertices[7+tt]=J,Le.rectVertices[8+tt]=$,Le.rectVertices[14+tt]=j,Le.rectVertices[15+tt]=Z,Le.rectVertices[16+tt]=J,Le.rectVertices[17+tt]=$,Le.rectVertices[23+tt]=j,Le.rectVertices[24+tt]=Z,Le.rectVertices[25+tt]=J,Le.rectVertices[26+tt]=$,Le.rectVertices[32+tt]=j,Le.rectVertices[33+tt]=Z,Le.rectVertices[34+tt]=J,Le.rectVertices[35+tt]=$;var et=q.get_width()/q.get_realWidth(),it=q.get_height()/q.get_realHeight(),nt=9*Le.bufferIndex*4;Le.rectVertices[3+nt]=0,Le.rectVertices[4+nt]=it,Le.rectVertices[12+nt]=0,Le.rectVertices[13+nt]=0,Le.rectVertices[21+nt]=et,Le.rectVertices[22+nt]=0,Le.rectVertices[30+nt]=et,Le.rectVertices[31+nt]=it;var rt=9*Le.bufferIndex*4;Le.rectVertices[rt]=_,Le.rectVertices[1+rt]=f,Le.rectVertices[2+rt]=-5,Le.rectVertices[9+rt]=x,Le.rectVertices[10+rt]=E,Le.rectVertices[11+rt]=-5,Le.rectVertices[18+rt]=R,Le.rectVertices[19+rt]=M,Le.rectVertices[20+rt]=-5,Le.rectVertices[27+rt]=z,Le.rectVertices[28+rt]=Y,Le.rectVertices[29+rt]=-5,++Le.bufferIndex,Le.lastTexture=q},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){var u=this.coloredPainter;0<Ne.triangleBufferIndex&&u.drawTriBuffer(!1),0<Ne.bufferIndex&&u.drawBuffer(!1),this.textPainter.end();var h=this.transformations[this.transformationIndex],A=s,c=a+l;null==c&&(c=0),null==A&&(A=0);var d=A,_=c,f=h._02*d+h._12*_+h._22,g=(h._00*d+h._10*_+h._20)/f,p=(h._01*d+h._11*_+h._21)/f;null==p&&(p=0),null==g&&(g=0);var v=g,m=p,w=this.transformations[this.transformationIndex],b=s,S=a;null==S&&(S=0),null==b&&(b=0);var y=b,x=S,E=w._02*y+w._12*x+w._22,T=(w._00*y+w._10*x+w._20)/E,B=(w._01*y+w._11*x+w._21)/E;null==B&&(B=0),null==T&&(T=0);var k=T,C=B,I=this.transformations[this.transformationIndex],L=s+o,N=a;null==N&&(N=0),null==L&&(L=0);var P=L,R=N,M=I._02*P+I._12*R+I._22,V=(I._00*P+I._10*R+I._20)/M,D=(I._01*P+I._11*R+I._21)/M;null==D&&(D=0),null==V&&(V=0);var O=V,F=D,U=this.transformations[this.transformationIndex],H=s+o,W=a+l;null==W&&(W=0),null==H&&(H=0);var G=H,z=W,Y=U._02*G+U._12*z+U._22,X=(U._00*G+U._10*z+U._20)/Y,K=(U._01*G+U._11*z+U._21)/Y;null==K&&(K=0),null==X&&(X=0);var Q=X,q=K,j=this.imagePainter,Z=this.get_opacity(),J=this.get_color(),$=t;(1500<=Le.bufferIndex+1||null!=Le.lastTexture&&$!=Le.lastTexture)&&j.drawBuffer();var tt=e/$.get_realWidth(),et=i/$.get_realHeight(),it=(e+n)/$.get_realWidth(),nt=(i+r)/$.get_realHeight(),rt=9*Le.bufferIndex*4;Le.rectVertices[3+rt]=tt,Le.rectVertices[4+rt]=nt,Le.rectVertices[12+rt]=tt,Le.rectVertices[13+rt]=et,Le.rectVertices[21+rt]=it,Le.rectVertices[22+rt]=et,Le.rectVertices[30+rt]=it,Le.rectVertices[31+rt]=nt;var st=.00392156862745098*((16711680&J)>>>16),at=.00392156862745098*((65280&J)>>>8),ot=.00392156862745098*(255&J),lt=.00392156862745098*(J>>>24)*Z,ut=9*Le.bufferIndex*4;Le.rectVertices[5+ut]=st,Le.rectVertices[6+ut]=at,Le.rectVertices[7+ut]=ot,Le.rectVertices[8+ut]=lt,Le.rectVertices[14+ut]=st,Le.rectVertices[15+ut]=at,Le.rectVertices[16+ut]=ot,Le.rectVertices[17+ut]=lt,Le.rectVertices[23+ut]=st,Le.rectVertices[24+ut]=at,Le.rectVertices[25+ut]=ot,Le.rectVertices[26+ut]=lt,Le.rectVertices[32+ut]=st,Le.rectVertices[33+ut]=at,Le.rectVertices[34+ut]=ot,Le.rectVertices[35+ut]=lt;var ht=9*Le.bufferIndex*4;Le.rectVertices[ht]=v,Le.rectVertices[1+ht]=m,Le.rectVertices[2+ht]=-5,Le.rectVertices[9+ht]=k,Le.rectVertices[10+ht]=C,Le.rectVertices[11+ht]=-5,Le.rectVertices[18+ht]=O,Le.rectVertices[19+ht]=F,Le.rectVertices[20+ht]=-5,Le.rectVertices[27+ht]=Q,Le.rectVertices[28+ht]=q,Le.rectVertices[29+ht]=-5,++Le.bufferIndex,Le.lastTexture=$},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=this.transformations[this.transformationIndex],a=t-r/2,o=e+r/2;null==o&&(o=0),null==a&&(a=0);var l=a,u=o,h=s._02*l+s._12*u+s._22,A=(s._00*l+s._10*u+s._20)/h,c=(s._01*l+s._11*u+s._21)/h;null==c&&(c=0),null==A&&(A=0);var d=A,_=c,f=this.transformations[this.transformationIndex],g=t-r/2,p=e-r/2;null==p&&(p=0),null==g&&(g=0);var v=g,m=p,w=f._02*v+f._12*m+f._22,b=(f._00*v+f._10*m+f._20)/w,S=(f._01*v+f._11*m+f._21)/w;null==S&&(S=0),null==b&&(b=0);var y=b,x=S,E=this.transformations[this.transformationIndex],T=t+i+r/2,B=e-r/2;null==B&&(B=0),null==T&&(T=0);var k=T,C=B,I=E._02*k+E._12*C+E._22,L=(E._00*k+E._10*C+E._20)/I,N=(E._01*k+E._11*C+E._21)/I;null==N&&(N=0),null==L&&(L=0);var P=L,R=N,M=this.transformations[this.transformationIndex],V=t+i+r/2,D=e+r/2;null==D&&(D=0),null==V&&(V=0);var O=V,F=D,U=M._02*O+M._12*F+M._22,H=(M._00*O+M._10*F+M._20)/U,W=(M._01*O+M._11*F+M._21)/U;null==W&&(W=0),null==H&&(H=0);var G=H,z=W;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),d,_,y,x,P,R,G,z);var Y=this.transformations[this.transformationIndex],X=t-r/2,K=e+n-r/2;null==K&&(K=0),null==X&&(X=0);var Q=X,q=K,j=Y._02*Q+Y._12*q+Y._22,Z=(Y._00*Q+Y._10*q+Y._20)/j,J=(Y._01*Q+Y._11*q+Y._21)/j;null==J&&(J=0),null==Z&&(Z=0),d=Z,_=J;var $=this.transformations[this.transformationIndex],tt=t-r/2,et=e+r/2;null==et&&(et=0),null==tt&&(tt=0);var it=tt,nt=et,rt=$._02*it+$._12*nt+$._22,st=($._00*it+$._10*nt+$._20)/rt,at=($._01*it+$._11*nt+$._21)/rt;null==at&&(at=0),null==st&&(st=0),y=st,x=at;var ot=this.transformations[this.transformationIndex],lt=t+r/2,ut=e+r/2;null==ut&&(ut=0),null==lt&&(lt=0);var ht=lt,At=ut,ct=ot._02*ht+ot._12*At+ot._22,dt=(ot._00*ht+ot._10*At+ot._20)/ct,_t=(ot._01*ht+ot._11*At+ot._21)/ct;null==_t&&(_t=0),null==dt&&(dt=0),P=dt,R=_t;var ft=this.transformations[this.transformationIndex],gt=t+r/2,pt=e+n-r/2;null==pt&&(pt=0),null==gt&&(gt=0);var vt=gt,mt=pt,wt=ft._02*vt+ft._12*mt+ft._22,bt=(ft._00*vt+ft._10*mt+ft._20)/wt,St=(ft._01*vt+ft._11*mt+ft._21)/wt;null==St&&(St=0),null==bt&&(bt=0),G=bt,z=St,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),d,_,y,x,P,R,G,z);var yt=this.transformations[this.transformationIndex],xt=t-r/2,Et=e+n+r/2;null==Et&&(Et=0),null==xt&&(xt=0);var Tt=xt,Bt=Et,kt=yt._02*Tt+yt._12*Bt+yt._22,Ct=(yt._00*Tt+yt._10*Bt+yt._20)/kt,It=(yt._01*Tt+yt._11*Bt+yt._21)/kt;null==It&&(It=0),null==Ct&&(Ct=0),d=Ct,_=It;var Lt=this.transformations[this.transformationIndex],Nt=t-r/2,Pt=e+n-r/2;null==Pt&&(Pt=0),null==Nt&&(Nt=0);var Rt=Nt,Mt=Pt,Vt=Lt._02*Rt+Lt._12*Mt+Lt._22,Dt=(Lt._00*Rt+Lt._10*Mt+Lt._20)/Vt,Ot=(Lt._01*Rt+Lt._11*Mt+Lt._21)/Vt;null==Ot&&(Ot=0),null==Dt&&(Dt=0),y=Dt,x=Ot;var Ft=this.transformations[this.transformationIndex],Ut=t+i+r/2,Ht=e+n-r/2;null==Ht&&(Ht=0),null==Ut&&(Ut=0);var Wt=Ut,Gt=Ht,zt=Ft._02*Wt+Ft._12*Gt+Ft._22,Yt=(Ft._00*Wt+Ft._10*Gt+Ft._20)/zt,Xt=(Ft._01*Wt+Ft._11*Gt+Ft._21)/zt;null==Xt&&(Xt=0),null==Yt&&(Yt=0),P=Yt,R=Xt;var Kt=this.transformations[this.transformationIndex],Qt=t+i+r/2,qt=e+n+r/2;null==qt&&(qt=0),null==Qt&&(Qt=0);var jt=Qt,Zt=qt,Jt=Kt._02*jt+Kt._12*Zt+Kt._22,$t=(Kt._00*jt+Kt._10*Zt+Kt._20)/Jt,te=(Kt._01*jt+Kt._11*Zt+Kt._21)/Jt;null==te&&(te=0),null==$t&&($t=0),G=$t,z=te,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),d,_,y,x,P,R,G,z);var ee=this.transformations[this.transformationIndex],ie=t+i-r/2,ne=e+n-r/2;null==ne&&(ne=0),null==ie&&(ie=0);var re=ie,se=ne,ae=ee._02*re+ee._12*se+ee._22,oe=(ee._00*re+ee._10*se+ee._20)/ae,le=(ee._01*re+ee._11*se+ee._21)/ae;null==le&&(le=0),null==oe&&(oe=0),d=oe,_=le;var ue=this.transformations[this.transformationIndex],he=t+i-r/2,Ae=e+r/2;null==Ae&&(Ae=0),null==he&&(he=0);var ce=he,de=Ae,_e=ue._02*ce+ue._12*de+ue._22,fe=(ue._00*ce+ue._10*de+ue._20)/_e,ge=(ue._01*ce+ue._11*de+ue._21)/_e;null==ge&&(ge=0),null==fe&&(fe=0),y=fe,x=ge;var pe=this.transformations[this.transformationIndex],ve=t+i+r/2,me=e+r/2;null==me&&(me=0),null==ve&&(ve=0);var we=ve,be=me,Se=pe._02*we+pe._12*be+pe._22,ye=(pe._00*we+pe._10*be+pe._20)/Se,xe=(pe._01*we+pe._11*be+pe._21)/Se;null==xe&&(xe=0),null==ye&&(ye=0),P=ye,R=xe;var Ee=this.transformations[this.transformationIndex],Te=t+i+r/2,Be=e+n-r/2;null==Be&&(Be=0),null==Te&&(Te=0);var ke=Te,Ce=Be,Ie=Ee._02*ke+Ee._12*Ce+Ee._22,Le=(Ee._00*ke+Ee._10*Ce+Ee._20)/Ie,Ne=(Ee._01*ke+Ee._11*Ce+Ee._21)/Ie;null==Ne&&(Ne=0),null==Le&&(Le=0),G=Le,z=Ne,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),d,_,y,x,P,R,G,z)},fillRect:function(t,e,i,n){this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformationIndex],s=t,a=e+n;null==a&&(a=0),null==s&&(s=0);var o=s,l=a,u=r._02*o+r._12*l+r._22,h=(r._00*o+r._10*l+r._20)/u,A=(r._01*o+r._11*l+r._21)/u;null==A&&(A=0),null==h&&(h=0);var c=h,d=A,_=this.transformations[this.transformationIndex],f=t,g=e;null==g&&(g=0),null==f&&(f=0);var p=f,v=g,m=_._02*p+_._12*v+_._22,w=(_._00*p+_._10*v+_._20)/m,b=(_._01*p+_._11*v+_._21)/m;null==b&&(b=0),null==w&&(w=0);var S=w,y=b,x=this.transformations[this.transformationIndex],E=t+i,T=e;null==T&&(T=0),null==E&&(E=0);var B=E,k=T,C=x._02*B+x._12*k+x._22,I=(x._00*B+x._10*k+x._20)/C,L=(x._01*B+x._11*k+x._21)/C;null==L&&(L=0),null==I&&(I=0);var N=I,P=L,R=this.transformations[this.transformationIndex],M=t+i,V=e+n;null==V&&(V=0),null==M&&(M=0);var D=M,O=V,F=R._02*D+R._12*O+R._22,U=(R._00*D+R._10*O+R._20)/F,H=(R._01*D+R._11*O+R._21)/F;null==H&&(H=0),null==U&&(U=0);var W=U,G=H;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c,d,S,y,N,P,W,G)},drawString:function(t,e,i){this.imagePainter.end();var n=this.coloredPainter;0<Ne.triangleBufferIndex&&n.drawTriBuffer(!1),0<Ne.bufferIndex&&n.drawBuffer(!1),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.transformations[this.transformationIndex])},drawCharacters:function(t,e,i,n,r){this.imagePainter.end();var s=this.coloredPainter;0<Ne.triangleBufferIndex&&s.drawTriBuffer(!1),0<Ne.bufferIndex&&s.drawBuffer(!1),this.textPainter.drawCharacters(t,e,i,this.get_opacity(),this.get_color(),n,r,this.transformations[this.transformationIndex])},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return ee.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=0,a=0;if(n==e){var o=0,l=-1;null==l&&(l=0),null==o&&(o=0),s=o,a=l}else{var u=1,h=-(i-t)/(n-e);null==h&&(h=0),null==u&&(u=0),s=u,a=h}var A=Math.sqrt(s*s+a*a);if(0!=A){var c=r/A;s*=c,a*=c}var d=t+.5*s,_=e+.5*a;null==_&&(_=0),null==d&&(d=0);var f=d,g=_,p=i+.5*s,v=n+.5*a;null==v&&(v=0),null==p&&(p=0);var m=p,w=v,b=f-s,S=g-a;null==S&&(S=0),null==b&&(b=0);var y=b,x=S,E=m-s,T=w-a;null==T&&(T=0),null==E&&(E=0);var B=E,k=T,C=this.transformations[this.transformationIndex],I=C._02*f+C._12*g+C._22,L=(C._00*f+C._10*g+C._20)/I,N=(C._01*f+C._11*g+C._21)/I;null==N&&(N=0),null==L&&(L=0),f=L,g=N;var P=this.transformations[this.transformationIndex],R=P._02*m+P._12*w+P._22,M=(P._00*m+P._10*w+P._20)/R,V=(P._01*m+P._11*w+P._21)/R;null==V&&(V=0),null==M&&(M=0),m=M,w=V;var D=this.transformations[this.transformationIndex],O=D._02*y+D._12*x+D._22,F=(D._00*y+D._10*x+D._20)/O,U=(D._01*y+D._11*x+D._21)/O;null==U&&(U=0),null==F&&(F=0),y=F,x=U;var H=this.transformations[this.transformationIndex],W=H._02*B+H._12*k+H._22,G=(H._00*B+H._10*k+H._20)/W,z=(H._01*B+H._11*k+H._21)/W;null==z&&(z=0),null==G&&(G=0),B=G,k=z,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),f,g,m,w,y,x),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),y,x,m,w,B,k)},fillTriangle:function(t,e,i,n,r,s){this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],o=t,l=e;null==l&&(l=0),null==o&&(o=0);var u=o,h=l,A=a._02*u+a._12*h+a._22,c=(a._00*u+a._10*h+a._20)/A,d=(a._01*u+a._11*h+a._21)/A;null==d&&(d=0),null==c&&(c=0);var _=c,f=d,g=this.transformations[this.transformationIndex],p=i,v=n;null==v&&(v=0),null==p&&(p=0);var m=p,w=v,b=g._02*m+g._12*w+g._22,S=(g._00*m+g._10*w+g._20)/b,y=(g._01*m+g._11*w+g._21)/b;null==y&&(y=0),null==S&&(S=0);var x=S,E=y,T=this.transformations[this.transformationIndex],B=r,k=s;null==k&&(k=0),null==B&&(B=0);var C=B,I=k,L=T._02*C+T._12*I+T._22,N=(T._00*C+T._10*I+T._20)/L,P=(T._01*C+T._11*I+T._21)/L;null==P&&(P=0),null==N&&(N=0);var R=N,M=P;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),_,f,x,E,R,M)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(t){return t==this.myImageScaleQuality?t:(this.imagePainter.setBilinearFilter(t==oe.High),this.textPainter.setBilinearFilter(t==oe.High),this.myImageScaleQuality=t)},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(t){return this.imagePainter.setBilinearMipmapFilter(t==oe.High),this.myMipmapScaleQuality=t},pipelineCache:null,lastPipeline:null,setPipeline:function(t){if(t!=this.lastPipeline)if(this.lastPipeline=t,this.flush(),null==t)this.imagePainter.set_pipeline(null),this.coloredPainter.set_pipeline(null),this.textPainter.set_pipeline(null);else{var e=this.pipelineCache.h[t.__id__];null==e&&(e=new Ie(t),this.pipelineCache.set(t,e)),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e)}},scissorEnabled:null,scissorX:null,scissorY:null,scissorW:null,scissorH:null,scissor:function(t,e,i,n){this.scissorEnabled=!0,this.scissorX=t,this.scissorY=e,this.scissorW=i,this.scissorH=n,this.flush(),this.g.scissor(t,e,i,n)},disableScissor:function(){this.scissorEnabled=!1,this.flush(),this.g.disableScissor()},begin:function(t,e){if(null==t&&(t=!0),null!=Re.current)throw new ne("End before you begin");(Re.current=this).g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;0<Ne.triangleBufferIndex&&t.drawTriBuffer(!1),0<Ne.bufferIndex&&t.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),Re.current!=this)throw new ne("Begin before you end");Re.current=null},drawVideoInternal:function(t,e,i,n,r){},drawVideo:function(t,e,i,n,r){this.setPipeline(Re.videoPipeline),this.drawVideoInternal(t,e,i,n,r),this.setPipeline(null)},__class__:Re});var Me=function(t,e,i){null==i&&(i=!1),this.indexCount=t,this.buffer=Krom.createIndexBuffer(t)};(y["kha.graphics4.IndexBuffer"]=Me).__name__=!0,Me.prototype={buffer:null,_data:null,indexCount:null,delete:function(){Krom.deleteIndexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockIndexBuffer(this.buffer),null==t&&(t=0),null==e&&(e=this.indexCount),this._data.subarray(t,t+e)},unlock:function(t){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},count:function(){return this.indexCount},__class__:Me};function Ve(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Fe.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1}(y["kha.graphics4.PipelineStateBase"]=Ve).__name__=!0,Ve.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,set_colorWriteMask:function(t){var e=this.colorWriteMasksAlpha[0]=t,i=this.colorWriteMasksGreen[0]=e,n=this.colorWriteMasksBlue[0]=i;return this.colorWriteMasksRed[0]=n},get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:Ve};var De=function(){Ve.call(this),this.pipeline=Krom.createPipeline()};(y["kha.graphics4.PipelineState"]=De).__name__=!0,De.convertCullMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},De.convertCompareMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},De.convertStencilAction=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},De.convertBlendingFactor=function(t){switch(t){case 0:case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5;case 7:return 6;case 8:return 7;case 9:return 8;case 10:return 9}},De.__super__=Ve,De.prototype=r(Ve.prototype,{pipeline:null,delete:function(){Krom.deletePipeline(this.pipeline),this.pipeline=null},compile:function(){var t=0<this.inputLayout.length?this.inputLayout[0]:null,e=1<this.inputLayout.length?this.inputLayout[1]:null,i=2<this.inputLayout.length?this.inputLayout[2]:null,n=3<this.inputLayout.length?this.inputLayout[3]:null,r=null!=this.geometryShader?this.geometryShader.shader:null,s=null!=this.tessellationControlShader?this.tessellationControlShader.shader:null,a=null!=this.tessellationEvaluationShader?this.tessellationEvaluationShader.shader:null,o=0,l=this.stencilReferenceValue;1==l._hx_index&&(o=l.value);Krom.compilePipeline(this.pipeline,t,e,i,n,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,r,s,a,{cullMode:De.convertCullMode(this.cullMode),depthWrite:this.depthWrite,depthMode:De.convertCompareMode(this.depthMode),stencilMode:De.convertCompareMode(this.stencilMode),stencilBothPass:De.convertStencilAction(this.stencilBothPass),stencilDepthFail:De.convertStencilAction(this.stencilDepthFail),stencilFail:De.convertStencilAction(this.stencilFail),stencilReferenceValue:o,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:De.convertBlendingFactor(this.blendSource),blendDestination:De.convertBlendingFactor(this.blendDestination),alphaBlendSource:De.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:De.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(t){return Krom.getConstantLocation(this.pipeline,t)},getTextureUnit:function(t){return Krom.getTextureUnit(this.pipeline,t)},__class__:De});function Oe(t,e){this.shader=Krom.createTessellationControlShader(t[0].bytes.b.bufferValue,e[0])}var Fe=f["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:(e=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:i}},e.__params__=["value"],e)};(y["kha.graphics4.TessellationControlShader"]=Oe).__name__=!0,Oe.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Oe};function Ue(t,e){this.shader=Krom.createTessellationEvaluationShader(t[0].bytes.b.bufferValue,e[0])}(y["kha.graphics4.TessellationEvaluationShader"]=Ue).__name__=!0,Ue.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ue};function He(){}(y["kha.graphics4.TextureUnit"]=He).__name__=!0,He.__isInterface__=!0;var We=function(t,e,i,n,r){null==r&&(r=!1),null==n&&(n=0),this.vertexCount=t,this.structure=e,this.buffer=Krom.createVertexBuffer(t,e.elements,i,n)};(y["kha.graphics4.VertexBuffer"]=We).__name__=!0,We.prototype={buffer:null,_data:null,vertexCount:null,structure:null,delete:function(){Krom.deleteVertexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},lockInt16:function(t,e){return new Int16Array(this.lock(t,e).buffer)},unlock:function(t){Krom.unlockVertexBuffer(this.buffer)},stride:function(){return this.structure.byteSize()},count:function(){return this.vertexCount},set:function(t){return Krom.setVertexBuffer(this.buffer),0},__class__:We};function Ge(t,e){this.name=t,this.data=e}(y["kha.graphics4.VertexElement"]=Ge).__name__=!0,Ge.prototype={name:null,data:null,__class__:Ge};var ze=function(t,e){null!=t&&(this.shader=Krom.createVertexShader(t[0].bytes.b.bufferValue,e[0]))};(y["kha.graphics4.VertexShader"]=ze).__name__=!0,ze.fromSource=function(t){var e=new ze(null,null);return e.shader=Krom.createVertexShaderFromSource(t),e},ze.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:ze};var Ye=function(){this.elements=[],this.instanced=!1};(y["kha.graphics4.VertexStructure"]=Ye).__name__=!0,Ye.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new Ge(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,i=this.elements.length;e<i;){var n=e++;t+=this.dataByteSize(this.elements[n].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64;case 5:return 4;case 6:return 8}},get:function(t){return this.elements[t]},__class__:Ye};var Xe=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Xe.instances[t]=this};(y["kha.input.Gamepad"]=Xe).__name__=!0,Xe.get=function(t){return null==t&&(t=0),t>=Xe.instances.length?null:Xe.instances[t]},Xe.notifyOnConnect=function(t,e){null!=t&&Xe.connectListeners.push(t),null!=e&&Xe.disconnectListeners.push(e)},Xe.removeConnect=function(t,e){null!=t&&xt.remove(Xe.connectListeners,t),null!=e&&xt.remove(Xe.disconnectListeners,e)},Xe.sendConnectEvent=function(t){Xe.instances[t].connected=!0;for(var e=0,i=Xe.connectListeners;e<i.length;){var n=i[e];++e,n(t)}},Xe.sendDisconnectEvent=function(t){Xe.instances[t].connected=!1;for(var e=0,i=Xe.disconnectListeners;e<i.length;){var n=i[e];++e,n(t)}},Xe.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},remove:function(t,e){null!=t&&xt.remove(this.axisListeners,t),null!=e&&xt.remove(this.buttonListeners,e)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return W.getGamepadId(this.index)},sendAxisEvent:function(t,e){for(var i=0,n=this.axisListeners;i<n.length;){var r=n[i];++i,r(t,e)}},sendButtonEvent:function(t,e){for(var i=0,n=this.buttonListeners;i<n.length;){var r=n[i];++i,r(t,e)}},__class__:Xe};function Ke(){this.__id=_i.nextId++,this._inputBuffer=new kt(new ArrayBuffer(1))}var Qe=f["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:i},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:i},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:i},Custom:(e=function(t){return{_hx_index:3,func:t,__enum__:"kha.input.BlockInterventions",toString:i}},e.__params__=["func"],e)};(y["kha.netsync.Controller"]=Ke).__name__=!0,Ke.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(t){},__class__:Ke};var qe=t.kha.input.Keyboard=function(){Ke.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],qe.instance=this};(y["kha.input.Keyboard"]=qe).__name__=!0,qe.get=function(t){return null==t&&(t=0),W.getKeyboard(t)},qe.disableSystemInterventions=function(t){qe.keyBehavior=t},qe.__super__=Ke,qe.prototype=r(Ke.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},remove:function(t,e,i){null!=t&&xt.remove(this.downListeners,t),null!=e&&xt.remove(this.upListeners,e),null!=i&&xt.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){for(var e=0,i=this.downListeners;e<i.length;){var n=i[e];++e,n(t)}},sendUpEvent:function(t){for(var e=0,i=this.upListeners;e<i.length;){var n=i[e];++e,n(t)}},sendPressEvent:function(t){for(var e=0,i=this.pressListeners;e<i.length;){var n=i[e];++e,n(t)}},_receive:function(t){},__class__:qe});var je=t.kha.input.Mouse=function(){Ke.call(this),je.instance=this};(y["kha.input.Mouse"]=je).__name__=!0,je.get=function(t){return null==t&&(t=0),W.getMouse(t)},je.__super__=Ke,je.prototype=r(Ke.prototype,{notify:function(t,e,i,n,r){this.notifyWindowed(0,t,e,i,n,r)},remove:function(t,e,i,n,r){this.removeWindowed(0,t,e,i,n,r)},notifyWindowed:function(t,e,i,n,r,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}if(null!=r){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(r)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},removeWindowed:function(t,e,i,n,r,s){null!=e&&(null!=this.windowDownListeners?t<this.windowDownListeners.length?xt.remove(this.windowDownListeners[t],e):L.trace('no downListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?t<this.windowUpListeners.length?xt.remove(this.windowUpListeners[t],i):L.trace('no upListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowMoveListeners?t<this.windowMoveListeners.length?xt.remove(this.windowMoveListeners[t],n):L.trace('no moveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowWheelListeners?t<this.windowWheelListeners.length?xt.remove(this.windowWheelListeners[t],r):L.trace('no wheelListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowLeaveListeners?t<this.windowLeaveListeners.length?xt.remove(this.windowLeaveListeners[t],s):L.trace('no leaveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):L.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(t,e){},removeFromLockChange:function(t,e){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=this.windowLeaveListeners)for(var e=0,i=this.windowLeaveListeners[t];e<i.length;){var n=i[e];++e,n()}},sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n,r){if(null!=this.windowMoveListeners)for(var s=0,a=this.windowMoveListeners[t];s<a.length;){var o=a[s];++s,o(e,i,n,r)}},sendWheelEvent:function(t,e){if(null!=this.windowWheelListeners)for(var i=0,n=this.windowWheelListeners[t];i<n.length;){var r=n[i];++i,r(e)}},_receive:function(t){},__class__:je});var Ze=function(){je.call(this)};(y["kha.input.MouseImpl"]=Ze).__name__=!0,Ze.__super__=je,Ze.prototype=r(je.prototype,{lock:function(){W.lockMouse()},unlock:function(){W.unlockMouse()},canLock:function(){return W.canLockMouse()},isLocked:function(){return W.isMouseLocked()},notifyOnLockChange:function(t,e){W.notifyOfMouseLockChange(t,e)},removeFromLockChange:function(t,e){W.removeFromMouseLockChange(t,e)},hideSystemCursor:function(){W.hideSystemCursor()},showSystemCursor:function(){W.showSystemCursor()},_receive:function(t){},__class__:Ze});var Je=function(){Je.instance=this};(y["kha.input.Pen"]=Je).__name__=!0,Je.get=function(t){return null==t&&(t=0),W.getPen(t)},Je.prototype={notify:function(t,e,i){this.notifyWindowed(0,t,e,i)},remove:function(t,e,i){this.removeWindowed(0,t,e,i)},notifyWindowed:function(t,e,i,n){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}},removeWindowed:function(t,e,i,n){null!=e&&null!=this.windowDownListeners&&t<this.windowDownListeners.length&&xt.remove(this.windowDownListeners[t],e),null!=i&&null!=this.windowUpListeners&&t<this.windowUpListeners.length&&xt.remove(this.windowUpListeners[t],i),null!=n&&null!=this.windowMoveListeners&&t<this.windowMoveListeners.length&&xt.remove(this.windowMoveListeners[t],n)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n){if(null!=this.windowMoveListeners)for(var r=0,s=this.windowMoveListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},__class__:Je};var $e=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],$e.instance=this};(y["kha.input.Surface"]=$e).__name__=!0,$e.get=function(t){return null==t&&(t=0),0!=t?null:$e.instance},$e.prototype={notify:function(t,e,i){null!=t&&this.touchStartListeners.push(t),null!=e&&this.touchEndListeners.push(e),null!=i&&this.moveListeners.push(i)},remove:function(t,e,i){null!=t&&xt.remove(this.touchStartListeners,t),null!=e&&xt.remove(this.touchEndListeners,e),null!=i&&xt.remove(this.moveListeners,i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,i){for(var n=0,r=this.touchStartListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var n=0,r=this.touchEndListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendMoveEvent:function(t,e,i){for(var n=0,r=this.moveListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},__class__:$e};var ti=function(t){this.bytes=t};(y["kha.internal.BytesBlob"]=ti).__name__=!0,ti.__interfaces__=[k],ti.fromBytes=function(t){return new ti(t)},ti.alloc=function(t){return new ti(new kt(new ArrayBuffer(t)))},ti.readF32=function(t){var e=0==(-2147483648&t)?1:-1,i=t>>23&255,n=8388607&t;switch(i){case 0:return 0;case 255:return 0!=n?NaN:0<e?1/0:-1/0;default:return(8388608+n)/8388608*e*Math.pow(2,i-127)}},ti.bit=function(t,e){if(1==(t>>>e&1)){return!0}return!1},ti.toText=function(t,e){for(var i="",n=0,r=e;n<r;){var s=n++;i+=String.fromCodePoint(t[s])}return i},ti.prototype={bytes:null,sub:function(t,e){return new ti(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=e},readU8:function(t){var e=this.bytes.b[t];return++t,e},readS8:function(t){var e=this.bytes.b[t];return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*e+i},readU16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*i+e},readU32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,e+256*i+256*n*256+256*r*256*256},readU32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,r+256*n+256*i*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];t+=2;var n=0==(128&e)?1:-1;return e&=127,-1==n?256*e-32767+i:256*e+i},readS16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=0==(128&i)?1:-1;return i&=127,t+=2,-1==n?256*i-32767+e:256*i+e},readS32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&r)?1:-1;return r&=127,t+=4,-1==s?-2147483647+e+256*i+256*n*256+256*r*256*256:e+256*i+256*n*256+256*r*256*256},readS32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&e)?1:-1;return e&=127,t+=4,-1==s?-2147483647+r+256*n+256*i*256+256*e*256*256:r+256*n+256*i*256+256*e*256*256},readF32LE:function(t){return ti.readF32(this.readS32LE(t))},readF32BE:function(t){return ti.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8String:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:ti};var ei=function(t){this.renderTarget=t};(y["kha.krom.Graphics"]=ei).__name__=!0,ei.__interfaces__=[Ce],ei.prototype={renderTarget:null,begin:function(t){Krom.begin(this.renderTarget,t)},beginFace:function(t){Krom.beginFace(this.renderTarget,t)},beginEye:function(t){},end:function(){Krom.end()},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(t,e,i){var n=0;null!=t&&(n|=1),null!=e&&(n|=2),null!=i&&(n|=4),Krom.clear(n,null==t?0:t,e,i)},viewport:function(t,e,i,n){Krom.viewport(t,e,i,n)},setVertexBuffer:function(t){t.set(0)},setVertexBuffers:function(t){Krom.setVertexBuffers(t)},setIndexBuffer:function(t){t.set()},setCubeMap:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setCubeMapDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTexture:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setTextureDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTextureArray:function(t,e){},setVideoTexture:function(t,e){},setImageTexture:function(t,e){null!=e&&Krom.setImageTexture(t,e.texture_)},setTextureParameters:function(t,e,i,n,r,s){Krom.setTextureParameters(t,e,i,n,r,s)},setTexture3DParameters:function(t,e,i,n,r,s,a){Krom.setTexture3DParameters(t,e,i,n,r,s,a)},setTextureCompareMode:function(t,e){Krom.setTextureCompareMode(t,e)},setCubeMapCompareMode:function(t,e){Krom.setCubeMapCompareMode(t,e)},setPipeline:function(t){t.set()},setStencilReferenceValue:function(t){},setBool:function(t,e){Krom.setBool(t,e)},setInt:function(t,e){Krom.setInt(t,e)},setFloat:function(t,e){Krom.setFloat(t,e)},setFloat2:function(t,e,i){Krom.setFloat2(t,e,i)},setFloat3:function(t,e,i,n){Krom.setFloat3(t,e,i,n)},setFloat4:function(t,e,i,n,r){Krom.setFloat4(t,e,i,n,r)},setFloats:function(t,e){Krom.setFloats(t,e.buffer)},setVector2:function(t,e){Krom.setFloat2(t,e.x,e.y)},setVector3:function(t,e){Krom.setFloat3(t,e.x,e.y,e.z)},setVector4:function(t,e){Krom.setFloat4(t,e.x,e.y,e.z,e.w)},setMatrix:function(t,e){ei.mat[0]=e._00,ei.mat[1]=e._01,ei.mat[2]=e._02,ei.mat[3]=e._03,ei.mat[4]=e._10,ei.mat[5]=e._11,ei.mat[6]=e._12,ei.mat[7]=e._13,ei.mat[8]=e._20,ei.mat[9]=e._21,ei.mat[10]=e._22,ei.mat[11]=e._23,ei.mat[12]=e._30,ei.mat[13]=e._31,ei.mat[14]=e._32,ei.mat[15]=e._33,Krom.setMatrix(t,ei.mat.buffer)},setMatrix3:function(t,e){ei.mat[0]=e._00,ei.mat[1]=e._01,ei.mat[2]=e._02,ei.mat[3]=e._10,ei.mat[4]=e._11,ei.mat[5]=e._12,ei.mat[6]=e._20,ei.mat[7]=e._21,ei.mat[8]=e._22,Krom.setMatrix3(t,ei.mat.buffer)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0),Krom.drawIndexedVertices(t,e)},drawIndexedVerticesInstanced:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),Krom.drawIndexedVerticesInstanced(t,e,i)},instancedRenderingAvailable:function(){return!0},scissor:function(t,e,i,n){Krom.scissor(t,e,i,n)},disableScissor:function(){Krom.disableScissor()},__class__:ei};var ii=function(t){U.call(this);var e=t.length/4|0,i=new Float32Array(e);this.uncompressedData=i;for(var n=0,r=e;n<r;){var s=n++;this.uncompressedData[s]=t.getFloat(4*s)}this.compressedData=null};(y["kha.krom.Sound"]=ii).__name__=!0,ii.__super__=U,ii.prototype=r(U.prototype,{uncompress:function(t){t()},unload:function(){U.prototype.unload.call(this)},__class__:ii});var ni=function(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};(y["kha.math.FastMatrix3"]=ni).__name__=!0,ni.fromMatrix3=function(t){return new ni(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},ni.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:ni};var ri=function(t,e,i,n,r,s,a,o,l,u,h,A,c,d,_,f){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=A,this._03=c,this._13=d,this._23=_,this._33=f};(y["kha.math.FastMatrix4"]=ri).__name__=!0,ri.fromMatrix4=function(t){return new ri(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ri.orthogonalProjection=function(t,e,i,n,r,s){return new ri(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},ri.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new ri(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ri.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z;null==s&&(s=0),null==r&&(r=0),null==n&&(n=0);var a=n,o=r,l=s;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,A=l,c=Math.sqrt(u*u+h*h+A*A);if(0!=c){var d=1/c;u*=d,h*=d,A*=d}var _=h*i.z-A*i.y,f=A*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==f&&(f=0),null==_&&(_=0);var p=_,v=f,m=g;null==m&&(m=0),null==v&&(v=0),null==p&&(p=0);var w=p,b=v,S=m,y=Math.sqrt(w*w+b*b+S*S);if(0!=y){var x=1/y;w*=x,b*=x,S*=x}var E=b*A-S*h,T=S*u-w*A,B=w*h-b*u;null==B&&(B=0),null==T&&(T=0),null==E&&(E=0);var k=E,C=T,I=B;return new ri(w,b,S,-(w*t.x+b*t.y+S*t.z),k,C,I,-(k*t.x+C*t.y+I*t.z),-u,-h,-A,u*t.x+h*t.y+A*t.z,0,0,0,1)},ri.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ri};function si(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e}(y["kha.math.FastVector2"]=si).__name__=!0,si.fromVector2=function(t){return new si(t.x,t.y)},si.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:si};function ai(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(y["kha.math.FastVector3"]=ai).__name__=!0,ai.fromVector3=function(t){return new ai(t.x,t.y,t.z)},ai.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:ai};function oi(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(y["kha.math.FastVector4"]=oi).__name__=!0,oi.fromVector4=function(t){return new oi(t.x,t.y,t.z,t.w)},oi.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:oi};function li(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l}(y["kha.math.Matrix3"]=li).__name__=!0,li.fromFastMatrix3=function(t){return new li(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},li.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:li};function ui(t,e,i,n,r,s,a,o,l,u,h,A,c,d,_,f){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=A,this._03=c,this._13=d,this._23=_,this._33=f}(y["kha.math.Matrix4"]=ui).__name__=!0,ui.fromFastMatrix4=function(t){return new ui(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ui.orthogonalProjection=function(t,e,i,n,r,s){return new ui(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},ui.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new ui(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ui.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z;null==s&&(s=0),null==r&&(r=0),null==n&&(n=0);var a=n,o=r,l=s;null==l&&(l=0),null==o&&(o=0),null==a&&(a=0);var u=a,h=o,A=l,c=Math.sqrt(u*u+h*h+A*A);if(0!=c){var d=1/c;u*=d,h*=d,A*=d}var _=h*i.z-A*i.y,f=A*i.x-u*i.z,g=u*i.y-h*i.x;null==g&&(g=0),null==f&&(f=0),null==_&&(_=0);var p=_,v=f,m=g;null==m&&(m=0),null==v&&(v=0),null==p&&(p=0);var w=p,b=v,S=m,y=Math.sqrt(w*w+b*b+S*S);if(0!=y){var x=1/y;w*=x,b*=x,S*=x}var E=b*A-S*h,T=S*u-w*A,B=w*h-b*u;null==B&&(B=0),null==T&&(T=0),null==E&&(E=0);var k=E,C=T,I=B;return new ui(w,b,S,-(w*t.x+b*t.y+S*t.z),k,C,I,-(k*t.x+C*t.y+I*t.z),-u,-h,-A,u*t.x+h*t.y+A*t.z,0,0,0,1)},ui.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ui};var hi=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(y["kha.math.Vector2"]=hi).__name__=!0,hi.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:hi};function Ai(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i}(y["kha.math.Vector3"]=Ai).__name__=!0,Ai.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},__class__:Ai};function ci(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n}(y["kha.math.Vector4"]=ci).__name__=!0,ci.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},__class__:ci};function di(){}(y["kha.netsync.Client"]=di).__name__=!0,di.__isInterface__=!0,di.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:di};var _i=function(){};(y["kha.netsync.ControllerBuilder"]=_i).__name__=!0;function fi(){}(y["kha.netsync.Entity"]=fi).__name__=!0,fi.__isInterface__=!0,fi.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:fi};function gi(t){this.myId=t}(y["kha.netsync.LocalClient"]=gi).__name__=!0,gi.__interfaces__=[di],gi.prototype={myId:null,send:function(t,e){},receive:function(t){},onClose:function(t){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:gi};function pi(t,e){this.time=t,this.data=e}(y["kha.netsync.State"]=pi).__name__=!0,pi.prototype={time:null,data:null,__class__:pi};var vi=function(t,e,i){this.ping=1,this.currentPlayers=0,this.controllers=new $,this.entities=new $,(vi.instance=this).maxPlayers=t,this.address=e,this.port=i};(y["kha.netsync.Session"]=vi).__name__=!0,vi.the=function(){return vi.instance},vi.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(t){var e=this.entities,i=t._id();e.h[i]=t},addController:function(t){L.trace("Adding controller id "+t._id(),{fileName:"kha/netsync/Session.hx",lineNumber:88,className:"kha.netsync.Session",methodName:"addController"}),t._inputBufferIndex=0;var e=this.controllers,i=t._id();e.h[i]=t},sendControllerUpdate:function(t,e){if(this.controllers.h.hasOwnProperty(t)){if(this.controllers.h[t]._inputBuffer.length<this.controllers.h[t]._inputBufferIndex+4+e.length){var i=new kt(new ArrayBuffer(this.controllers.h[t]._inputBufferIndex+4+e.length));i.blit(0,this.controllers.h[t]._inputBuffer,0,this.controllers.h[t]._inputBufferIndex),this.controllers.h[t]._inputBuffer=i}this.controllers.h[t]._inputBuffer.setInt32(this.controllers.h[t]._inputBufferIndex,e.length),this.controllers.h[t]._inputBuffer.blit(this.controllers.h[t]._inputBufferIndex+4,e,0,e.length),this.controllers.h[t]._inputBufferIndex+=4+e.length}},sendPing:function(){var t=new kt(new ArrayBuffer(5));t.b[0]=4,t.setFloat(1,D.realTime()),this.sendToServer(t)},sendPlayerUpdate:function(){},receive:function(t,e){switch(t.b[0]){case 0:var i=t.b[1];this.localClient=new gi(i),D.resetTime(),this.startCallback();break;case 1:for(var n=t.getDouble(1),r=9,s=this.entities.iterator();s.hasNext();){var a=s.next();a._receive(r,t),r+=a._size()}D.warp(n);break;case 3:switch(t.b[1]){case 0:break;case 1:this.executeRPC(t)}break;case 4:var o=t.getFloat(1);this.ping=D.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=t.getInt32(1)}},executeRPC:function(t){var e=[],i=t.getInt32(2),n=6,r=t.getUInt16(n);n+=2;for(var s="",a=0,o=r;a<o;){a++;var l=t.b[n];s+=String.fromCodePoint(l),++n}var u=t.getUInt16(n);n+=2;for(var h="",A=0,c=u;A<c;){A++;var d=t.b[n];h+=String.fromCodePoint(d),++n}for(;n<t.length;){var _=t.b[n];switch(++n,_){case 66:var f=1==t.b[n];++n,L.trace("Bool: "+(null==f?"null":""+f),{fileName:"kha/netsync/Session.hx",lineNumber:295,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(f);break;case 70:var g=t.getDouble(n);n+=8,L.trace("Float: "+g,{fileName:"kha/netsync/Session.hx",lineNumber:300,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(g);break;case 73:var p=t.getInt32(n);n+=4,L.trace("Int: "+p,{fileName:"kha/netsync/Session.hx",lineNumber:305,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(p);break;case 83:var v=t.getUInt16(n);n+=2;for(var m="",w=0,b=v;w<b;){w++;var S=t.b[n];m+=String.fromCodePoint(S),++n}L.trace("String: "+m,{fileName:"kha/netsync/Session.hx",lineNumber:315,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(m);break;default:L.trace("Unknown argument type.",{fileName:"kha/netsync/Session.hx",lineNumber:318,className:"kha.netsync.Session",methodName:"executeRPC"})}}-1==i?K.field(y[s],h+"_remotely").apply(null,e):K.field(mi.objects[i],h+"_remotely").apply(mi.objects[i],e)},waitForStart:function(t,e,i,n,r){var s=this;this.startCallback=t,this.refusedCallback=e,this.resetCallback=r,this.network=new kha.netsync.Network(this.address,this.port,i,function(){n(),s.reset()}),this.network.listen(function(t){s.receive(t)}),this.updateTaskId=D.addFrameTask(Bi(this,this.update),0),this.ping=1,this.pingTaskId=D.addTimeTask(Bi(this,this.sendPing),0,1)},reset:function(){D.removeFrameTask(this.updateTaskId),D.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new $,this.entities=new $,this.resetCallback()},update:function(){for(var t=this.controllers.iterator();t.hasNext();){var e=t.next();if(0<e._inputBufferIndex){var i=new kt(new ArrayBuffer(22+e._inputBufferIndex));i.b[0]=2,i.setInt32(1,e._id()),i.setDouble(5,D.time()),i.setInt32(13,It.windowWidth(0)),i.setInt32(17,It.windowHeight(0)),i.b[21]=0,i.blit(22,e._inputBuffer,0,e._inputBufferIndex),this.sendToServer(i),e._inputBufferIndex=0}}},sendToServer:function(t){this.network.send(t,!1)},__class__:vi};var mi=function(){};(y["kha.netsync.SyncBuilder"]=mi).__name__=!0;function wi(t,e,i,n){this._0=t,this._1=e,this._2=i,this._3=n}(y["kha.simd.Float32x4"]=wi).__name__=!0,wi.create=function(){return new wi(0,0,0,0)},wi.loadAllFast=function(t){return new wi(t,t,t,t)},wi.load=function(t,e,i,n){return new wi(t,e,i,n)},wi.loadFast=function(t,e,i,n){return new wi(t,e,i,n)},wi.get=function(t,e){var i=0;switch(e){case 0:i=t._0;break;case 1:i=t._1;break;case 2:i=t._2;break;case 3:i=t._3}return i},wi.getFast=function(t,e){switch(e){case 0:return t._0;case 1:return t._1;case 2:return t._2;case 3:return t._3}return 0},wi.abs=function(t){return new wi(Math.abs(t._0),Math.abs(t._1),Math.abs(t._2),Math.abs(t._3))},wi.add=function(t,e){return new wi(t._0+e._0,t._1+e._1,t._2+e._2,t._3+e._3)},wi.div=function(t,e){return new wi(t._0/e._0,t._1/e._1,t._2/e._2,t._3/e._3)},wi.mul=function(t,e){return new wi(t._0*e._0,t._1*e._1,t._2*e._2,t._3*e._3)},wi.neg=function(t){return new wi(-t._0,-t._1,-t._2,-t._3)},wi.reciprocalApproximation=function(t){return new wi(0,0,0,0)},wi.reciprocalSqrtApproximation=function(t){return new wi(0,0,0,0)},wi.sub=function(t,e){return new wi(t._0-e._0,t._1-e._1,t._2-e._2,t._3-e._3)},wi.sqrt=function(t){return new wi(Math.sqrt(t._0),Math.sqrt(t._1),Math.sqrt(t._2),Math.sqrt(t._3))},wi.prototype={_0:null,_1:null,_2:null,_3:null,__class__:wi};var bi=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(y["zui.Handle"]=bi).__name__=!0,bi.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){null==this.children&&(this.children=new $);var i=this.children.h[t];if(null==i){var n=this.children;i=new bi(e),n.h[t]=i}return i},__class__:bi};var Si=function(){};(y["zui.Canvas"]=Si).__name__=!0,Si.draw=function(t,e,i){-1==Si.screenW&&(Si.screenW=It.windowWidth(),Si.screenH=It.windowHeight()),Si.events=[],Si._ui=t,i.end(),t.begin(i),i.begin(!1),t.g=i;for(var n=0,r=e.elements;n<r.length;){var s=r[n];++n,null==s.parent&&Si.drawElement(t,e,s)}return i.end(),t.end(),i.begin(!1),Si.events},Si.drawElement=function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=0),null!=i&&0!=i.visible){var s=e.width*Si._ui.SCALE|0,a=e.height*Si._ui.SCALE|0;switch(i.anchor){case 1:n-=(s-Si.screenW)/2;break;case 2:n-=s-Si.screenW;break;case 3:r-=(a-Si.screenH)/2;break;case 4:n-=(s-Si.screenW)/2,r-=(a-Si.screenH)/2;break;case 5:n-=s-Si.screenW,r-=(a-Si.screenH)/2;break;case 6:r-=a-Si.screenH;break;case 7:n-=(s-Si.screenW)/2,r-=a-Si.screenH;break;case 8:n-=s-Si.screenW,r-=a-Si.screenH}t._x=e.x+(i.x*Si._ui.SCALE|0)+(n*Si._ui.SCALE|0),t._y=e.y+(i.y*Si._ui.SCALE|0)+(r*Si._ui.SCALE|0),t._w=i.width*Si._ui.SCALE|0;var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+(i.width*Si._ui.SCALE|0)/2,t._y+(i.height*Si._ui.SCALE|0)/2),i.type){case 0:var l=t.ops.font,u=t.fontSize,h=t.t.TEXT_COL;null!=i.asset&&Bt.endsWith(i.asset,".ttf")&&(t.ops.font=Si.getAsset(e,i.asset)),t.fontSize=i.height*Si._ui.SCALE|0,t.t.TEXT_COL=i.color_text,t.text(i.text),t.ops.font=l,t.fontSize=u,t.t.TEXT_COL=h;break;case 1:var A=Si.getAsset(e,i.asset),c=null!=i.asset&&Bt.endsWith(i.asset,".ttf");if(null!=A&&!c){t.imageScrollAlign=!1;var d=null!=i.color?i.color:-1;if(3==t.image(A,d,i.height*Si._ui.SCALE|0)){var _=i.event;null!=_&&""!=_&&Si.events.push(_)}t.imageScrollAlign=!0}break;case 2:var f=t.t.BUTTON_H;if(t.t.BUTTON_H=i.height*Si._ui.SCALE|0,t.t.BUTTON_COL=i.color,t.t.BUTTON_TEXT_COL=i.color_text,t.t.BUTTON_HOVER_COL=i.color_hover,t.t.BUTTON_PRESSED_COL=i.color_press,t.button(i.text)){var g=i.event;null!=g&&""!=g&&Si.events.push(g)}t.t.BUTTON_H=f;break;case 3:break;case 6:t.t.TEXT_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.check(Si.h.nest(i.id),i.text);break;case 7:t.t.TEXT_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.inlineRadio(Si.h.nest(i.id),i.text.split(";"));break;case 8:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.SEPARATOR_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.combo(Si.h.nest(i.id),i.text.split(";"));break;case 9:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.slider(Si.h.nest(i.id),i.text,0,1,!0);break;case 10:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.textInput(Si.h.nest(i.id),i.text);break;case 11:var p=t.g.get_color();t.g.set_color(i.color),t.g.fillRect(t._x,t._y,t._w,i.height*Si._ui.SCALE|0),t.g.set_color(p);break;case 12:var v=t.g.get_color();t.g.set_color(i.color),t.g.drawRect(t._x,t._y,t._w,i.height*Si._ui.SCALE|0,i.strength),t.g.set_color(v);break;case 13:var m=t.g.get_color();t.g.set_color(i.color),re.fillCircle(t.g,t._x+(i.width*Si._ui.SCALE|0)/2,t._y+(i.height*Si._ui.SCALE|0)/2,t._w/2),t.g.set_color(m);break;case 14:var w=t.g.get_color();t.g.set_color(i.color),re.drawCircle(t.g,t._x+(i.width*Si._ui.SCALE|0)/2,t._y+(i.height*Si._ui.SCALE|0)/2,t._w/2,i.strength),t.g.set_color(w);break;case 15:var b=t.g.get_color();t.g.set_color(i.color),t.g.fillTriangle(t._x+t._w/2,t._y,t._x,t._y+(i.height*Si._ui.SCALE|0),t._x+t._w,t._y+(i.height*Si._ui.SCALE|0)),t.g.set_color(b);break;case 16:var S=t.g.get_color();t.g.set_color(i.color),t.g.drawLine(t._x+t._w/2,t._y,t._x,t._y+(i.height*Si._ui.SCALE|0),i.strength),t.g.drawLine(t._x,t._y+(i.height*Si._ui.SCALE|0),t._x+t._w,t._y+(i.height*Si._ui.SCALE|0),i.strength),t.g.drawLine(t._x+t._w,t._y+(i.height*Si._ui.SCALE|0),t._x+t._w/2,t._y,i.strength),t.g.set_color(S);break;case 17:var y=t.g.get_color();t.g.set_color(i.color);var x=i.progress_at,E=i.progress_total;t.g.drawRect(t._x,t._y,t._w,i.height*Si._ui.SCALE|0,i.strength),t.g.fillRect(t._x,t._y,t._w/E*Math.min(x,E),i.height*Si._ui.SCALE|0),t.g.set_color(y);break;case 18:var T=t.g.get_color(),B=i.progress_at,k=i.progress_total;t.g.set_color(i.color),re.drawArc(t.g,t._x+(i.width*Si._ui.SCALE|0)/2,t._y+(i.height*Si._ui.SCALE|0)/2,t._w/2,-Math.PI/2,2*Math.PI/k*B-Math.PI/2,i.strength),t.g.set_color(-1513499),re.fillCircle(t.g,t._x+(i.width*Si._ui.SCALE|0)/2,t._y+(i.height*Si._ui.SCALE|0)/2,t._w/2-10),t.g.set_color(T)}if(null!=i.children)for(var C=0,I=i.children;C<I.length;){var L=I[C];++C,Si.drawElement(t,e,Si.elemById(e,L),i.x+n,i.y+r)}o&&t.g.popTransformation()}},Si.getText=function(t,e){return e.text},Si.getAsset=function(t,e){for(var i=0,n=t.assets;i<n.length;){var r=n[i];if(++i,r.name==e)return Si.assetMap.h[r.id]}return null},Si.getElementId=function(t){if(-1==Si.elemId)for(var e=0,i=t.elements;e<i.length;){var n=i[e];++e,Si.elemId<n.id&&(Si.elemId=n.id)}return++Si.elemId},Si.getAssetId=function(t){if(-1==Si.assetId)for(var e=0,i=t.assets;e<i.length;){var n=i[e];++e,Si.assetId<n.id&&(Si.assetId=n.id)}return++Si.assetId},Si.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var r=n[i];if(++i,r.id==e)return r}return null},Si.scaled=function(t){return t*Si._ui.SCALE|0};var yi=function(){};(y["zui.Ext"]=yi).__name__=!0,yi.floatInput=function(t,e,i,n){null==n&&(n=0),null==i&&(i=""),e.text=null==e.value?"null":""+e.value;var r=t.textInput(e,i,n);return e.value=parseFloat(r),e.value},yi.list=function(t,e,i,n){var r=0;null==n&&(n={});for(var s=null!=n.addCb?n.addCb:function(t){i.push(t)},a=null!=n.removeCb?n.removeCb:function(t){i.splice(t,1)},o=null!=n.getNameCb?n.getNameCb:function(t){return i[t]},l=null!=n.setNameCb?n.setNameCb:function(t,e){i[t]=e},u=null!=n.getLabelCb?n.getLabelCb:function(t){return""},h=n.itemDrawCb,A=null!=n.showRadio&&n.showRadio,c=null==n.editable||n.editable,d=null==n.showAdd||n.showAdd,_=null!=n.addLabel?n.addLabel:"Add",f=0;f<i.length;){A?(t.row([.12,.68,.2]),t.radio(e.nest(0),f,"")&&(r=f)):t.row([.8,.2]);var g=e.nest(f);g.text=o(f),c?l(f,t.textInput(g,u(f))):t.text(o(f)),t.button("X")?a(f):++f,null!=h&&h(g.nest(f),f-1)}return d&&t.button(_)&&s("untitled"),r},yi.panelList=function(t,e,i,n,r,s,a,o,l,u,h){null==h&&(h="Add"),null==u&&(u=!0),null==l&&(l=!0),null==n&&(n=function(t){i.push(t)}),null==r&&(r=function(t){i.splice(t,1)}),null==s&&(s=function(t){return i[t]}),null==a&&(a=function(t,e){i[t]=e});for(var A=0;A<i.length;){t.row([.12,.68,.2]);var c=t.panel(e.nest(A),"",0),d=e.nest(A);l?a(A,t.textInput(d,s(A))):t.text(s(A)),t.button("X")?r(A):++A,null!=o&&c&&o(d.nest(A),A-1)}u&&t.button(h)&&n("untitled")},yi.colorPicker=function(t,e,i){null==i&&(i=!1);var n=t.slider(e.nest(0,{value:.00392156862745098*((16711680&e.color)>>>16)}),"R",0,1,!0),r=t.slider(e.nest(1,{value:.00392156862745098*((65280&e.color)>>>8)}),"G",0,1,!0),s=t.slider(e.nest(2,{value:.00392156862745098*(255&e.color)}),"B",0,1,!0),a=.00392156862745098*(e.color>>>24);i&&(a=t.slider(e.nest(3,{value:a}),"A",0,1,!0));var o=B.fromFloats(n,r,s,a);return t.text("",2,o),o},yi.initPath=function(t,e){t.text="Windows"==e?"C:\\Users":"/"},yi.fileBrowser=function(t,e,i){null==i&&(i=!1);var n="/",r="ls ",s=It.get_systemId();"Windows"==s&&(r="dir /b ",i&&(r+="/ad "),n="\\",e.text=Bt.replace(e.text,"\\\\","\\"),e.text=Bt.replace(e.text,"\r","")),""==e.text&&yi.initPath(e,s);var a=Krom.getFilesLocation()+n+yi.dataPath+"dir.txt";e.text!=yi.lastPath&&Krom.sysCommand(r+'"'+e.text+'" > "'+a+'"'),yi.lastPath=e.text;var o=kt.ofData(Krom.loadBlob(a)).toString().split("\n"),l=e.text.indexOf("/"),u=e.text.indexOf("\\");(-1<l&&e.text.length-1>l||-1<u&&e.text.length-1>u)&&t.button("..",0)&&(e.text=e.text.substring(0,e.text.lastIndexOf(n)),2==e.text.length&&":"==e.text.charAt(1)&&(e.text+=n));for(var h=0;h<o.length;){var A=o[h];++h,""!=A&&"."!=A.charAt(0)&&t.button(A,0)&&(e.text.charAt(e.text.length-1)!=n&&(e.text+=n),e.text+=A)}return e.text},yi.colorWheel=function(t,e,i,n,r){null==r&&(r=!1),null==i&&(i=!1),null==n&&(n=t._w),yi.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),yi.ar);var s=yi.ar[0],a=yi.ar[1],o=yi.ar[2],l=.00392156862745098*(e.color>>>24),u=t._x,h=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(n-=t.t.SCROLL_W*t.SCALE|0,u+=(t.t.SCROLL_W*t.SCALE|0)/2),t.image(t.ops.color_wheel,B.fromFloats(o,o,o));var A=u+n/2,c=h+(t._y-h)/2,d=.7*n,_=d/2,f=A,g=c+a*_,p=s*(2*Math.PI),v=Math.cos(p)*(f-A)-Math.sin(p)*(g-c)+A,m=Math.sin(p)*(f-A)+Math.cos(p)*(g-c)+c;f=v,g=m,t.g.set_color(-16777216),t.g.fillRect(f-3*t.SCALE,g-3*t.SCALE,6*t.SCALE,6*t.SCALE),t.g.set_color(-1),t.g.fillRect(f-2*t.SCALE,g-2*t.SCALE,4*t.SCALE,4*t.SCALE),r&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var w=e.nest(0);if(w.value=Math.round(100*o)/100,o=t.slider(w,"Value",0,1,!0),w.changed&&(e.changed=t.changed=!0),i){var b=e.nest(1,{value:Math.round(100*l)/100});l=t.slider(b,"Alpha",0,1,!0),b.changed&&(e.changed=t.changed=!0)}var S=A+t._windowX,y=c+t._windowY;if(t.inputStarted&&t.getInputInRect(S-_,y-_,d,d)&&(yi.wheelSelectedHande=e),t.inputReleased&&(yi.wheelSelectedHande=null),t.inputDown&&yi.wheelSelectedHande==e){var x=S-t.inputX,E=y-t.inputY;a=Math.min(Math.sqrt(x*x+E*E),_)/_;var T=Math.atan2(t.inputX-S,t.inputY-y);T<0&&(T=Math.PI+(Math.PI-Math.abs(T))),s=(T=2*Math.PI-T)/(2*Math.PI),e.changed=t.changed=!0}return yi.hsvToRgb(s,a,o,yi.ar),e.color=B.fromFloats(yi.ar[0],yi.ar[1],yi.ar[2],l),t.text("",2,e.color),e.color},yi.dist=function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},yi.fract=function(t){return t-(0|t)},yi.mix=function(t,e,i){return t*(1-i)+e*i},yi.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},yi.step=function(t,e){return e<t?0:1},yi.hsvToRgb=function(t,e,i,n){var r=t+1,s=Math.abs(6*(r-(0|r))-3),a=t+.6666666666666666,o=Math.abs(6*(a-(0|a))-3),l=t+.3333333333333333,u=Math.abs(6*(l-(0|l))-3);n[0]=i*(1-e+Math.min(Math.max(s-1,0),1)*e),n[1]=i*(1-e+Math.min(Math.max(o-1,0),1)*e),n[2]=i*(1-e+Math.min(Math.max(u-1,0),1)*e)},yi.rgbToHsv=function(t,e,i,n){var r=e<i?0:1,s=i*(1-r)+e*r,a=e<i?0:1,o=e*(1-a)+i*a,l=e<i?0:1,u=e<i?0:1,h=t<s?0:1,A=s*(1-h)+t*h,c=t<s?0:1,d=o*(1-c)+o*c,_=t<s?0:1,f=(.6666666666666666*(1-u)+-.3333333333333333*u)*(1-_)+(-1*(1-l)+0*l)*_,g=t<s?0:1,p=t*(1-g)+s*g,v=A-Math.min(p,d);n[0]=Math.abs(f+(p-d)/(6*v+1e-10)),n[1]=v/(1e-10+A),n[2]=A};function xi(){}(y["zui.Id"]=xi).__name__=!0;var Ei=function(){};(y["zui.Themes"]=Ei).__name__=!0;var Ti=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipWait=!1,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImgMaxWidth=null,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this._windowY=0,this._windowX=0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isEscapeDown=!1,this.isDeleteDown=!1,this.isBackspaceDown=!1,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.alwaysRedraw=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.enabled=!0,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=Ei.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),null==Ti.copyReceiver&&(Ti.copyReceiver=this,It.notifyOnCutCopyPaste(Bi(this,this.onCut),Bi(this,this.onCopy),Bi(this,this.onPaste)),It.notifyOnFrames(function(t){(Ti.isCopy||Ti.isPaste)&&1<++Ti.copyFrame&&(Ti.isCopy=Ti.isCut=Ti.isPaste=!1,Ti.copyFrame=0)}));var e=Re.createTextVertexStructure();this.rtTextPipeline=Re.createTextPipeline(e),this.rtTextPipeline.alphaBlendSource=1,this.rtTextPipeline.compile()};function Bi(t,e){return null==e?null:(null==e.__id__&&(e.__id__=n.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}(y["zui.Zui"]=Ti).__name__=!0,Ti.prototype={isScrolling:null,isTyping:null,enabled:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,imageInvertY:null,scrollEnabled:null,alwaysRedraw:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,isBackspaceDown:null,isDeleteDown:null,isEscapeDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,rtTextPipeline:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipImgMaxWidth:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipWait:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=this.t.FONT_SIZE*this.ops.scaleFactor|0;var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.SCALE-e)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.ARROW_SIZE*this.SCALE)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.SCALE)/this.SCALE,this.buttonOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.BUTTON_H*this.SCALE)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=C.createRenderTarget(this.t.CHECK_SELECT_SIZE*this.SCALE|0,this.t.CHECK_SELECT_SIZE*this.SCALE|0,null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},remove:function(){this.ops.autoNotifyInput&&this.unregisterInput()},registerInput:function(){je.get().notifyWindowed(this.ops.khaWindowId,Bi(this,this.onMouseDown),Bi(this,this.onMouseUp),Bi(this,this.onMouseMove),Bi(this,this.onMouseWheel)),qe.get().notify(Bi(this,this.onKeyDown),Bi(this,this.onKeyUp),Bi(this,this.onKeyPress)),this.inputRegistered=!0},unregisterInput:function(){je.get().removeWindowed(this.ops.khaWindowId,Bi(this,this.onMouseDown),Bi(this,this.onMouseUp),Bi(this,this.onMouseMove),Bi(this,this.onMouseWheel)),qe.get().remove(Bi(this,this.onKeyDown),Bi(this,this.onKeyUp),Bi(this,this.onKeyPress)),this.endInput(),this.inputX=this.inputY=0,this.inputRegistered=!1},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),""!=this.tooltipText||null!=this.tooltipImg?(this.inputChanged()&&(this.tooltipShown=!1,this.tooltipWait=0==this.inputDX&&0==this.inputDY),this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=D.time()),!this.tooltipWait&&1<D.time()-this.tooltipTime&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.endInput(),this.tabPressedHandle=null},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,Ti.textToPaste=""},beginLayout:function(t,e,i,n){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=n,this._x=e,this._y=i,this._w=n},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,i,n,r){var s=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(s,a,n,r)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,n,r,s){return null==s&&(s=!1),null!=t.texture&&n==t.texture.get_width()&&r==t.texture.get_height()||this.resize(t,n,r,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=n,this._windowH=r,this.windowHeader=0,this.windowDirty(t,e,i,n,r)&&(t.redraws=2),null!=Ti.onBorderHover&&(this.getInputInRect(this._windowX-4,this._windowY,8,this._windowH)?Ti.onBorderHover(t,0):this.getInputInRect(this._windowX+this._windowW-4,this._windowY,8,this._windowH)?Ti.onBorderHover(t,1):this.getInputInRect(this._windowX,this._windowY-4,this._windowW,8)?Ti.onBorderHover(t,2):this.getInputInRect(this._windowX,this._windowY+this._windowH-4,this._windowW,8)&&Ti.onBorderHover(t,3)),!(t.redraws<=0)&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(n=this.t.ELEMENT_W*this.SCALE|0),this._w=t.scrollEnabled?n-(this.t.SCROLL_W*this.SCALE|0):n,this._h=r,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=s)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=0|this.inputDX,t.dragY+=0|this.inputDY),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var i=this._y-e.scrollOffset;if(i<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var n=i-this._windowH,r=-e.scrollOffset/n,s=this._windowH*Math.abs(this._windowH/i);s=Math.max(s,this.t.ELEMENT_H*this.SCALE);var a=this._windowH-s,o=n/a,l=a*r,u=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.SCALE|0),l+this._windowY,this.t.SCROLL_W*this.SCALE|0,s);this.inputStarted&&u&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*o,i):0!=this.inputWheelDelta&&null==this.comboSelectedHandle&&this.getInputInRect(this._windowX,this._windowY,this._windowW,this._windowH)&&this.scroll(this.inputWheelDelta*(this.t.ELEMENT_H*this.SCALE),i),0<e.scrollOffset?e.scrollOffset=0:i+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-i),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.SCALE|0),this._windowY,this.t.SCROLL_W*this.SCALE|0,this._windowH),this.g.set_color(this.t.ACCENT_COL);var h=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.SCALE|0),this._windowY,this.t.SCROLL_W*this.SCALE|0,this._windowH)||e.scrolling?this.t.SCROLL_W*this.SCALE|0:(this.t.SCROLL_W*this.SCALE|0)/3;this.g.fillRect(this._windowW-h-this.scrollAlign,l,h,s)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,(Ti.alwaysRedrawWindow||-4<e.redraws)&&(t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),t&&this.globalG.end(),e.redraws<=0&&e.redraws--)}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,tab:function(t,e){null==this.tabNames&&(this.tabNames=[],this.tabHandle=t,this.windowHeader+=this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this.restoreX=this.inputX,this.restoreY=this.inputY,this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeader)&&(this.inputX=this.inputY=-1)),this.tabNames.push(e);var i=t.position==this.tabNames.length-1;return i&&this.endElement(),i},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this.t.BUTTON_H*this.SCALE*1.1|0,i=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.tabHandle.changed=!1,this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+e+2),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+e+2,this._windowW-2*this.buttonOffsetY,this.t.LINE_STRENGTH*this.SCALE),this._y+=2;for(var n=0,r=this.tabNames.length;n<r;){var s=n++;this._x=t,this._w=this.ops.font.width(this.fontSize,this.tabNames[s])+2*this.buttonOffsetY+14*this.SCALE|0;var a=this.getReleased(),o=this.getPushed(),l=this.getHover();if(a){var u=this.tabHandle.nest(this.tabHandle.position);u.scrollOffset=this.currentWindow.scrollOffset,u=this.tabHandle.nest(s),this.tabScroll=u.scrollOffset,this.tabHandle.position=s,this.currentWindow.redraws=3,this.tabHandle.changed=!0}var h=this.tabHandle.position==s;this.g.set_color(h?this.t.WINDOW_BG_COL:o||l?this.t.BUTTON_HOVER_COL:this.t.SEPARATOR_COL),t+=this._w+1;var A=this.g,c=this._x+this.buttonOffsetY,d=this._y+this.buttonOffsetY,_=this._w,f=0;0==f&&(f=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),A.fillRect(c,d,_,e),this.g.set_color(h?this.t.BUTTON_TEXT_COL:this.t.LABEL_COL),this.drawString(this.g,this.tabNames[s],this.t.TEXT_OFFSET,0,0),h&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+e,this._w-1,this.t.LINE_STRENGTH*this.SCALE))}this._x=0,this._y=i,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(this.t.SCROLL_W*this.SCALE|0):this._windowW)}},panel:function(t,e,i,n){return null==n&&(n=!1),null==i&&(i=0),this.isVisible(this.t.ELEMENT_H*this.SCALE)&&(this.getReleased()&&(t.selected=!t.selected),0<i&&(this.g.set_color(this.t.PANEL_BG_COL),this.g.fillRect(this._x,this._y,this._w,this.t.ELEMENT_H*this.SCALE)),n?this.drawTree(t.selected):this.drawArrow(t.selected),this.g.set_color(this.t.PANEL_TEXT_COL),this.g.set_opacity(1),this.drawString(this.g,e,this.titleOffsetX,0)),this.endElement(),t.selected},image:function(t,e,i,n,r,s,a){null==a&&(a=0),null==s&&(s=0),null==r&&(r=0),null==n&&(n=0),null==e&&(e=-1);var o=(0<s?s:t.get_width())*this.SCALE,l=(0<a?a:t.get_height())*this.SCALE,u=Math.min(o,this._w),h=this._x;if(this.imageScrollAlign&&(u=Math.min(o,this._w-2*this.buttonOffsetY),h+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var A=-1==this.curRatio?1:this.ratios[this.curRatio];u-=(this.t.SCROLL_W*this.SCALE|0)*A,h+=(this.t.SCROLL_W*this.SCALE|0)*A/2}var c=null==i?u/o:i/l;if(null==i?i=l*c:u=o*c,!this.isVisible(i))return this.endElement(i),0;var d=this.getStarted(i),_=this.getPushed(i),f=this.getReleased(i);this.getHover(i);this.g.set_color(e),this.enabled||this.fadeColor();var g=i;return 0<s?this.imageInvertY?this.g.drawScaledSubImage(t,n,r,s,a,h,this._y+g,u,-g):this.g.drawScaledSubImage(t,n,r,s,a,h,this._y,u,g):this.imageInvertY?this.g.drawScaledImage(t,h,this._y+g,u,-g):this.g.drawScaledImage(t,h,this._y,u,g),this.endElement(i),d?1:f?3:_?2:0},text:function(t,e,i){if(null==i&&(i=0),null==e&&(e=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),0;var n=this.getStarted(),r=this.getPushed(),s=this.getReleased();this.getHover();return 0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),this.endElement(),n?1:s?3:r?2:0},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed&&(this.tabPressed=!1,this.isKeyDown=!1),this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=qe.get()&&qe.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=xt.substr(e,0,this.cursorX-1)+xt.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=xt.substr(e,0,this.highlightAnchor)+xt.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=xt.substr(e,0,this.cursorX)+xt.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=xt.substr(e,0,this.cursorX)+xt.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=xt.substr(e,0,this.highlightAnchor)+xt.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=xt.substr(e,0,this.cursorX)+xt.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&38!=this.key&&40!=this.key&&null!=this.char&&""!=this.char&&32<=xt.cca(this.char,0)&&(e=xt.substr(e,0,this.highlightAnchor)+this.char+xt.substr(e,this.cursorX,null),this.cursorX=this.cursorX+1>e.length?e.length:this.cursorX+1),this.isShiftDown&&(37==this.key||39==this.key||16==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=Ti.textToPaste&&(e=xt.substr(e,0,this.highlightAnchor)+Ti.textToPaste+xt.substr(e,this.cursorX,null),this.cursorX+=Ti.textToPaste.length,this.highlightAnchor=this.cursorX,Ti.textToPaste=""),this.highlightAnchor==this.cursorX?Ti.textToCopy=e:this.highlightAnchor<this.cursorX?Ti.textToCopy=e.substring(this.highlightAnchor,this.cursorX):Ti.textToCopy=e.substring(this.cursorX,this.highlightAnchor),Ti.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=xt.substr(e,0,this.highlightAnchor)+xt.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=xt.substr(e,0,this.cursorX)+xt.substr(e,this.highlightAnchor,e.length));var i=this.t.TEXT_OFFSET,n=this.t.ELEMENT_H*this.SCALE,r=n-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var s=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(s=this.highlightAnchor,a=this.cursorX);var o=xt.substr(e,s,a-s),l=this.g.get_font().width(this.g.get_fontSize(),o),u=this.g.get_font().width(this.g.get_fontSize(),xt.substr(e,0,s)),h=0==t?this._x+u+i:this._x+this._w-l-i;2==t&&(h-=this.g.get_font().width(this.g.get_fontSize(),xt.substr(e,a,e.length))),this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(h,this._y+this.cursorY*n+1.5*this.buttonOffsetY,l*this.SCALE,r)}if(D.time()%1<.5){var A=0==t?xt.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),c=this.g.get_font().width(this.g.get_fontSize(),A),d=0==t?this._x+c+i:this._x+this._w-c-i;this.g.set_color(this.t.TEXT_COL),this.g.fillRect(d,this._y+this.cursorY*n+1.5*this.buttonOffsetY,this.SCALE,r)}this.textSelectedCurrentText=e},textInput:function(t,e,i){if(null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.text;var n=this.getHover();n&&null!=Ti.onTextHover&&Ti.onTextHover(),this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this._x+this.buttonOffsetY,o=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,u=this.t.BUTTON_H*this.SCALE,h=0;0==h&&(h=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(a,o,l,u):r.drawRect(a,o,l,u,h);var A=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&A&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var c=2==i?0:2,d=0==c?7:0;this.drawString(this.g,e,d,0,c)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelectedCurrentText,null,0,i),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=qe.get()&&qe.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e,i){if(null==i&&(i=""),null==e&&(e=1),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),!1;var n=this.getReleased(),r=this.getPushed(),s=this.getHover();n&&(this.changed=!0),this.g.set_color(r?this.t.BUTTON_PRESSED_COL:s?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var a=this.g,o=this.t.FILL_BUTTON_BG,l=this._x+this.buttonOffsetY,u=this._y+this.buttonOffsetY,h=this._w-2*this.buttonOffsetY,A=this.t.BUTTON_H*this.SCALE,c=0;return 0==c&&(c=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),o?a.fillRect(l,u,h,A):a.drawRect(l,u,h,A,c),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),""!=i&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,this.t.TEXT_OFFSET,0,2==e?0:2)),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawRadio(t.position==e,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawInlineRadio(e[t.position],i),this.endElement(),t.position},combo:function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=!1),null==i&&(i=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;if(this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=r,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=this._x+this._windowX|0,this.comboSelectedY=this._y+this._windowY+this.t.ELEMENT_H*this.SCALE|0,this.comboSelectedW=0|this._w),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()){this.g.set_color(this.t.ACCENT_HOVER_COL);var s=this.g,a=this.t.FILL_ACCENT_BG,o=this._x+this.buttonOffsetY,l=this._y+this.buttonOffsetY,u=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.SCALE,A=0;0==A&&(A=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),a?s.fillRect(o,l,u,h):s.drawRect(o,l,u,h,A)}else{this.g.set_color(this.t.ACCENT_COL);var c=this.g,d=this.t.FILL_ACCENT_BG,_=this._x+this.buttonOffsetY,f=this._y+this.buttonOffsetY,g=this._w-2*this.buttonOffsetY,p=this.t.BUTTON_H*this.SCALE,v=0;0==v&&(v=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),d?c.fillRect(_,f,g,p):c.drawRect(_,f,g,p,v)}var m=this._x+this._w-this.arrowOffsetX-8,w=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(m,w,m+this.t.ARROW_SIZE*this.SCALE,w,m+this.t.ARROW_SIZE*this.SCALE/2,w+this.t.ARROW_SIZE*this.SCALE/2),n&&""!=i&&(0==r&&(this._x-=15),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,null,0,0==r?2:0),0==r&&(this._x+=15)),2==r&&(this._x-=15),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e[t.position],null,0,r),2==r&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,n,r,s,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==s&&(s=100),null==r&&(r=!1),null==n&&(n=1),null==i&&(i=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var u=n-i,h=this._x+this._windowX+this.buttonOffsetY,A=u/(this._w-2*this.buttonOffsetY),c=i+(this.inputX-h)*A;t.value=Math.round(c*s)/s,t.value<i?t.value=i:t.value>n&&(t.value=n),t.changed=this.changed=!0}var d=this.getHover();this.drawSlider(t.value,i,n,r,d),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t));var _=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(_),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,_):this.drawString(this.g,this.textSelectedCurrentText,null,0,_)),this.endElement(),t.value},separator:function(t,e){null==e&&(e=!0),null==t&&(t=4),this.isVisible(this.t.ELEMENT_H*this.SCALE)&&e&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(this._x,this._y,this._w,t*this.SCALE)),this._y+=t*this.SCALE},tooltip:function(t){this.tooltipText=t,this.tooltipY=this._y+this._windowY},tooltipImage:function(t,e){this.tooltipImg=t,this.tooltipImgMaxWidth=e,this.tooltipInvertY=this.imageInvertY,this.tooltipY=this._y+this._windowY},drawArrow:function(t){var e=this._x+this.arrowOffsetX,i=this._y+this.arrowOffsetY;this.g.set_color(this.t.ARROW_COL),t?this.g.fillTriangle(e,i,e+this.t.ARROW_SIZE*this.SCALE,i,e+this.t.ARROW_SIZE*this.SCALE/2,i+this.t.ARROW_SIZE*this.SCALE):this.g.fillTriangle(e,i,e,i+this.t.ARROW_SIZE*this.SCALE,e+this.t.ARROW_SIZE*this.SCALE,i+this.t.ARROW_SIZE*this.SCALE/2)},drawTree:function(t){var e=7*this.SCALE,i=this._x+this.arrowOffsetX+1,n=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.ARROW_COL),t?this.g.fillRect(i,n+e/2-1,e,e/8):(this.g.fillRect(i,n+e/2-1,e,e/8),this.g.fillRect(i+e/2-1,n,e/8,e))},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,n=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.SCALE,o=this.t.CHECK_SIZE*this.SCALE,l=0;if(0==l&&(l=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(i,n,a,o):r.drawRect(i,n,a,o,l),t){this.g.set_color(-1),this.enabled||this.fadeColor();var u=this.t.CHECK_SELECT_SIZE*this.SCALE|0;this.g.drawScaledImage(this.checkSelectImage,i+this.checkSelectOffsetX,n+this.checkSelectOffsetY,u,u)}},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,n=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.SCALE,o=this.t.CHECK_SIZE*this.SCALE,l=0;0==l&&(l=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(i,n,a,o):r.drawRect(i,n,a,o,l),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.enabled||this.fadeColor(),this.g.fillRect(i+this.radioSelectOffsetX,n+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.SCALE,this.t.CHECK_SELECT_SIZE*this.SCALE))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)):(this.g.set_color(this.t.ACCENT_COL),this.enabled||this.fadeColor(),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,i,n,r){var s=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=this.g,u=this.t.FILL_ACCENT_BG,h=this.t.BUTTON_H*this.SCALE,A=0;0==A&&(A=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),u?l.fillRect(s,a,o,h):l.drawRect(s,a,o,h,A),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var c=(t-e)/(i-e),d=8*this.SCALE,_=n?s:s+(o-d)*c,f=n?o*c:d;f=Math.max(Math.min(f,o),0);var g=this.g,p=this.t.BUTTON_H*this.SCALE,v=0;0==v&&(v=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),g.fillRect(_,a,f,p)},drawCombo:function(){var t=this.g;this.globalG.set_color(this.t.SEPARATOR_COL);var e=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE|0,i=(this.comboSelectedTexts.length+1)*e;this.globalG.begin(!1);var n=this.comboSelectedY+i>It.windowHeight(),r=n?this.comboSelectedY-i-(this.t.ELEMENT_H*this.SCALE|0):this.comboSelectedY;this.globalG.fillRect(this.comboSelectedX,r,this.comboSelectedW,i),this.beginLayout(this.globalG,this.comboSelectedX,r,this.comboSelectedW),n&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2),this._y+=e,this.fill(0,0,this._w,this.SCALE,this.t.ACCENT_SELECT_COL)),this.inputEnabled=!0;for(var s=this.t.BUTTON_COL,a=0,o=this.comboSelectedTexts.length;a<o;){var l=a++,u=n?this.comboSelectedTexts.length-1-l:l;if(this.t.BUTTON_COL=u==this.comboSelectedHandle.position?this.t.PANEL_BG_COL:this.t.SEPARATOR_COL,this.button(this.comboSelectedTexts[u],this.comboSelectedAlign)){this.comboToSubmit=u,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.t.BUTTON_COL=s,n||(this.fill(0,0,this._w,this.SCALE,this.t.ACCENT_SELECT_COL),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2)),!this.inputReleased&&!this.isEscapeDown||Ti.comboFirst?Ti.comboFirst=!1:(this.comboSelectedHandle=null,Ti.comboFirst=!0),this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var n=t[i];++i;var r=this.ops.font.width(this.fontSize,n);e<r&&(e=r)}this.tooltipX=Math.min(this.tooltipX,It.windowWidth()-e-20),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.t.ELEMENT_H*this.SCALE*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var s=0,a=t.length;s<a;){var o=s++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}this.globalG.end()},drawTooltipImage:function(){var t=this.tooltipImg.get_width();null!=this.tooltipImgMaxWidth&&t>this.tooltipImgMaxWidth&&(t=this.tooltipImgMaxWidth);var e=this.tooltipImg.get_height()*(t/this.tooltipImg.get_width());this.tooltipX=Math.min(this.tooltipX,It.windowWidth()-t-20),this.tooltipY=Math.min(this.tooltipY,It.windowHeight()-e-20),this.globalG.set_color(-16777216),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,t,e),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+e,t,-e):this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY,t,e),this.globalG.end()},drawString:function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=this._w/(this.fontSize/2|0)|0;e.length>s&&(e=e.substring(0,s)+".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==r?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==r&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.t.TEXT_OFFSET),this.enabled||this.fadeColor(),t.set_pipeline(this.rtTextPipeline),t.drawString(e,this._x+i,this._y+this.fontOffsetY+n),t.set_pipeline(null)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=this.wBeforeSplit*this.ratios[this.curRatio]|0):this._x+=this._w+this.t.ELEMENT_OFFSET*this.SCALE:this._y+=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=this._w*t[this.curRatio]|0},indent:function(){this._x+=this.t.TAB_W*this.SCALE|0,this._w-=this.t.TAB_W*this.SCALE|0},unindent:function(){this._x-=this.t.TAB_W*this.SCALE|0,this._w+=this.t.TAB_W*this.SCALE|0},fadeColor:function(){this.g.set_color(B.fromFloats(.00392156862745098*((16711680&this.g.get_color())>>>16),.00392156862745098*((65280&this.g.get_color())>>>8),.00392156862745098*(255&this.g.get_color()),.25))},fill:function(t,e,i,n,r){this.g.set_color(r),this.enabled||this.fadeColor(),this.g.fillRect(this._x+t*this.SCALE,this._y+e*this.SCALE,i*this.SCALE,n*this.SCALE),this.g.set_color(-1)},rect:function(t,e,i,n,r,s){null==s&&(s=1),this.g.set_color(r),this.enabled||this.fadeColor(),this.g.drawRect(this._x+t*this.SCALE,this._y+e*this.SCALE,i*this.SCALE,n*this.SCALE,s),this.g.set_color(-1)},drawRect:function(t,e,i,n,r,s,a){null==a&&(a=0),0==a&&(a=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),e?t.fillRect(i,n,r,s):t.drawRect(i,n,r,s,a)},isVisible:function(t){return null==this.currentWindow||0<this._y+t&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.enabled&&this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.enabled&&this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.enabled&&this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),!!(this.enabled&&this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),this.isHovered=this.enabled&&this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,n,r){return null==r&&(r=1),!!(this.enabled&&this.inputEnabled&&this.inputX>=t*r&&this.inputX<(t+i)*r&&this.inputY>=e*r)&&this.inputY<(e+n)*r},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var n=e*this.ops.scaleTexture|0,r=i*this.ops.scaleTexture|0;this.setInputPosition(n,r),this.inputInitialX=n,this.inputInitialY=r},onMouseUp:function(t,e,i){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&i==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(e*this.ops.scaleTexture|0,i*this.ops.scaleTexture|0),this.deselectText()},onMouseMove:function(t,e,i,n){this.setInputPosition(t*this.ops.scaleTexture|0,e*this.ops.scaleTexture|0)},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 8:this.isBackspaceDown=!0;break;case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 27:this.isEscapeDown=!0;break;case 32:this.char=" ";break;case 46:this.isDeleteDown=!0}},onKeyUp:function(t){switch(t){case 8:this.isBackspaceDown=!1;break;case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1;break;case 27:this.isEscapeDown=!1;break;case 46:this.isDeleteDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return Ti.isCut=!0,this.onCopy()},onCopy:function(){return Ti.isCopy=!0,Ti.textToCopy},onPaste:function(t){Ti.isPaste=!0,Ti.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return this.t.SCROLL_W*this.SCALE|0},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},TAB_W:function(){return this.t.TAB_W*this.SCALE|0},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},FLASH_SPEED:function(){return.5},TOOLTIP_DELAY:function(){return 1},resize:function(t,e,i,n){null==n&&(n=0),t.redraws=2,null!=t.texture&&t.texture.unload(),e<1&&(e=1),i<1&&(i=1),t.texture=C.createRenderTarget(e,i,0,0,1,n),t.texture.get_g2().set_imageScaleQuality(oe.High)},__class__:Ti},void 0===n.$haxeUID&&(n.$haxeUID=0),y.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=y.String=String,String.__name__=!0,y.Array=Array,Array.__name__=!0,Date.prototype.__class__=y.Date=Date,Date.__name__="Date";var ki={},Ci={},Ii=Number,Li=Boolean,Ni={},Pi={};et.count=0;var Ri={};Object.defineProperty(ne.prototype,"message",{get:function(){return String(this.val)}}),p.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=m.sliceImpl),yt.windowW=yt.defaultWindowW=240,yt.coffX=70,yt.coffY=50,yt.modalW=625,yt.modalH=545,yt.modalHeaderH=66,yt.modalRectW=625,yt.modalRectH=545,yt.path="/",Et.cwd="",J.DEFAULT_RESOLVER=new a,J.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",_.helper=new DataView(new ArrayBuffer(8)),Ct.images=new q,Ct.sounds=new j,Ct.blobs=new Z,Ct.fonts=new nt,Ct.videos=new rt,B.Black=-16777216,B.White=-1,B.Red=-65536,B.Blue=-16776961,B.Green=-16711936,B.Magenta=-65281,B.Yellow=-256,B.Cyan=-16711681,B.Purple=-8388480,B.Pink=-16181,B.Orange=-23296,B.Transparent=0,B.invMaxChannelValue=.00392156862745098,b.displays=[],x.Default=new x(!1,!1,!1),D.timeWarpSaveTime=10,D.DIF_COUNT=3,D.maxframetime=.5,D.startTime=0,O.painter_colored_fragData0="s580:AAAARFhCQwKRAhCE2jyY1lWcLP2kpYQBAAAAsAEAAAUAAAA0AAAAjAAAAMAAAAD0AAAANAEAAFJERUZQAAAAAAAAAAAAAAAAAAAAHAAAAAAE::8AAQAAHAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOLAAAAAEAAAAIAAAAIAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFI4AAAAQAAAAA4AAABiEAAD8hAQAAAAAABlAAAD8iAQAAAAAAA2AAAF8iAQAAAAAABGHhAAAAAAAD4AAAFTVEFUdAAAAAIAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_colored_vertData0="s1314:AnZlcnRleENvbG9yAAB2ZXJ0ZXhQb3NpdGlvbgABASRHbG9iYWxzAAABcHJvamVjdGlvbk1hdHJpeAAAAAAAQAAAAAQERFhCQ5A:MgyGPthJiwcRz4ddIcQBAAAAlAMAAAUAAAA0AAAADAEAAFgBAACwAQAAGAMAAFJERUbQAAAAAQAAAEgAAAABAAAAHAAAAAAE:v8AAQAAnAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAJEdsb2JhbHMAq6urPAAAAAEAAABgAAAAQAAAAAAAAAAAAAAAeAAAAAAAAABAAAAAAgAAAIwAAAAAAAAAcHJvamVjdGlvbk1hdHJpeACrq6sDAAMABAAEAAAAAAAAAAAATWljcm9zb2Z0IChSKSBITFNMIFNoYWRlciBDb21waWxlciA2LjMuOTYwMC4xNjM4NACrq0lTR05EAAAAAgAAAAgAAAA4AAAAAAAAAAAAAAADAAAAAAAAAA8PAAA4AAAAAQAAAAAAAAADAAAAAQAAAAcHAABURVhDT09SRACrq6tPU0dOUAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPAAAAQQAAAAAAAAABAAAAAwAAAAEAAAAPAAAAVEVYQ09PUkQAU1ZfUG9zaXRpb24Aq6urU0hEUmABAABAAAEAWAAAAFkAAARGjiAAAAAAAAQAAABfAAAD8hAQAAAAAABfAAADchAQAAEAAABlAAAD8iAQAAAAAABnAAAE8iAQAAEAAAABAAAAaAAAAgIAAAA2AAAF8iAQAAAAAABGHhAAAAAAADYAAAVyABAAAAAAAEYSEAABAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAQAAABoAEAABAAAAOAAAB0IgEAABAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAQAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAABAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAALAAAAAgAAAAAAAAAEAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_image_fragData0="s931:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkMLuHx52DaqoPgbxVgoLcgLAQAAAKQCAAAFAAAANAAAANwAAAAoAQAAXAEAACgCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFLEAAAAQAAAADEAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAH8gAQAAAAAABGDhAAAAAAAEYeEAAAAAAAOAAAB3IgEAAAAAAARgIQAAAAAAD2HxAAAAAAADYAAAWCIBAAAAAAADoAEAAAAAAAPgAAAVNUQVR0AAAABQAAAAEAAAAAAAAAAwAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_image_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_text_fragData0="s894:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkN4eKkSkOMyc:NS8ppPD1BYAQAAAIgCAAAFAAAANAAAANwAAAAoAQAAXAEAAAwCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFKoAAAAQAAAACoAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAHgiAQAAAAAAAKABAAAAAAADoQEAAAAAAANgAABXIgEAAAAAAARhIQAAAAAAA%AAABU1RBVHQAAAAEAAAAAQAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_text_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_video_fragData0="s931:AAJfdGV4X3NhbXBsZXIAAHRleAAAAERYQkMLuHx52DaqoPgbxVgoLcgLAQAAAKQCAAAFAAAANAAAANwAAAAoAQAAXAEAACgCAABSREVGoAAAAAAAAAAAAAAAAgAAABwAAAAABP::AAEAAG0AAABcAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAGkAAAACAAAABQAAAAQAAAD:::::AAAAAAEAAAAMAAAAX3RleF9zYW1wbGVyAHRleABNaWNyb3NvZnQgKFIpIEhMU0wgU2hhZGVyIENvbXBpbGVyIDYuMy45NjAwLjE2Mzg0AKtJU0dORAAAAAIAAAAIAAAAOAAAAAAAAAAAAAAAAwAAAAAAAAAPDwAAOAAAAAEAAAAAAAAAAwAAAAEAAAADAwAAVEVYQ09PUkQAq6urT1NHTiwAAAABAAAACAAAACAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFNWX1RhcmdldACrq1NIRFLEAAAAQAAAADEAAABaAAADAGAQAAAAAABYGAAEAHAQAAAAAABVVQAAYhAAA:IQEAAAAAAAYhAAAzIQEAABAAAAZQAAA:IgEAAAAAAAaAAAAgEAAABFAAAJ8gAQAAAAAABGEBAAAQAAAEZ%EAAAAAAAAGAQAAAAAAA4AAAH8gAQAAAAAABGDhAAAAAAAEYeEAAAAAAAOAAAB3IgEAAAAAAARgIQAAAAAAD2HxAAAAAAADYAAAWCIBAAAAAAADoAEAAAAAAAPgAAAVNUQVR0AAAABQAAAAEAAAAAAAAAAwAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",O.painter_video_vertData0="s1454:A3RleFBvc2l0aW9uAAB2ZXJ0ZXhDb2xvcgABdmVydGV4UG9zaXRpb24AAgEkR2xvYmFscwAAAXByb2plY3Rpb25NYXRyaXgAAAAAAEAAAAAEBERYQkMYRgMBQiEp1Ksh8UKJ6SuGAQAAAPADAAAFAAAANAAAAAwBAABwAQAA4AEAAHQDAABSREVG0AAAAAEAAABIAAAAAQAAABwAAAAABP7:AAEAAJwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAACRHbG9iYWxzAKurqzwAAAABAAAAYAAAAEAAAAAAAAAAAAAAAHgAAAAAAAAAQAAAAAIAAACMAAAAAAAAAHByb2plY3Rpb25NYXRyaXgAq6urAwADAAQABAAAAAAAAAAAAE1pY3Jvc29mdCAoUikgSExTTCBTaGFkZXIgQ29tcGlsZXIgNi4zLjk2MDAuMTYzODQAq6tJU0dOXAAAAAMAAAAIAAAAUAAAAAAAAAAAAAAAAwAAAAAAAAADAwAAUAAAAAEAAAAAAAAAAwAAAAEAAAAPDwAAUAAAAAIAAAAAAAAAAwAAAAIAAAAHBwAAVEVYQ09PUkQAq6urT1NHTmgAAAADAAAACAAAAFAAAAAAAAAAAAAAAAMAAAAAAAAADwAAAFAAAAABAAAAAAAAAAMAAAABAAAAAwwAAFkAAAAAAAAAAQAAAAMAAAACAAAADwAAAFRFWENPT1JEAFNWX1Bvc2l0aW9uAKurq1NIRFKMAQAAQAABAGMAAABZAAAERo4gAAAAAAAEAAAAXwAAAzIQEAAAAAAAXwAAA:IQEAABAAAAXwAAA3IQEAACAAAAZQAAA:IgEAAAAAAAZQAAAzIgEAABAAAAZwAABPIgEAACAAAAAQAAAGgAAAICAAAANgAABfIgEAAAAAAARh4QAAEAAAA2AAAFMiAQAAEAAABGEBAAAAAAADYAAAVyABAAAAAAAEYSEAACAAAANgAABYIAEAAAAAAAAUAAAAAAgD8RAAAIEgAQAAEAAABGDhAAAAAAAEaOIAAAAAAAAgAAABEAAAgiABAAAQAAAEYOEAAAAAAARo4gAAAAAAADAAAAAAAABxIAEAABAAAAGgAQAAEAAAAKABAAAQAAADYAAAWCIBAAAgAAABoAEAABAAAAOAAAB0IgEAACAAAACgAQAAEAAAABQAAAAAAAPxEAAAgSIBAAAgAAAEYOEAAAAAAARo4gAAAAAAAAAAAAEQAACCIgEAACAAAARg4QAAAAAABGjiAAAAAAAAEAAAA%AAABU1RBVHQAAAAMAAAAAgAAAAAAAAAGAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",It.renderListeners=[],It.foregroundListeners=[],It.resumeListeners=[],It.pauseListeners=[],It.backgroundListeners=[],It.shutdownListeners=[],It.dropFilesListeners=[],W.maxGamepads=4,W.mouseLockListeners=[],z.windows=[],Y.None=0,Y.FeatureResizable=1,Y.FeatureMinimizable=2,Y.FeatureMaximizable=4,Y.FeatureBorderless=8,Y.FeatureOnTop=16,ct.disableGcInteractions=!1,ct.intBox=new ut(0),dt.channelCount=32,dt.lastAllocationCount=0,vt.POLY=79764919,St.INVALID_BITS=-1,Pt.EOP=-1,Pt.M__PI=3.141592653589793,Pt.DIVTAB_NUMER=32,Pt.DIVTAB_DENOM=64,Pt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Rt.NO_CODE=255,Rt.delay=0,Ut.PACKET_ID=1,Ut.PACKET_COMMENT=3,Ut.PACKET_SETUP=5,Xt.CONTINUED_PACKET=1,Xt.FIRST_PAGE=2,Xt.LAST_PAGE=4,Zt.MAX_CHANNELS=16,Zt.PUSHDATA_CRC_COUNT=4,Zt.FAST_HUFFMAN_LENGTH=10,Zt.FAST_HUFFMAN_TABLE_SIZE=1024,Zt.FAST_HUFFMAN_TABLE_MASK=1023,ee.fontGlyphs=function(){for(var t=[],e=32;e<256;){var i=e++;t.push(i)}return t}(),xe.STBTT_vmove=1,xe.STBTT_vline=2,xe.STBTT_vcurve=3,xe.STBTT_MACSTYLE_DONTCARE=0,xe.STBTT_MACSTYLE_BOLD=1,xe.STBTT_MACSTYLE_ITALIC=2,xe.STBTT_MACSTYLE_UNDERSCORE=4,xe.STBTT_MACSTYLE_NONE=8,xe.STBTT_PLATFORM_ID_UNICODE=0,xe.STBTT_PLATFORM_ID_MAC=1,xe.STBTT_PLATFORM_ID_ISO=2,xe.STBTT_PLATFORM_ID_MICROSOFT=3,xe.STBTT_UNICODE_EID_UNICODE_1_0=0,xe.STBTT_UNICODE_EID_UNICODE_1_1=1,xe.STBTT_UNICODE_EID_ISO_10646=2,xe.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,xe.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,xe.STBTT_MS_EID_SYMBOL=0,xe.STBTT_MS_EID_UNICODE_BMP=1,xe.STBTT_MS_EID_SHIFTJIS=2,xe.STBTT_MS_EID_UNICODE_FULL=10,xe.STBTT_MAC_EID_ROMAN=0,xe.STBTT_MAC_EID_ARABIC=4,xe.STBTT_MAC_EID_JAPANESE=1,xe.STBTT_MAC_EID_HEBREW=5,xe.STBTT_MAC_EID_CHINESE_TRAD=2,xe.STBTT_MAC_EID_GREEK=6,xe.STBTT_MAC_EID_KOREAN=3,xe.STBTT_MAC_EID_RUSSIAN=7,xe.STBTT_MS_LANG_ENGLISH=1033,xe.STBTT_MS_LANG_ITALIAN=1040,xe.STBTT_MS_LANG_CHINESE=2052,xe.STBTT_MS_LANG_JAPANESE=1041,xe.STBTT_MS_LANG_DUTCH=1043,xe.STBTT_MS_LANG_KOREAN=1042,xe.STBTT_MS_LANG_FRENCH=1036,xe.STBTT_MS_LANG_RUSSIAN=1049,xe.STBTT_MS_LANG_GERMAN=1031,xe.STBTT_MS_LANG_SPANISH=1033,xe.STBTT_MS_LANG_HEBREW=1037,xe.STBTT_MS_LANG_SWEDISH=1053,xe.STBTT_MAC_LANG_ENGLISH=0,xe.STBTT_MAC_LANG_JAPANESE=11,xe.STBTT_MAC_LANG_ARABIC=12,xe.STBTT_MAC_LANG_KOREAN=23,xe.STBTT_MAC_LANG_DUTCH=4,xe.STBTT_MAC_LANG_RUSSIAN=32,xe.STBTT_MAC_LANG_FRENCH=1,xe.STBTT_MAC_LANG_SPANISH=6,xe.STBTT_MAC_LANG_GERMAN=2,xe.STBTT_MAC_LANG_SWEDISH=5,xe.STBTT_MAC_LANG_HEBREW=10,xe.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,xe.STBTT_MAC_LANG_ITALIAN=3,xe.STBTT_MAC_LANG_CHINESE_TRAD=19,xe.STBTT_MAX_OVERSAMPLE=8,xe.STBTT_RASTERIZER_VERSION=2,Le.bufferSize=1500,Le.vertexSize=9,Ne.bufferSize=1e3,Ne.triangleBufferSize=1e3,Pe.bufferSize=1e3,Xe.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Xe.instances=[],Xe.connectListeners=[],Xe.disconnectListeners=[],qe.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},qe.keyBehavior=Qe.Default,je.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},ti.bufferSize=2e3,ei.mat=new Float32Array(16),ni.width=3,ni.height=3,ri.width=4,ri.height=4,li.width=3,li.height=3,ui.width=4,ui.height=4,_i.nextId=0,vi.START=0,vi.ENTITY_UPDATES=1,vi.CONTROLLER_UPDATES=2,vi.REMOTE_CALL=3,vi.PING=4,vi.SESSION_ERROR=5,vi.PLAYER_UPDATES=6,vi.RPC_SERVER=0,vi.RPC_ALL=1,mi.nextId=0,mi.objects=[],bi.global=new bi,Si.assetMap=new $,Si.events=[],Si.screenW=-1,Si.screenH=-1,Si.locale="en",Si.h=new bi,Si.elemId=-1,Si.assetId=-1,yi.dataPath="",yi.lastPath="",yi.kx=1,yi.ky=.6666666666666666,yi.kz=.3333333333333333,yi.kw=3,yi.ar=[0,0,0],yi.Kx=0,yi.Ky=-.3333333333333333,yi.Kz=.6666666666666666,yi.Kw=-1,yi.e=1e-10,xi.i=0,Ei.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:4,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:6,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-13421773,WINDOW_TINT_COL:-1,ACCENT_COL:-12303292,ACCENT_HOVER_COL:-12040120,ACCENT_SELECT_COL:-10461088,PANEL_BG_COL:-13421773,PANEL_TEXT_COL:-1513499,BUTTON_COL:-12040120,BUTTON_TEXT_COL:-1513499,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-1513499,LABEL_COL:-3618616,ARROW_COL:-1513499,SEPARATOR_COL:-14211289,HIGHLIGHT_COL:-14656100},Ei.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:12,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887,HIGHLIGHT_COL:-14656100},Ti.alwaysRedrawWindow=!0,Ti.textToPaste="",Ti.textToCopy="",Ti.isCut=!1,Ti.isCopy=!1,Ti.isPaste=!1,Ti.copyFrame=0,Ti.comboFirst=!0,Et.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);